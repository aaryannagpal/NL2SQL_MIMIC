id,question,true_query,generated_sql,result
7615134b4fa7ff6ddf73b525,Tell me the total number of patients who were discharged from the hospital in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'","SELECT COUNT(DISTINCT ""patient_id"") FROM ""discharge_summary"" WHERE ""discharge_year"" = 2100",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
828e100d1270a025a702476f,Tell me what was patient 10018423's daily maximum weight since 28 months ago?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10018423 AND date > CURRENT_DATE - INTERVAL '28 month' GROUP BY date,[]
138c2d22c5c0e542ad8688f0,What diagnosis did patient 10010471 receive in the first hospital encounter for the last time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10010471 AND NOT diagnoses.hospital_dischtime IS NULL ORDER BY diagnoses.hospital_admittime NULLS FIRST LIMIT 1;,
7a437c8dbddf61c5a8051a64,Show me the top three most frequent drugs that patients were prescribed within the same hospital visit after being diagnosed with hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (LUTS)' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, prescriptions.drug, prescriptions.prescription_date FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE DATETIME(prescriptions.prescription_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.",
c47c4a63334997fb668032de,What the proccedural of the drugs against cancer is?,,,
2e71a00ad2d28b3a77dfcd7e,Count the number of current patients who are in their 60 or above.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT(*) FROM current_patients WHERE age >= 60;,
8716193b576f9f33068e792d,Are any new drugs prescribed to patient 10004733 today compared to the ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT SUM(CASE WHEN date_sub('day', 1, current_date) = date_sub('day', 1, T1.date) THEN 1 ELSE 0 END) FROM (SELECT date FROM patient_drugs WHERE patient_id = 10004733) AS T1 JOIN (SELECT date FROM patient_drugs WHERE patient_id = 10004733) AS T2 ON T1.date = T2.date WHERE T1.date <> T2.date",[]
85e6a823fac4aece9e3933ba,When did patient 10011398 get the microbiology test for the last time in 12/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(date) FROM microbiology WHERE patient = 10011398 AND date_part('month', date) = 12 AND date_part('year', date) = 2022",[]
30472e5c27673faeb87b6a0d,What was the total number of patients on hematology/oncology in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT(DISTINCT diagnosis_date) FROM diagnoses WHERE service_type = 'hematology/oncology' AND STRFTIME('%y', diagnosis_date) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
a7865e6aada988aba5950707,Can you tell the yearly maximum dose of pacu crystalloid intake that patient 10008454 received since 08/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pacu crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-08' GROUP BY strftime('%Y',inputevents.starttime)",SELECT MAX(dose) FROM intake WHERE patient_id = 10008454 AND intake_name = 'pacu crystalloid' AND date >= '08/2100' GROUP BY date,[]
db468e7d4e952084d2241b01,Could you list patient 10004235's monthly average weight since 03/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10004235 AND date >= '2000-03-2100' GROUP BY date ORDER BY date NULLS FIRST,[]
9811bdd8dd976caed209c6a2,What percentile is the value of the mcv of 80.0 among patients of the same age as patient 10018423 during the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 80.0","SELECT value FROM (SELECT mcv(age(current_date, patient.age(current_date, '-1 year'))) AS value FROM patient WHERE patient.age(current_date, '-1 year') = (SELECT patient.age(current_date, '-1 year') FROM patient WHERE patient.uniquepatientid = 10018423 AND NOT patient.hospitaldischtime IS NULL ORDER BY patient.hospitaladmittime DESC LIMIT 1)) AS subquery WHERE value = 80.0",
8730272c87597016340a1b9a,What was the overall amount of input for patient 10016742 since 07/11/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-11'",SELECT SUM(input) FROM input_table WHERE patient_id = 10016742 AND date >= '2100-07-11',[{'SUM(inputevents.totalamount)': 36640.0}]
ed8eb61d00ca803fbe330b9c,What are the top five most frequently performed procedures for patients who are 30s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT * FROM patients WHERE my_age BETWEEN 30 AND 39) AS t1 JOIN procedures ON t1.treatment = procedures.treatment) AS t2 GROUP BY t2.treatment ORDER BY COUNT(t2.treatment) DESC LIMIT 5",
f7b36fae7e1f6246c0b81fd5,Count the number of hospital visits for patient 10022041 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022041 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(DISTINCT HOSP_VISIT) FROM hospital_visits WHERE PATIENT_ID = 10022041 AND STRFTIME('%y', HOSP_VISIT_DATE) >= '2100';",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
e2b4b7e5509dd99e1a88449e,What is the percentile ranking of a phosphate test value of 8.7 for patients of the same age as patient 10014354 on their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.7",SELECT DISTINCT t1.c1 FROM (SELECT percent_rank() OVER (ORDER BY phosphate_test) AS c1 FROM patients WHERE age = (SELECT age FROM patients WHERE id = 10014354 AND NOT last_hospital_visit IS NULL ORDER BY age DESC LIMIT 1)) AS t1 WHERE t1.c1 = 8.7,
77020ee533db2c04412900f0,What code is associated with icd-11 for helicobacter pylori in icd-10?,,SELECT icd_11_code FROM icd_10_to_icd_11 WHERE icd_10_code = 'helicobacter pylori',
620d90e5c2bc12b7e637d7b2,"In patients who had the other repair of vessel in 2100, what were the four most common diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.date FROM (SELECT DATE '2100-01-01' AS date FROM patients WHERE other_repair_of_vessel = 'other repair') AS t1 JOIN (SELECT patient_id, diagnosis, date FROM diagnoses WHERE date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month')) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 4",
02c15c7a4faad2a32636fac7,What was patient 10011398's documented weight on the last record in 12/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '12' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT patient.documented_weight FROM patient WHERE patient.patient_id = 10011398 AND DATETIME(patient.documented_weight_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', patient.documented_weight_date) = '12';",[]
ce9d557587a02ef7b5b69000,When did last patient 10005348 have the minimum value of calculated total co2?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT last(timestamp) FROM patients WHERE patient_id = 10005348 AND activity_domain = 'calculated total co2',[]
5d18dc5b86410f1a0b68d571,"What is the diagnosis cost of urinary tract infection, site not specified?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) )","SELECT SUM(Diagnosis_Cost) FROM diagnoses WHERE Diagnosis = 'Urinary tract infection, site not specified'",
81e40ba71ccb07316db2401c,When was the last time patient 10007058 had the minimum heart rate since 11/20/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-20' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1","SELECT MAX(heart_rate) FROM patient WHERE patient.id = 10007058 AND heart_rate IS NOT NULL AND date_since(heart_rate, '11/20/2100')",[]
9d5b103ab75bc4e5ec507f0a,Calculate the length of stay in days for patient 10007058's last ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', ICU.EXIT_DATE) - STRFTIME('%j', ICU.ADMIT_DATE) FROM ICU WHERE ICU.PATIENT_ID = 10007058 AND NOT ICU.EXIT_DATE IS NULL ORDER BY ICU.ADMIT_DATE DESC LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.022962963208556}]"
451dfc06ff9455d76225f86b,Can you point to a genetic test that patient 655 received?,,"SELECT ""genetic_test"" FROM ""patient_655"" WHERE ""genetic_test"" IS NOT NULL;",
e7693ad9894979dd2cf53541,How much is the drug perphenazine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'perphenazine' ),"SELECT DELIMITER ',' FROM (SELECT DISTINCT ON (drug_name) drug_name, dose_forms FROM drugs WHERE drug_name = 'perphenazine') AS subquery;",
bf0f4f576e73bf0337820ba1,"What are the charges for a procedure called occlusion of right vertebral artery with intraluminal device, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) )","SELECT ""Charges"" FROM ""Procedures"" WHERE ""Procedure"" = 'Oclusion of right vertebral artery with intraluminal device, percutaneous approach'",
56dc9b6a0a55ec1fc9f4a5c8,Could you inform me of the top four most common specimen tests that were conducted during this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT t.specimen, COUNT(t.specimen) FROM top_four_species t WHERE t.year = 2022 GROUP BY t.specimen ORDER BY COUNT(t.specimen) DESC LIMIT 4",[]
7dab61a9dbafa23e083cd77e,Was patient 10004720 given any gt flush medication on this month/08?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '08'",SELECT COUNT(*) FROM patient WHERE patient.id = 10004720 AND patient.medication_start_date = '2022-04-08' AND patient.medication = 'Gt Flush',[{'COUNT(*)>0': 0}]
1533c631557452d754da7280,When was the last time patient 10004733 measured its heart rate greater than 118.0 during their first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 118.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(heart_rate_measurement_time) FROM patient_heart_rate_measurements WHERE patient_id = 10004733 AND heart_rate > 118.0 AND NOT icu_visit_number = 1,[]
8d3d64b56c340125f70300f3,Count the number of drugs prescribed since 24 months ago for patient 10003046.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')","SELECT COUNT(*) FROM drugs WHERE drugs.patient_id = 10003046 AND DATETIME(drugs.date_prescribed) >= DATETIME(CURRENT_TIME, '-24 month')",[{'COUNT(*)': 84}]
ca0b792691b7ae80aefbc093,Is there a genetic test that was given to patient 1561?,,"SELECT DISTINCT T1.test_name FROM lab_tests AS T1 JOIN patient_tests AS T2 ON T1.test_id = T2.test_id WHERE T2.patient_id = 1561 AND T1.test_type = ""genetic""",
27c48e778f2f116680270dd6,Give me the top three most frequently prescribed drugs within 2 months for patients in their 20s who were diagnosed with long-term (current) use of anticoagulants.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'long-term (current) use of anticoagulants') AS t1 JOIN (SELECT patient.id, prescription.drug, prescription.date FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE patient.age BETWEEN 20 AND 29) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.drug) AS t3 WHERE t3.c1 <= 3",
74fa66a731eaa7d33a261eba,Calculate the length of stay in days for patient 10015860's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', icu.out_time) - STRFTIME('%j', icu.in_time) AS length_of_stay_days","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.7518518520519137}]"
7817472ef455fc770676dced,How was patient 10020187 admitted in terms of admission type for the last time at the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020187 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1","SELECT T1.AdmissionType FROM (SELECT AdmissionType, COUNT(AdmissionType) AS c FROM (SELECT PatientID, AdmissionType FROM (SELECT PatientID, 'admitted' AS AdmissionType FROM ""admissions"") UNION ALL SELECT PatientID, 'discharged' AS AdmissionType FROM ""discharges"") AS T GROUP BY AdmissionType) AS T1 WHERE T1.c = (SELECT MAX(c) FROM (SELECT AdmissionType, COUNT(AdmissionType) AS c FROM (SELECT PatientID, AdmissionType FROM (SELECT PatientID, 'admitted' AS AdmissionType FROM ""admissions"") UNION ALL SELECT PatientID, 'discharged' AS AdmissionType FROM ""discharges"") AS T GROUP BY AdmissionType) AS T1 JOIN patients ON T1.PatientID = patients.SSN WHERE patients.SSN = 10020187",[]
fa7d7ca1c281f5d1e6a549c9,Has patient 10004720 had gastric meds input since 10/02/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-02'",SELECT COUNT(*) > 0 FROM input_gastric_meds WHERE patient_id = 10004720 AND input_date >= '2100-10-02',[{'COUNT(*)>0': 0}]
a38ecaf9f7fe8c5a81432f27,What is the monthly maximum value of weight for patient 10009049 since 01/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10009049 AND date >= '01/2100' GROUP BY month,[]
a3279eb9747f960bcb7b62b6,What percentile is 16.5 white blood cells in a patient of the same age as patient 10031757 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 16.5","SELECT 10031757.age, 16.5 FROM 10031757 WHERE 10031757.age = (SELECT 10031757.age FROM 10031757 WHERE 10031757.age = (SELECT MAX(10031757.age) FROM 10031757 WHERE 10031757.age = (SELECT DOCTOR.age FROM DOCTOR WHERE DOCTOR.name = 'Jane Doe'))) AND 10031757.age = (SELECT MAX(10031757.age) FROM 10031757 WHERE 10031757.age = (SELECT DOCTOR.age FROM DOCTOR WHERE DOCTOR.name = 'Jane Doe'))",
97b11bd8315c504b3001f159,Expose the top five most frequent output events since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT COUNT(DISTINCT output) FROM (SELECT output FROM program WHERE frequency > 2100 ORDER BY frequency DESC LIMIT 5),"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
c07fa4ddf84fc8c4cfd717ab,What was the total dose of levetiracetam patient 10001217 had been prescribed in 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'levetiracetam' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'",SELECT SUM(levetiracetam) FROM patients WHERE patient_id = 10001217 AND month = '12' AND year = 2000,[{'SUM(prescriptions.dose_val_rx)': None}]
27cbb7342a12ed24d5662980,"What was the drug that patient 10025463 was prescribed for during the same hospital encounter after the procedure of excision or destruction of other lesion or tissue of heart, endovascular approach?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision or destruction of other lesion or tissue of heart, endovascular approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.uniquecarrier, treatment.startdate, patient.patient_name FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE patient.patient_name = '10025463' AND treatment.treatment_name = 'excision or destruction of other lesion or tissue of heart, endovascular approach') AS t1 JOIN (SELECT patient.uniquecarrier, drug.drug, drug.startdate FROM drug JOIN patient ON drug.patient_id = patient.patient_id WHERE patient.patient_name = '10025463') AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.startdate < t2.startdate AND t1.patient_name = t2.patient_name",
2ad3296a49ba1754c226eef3,What was the overall amount of input for patient 10007818 on 07/17/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-17'",SELECT SUM(input) FROM input_table WHERE patient_id = 10007818 AND input_date = '07/17/2022',[{'SUM(inputevents.totalamount)': None}]
32d7327a3beff353c0d3b98e,Tell me the name of the organism found in patient 10019172's last urine microbiology tests since 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT name FROM microbiology WHERE microbiology.patient_id IN (SELECT patients.patient_id FROM patients WHERE patients.last_urine_microbiology = true AND patients.patient_id = 10019172) AND microbiology.type = 'organism' AND STRFTIME('%y-%m', microbiology.date) >= '2100-10' ORDER BY microbiology.date DESC LIMIT 1",[]
000f58d3abb4ad76b2ebc35c,When was the first time the respiratory rate of patient 10018081 was measured to be less than 23.0 today?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 23.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(respiratory_rate) FROM respiratory_rate WHERE patient_id = 10018081 AND respiratory_rate < 23.0 AND DATETIME(respiratory_rate_date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day')",[]
42338b681fd350441ca9efc0,Do patient 19894 have a appointment in another department?,,SELECT COUNT(DISTINCT T1.date) FROM Appointment AS T1 JOIN Patient AS T2 ON T1.patient_id = T2.patient_id WHERE T2.patient_id = 19894 AND T1.department <> (SELECT department FROM Appointment WHERE patient_id = 19894 ORDER BY date NULLS FIRST LIMIT 1),
43dc5805c85d11ad9ce1eb53,Count the total number of hospital visits made by patient 10029291 in the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10029291 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT HOSPITAL_ID) FROM visit_table WHERE PATIENT_ID = 10029291 AND DATETIME(VISIT_DATE, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year');",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
648035b87d03c40993442aeb,"On the current hospital visit, how many hours have passed since patient 10018081's first diagnosis of abnormal coagulation profile?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE patient_id = 10018081 AND diagnosis_type = ""abnormal coagulation profile"" AND hospital_active = 1",
d289ae08b9d6d02468d8c8d2,"Since 22 months ago, how much did patient 10019172 weigh during the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT 10019172.weight FROM 'weight_log.csv' WHERE date = (SELECT date FROM 'weight_log.csv' WHERE patient_id = 10019172 ORDER BY date DESC LIMIT 1) AND measurement_id = 1,[]
6874b240b1ee6575829fb705,"Which were the three most commonly ordered procedures for patients previously diagnosed with streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus] during the same month, since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, t2.month FROM (SELECT t1.treatment, t1.month FROM (SELECT 'streptococcus' AS treatment, DATEADD(MONTH, -1, GETDATE()) AS month FROM streptococcus WHERE streptococcus.site = 'unspecified') AS t1 GROUP BY t1.treatment) AS t2 GROUP BY t2.treatment, t2.month) AS t3 WHERE t3.treatment = ANY(SELECT t2.treatment FROM (SELECT 'streptococcus' AS treatment, DATEADD(MONTH, -1, GETDATE()) AS month FROM streptococcus WHERE streptococcus.site = 'unspecified') AS t2 GROUP BY t2.treatment) AND t3.month = ANY (SELECT t2.month FROM (SELECT 'streptococcus' AS treatment, DATEADD(MONTH, -1, GETDATE()) AS month FROM streptococcus WHERE streptococcus.site",
0d8f8539a8e82f5daa90562f,What precautions should you follow after the cont inv mec ven 96+ hrs procedure?,,SELECT * FROM duckdb_procedures WHERE procedure_name = 'cont inv mec ven 96+ hrs';,
7f9c0eb6e47a6e07284a459d,"Has patient 10007818 undergone a insertion of endotracheal airway into trachea, via natural or artificial opening since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal airway into trachea, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.patientId = 10007818 AND procedures.procedureType = 'Insertion of endotracheal airway into trachea, via natural or artificial opening' AND STRFTIME('%y', procedures.procedureDate) >= '2100'",
30ed0a6953999ac4024916ae,What is the minimum total cost of the hospital which involves calculus of kidney?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(DISTINCT t1.total_cost) FROM (SELECT SUM(cost) AS total_cost FROM cost_table WHERE cost_type = 'calculus of kidney' GROUP BY cost_table.patient_id) AS t1,
7b8292b0a8f2a804114ac706,"How many hours have elapsed since the last time during their current hospital encounter that patient 10004733 was diagnosed with chronic kidney disease, unspecified?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE patient_id = 10004733 AND diagnosis = 'Chronic kidney disease, unspecified'",
ffcd5cfa2ddc5dc30fef4cd5,"When, since 03/30/2100, was patient 10020740's respiratory rate measured less than 21.0 for the first time?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-03-30' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(RespiratoryRate) FROM RespiratoryRate WHERE PatientID = 10020740 AND RespiratoryRate < 21.0 AND MeasurementDate >= '2003-03-30',[]
1f400039f5811e19f5da4593,Do you think patient 29540 is subject to covid-19 testing?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_id = 29540 AND patients.covid_19_testing = 'yes',
63dc3947dde2cd40f4b0c364,How much metronidazole (flagyl) had been prescribed to patient 10001217 in total in 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'metronidazole (flagyl)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'","SELECT SUM(metronidazole (flagyl)) FROM prescriptions WHERE prescriptions.patient_id = 10001217 AND STRFTIME('%y-%m', prescriptions.date) = '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}]
c0dcb9d8aed598dc3c1ff8fd,What is the cost for the drug acetazolamide sodium?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' ),"SELECT ""cost"" FROM ""drug"" WHERE ""drug"" = 'acetazolamide sodium'",
016d92926546ac6ede02409b,What is the anion gap percentile of 11.0 among patients of the same age as patient 10014729 during their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.0","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, MIN(hospital.age) AS c1 FROM patient JOIN hospital ON patient.age = hospital.age WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = '10014729') GROUP BY patient.age) AS t1 JOIN (SELECT patient.age, MIN(hospital.age) AS c1 FROM patient JOIN hospital ON patient.age = hospital.age WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = '11.0')) AS t2 ON t1.age = t2.age",
4e4d519fec610e5878e325da,List the three most frequent specimens that were tested during this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",SELECT specimen FROM inventory WHERE date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 3;,[]
ffc00c5a91336c29e74e82e7,Name the three most frequently prescribed drugs in the same hospital visit following a diagnosis of pure hypercholesterolemia.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate, patient.patientname FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'Pure hypercholesterolemia') AS t1 JOIN (SELECT patient.uniquepid, drug.drug, drug.drugdate, patient.patientname FROM drug JOIN patient ON drug.patientid = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.drugdate AND DATETIME(t1.diagnosisdate, 'start of hospital') = DATETIME(t2.drugdate, 'start of hospital') GROUP BY t2.drug) AS t3 WHERE t3.c1 <= 3",
072f960a91e48e6fe38d81a1,Calculate the number of prescribed drugs for patient 10001725 in 04/this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10001725 AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '04'",[{'COUNT(*)': 0}]
e8433f2ef9b3e709b1fe04cf,"Count the number of people who were diagnosed with other disorders of muscle, ligament, and fascia since 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other disorders of muscle, ligament, and fascia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(*) FROM diagnoses WHERE diagnosis = 'other disorders of muscle, ligament, and fascia' AND year >= 2100",
3a3cae7df796116acb43c341,"Give me the top three most frequent lab tests that patients were given after being diagnosed with allergic rhinitis, unspecified in the same hospital encounter in 2100.","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Allergic rhinitis, unspecified"" AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100') AS t1 JOIN (SELECT admissions.subject_id, lab_test, lab_date FROM lab_tests JOIN admissions ON lab_tests.admission_id = admissions.admission_id WHERE STRFTIME('%y', lab_date) = '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.lab_date AND t1.admission_id = t2.admission_id GROUP BY t2.lab_test) AS t3 WHERE t3",
4f998b87cac41752ae6d9248,What was the name of the insurance used for patient 10000032 during their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT i.insurance_name FROM insurances i WHERE i.patient_id = 10000032 AND NOT i.end_date IS NULL ORDER BY i.start_date DESC LIMIT 1,[{'insurance': 'Medicaid'}]
9e84a6e731e2b335a972b488,What was the last drug that was prescribed to patient 10038992 in their last hospital encounter via the oral route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10038992 AND prescriptions.route = 'ORAL',[]
9da1c2b4d2477e7d54541e82,Show me the top three most frequent diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 3;","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]"
3ed75cc0aecb87eee22cf8e5,"What are the four frequently ordered treatments for patients who were diagnosed with other and unspecified alcohol dependence, continuous during the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, continuous' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment FROM (SELECT diagnosis.treatment FROM diagnosis WHERE diagnosis.diagnosis = 'Other and unspecified alcohol dependence, continuous') AS t GROUP BY t.treatment) AS t1 JOIN (SELECT treatment.treatment FROM treatment WHERE treatment.treatment = 'Monthly reinforcement') AS t2 ON t1.treatment = t2.treatment WHERE DATETIME(t1.treatment, 'start of month') = DATETIME(t2.treatment, 'start of month') GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 4",
d1c500e1dc43c5cae4cf9075,"What is the maximum total cost for a hospital visit that involved a amylase, ascites lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.total_cost) FROM (SELECT SUM(cost) AS total_cost FROM cost_table WHERE cost_table.product_type = 'lab' AND cost_table.product_name = 'amylase, ascites' GROUP BY cost_table.cost_id) AS t1",
ba17453769db45c0f15880db,"What are the five most commonly prescribed medications for patients who were diagnosed with atherosclerotic heart disease of native coronary artery without angina pectoris previously in the same month, in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery without angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Atherosclerotic heart disease of native coronary artery without angina pectoris' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE STRFTIME('%y', medication.date) = '2100') AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 5",
b294fc478c483f32414156f0,"What are the top four most common specimens tested after receiving excision of left main bronchus, via natural or artificial opening endoscopic in the same hospital encounter since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT 'left main bronchus' AS specimen, COUNT('left main bronchus') AS count FROM patients WHERE NOT patients.dischtime IS NULL AND patients.admittime >= '2100-01-01') AS t2 GROUP BY t2.specimen) AS t3 GROUP BY t3.specimen) AS t4 WHERE t4.count > 2000 GROUP BY t4.specimen ORDER BY COUNT(t4.specimen) DESC",
a09c071ef325a1bc1e1417a1,"Provide a list of the four most common diagnoses that patients were diagnosed with within 2 months after undergoing the extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic procedure.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT diagnosis FROM (SELECT patient.uniquepid, diagnosis.diagnosis FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis IN ('extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic procedure')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis IN ('extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic procedure')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis <> t2.diagnosis AND DATETIME(t2.diagnosis, 'start of month') BETWEEN DATETIME(t1.diagnosis, 'start of month') AND DATETIME(t1.diagnosis, 'start of month', '+2 month') GROUP BY t1.uniquepid, t1.diagnosis ORDER BY COUNT(*) DESC LIMIT 4",
bb7840631855547af8253009,When was the last time that patient 10011398 was prescribed a medication since 10/2100 via im?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM medication_usage WHERE patient_id = 10011398 AND date_prescribed >= '2000-10-21' AND prescription_method = 'im',[]
5103a06a571d43b9da46cda7,Tell me the length in days of the first stay for patient 10020740 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT MIN(LENGTH(STAY_DATE(1))) AS days FROM patient WHERE PATIENT_ID = 10020740 AND NOT ICU_ID IS NULL,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 7.446423612069339}]"
05c1bc3943f37d24fbc4a227,What was patient 10009049's last tested culture since 24 months ago?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-24 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT patient.name, patient.culture, TIMESTAMP '2022-01-01 10:00:00' - INTERVAL '24 month' as last_tested",[{'spec_type_desc': 'BLOOD CULTURE'}]
5c872eafe61305c165ef7490,Tell me the reimbursement standard for a drug?,,"SELECT ""reimbursement_standard"" FROM ""drug"" WHERE ""drug"" = 'ibuprofen'",
0741b96a36302acf8ace5c02,When since 07/2100 did patient 10016810 receive the sodium test for the last time?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(date) FROM lab WHERE lab.patient = 10016810 AND lab.test = 'sodium' AND STRFTIME('%y-%m', lab.date) >= '2100-07';",[]
4e5496cc5a22509ea5c3e4e8,"Since 1 year ago, how many insertion of endotracheal airway into trachea, via natural or artificial opening procedures were there?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal airway into trachea, via natural or artificial opening' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'insertion of endotracheal airway into trachea, via natural or artificial opening' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
8b0171b645230d02485753dc,How many hours has it been since the first diagnosis of candidiasis of mouth in patient 10018081 during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT SUM(24) FROM diagnoses WHERE diagnoses.patient_id = 10018081 AND diagnoses.diagnosis = 'candidiasis of mouth' AND DATETIME(diagnoses.diagnosis_date) = DATETIME(CURRENT_TIME, '-0 year')",
7699b4e5c410adc67ecb3537,What is the treatment that patient 10007795 was given two or more times since 23 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-23 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT patient.id, treatment.treatment, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.id WHERE patient.id = 10007795 AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-23 month')) AS t1 GROUP BY t1.treatment HAVING COUNT(t1.treatment) >= 2",
137db7f9de6adce5df221be5,How often did patient 10039997 go to the ICU on the first hospital encounter?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(DISTINCT ICU_VISITS.ICU_VISIT_DATE) FROM icu_visits WHERE ICU_VISITS.PATIENT_ID = 10039997 AND NOT ICU_VISITS.HOSPITAL_DEPARTMENT IS NULL ORDER BY ICU_VISITS.ICU_VISIT_DATE NULLS FIRST LIMIT 1,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
1858b068f17e456b42371330,Show the mean blood pressure changes of patient 10031757 last measured on the first ICU visit compared to the value second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT mean_blood_pressure FROM (SELECTblood_pressure FROM patient_blood_pressure WHERE patient_id = 10031757 AND icu_index = 1) AS T1 JOIN (SELECTblood_pressure FROM patient_blood_pressure WHERE patient_id = 10031757 AND icu_index = 1) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.measurement_time = T2.measurement_time ORDER BY T1.measurement_time DESC LIMIT 1) - (SELECT mean_blood_pressure FROM (SELECTblood_pressure FROM patient_blood_pressure WHERE patient_id = 10031757 AND icu_index = 1) AS T1 JOIN (SELECTblood_pressure FROM patient_blood_pressure WHERE patient_id = 10031757 AND icu_index = 1) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.measurement,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
2c1feec1d1f2e0f1260812d2,What are the three most common diagnoses of patients in their 30s this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.uniquepid WHERE diagnosis.onset = ONSET AND patient.age BETWEEN 30 AND 39) AS t1 WHERE t1.c1 <= 3",
08a1f3896026c957daada255,What's the average daily number of admissions for other specified coagulation defects in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",SELECT AVG(daily_admissions) FROM admissions WHERE other_coagulation_defect = '2100',
d5968ba9a98b70f548218263,"So, the last glucose test result for the patient 10018423 on the last hospital visit was?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1,"SELECT last_glucose FROM (SELECT patient_id, hospital_sequence, glucose FROM (SELECT patient_id, hospital_sequence, glucose FROM (SELECT patient_id, hospital_sequence, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, glucose FROM (SELECT patient_id, gl",[]
d22a0040ed5e1ed60f2c89ea,"What was the first time that patient 10004422 was prescribed aspirin ec and milk of magnesia in 01/this year, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin ec' AND admissions.subject_id = 10004422 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10004422 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT t1.date FROM (SELECT PATIENT_ID, DATE '2022-01-01' AS date FROM prescriptions WHERE PATIENT_ID = 10004422 AND MEDICINE_NAME = 'aspirin ec') AS t1 JOIN (SELECT PATIENT_ID, DATE '2022-01-01' AS date FROM prescriptions WHERE PATIENT_ID = 10004422 AND MEDICINE_NAME = 'milk of magnesia') AS t2 ON t1.patient_id = t2.patient_id WHERE DATETIME(t1.date) = DATETIME(t2.date) ORDER BY t1.date NULLS FIRST LIMIT 1",[]
f4ea3a1a0ad748d9673ee4c3,"What was the name of the organism found in the first microbiology test conducted on patient 10021487's fluid,other since 03/2100?","SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT organism_name FROM microbiology WHERE patient_id = 10021487 AND sample_type = 'fluid,other' AND date_test > '2000-03-21' ORDER BY date_test NULLS FIRST LIMIT 1",[]
75f06d4831e589b2c6c537f0,What medication was prescribed for the last time since 04/2100 to patient 10015931?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT medication FROM prescriptions WHERE patient = 10015931 AND date >= '2000-04-21' ORDER BY date DESC LIMIT 1;,[{'drug': 'LORazepam'}]
f67318674d2ce3452b9792f6,When did patient 10038933 since 07/17/2100 for the first time have an input?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-17' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT input FROM Brackets WHERE patient = '10038933' AND input_date >= '2100-07-17' ORDER BY input_date NULLS FIRST LIMIT 1,[{'starttime': '2148-09-10 13:30:00'}]
6857374e8a42190064459f79,"How much does a procedure known as drainage of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'Drainage of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic'",
10a89ace2e918f90758fc385,When did patient 10021487 receive the last prescription of sodium bicarbonate and famotidine at the same time in 12/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",,[]
c469f81f092e3b28dadc05f4,What was diagnosed for patient 10002930 the last time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE patient = 10002930 ORDER BY diagnosis_date DESC LIMIT 1,
24d90e86a7032d40c367258d,When did patient 10003046 last have their maximum SaO2 in the last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(SaO2) FROM (SELECT SaO2 FROM ICU WHERE ICU.patientId = 10003046),[]
741e6bfd3ada80120eff4191,Has patient 10002930 received a medication prescription since 02/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'","SELECT COUNT(*) > 0 FROM medication_prescriptions WHERE medication_prescriptions.patient_id = 10002930 AND STRFTIME('%y-%m', medication_prescriptions.date) >= '2100-02'",[{'COUNT(*)>0': 1}]
8325c8b0200f0d5f16e96fd7,How much did patient 10021487 weigh during their first measurement in 12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT weight FROM patients WHERE patient_id = 10021487 AND measurement_date = '12/2100' ORDER BY measurement_date NULLS FIRST LIMIT 1;,[]
df4e908303402aa200726682,Provide me with all of the prescriptions received by patient 16879 in another department.,,SELECT prescriptions FROM pharmacy WHERE pharmacy_id IN (SELECT pharmacy_id FROM prescriptions WHERE patient_id = 16879),
dd41fa87a9bb005a4d9cfe78,"If it is a cerebrovascular mri, what's the reimbursement standard?",,SELECT MAX(reimbursement_standard) FROM procedures WHERE procedure_type = 'Cerebrovascular MRI';,
f7f753ce0654fdfa9372170c,How many days was patient 10029291's last stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', patients.INTENSIVE_CARE_UNIT_LENGTH) - STRFTIME('%j', patients.INTENSIVE_CARE_UNIT_LENGTH) FROM patients WHERE patients.PATIENT_ID = 10029291 AND NOT patients.INTENSIVE_CARE_UNIT_LENGTH IS NULL ORDER BY patients.INTENSIVE_CARE_UNIT_LENGTH DESC LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 6.4747916660271585}]"
d0de144bda7a040a2f9dfa07,Can you tell me when patient 10007818's first microbiology test was in 06/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-06' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT patient.first_microbiology_test FROM patient WHERE patient.patient_id = 10007818 AND STRFTIME('%y-%m', patient.first_microbiology_test) = '2100-06'",[]
53c2c01705d8513ebac151eb,What was the total of potassium chloride (powder) patient 10021118 had been prescribed since 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.drug = 'potassium chloride (powder)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'",SELECT SUM(potassium chloride (powder)) FROM prescriptions WHERE patient = 10021118 AND start_date >= '12/2100',[{'SUM(prescriptions.dose_val_rx)': None}]
9c5b3244cf12068e0fc12891,Will patient 28443 receive any additional immunology test?,,SELECT COUNT(*) > 0 FROM test WHERE test.patient_id = 28443 AND test.type = 'immunology',
695dff1ad99f6d2eb4de81db,"What are the five commonly ordered medications that patients aged 60 or above were prescribed in the same month after diagnosed with retention of urine, unspecified in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'retention of urine, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t5.name FROM (SELECT t4.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t3.name, t3.time FROM (SELECT 'Retention of urine, unspecified' AS name, '2100-01-01 12:30:00' AS time FROM diagnoses WHERE diagnoses.name = 'Retention of urine, unspecified') AS t3 JOIN (SELECT patient.name, medication.time FROM medication JOIN patient ON medication.patient = patient.name WHERE patient.age >= 60) AS t4 ON t3.name = t4.name WHERE t3.time < t4.time AND DATETIME(t3.time, 'start of month') = DATETIME(t4.time, 'start of month') GROUP BY t4.name) AS t5 WHERE t5.c1 <= 5",
e3d50b7cc908a38055145b12,"What are the three most commonly prescribed medications for patients who were previously diagnosed with grand mal status within the same month, this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'grand mal status' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Grand mal status' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE DATETIME(medication.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t2.name",
ba3296488999e2e149c3a32e,How often was other enterostomy done?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other enterostomy' ),SELECT COUNT(*) FROM procedures WHERE procedure_name = 'other enterostomy',[{'COUNT(*)': 0}]
5005d7619cfd562a1af8ba4e,What was the last time that patient 10003046 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003046 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.hospitaldischargeid = 10003046;,[]
9ad2b349b566ce28567c5d6b,When was patient 10005817's last microbiological examination since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(Microbiology_Date) FROM Microbiology WHERE Microbiology.Patient_ID = 10005817 AND STRFTIME('%y-%m', Microbiology_Date) >= '2100-03'",[{'charttime': '2135-01-16 16:27:00'}]
ddf67e92449897f5c52db5d2,List the top four most frequent microbiology tests that were given to patients after they were diagnosed with sepsis during the same hospital visit during this year.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t3.Microbiology, COUNT(t3.Microbiology) FROM (SELECT t2.Microbiology, t1.diagnosis_date, t1.hadm_di FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.hadm_di FROM diagnoses JOIN admissions ON diagnoses.hadm_admission = admissions.hadm_admission WHERE diagnoses.diagnosis = 'sepsis') AS t1 JOIN (SELECT admissions.subject_id, microbiology.microbiology, admissions.hadm_di FROM microbiology JOIN admissions ON microbiology.hadm_admission = admissions.hadm_admission WHERE DATETIME(microbiology.microbiology_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.microbiology_date AND t1.hadm_di = t2.hadm_",
7766442f90d1794d8c97fdfb,Has patient 10023117 entered the hospital in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) = '2100'",SELECT COUNT(*) > 0 FROM hdb.patients WHERE hdb.patients.entered_hospital = '2100' AND hdb.patients.uniquepatientid = 10023117,[{'COUNT(*)>0': 0}]
00b98d0bf4d50497625b257e,Has patient 10019917 been given any drugs in 04/last year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) > 0 FROM patient WHERE patient.patient_id = 10019917 AND DATETIME(patient.last_drug_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year') AND STRFTIME('%m', patient.last_drug_date) = '04'",[{'COUNT(*)>0': 0}]
d6557e346d781e08feab81d0,How many patients in 2100 were diagnosed with hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis FROM diagnoses WHERE diagnosis = 'Hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (LUTS)' AND year = 2100) AS t1 JOIN (SELECT subject_id, diagnosis FROM diagnoses WHERE diagnosis = 'Hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (LUTS)' AND year = 2100) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis = t2.diagnosis",
226565b9dfa316da14138b50,"What was patient 10007795's maximum amylase, ascites value?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' )","SELECT MAX(Amylase, Ascites) FROM patient WHERE patient.id = 10007795;",[{'MAX(labevents.valuenum)': None}]
810985919f9d2ed07555c4b0,What was the time of patient 10027445's last influenza a/b by dfa microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'influenza a/b by dfa' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(dfa.microbiology.influenza_ab) FROM dfa.microbiology WHERE dfa.microbiology.patient_id = (SELECT patient.id FROM patient WHERE patient.id = 10027445) AND dfa.microbiology.test_type = 'influenza a/b by dfa' AND STRFTIME('%y-%m', dfa.microbiology.date) >= '2100-03'",[]
2a32cb9fdb4241702a454055,"For patients who received performance of cardiac output, continuous , what are the top five most frequent diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.months FROM (SELECT patient.diagnosis, diagnosis_date.months FROM diagnosis_date JOIN patient ON diagnosis_date.patient = patient.patient WHERE diagnosis_date.diagnosis = 'performance of cardiac output, continuous') AS t1 JOIN (SELECT patient.diagnosis, diagnosis_date.months FROM diagnosis_date JOIN patient ON diagnosis_date.patient = patient.patient) AS t2 ON t1.months = t2.months WHERE t1.diagnosis = t2.diagnosis) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 5",
6daf43327893e27cc1c785bb,What are the precautions that should be followed after the procedure of coronar arteriogr-1 cath?,,"SELECT ""Precautions"" FROM ""Coronar arteriogr-1 cath"" WHERE ""Coronar arteriogr-1 cath"" = 'Coronar arteriogr-1 cath'",
dcc6094fae5bc1bb4de3c989,What was the last time in this hospital visit patient 10004733 had the minimum protein.,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MAX(hospital_time) FROM hospital_visits WHERE patient_id = 10004733;,[]
d7d112f41aba75a33dcbeb67,What is the cost for the drug haloperidol?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'haloperidol' ),"SELECT ""cost"" FROM ""drug"" WHERE ""drug"" = 'haloperidol'",
9ac29fcc00066ee270a82758,Has patient 26262 been provided with additional eye test?,,SELECT COUNT(*) FROM tests WHERE tests.patient_id = 26262 AND tests.test_name = 'Additional eye test',
84cf86069630ec83176f8f8e,What were the top five most often performed treatments for patients in their 20s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment FROM (SELECT * FROM patients WHERE t.age BETWEEN 20 AND 29) AS t GROUP BY t.treatment) AS t1 JOIN (SELECT date_part('year', i.date) AS year, i.treatment FROM (SELECT date_part('year', interaction_date) AS date, treatment FROM interactions) AS i GROUP BY date_part('year', interaction_date), treatment) AS t2 ON t1.treatment = t2.treatment WHERE t1.year = t2.year GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 5",
2cceb4c8bccd163def8170ce,Has there been a alpha-fetoprotein lab test performed on patient 10038081 since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alpha-fetoprotein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y',labevents.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10038081 AND lab_results.lab_name = 'alpha-fetoprotein' AND STRFTIME('%y', lab_results.date) >= '2100'",[{'COUNT(*)>0': 0}]
78deb17fb4b0f07c1c1b0051,How many medications were assigned to patient 10004422 in the previous year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM medication_usage WHERE patient_id = 10004422 AND date_submitted >= (SELECT MIN(date_submitted) FROM medication_usage WHERE patient_id = 10004422) AND date_submitted < (SELECT MIN(date_submitted) FROM medication_usage WHERE patient_id = 10004422) AND date_part('year', date_submitted) = (SELECT MIN(date_part('year', date_submitted)) FROM medication_usage WHERE patient_id = 10004422) - 1",[{'COUNT(*)': 0}]
70b635d6cbd4d6a5cf0cccfa,How many days was patient 10038933 in the intensive care unit during their last visit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT SUM(DaysInUnit) FROM ""icu"" WHERE ""patientId"" = 10038933 AND ""unitDischtime"" IS NULL","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.355196759104729}]"
cc1b03b3dc9e12a0e0841326,Has patient 10019385 been to the emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM checkin_log WHERE patient_id = 10019385 AND location = 'emergency room admit',[{'COUNT(*)>0': 0}]
f9308fa63d859b237ccb712b,What were the four most commonly given diagnoses for patients who had received anastomosis of hepatic duct to gastrointestinal tract before in the same month this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t1.subject_id, t1.diagnosis, t1.month FROM (SELECT ASN123 AS subject_id, 'diabetes with renal & hepatIC issues' AS diagnosis, EXTRACT(MONTH FROM CURRENT_TIMESTAMP) AS month FROM patients WHERE t1.diagnosis = 'diabetes with renal & hepatIC issues') AS t1 JOIN (SELECT ASN123 AS subject_id, 'anastomosis of hepatic duct to gastrointestinal tract' AS diagnosis, EXTRACT(MONTH FROM CURRENT_TIMESTAMP) AS month FROM patients WHERE t1.diagnosis = 'anastomosis of hepatic duct to gastrointestinal tract') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.month = t2.month AND DATETIME(t1.month, 'start of year",
e443e032271f916c3381b735,When is the earliest next hospital visit of patient 73652?,,SELECT MIN(visit_time) FROM (SELECT visit_time FROM visit_table WHERE patient_id = 73652) AS subquery,
9a56a0173232de3b3d548756,"Since 2100, what are the top five most common medications prescribed in the same hospital visit to the patients aged 60 or above after they were diagnosed with unspecified acquired hypothyroidism?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_time, patient.age FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'ACQUIRED HYPOTHYROIDISM NOS' AND STRFTIME('%y', diagnosis.diagnosis_time) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.medication_time, patient.age FROM medication JOIN patient ON medication.patient_id = patient.uniquepid WHERE STRFTIME('%y', medication.medication_time) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_time < t2.medication_time AND t1.patient_id = t2.patient_id GROUP BY t2.name) AS t3 WHERE t3.c1",
86c0624f79d2e1a57bd72381,What are the consumption methods of ampicillin sodium?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium',SELECT DISTINCT prescribing_method FROM drugs WHERE drug_name = 'Ampicillin Sodium';,[{'route': 'IM'}]
88c38001054f068df22c8b37,What was the name of the drug which patient 10027602 was prescribed in the same hospital visit after receiving a percutaneous [endoscopic] gastrostomy [peg] procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,
0f16647da206cfafc77bdb03,Does patient 15209 have acute pain due to trauma that is part of her family?,,"SELECT COUNT(*) FROM patients WHERE patients.family_history = ""acute pain due to trauma"" AND patients.subject_id = 15209",
04f71c7e519351b6f93b7777,List the top five most frequent diagnoses that patients were diagnosed with within 2 months after receiving diagnostic ultrasound of digestive system since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'diagnostic ultrasound of digestive system' AND STRFTIME('%y', treatment.treatmenttime) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosistime FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE STRFTIME('%y', diagnosis.diagnosistime) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.diagnosistime AND DATETIME(t2.diagnosistime) BETWEEN DATETIME(t1.treatmenttime) AND DATETIME(t1.treatmenttime, '+2 month') GROUP",
37921e0dd6b843c93c0dacc1,Which are the top three most common lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Lab_Test, COUNT(t1.Lab_Test) FROM (SELECT Lab_Test FROM lab_tests WHERE Year = 2000 GROUP BY Lab_Test) AS t1 JOIN lab_tests AS t2 ON t1.Lab_Test = t2.Lab_Test GROUP BY t1.Lab_Test ORDER BY COUNT(t1.Lab_Test) DESC LIMIT 3",[]
5e099470827356f7917d86bf,Tell me the top five most commonly prescribed drugs in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE STRFTIME('%y', prescriptions.date) = '2100' GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 5",[]
45e5fa3d7ddb3e52763ec749,"What are the four most frequently given diagnoses for patients who had previously had bypass coronary artery, one artery from left internal mammary, open approach during the same month, throughout this year?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'bypass coronary artery, one artery from left internal mammary, open approach') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE NOT diagnosis.diagnosis IS NULL) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of year') = DATETIME(t2.diagnosis_date, 'start of year') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 4",
e4946b7c7c8d1c41eb7d77e2,What is the percentile of the hemoglobin value of 10.4 among patients of the same age as patient 10020740 on their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 10.4","SELECT DISTINCT t1.c1 FROM (SELECT lab.hemoglobin, NTILE(100) OVER (ORDER BY lab.hemoglobin NULLS FIRST) AS c1 FROM lab WHERE lab.age = (SELECT lab.age FROM lab WHERE lab.id = 10020740 AND NOT lab.dischtime IS NULL ORDER BY lab.admittime NULLS FIRST LIMIT 1)) AS t1 WHERE t1.hemoglobin = 10.4",
170d16d87b8d77ec966d5f56,How many hours have elapsed since patient 10021487 has last received a protein lab test in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_test_date)) FROM lab_tests WHERE lab_tests.patient_id = 10021487 AND lab_tests.lab_test_type = 'protein' AND lab_tests.hospital_location = 'this hospital' ORDER BY lab_test_date DESC LIMIT 1;",[]
add9d8c55cfa9b469ea183bf,Which are the top four most frequent output events during this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT Event, COUNT(Event) FROM outputs WHERE Timestamp = 2015 GROUP BY Event ORDER BY COUNT(Event) DESC LIMIT 4;",[]
560ac67e93ac8a709bbc10ea,How many people were diagnosed with amyotrophic lateral sclerosis throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'amyotrophic lateral sclerosis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(*) FROM diagnoses WHERE diagnosis = ""AMYOTROPHIC LATERAL SCLEROSIS"" AND date_submitted = SELECT DATEFROMVALUES(CURRENT_DATE) WHERE NOT session_id IS NULL;",
3bb6bf7407b7133944318142,When was patient 10005909 prescribed a acetaminophen and oxycodone (immediate release) at the same time for the first time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10005909 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'oxycodone (immediate release)' AND admissions.subject_id = 10005909 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",SELECT q1.date_prescribed FROM (SELECT patient.date_prescribed FROM patient WHERE patient.patient_id = 10005909 AND patient.prescriptions = 'acetaminophen') AS q1 JOIN (SELECT patient.date_prescribed FROM patient WHERE patient.patient_id = 10005909 AND patient.prescriptions = 'oxycodone (immediate release)') AS q2 ON q1.date_prescribed = q2.date_prescribed ORDER BY q1.date_prescribed NULLS FIRST LIMIT 1,[]
e1784c5485d83cd0645a3d4e,Tell me the five most frequent treatments for patients aged 40s in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT * FROM patients WHERE age BETWEEN 40 AND 49) AS t1 JOIN (SELECT * FROM treatments WHERE year = 2100) AS t2 ON t1.treatment = t2.treatment) GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 5",
63677b75a5d720c6cc3d41f2,How many of ticagrelor were prescribed to patient 10007058 in total in the last month?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.drug = 'ticagrelor' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10007058 AND medication.drug_name = 'ticagrelor' AND DATETIME(medication.date_prescribed, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month')",[{'SUM(prescriptions.dose_val_rx)': None}]
55ea65a1f7c485a457c4696d,What number of patients stayed in med/surg/gyn?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' ),"SELECT COUNT(DISTINCT patient_id) FROM patients WHERE location = ""MED/SURG/GYN"";",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f8d725f820917d71a5301983,When was the first time when patient 10019568 had the minimum value of ptt?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",SELECT MIN(ptt) FROMPatient 10019568,[]
85217448903d24f91d5ea081,What is the maximum total hospital cost for a person with streptococcal septicemia since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcal septicemia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.item = 'streptococcal septicemia' AND STRFTIME('%y', cost_table.date) >= '2100' GROUP BY cost_table.person_id) AS t1",
7b241688629b0769f326af90,Has patient 10005909 had lab testing since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',labevents.charttime) >= '2100'",SELECT COUNT(*) > 0 FROM lab_results WHERE patient_id = 10005909 AND year >= 2100,[{'COUNT(*)>0': 1}]
3472f6614f855a1f74a08298,Has patient 10005866 been admitted to the emergency room since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(*) FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.emergency_room_admit_time >= '2100-01-01',[{'COUNT(*)>0': 0}]
2a21e251ed3b120d205aa09a,When was patient 10035185's first input time since 04/13/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-13' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10035185 AND input_time >= '2100-04-13',[{'starttime': '2120-05-13 17:26:00'}]
26f7019ccc450e407b7f54db,Give me the top five most common lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.lab_test, COUNT(t1.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE year > 2010) AS t1 JOIN lab_results ON t1.lab_test = lab_results.lab_test GROUP BY t1.lab_test ORDER BY COUNT(t1.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
bbd83d8b93e5221cf79488b1,What was the name of the output the last time patient 10029484 had since 11/10/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT output_name FROM duckdb_outputs WHERE patient_id = 10029484 AND date_since = '11/10/2100' ORDER BY date_since DESC LIMIT 1,[{'label': 'Void'}]
9be85669c081afc82d4c6a57,"Count the number of patients who received a assistance with cardiac output using balloon pump, continuous procedure.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) )","SELECT COUNT(DISTINCT patient_id) FROM procedures WHERE procedures.assistance_type = 'cardiac output using balloon pump, continuous'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
6e4750dd27d5b6fd5f5faf2e,How many patients received a d-dimer lab test since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'd-dimer' ) AND strftime('%Y',labevents.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date FROM (SELECT subject_id, MIN(date) AS date FROM lab_data WHERE lab_data.lab_name = 'd-dimer' GROUP BY subject_id) AS t1 JOIN lab_data AS t2 ON t1.subject_id = t2.subject_id WHERE t2.date >= '2100-01-01')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
122e9c77f038fff730af3012,How many patients were discharged from hospitals since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT id) FROM patients WHERE NOT dismissed AND dateDischged >= DATEADD(year, -1, CURRENT_DATE);",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
6e40bf924c854c6bb7c3d749,When was first time the respiratory rate of patient 10020740 was greater than 17.0 on 06/15/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '06-15' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime(RespiratoryRate, '06/15/2020', 'greater than 17.0') as FirstTimeRespiratoryRateGreaterThan17",[]
26a928038c08abff85fc25c5,What were the total amount of or crystalloid intake input that patient 10018845 received since 02/12/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-12'",SELECT SUM(OR_CRYSTALLOID) FROM INPUT WHERE PATIENT_ID = 10018845 AND INPUT_DATE >= '2100-02-12',[{'SUM(inputevents.totalamount)': None}]
4ee0ef355bae021a512da458,"What was the first time that patient 10031757 was prescribed acetaminophen and phosphorus since 10/2100, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phosphorus' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT MIN(drug_start_date) FROM (SELECT patient_id, prescription_start_date AS drug_start_date FROM prescriptions WHERE prescriptions.patient_id = 10031757 AND prescriptions.drug = 'Acetaminophen' AND STRFTIME('%y-%m', prescriptions.drug_start_date) >= '2100-10') AS subquery2 WHERE subquery2.patient_id = 10031757 AND subquery2.drug = 'Phosphorus' AND STRFTIME('%y-%m', subquery2.drug_start_date) >= '2100-10'",[]
24dea0b7b119c44087400b3d,What was the first measured value of heart rate for patient 10039831 on their current ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM icu WHERE icu.unit_id IN (SELECT unit_id FROM icu WHERE icu.patient_id = 10039831) AND icu.out_time IS NULL) AS measured_heart_rates;,[]
98718dac8212efcff4207af5,"On the last hospital stay, how much amitriptyline has been prescribed to patient 10002930 in total?",SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'amitriptyline',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10002930 AND prescriptions.drug_name = 'amitriptyline',[{'SUM(prescriptions.dose_val_rx)': None}]
fa03821db7826057951a8f17,"What are the four most commonly prescribed medications for patients who were diagnosed with percutaneous transluminal coronary angioplasty status previously within 2 months, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'percutaneous transluminal coronary angioplasty status' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'percutaneous transluminal coronary angioplasty status' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.start_date FROM medication JOIN patient ON medication.patient_id = patient.uniquepid WHERE DATETIME(medication.start_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.start_date AND DATETIME(t2.start_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagn",
46a747d7b9992bd3eae9d736,Did patient 10022880 get a diagnosis during the first hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10022880 AND NOT diagnoses.handling_is_complete,[{'COUNT(*)>0': 1}]
35b0b505d474e73b841b45f6,What was the last weight of patient 10029291 recorded since 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(weight) FROM patient_weight WHERE patient_id = 10029291 AND date >= '2003-02-2100',[]
7151c86b2f910d26891150a0,Can you confirm the gender of patient 10026354?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10026354,"SELECT ""gender"" FROM ""patients"" WHERE ""ssn"" = '10026354';",[{'gender': 'M'}]
cdf6333e8b6736879a871a9a,Calculate patient 10004720's total amount of tf residual output on this month/07.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tf residual' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '07'",SELECT SUM(tf_residual_output) FROM patient_10004720 WHERE month = 07 AND tf_residual_output IS NOT NULL,[{'SUM(outputevents.value)': None}]
0d923876f67a35e78f8044b8,What was the name of the drug that was prescribed to patient 10021487 last time through the iv route since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT name FROM iv WHERE patient = 10021487 AND route = 'iv' AND date >= '12/2100' ORDER BY date DESC LIMIT 1,[]
38b98518dde0e0d276fdf109,Tell me the name of the diagnosis that patient 10020786 received the first time during their first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis_name FROM diagnoses WHERE patient_id = 10020786 AND NOT patient_id IS NULL ORDER BY visit_date NULLS FIRST LIMIT 1,
eddd42b7835d2666ea1728ba,Tell me the number of patients who were prescribed magnesium oxide during the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'magnesium oxide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient.id) FROM patient WHERE patient.id IN (SELECT patient.id FROM patient WHERE patient.location = 'brain') AND DATETIME(patient.last_modified, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year') AND patient.prescriptions = 'magnesium oxide'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
66e17c14c6b5f8370524c964,How much does it cost for a acute and chronic cholecystitis diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and chronic cholecystitis' ) ),SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = 'Acute and chronic cholecystitis';,
be9080e8bd4d6236bf72ed25,What was a drug that patient 10021487 was prescribed for in the same day after receiving arterial catheterization since 2 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-2 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10021487 AND treatment.type = 'arterial catheterization' AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-2 month')) AS t1 JOIN (SELECT patient.id, prescription.drug FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE patient.id = 10021487 AND DATETIME(prescription.date) >= DATETIME(CURRENT_TIME, '-2 month')) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day')",
fdc2cf2c322ae8d1a991cb88,"Since 01/2100, how much did patient 10031757 weigh during the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT patient.weight FROM patient WHERE patient.patient_id = 10031757 AND NOT patient.weight IS NULL AND patient.weight = (SELECT MIN(weight) FROM patient WHERE patient.patient_id = 10031757 AND NOT patient.weight IS NULL AND patient.weight > 0 AND DATE(patient.weight_date) >= DATE('2100-01-01')),[]
ef1717a5f8cb73c78748607d,What is the disinfection technique in a quarantine room??,,SELECT disinfection_technique FROM contact_details WHERE contact_details_id = 12345,
0c36b014ddebc557e87c1e72,List the top five diagnoses that have the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t4.diagnosis, t4.monthly_mortality FROM (SELECT t3.diagnosis, t3.monthly_mortality FROM (SELECT t2.diagnosis, t2.monthly_mortality FROM (SELECT ""All other diagnoses"" AS diagnosis, 12.5 AS monthly_mortality FROM t2 WHERE t2.diagnosis = 'All other diagnoses') AS t2 JOIN (SELECT ""All other diagnoses"" AS diagnosis, 12.5 AS monthly_mortality FROM t2 WHERE t2.diagnosis = 'All other diagnoses') AS t3 ON t2.diagnosis = t3.diagnosis) AS t4 WHERE t4.monthly_mortality = (SELECT MAX(monthly_mortality) FROM (SELECT t2.diagnosis, t2.monthly_mortality FROM (SELECT ""All other diagnoses"" AS diagnosis, 12.5 AS monthly_mortality FROM t2 WHERE t2.diagnosis = 'All other diagnoses') AS t2 JOIN (SELECT ""All other diagnoses"" AS diagnosis, 12",
5ec192bf57a5dff7718502ec,Calculate the length in days of patient 10031757's last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', ICU.OUTTIME) - STRFTIME('%j', ICU.INTIME) AS lengthindays","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.1996527779847383}]"
314415a08a9c1d6bd28fe89e,What should be done to stay safe after the cont inv mec ven <96 hrs?,,SELECT * FROM Users WHERE ContInvMecVen < 96;,
054b6f8bf46fb8b641b71498,What is the name of the drug that should not be administered during the endovasc embol hd/nk ves?,,SELECT name FROM drugs WHERE id = (SELECT drug_id FROM procedures WHERE name = 'endovasc embol hd/nk ves'),
9b96ce996e808fd4f87d1eee,What was the total tf residual output in patient 10020944 in their first ICU visit?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tf residual' AND d_items.linksto = 'outputevents' ),"SELECT SUM(tf_residual) FROM ""patient10020944"" WHERE ""unit"" = 'ICU 1';",[{'SUM(outputevents.value)': None}]
74504b66834c2700e6349766,What is the percentile urea nitrogen value of 17.0 among patients of the same age as patient 10004733 on the current hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 17.0","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, urea.urea_nitrogen, PERCENT_RANK() OVER (ORDER BY urea.urea_nitrogen NULLS FIRST) AS c1 FROM patient INNER JOIN lab_result urea ON patient.patient_id = urea.patient_id WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.patient_id = 10004733 AND patient.hospital_dischtime IS NULL) AND urea.urea_nitrogen = 17.0) AS t1 WHERE t1.age = 10004733",
4d4dd766a53d16c73dfa5445,Tell me the total number of patients who were diagnosed with diplopia in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT patient.subject, diagnosis.year FROM diagnosis JOIN patient ON diagnosis.patient = patient.subject WHERE diagnosis.type = 'diplopia' AND STRFTIME('%y', diagnosis.year) = '2100') AS t1",
0d8c124936a0fc726774b99e,What were the top three most frequently prescribed medicines in 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.name FROM (SELECT medications.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM medications WHERE STRFTIME('%y', medications.date) = '2100' GROUP BY medications.name) AS t1 WHERE t1.c1 <= 3;",[]
48b89e86915910878671569f,How much was the difference in diastolic blood pressure of patient 10008287 last measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT diastolic_blood_pressure FROM icu_visits WHERE icu_visits.patient_id = 10008287 AND NOT icu_visits.end_time IS NULL ORDER BY icu_visits.start_time DESC LIMIT 1) - (SELECT diastolic_blood_pressure FROM icu_visits WHERE icu_visits.patient_id = 10008287 AND NOT icu_visits.end_time IS NULL ORDER BY icu_visits.start_time DESC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
9074ac00135a21bec34e6199,Give me the total volume of output for patient 10022880 on 04/03/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '04-03'",SELECT SUM(output) FROM main.brackets WHERE patient_id = 10022880 AND date = '04/03/2020',[{'SUM(outputevents.value)': None}]
2dcb5e76008ed58c6fcf21ab,How many patients were prescribed the drug polyethylene glycol since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'polyethylene glycol' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c7b252f65de6eab4598bf4ae,When was the last time yesterday that patient 10018081's systolic blood pressure was measured greater than 88.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 88.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(blood_pressure_date) FROM systolic_blood_pressure WHERE patient_id = 10018081 AND blood_pressure > 88.0 AND date_submitted = DATEADD(day, -1, CURRENT_DATE)",[]
f056ac2de0d1253ccdc6c556,Could you provide me with the three most frequent output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT output FROM (SELECT output, COUNT(output) AS frequency FROM program WHERE YEAR(start_time) >= 2100 GROUP BY output) AS subquery ORDER BY frequency DESC LIMIT 3","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
19dd65ead0ee8862ebf01011,What was the accumulated output for patient 10039831 since 10/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-26'",SELECT COUNT(DISTINCT 'output') FROM (SELECT 'output' FROM patients WHERE patient_id = 10039831) AS t WHERE t.output_date >= '2000-10-26',[{'SUM(outputevents.value)': 6680.0}]
45de049f9307b8c592a68f2c,What is the total number of patients discharged from the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",SELECT COUNT(DISTINCT patient_id) FROM diagnosis_discharge WHERE discharge_year = 2100;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
2a1243e7e7beeb3198544ff2,"Tell me the name of the prescription drug that patient 10015931 was prescribed in the same day after having a replacement of aortic valve with zooplastic tissue, percutaneous approach procedure since 4 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-4 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-4 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT name FROM prescriptions WHERE patient_id = 10015931 AND date_sub('month', 4, SELECT date FROM procedures WHERE patient_id = 10015931 AND procedure_name = 'replacement of aortic valve with zooplastic tissue, percutaneous approach')",
aea39d595c762f58e94e6bc6,What was patient 10021312's first measured absolute eosinophil count since 01/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01' ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(absolute_eosinophil_count) FROM lab_data WHERE patient_id = 10021312 AND measurement_date >= '2000-01-21',[]
a7f9bb55036040073e02ba0e,Find the number of current patients in the 20s age group.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29,SELECT COUNT(*) FROM patients WHERE age BETWEEN 20 AND 29 AND current_patient = true,
f859ac724e0f730a950f3efa,When was patient 10012552 discharged from the hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012552 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = '10012552';,[]
eb546f4e23ee7c0f0ace4e68,Do you suppose patient 3369 has experience side effects during a blood transfusion?,,SELECT COUNT(*) > 0 FROM patient WHERE patient.patient_id = 3369 AND patient.side_effects_during_blood_transfusion = 'experience',
08e4e46ffbf10a71b11cc538,What was the amount of glucose gel dose prescribed to patient 10016150 during their last hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'glucose gel',SELECT SUM(glucose_gel) FROM prescriptions WHERE patient_id = 10016150 AND NOT patient_id IS NULL ORDER BY patient_id DESC LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
70b43bd19ed867f8f2420003,Has patient 10024043 come to the ER in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'",SELECT COUNT(*) > 0 FROM patient WHERE patient.date_of_entry_into_emergency_room = '2100-01-01' AND patient.unique_patient_id = 10024043,[{'COUNT(*)>0': 0}]
224e861c8a991fe5103027e4,Was patient 10020944 to the emergency room on their first hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM bracket_migration WHERE patient_id = 10020944 AND emergency_room = 1,[{'COUNT(*)>0': 0}]
2bb75165325ab535ac14bae8,When did patient 10031757 have the bands lab test for the first time in 10/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bands' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1","SELECT lab.date FROM lab WHERE lab.patient = 10031757 AND lab.test = 'bands' AND STRFTIME('%y-%m', lab.date) = '2100-10' ORDER BY lab.date NULLS FIRST LIMIT 1",[]
217aba84a14d98a4827d6be1,"What are the five commonly taken specimens for patients that were diagnosed with other disorders of neurohypophysis previously during the same hospital encounter, since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other disorders of neurohypophysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t3.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) as rank FROM (SELECT t2.specimen, t1.diagnosis, t1.treatment, t1.patient, t2.date FROM (SELECT patient, diagnosis, treatment, date FROM neurohypophysis WHERE date >= '2100-01-01') AS t1 JOIN (SELECT patient, specimen, date FROM neurohypophysis WHERE date >= '2100-01-01') AS t2 ON t1.patient = t2.patient WHERE t1.diagnosis = 'OTHER DISORDERS OF NEUROHYPOPHYSI' GROUP BY t2.specimen) AS t3 WHERE rank <= 5",
dc99421b0fa75072b7fc597f,Which method of disinfection in the quarantine room is?,,SELECT METHOD FROM UNNEST(STANDARD_METHODS) AS METHOD WHERE METHOD = 'Disinfection in the Quarantine Room';,
ba575890ff7ebaa1dcaa88c2,How many artificial tear ointment prescription instances occurred?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'artificial tear ointment',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Artificial Tear Ointment';,[{'COUNT(*)': 0}]
c0684c1ca2e984f005e2f914,What are five of the most frequent specimens taken since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen FROM (SELECT specimen, COUNT(specimen) AS count FROMBracketsSpecimens WHERE date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY specimen) AS subquery ORDER BY count DESC LIMIT 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
721e100bb5221ab0b783efb9,How much does it cost to get diagnostic of type 2 diabetes mellitus without complications?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus without complications' ) ),SELECT SUM(DIA_COST) FROM diagnoses WHERE DIAG_TYPE = '2' AND PERSON_ID = '1',
1f40a273d375689f569acb2e,What culture was patient 10016742 last tested during their first hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,,[{'spec_type_desc': 'STOOL'}]
750dbf95a8c1c5e4d75ecefe,How many times was patient 10023239 in the hospital this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient_id) FROM notifications WHERE patient_id = 10023239 AND DATETIME(notification_time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
7671f2895af9f8efa4666e20,"How many days has it been since the first time in their current hospital visit that patient 10004733 was diagnosed with hemiplegia, unspecified, affecting unspecified side?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified, affecting unspecified side' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT COUNT(DISTINCT t2.diagnosis_date) FROM (SELECT t1.subject_id, t1.diagnosis_date FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE admissions.subject_id = 10004733 AND diagnoses.diagnosis = ""Hemiplegia, unspecified, affecting unspecified side"") AS t1 GROUP BY t1.subject_id HAVING MIN(t1.diagnosis_date) = t1.diagnosis_date) AS t2 JOIN (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE admissions.subject_id = 10004733 AND diagnoses.diagnosis = ""Hemiplegia, unspecified, affecting unspecified side"") AS t3 ON t2.subject_id = t3.subject_id WHERE t2",
b8b17acef0f82e15a62e972b,"Has patient 10010471 been ordered bag, ipratropium-albuterol neb, or ferric gluconate in 05/this year?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.drug IN ( 'ipratropium-albuterol neb', 'bag', 'ferric gluconate' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05'","SELECT COUNT(*) FROM orders WHERE patient_id = 10010471 AND order_date BETWEEN '2005-05-01' AND '2005-05-31' AND order_name IN ('bag', 'ipratropium-albuterol neb', 'ferric gluconate')",[{'COUNT(*)>0': 0}]
b6ebd9e060d890c353600a6a,What was the first measurement of respiratory rate that patient 10008287 had since 268 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-268 day') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(RespiratoryRate) FROM respiratory_rate WHERE PatientID = 10008287 AND Date < CURRENT_DATE - INTERVAL '268 day',[]
22458c7e5433bc48eeb5f97c,When was the last time the systolic blood pressure of patient 10002495 was measured at a reading less than 101.0 on the last ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 101.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(dates.icu_admittime) FROM (SELECT icu_admittime FROM icu WHERE icu_admittime IS NOT NULL AND patient_id = 10002495 AND NOT icu_admittime IS NULL) AS dates WHERE systolic_blood_pressure < 101.0,[]
4fc4a020a5a905fbea065ca7,Show me the length of stay in days of patient 10037975 from the first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', ICU.OUTTAKE.STAY.END.TIME) - STRFTIME('%j', ICU.INTAKE.STAY.BEGIN.TIME) FROM ICU WHERE ICU.PATIENT.ID = 10037975 AND NOT ICU.INTAKE.STAY.BEGIN.TIME IS NULL ORDER BY ICU.INTAKE.STAY.BEGIN.TIME NULLS FIRST LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.87824074132368}]"
c2f2672cddbd186cf0790169,What are the top four most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.drug FROM (SELECT prescriber.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriber GROUP BY prescriber.drug) AS t1 WHERE t1.c1 <= 4;","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]"
f806b5540e6d98bc7a994ad3,What is the cost of a surgery called laparoscopic cholecystectomy?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure = 'laparoscopic cholecystectomy';,
f0a44b72608f1fb8a8a9bebc,Calculate the number of patients with other alteration of consciousness who were diagnosed since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other alteration of consciousness' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.date_ FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.alteration = 'other alteration of consciousness' AND STRFTIME('%y', diagnosis.date_) >= '2100') AS t1 JOIN (SELECT patient.subject_id, diagnosis.date_ FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.alteration = 'other alteration of consciousness' AND STRFTIME('%y', diagnosis.date_) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date_ < t2.date_",
c6e9f8b7ab342b4f62878e06,When was the last time that patient 10007058 was prescribed medication since 03/2100 via the po route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10007058 AND route = 'po' AND date_prescribed >= '2000-03-2100',[]
7866a9173d7aff1bce72d3a6,What was the name of the specimen test that patient 10020944 had for the last time since 03/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_type FROM patient_specimen WHERE patient_id = 10020944 AND date_since = '2003-02-10' ORDER BY date_since DESC LIMIT 1,[{'spec_type_desc': 'STOOL'}]
2f22847b30b971f2903664c3,When was patient 10021118's last microbiological examination since 06/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology WHERE patient = 10021118 AND date BETWEEN '2000-06-21' AND '2000-06-21',[{'charttime': '2161-11-19 12:30:00'}]
3377c0495e0a4873b8d561c0,Tell me the maximum SaO2 for patient 10027602's body on last month/25?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '25'",SELECT MAX(SaO2) FROM (SELECT SaO2 FROM patients WHERE patient_id = 10027602) WHERE date = '2025-01-01',[{'MAX(chartevents.valuenum)': None}]
5f0250669656b6e45463dfba,"Name the four most frequently prescribed drugs within 2 months following a diagnosis of polyneuropathy, unspecified this year.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'POLYNEURAPATHY, UNspecified' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, prescriptions.drug, prescriptions.prescription_date FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE DATETIME(prescriptions.prescription_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.",
4171edfb2349dc1b264cd1dd,When did patient 10007818 have the first body temperature less than 98.9?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.9 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(br.temperature) AS first_temperature,[]
0114a64085ec7d751f6e1bfd,What was the change in respiratory rate in patient 10026406 measured at 2100-01-12 13:00:00 compared to the value measured at 2100-01-12 12:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' ),SELECT (SELECT respiratory_rate FROM measurements WHERE patient_id = 10026406 AND measurement_time = '2100-01-12 13:00:00') - (SELECT respiratory_rate FROM measurements WHERE patient_id = 10026406 AND measurement_time = '2100-01-12 12:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' )"": None}]"
be4864408d7e9c4cb2d27c8a,"Was the value of patient 10022017's chloride, whole blood second measured on the last hospital visit greater than the value first measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT COUNT(*) > 0 FROM read_parquet('patients.parquet', columns={'Chloride, Whole Blood': 'measurement'}) WHERE 'patient_id' = 10022017 AND NOT 'hospital_dischtime' IS NULL ORDER BY 'hospital_admittime' DESC LIMIT 1","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
1533d0cd76139eb1dd097047,When was the first time patient 10020740 was measured with a heart rate greater than 65.0 on 03/28/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 65.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-28' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(MeasurementDate) FROM Measurements WHERE PatientID = 10020740 AND HeartRate > 65.0 AND DateMeasured = '2100-03-28',[]
37cae934208b2a009d5fa703,Has patient 10038081 received any other endoscopy of small intestine treatment since 1 year ago?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.patientId = 10038081 AND procedures.procedureType = 'other endoscopy of small intestine' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
935c667c51ade2f8d9a18b79,"Calculate the number of inspection of larynx, via natural or artificial opening endoscopic procedures performed since 2100.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of larynx, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patienttype = 'inspection' AND patient.patientname = 'larynx' AND patient.dateofprocedure >= '2100-01-01' AND patient.dateofprocedure < '2100-01-02',
a3703a6f4da15988521301ef,List the top four diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT TOP 4diagnoses FROM (SELECT diagnoses, 3-month mortality rate (%) FROM patients GROUP BY diagnoses) AS subquery ORDER BY 3-month mortality rate (%) DESC;",
8521d760a18e114ce1c608b3,What is patient 10039997's gender?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10039997,SELECT patients.gender FROM patients WHERE patients.ssn = 10039997;,[{'gender': 'F'}]
609e5996320873f84ea60fe9,When was patient 10004733 prescribed the drugs heparin flush (100 units/ml) and vancomycin at the same time for the last time since 10/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (100 units/ml)' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(DATE(prescription_date)) FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND prescriptions.drug_name = 'Heparin Flush (100 units/ml)' AND prescriptions.drug_name = 'Vancomycin' AND STRFTIME('%y-%m', prescription_date) >= '2100-10'",[]
782822c98c2534ba56c1c45b,What were the top five diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t5.diagnosis, t5.months FROM (SELECT t4.diagnosis, t4.months FROM (SELECT t3.diagnosis, t3.months FROM (SELECT 'All others' AS diagnosis, 6 AS months FROM (SELECT 'Yes' AS c1, 'No' AS c2, 'Other' AS diagnosis FROM dual) AS t1 JOIN (SELECT 'Yes' AS c1, 'No' AS c2, 'Other' AS diagnosis FROM dual) AS t2 ON t1.diagnosis = t2.diagnosis GROUP BY t1.diagnosis) AS t3 JOIN (SELECT 'Yes' AS c1, 'No' AS c2, 'Other' AS diagnosis FROM dual) AS t4 ON t3.diagnosis = t4.diagnosis GROUP BY t3.diagnosis) AS t5 ON t4.months = t5.months ORDER BY t5.months DESC LIMIT 1",
00bbbffdff5ee0427911211a,What was the output of patient 10027602 for the last time on this month/03?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '03' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT SUM(output) FROM output WHERE patient = 10027602 AND time >= '2022-03-01 00:00:00' AND time < '2022-03-01 00:00:00',[]
f6b867f588ae42e84d410450,What are the three most often performed treatments for patients aged 60 or above since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment, DATE_SUB('year', CURRENT_DATE, t.date) AS days_since_treatment FROM treatments AS t WHERE t.age >= 60) AS t1 GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 3",
06c554d6edfd2380ecdb7e9f,"Show me the top four most commonly prescribed drugs during the same hospital encounter to the patients aged 40s after diagnosed with alcohol abuse, unspecified since 1 year ago.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,
b69d13810f1abe3029a6d7ba,What is the minimum total cost of the hospital visits include the medicine named prismasate (b32 k2) since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prismasate (b32 k2)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM hospital_visits WHERE medicine_name = 'prismasate (b32 k2)' AND year >= 2100 GROUP BY patient_id) AS t1,
c21cf578f81ff7a390dc8596,"What is the cost of a malignant neoplasm of lower lobe, bronchus or lung diagnosis?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower lobe, bronchus or lung' ) )","SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = ""Malignant neoplasm of lower lobe, bronchus or lung""",
5a4f493fdb61cf9a1f898407,Tell me the protocol of the anticancer drug?,,SELECT protocol FROM drugs WHERE drug = 'anticancer drug',
9c299b7dcbfbd561bf0f6f6b,When did patient 10038081 last have a blood culture microbiology test in 09/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(date) FROM microbiology WHERE microbiology.patient_id = 10038081 AND microbiology.test_type = 'blood culture' AND STRFTIME('%y-%m', microbiology.date) = '2100-09'",[]
22f424d1096d768470e60a6d,"What are the four most commonly tested specimens for patients who were diagnosed with chronic lymphocytic leukemia of b-cell type not having achieved remission previously in the same month, in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic lymphocytic leukemia of b-cell type not having achieved remission' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT '2100-01-01'::DATE AS date, 'chronic lymphocytic leukemia of b-cell type not having achieved remission previously in the same month' AS specimen FROM chronic_lymphocytic_leukemia JOIN patients ON chronic_lymphocytic_leukemia.patient_id = patients.patient_id WHERE chronic_lymphocytic_leukemia.diagnosis_date = date) AS t2 JOIN (SELECT '2100-01-01'::DATE AS date, 'chronic lymphocytic leukemia of b-cell type not having achieved remission previously in the same month' AS specimen FROM chronic_lymphocytic_leukemia JOIN patients ON chronic_lymphocytic_leukemia.patient_id = patients",
6f8ec1a440771aa4151d974e,What was the drug that was prescribed to patient 10020740 for the last time in 03/2100 via the po route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.drug FROM prescriber WHERE prescriber.patient_id = 10020740 AND prescriber.route = 'po' AND STRFTIME('%y-%m', prescriber.date) = '2100-03' ORDER BY prescriber.date DESC LIMIT 1;",[]
40f923d3ceb04e98040b7c3e,Has patient 10007818 been tested on 25-oh vitamin d since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10007818 AND lab_data.type = '25-oh vitamin d' AND STRFTIME('%y-%m', lab_data.date) >= '2100-04'",[{'COUNT(*)>0': 0}]
f54bb9ca547f05441bb1ce7d,"What is the diagnosis price for closed dislocation, multiple cervical vertebrae?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed dislocation, multiple cervical vertebrae' ) )",SELECT AVG(diagnosis_price) FROM diagnoses WHERE dislocation = 'closed' AND vertebrae = 'multiple cervical vertebrae',
412c09bd6869eec57b61b8ab,What are the top five most frequent microbiology tests in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.test_name, COUNT(t.test_name) FROM microbiology_tests t WHERE t.test_date BETWEEN '2000-01-01' AND '2000-12-31' GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 5;",[]
5d5185c385123b16a09f65af,Has any prescription drug been given to patient 10005909 during this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10005909 AND DATETIME(prescriptions.date_given, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
1e7e5b854e3946d368c6016f,Find the number of current patients in the 50s age group.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,SELECT COUNT(*) FROM patients WHERE age = '50s' AND current_patient = 'true',
9b2ab198452a5ac2f78b9ebf,Could you provide the top five most common output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT o.output_event, COUNT(o.output_event) FROM output_events o WHERE o.occurrence_date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY o.output_event ORDER BY COUNT(o.output_event) DESC LIMIT 5","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
3dcaebddfb2987ddb1dc6ae7,Show me patient 10018081's daily average weight in 2100.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10018081 AND year = 2100 GROUP BY date;,[]
1413d85d169629ef664b2b96,How much is the cost for the drug nystatin cream?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nystatin cream' ),SELECT DISTINCT cost FROM drugs WHERE drug = 'Nystatin Cream',
7bd54b9aeab884f12aad013d,What are the single rooms that are currently available?,,,
d73922f383164918bb919ccd,How many current patients fall into the 30s age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT(*) FROM patients WHERE age BETWEEN 30 AND 39 AND current_patient = true,
0822c127d758cb84c86208ab,How old was patient 10023117 during their first hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.age FROM patients WHERE patient.id = 10023117 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1,
efd5c9c44ecab92af5e496fa,In what ways can phenazopyridine be ingested?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'phenazopyridine',SELECT * FROM ingestion_methods WHERE ingested_product = 'phenazopyridine';,[{'route': 'ORAL'}]
3c0cb65bd0831752922d8073,Is patient 3273 aware of any ill effects of blood transfusion?,,"SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 3273 AND diagnoses.illness = ""ill effects of blood transfusion""",
112cb104c8ac40bc947d642a,Calculate the number of patients staying in med/surg during this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",SELECT COUNT(DISTINCT patient_id) FROM admissions WHERE location = 'MED/SURG' AND admit_date BETWEEN '2022-01-01' AND '2022-12-31';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
af707d41fac6dee4c1688787,"Since 11/2100, when was patient 10021487's first microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT date FROM microbiology WHERE patient_id = 10021487 AND date >= '2011-2100-01' ORDER BY date NULLS FIRST LIMIT 1,[{'charttime': '2116-12-03 01:16:00'}]
2eb3e9db6880c98531ae9697,What were some of the five common specimen tests given?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",SELECT common_specimen_type FROM brackers WHERE number_of_specimens = 5;,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
683c48b602131b125efece68,"For the last time in 03/this year, when was patient 10019777 prescribed vancomycin and iso-osmotic dextrose at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic dextrose' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(vancomycin) FROM patients WHERE patients.patient_id = 10019777 AND iso_osmotic_dextrose = ""10%"" AND prescription_date BETWEEN '2003-01-01' AND '2003-12-31'",[]
bbd2daaab53a49a1140c416c,What did patient 10022041 get diagnosed with in the last hospital encounter for the first time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),"SELECT diagnosis FROM (SELECT patient_id, diagnosis FROM diagnoses WHERE NOT diagnosis IS NULL ORDER BY timestamp DESC LIMIT 1) AS last_diagnoses WHERE patient_id = 10022041;",
fc72497b8c3f4de11b1c418f,Tell me the percentile of the magnesium value of 2.4 among patients of the same age as patient 10011398 during the last hospital visit.,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.4","SELECT t1.c1 FROM (SELECT patient.age, MIN(patient.magnesium) AS c1 FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.id = 10011398 AND NOT patient.dischtime IS NULL ORDER BY patient.hospitalstay DESC LIMIT 1) GROUP BY patient.age) AS t1 WHERE t1.c1 = 2.4",
937063660ee9c96fa16dd7f5,Calculate the number of people who had other and unspecified pneumonectomy in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",SELECT COUNT(*) FROM procedures WHERE pneumonectomy <> 'other' AND pneumonectomy <> 'unspecified' AND year = 2100,
5f397d9337e3f7c527ae89c4,Show the weight changes of patient 10019172 second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patient WHERE patient.id = 10019172 AND NOT patient.hospital_info IS NULL ORDER BY patient.hospital_info->'admit_date' DESC LIMIT 1) - (SELECT weight FROM patient WHERE patient.id = 10019172 AND NOT patient.hospital_info IS NULL ORDER BY patient.hospital_info->'admit_date' DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
99302cc231fc961e9d68c413,Tell me the time when patient 10014729's SaO2 was less than 95.0 for the last time on 03/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 95.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-06' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT TIME FROM patients WHERE patient_id = 10014729 AND sao2 < 95.0 AND date = '03/06/2100',[]
1a9e4c04cde439b3eb51a5ee,Could you tell me the top five most common procedures for patients aged 20s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.Name FROM (SELECT procedures.Name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM procedures WHERE procedures.age BETWEEN 20 AND 29 AND STRFTIME('%y', procedures.date) = '2100' GROUP BY procedures.Name) AS t1 WHERE t1.c1 <= 5",
e487dbd0cdcc7e16522be18e,"In 2100, what are the top five most common microbiology tests that patients were diagnosed with in the same month after being diagnosed with personal history of malignant neoplasm of tongue?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of tongue' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND diagnosis.test_name = 'personal history of malignant neoplasm of tongue') AS t1 JOIN (SELECT patient.name, microbiology.test_name, microbiology.diagnosis_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.patient_id WHERE microbiology.diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(",
4a6a55a4bf98ebabca394606,Is there a genetic test that patient 83062 recieved?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 83062 AND patients.genetic_test = 'genetic',
4449c0b54dc6e4a7af5dc9d8,What was the first value of a myelocytes lab test of patient 10004235 during their last hospital visit?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'myelocytes' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT lab.myelocytes FROM lab WHERE lab.patient = (SELECT patient.id FROM patient WHERE patient.name = 'Jane Doe' AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1) AND lab.myelocytes IS NOT NULL ORDER BY lab.admittime NULLS FIRST LIMIT 1;,[]
07cfa2305771336777be3c17,How many current patients are there that are 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT(*) FROM patients WHERE age >= 60,
57ee9b35377fe295adfbf9c1,How much did patient 10031404 weigh during their last measurement since 21 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-21 month') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT weight_kg FROM patients WHERE patient_id = 10031404 AND measurement_time >= (CURRENT_TIMESTAMP - INTERVAL '21 month') ORDER BY measurement_time DESC LIMIT 1;,[]
1403522fcefbc7af92918f1c,"What was the drug that patient 10019385 was prescribed with within the same day after the performance of cardiac output, continuous in 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug FROM (SELECT patient.subject, action.action_time FROM patient JOIN action ON patient.subject = action.patient WHERE patient.subject = 10019385 AND action.action_type = 'cardiac output, continuous' AND STRFTIME('%y-%m', action.action_time) = '2100-03') AS t1 JOIN (SELECT patient.subject, drug.drug, drug.drug_start_time FROM patient JOIN drug ON patient.subject = drug.patient WHERE patient.subject = 10019385 AND STRFTIME('%y-%m', drug.drug_start_time) = '2100-03') AS t2 ON t1.subject = t2.subject WHERE t1.action_time < t2.drug_start_time AND DATETIME(t1.action_time, 'start of day') = DATETIME(t2.drug_start_time, 'start of day')",
6cadd9bbd8f4e8547babc4a4,Has patient 10019172 undergone the extraction of other tooth procedure in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extraction of other tooth' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",SELECT COUNT(*) FROM procedures WHERE patient_id = 10019172 AND procedure_name = 'extract other tooth' AND year = 2100,
0664f9448edc539d0cb228a4,What was the admission type for patient 10038933's last visit to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038933 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1","SELECT ""Admission Type"" FROM ""Patient"" WHERE ""Patient ID"" = 10038933 AND NOT ""Dischtime"" IS NULL ORDER BY ""Admittime"" DESC LIMIT 1;",[]
8a93df214af665f8defd91d1,What was the change in systolic blood pressure in patient 10037975 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT systolic_blood_pressure FROM icu_visits WHERE icu_visits.patient_id = 10037975 AND NOT icu_visits.outgoing THEN ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1) - (SELECT systolic_blood_pressure FROM icu_visits WHERE icu_visits.patient_id = 10037975 AND NOT icu_visits.outgoing THEN ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
53b45637910db65da16c946b,What procedure was given to patient 10029291 two or more times since 30 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT procedure FROM procedures WHERE patient = 10029291 AND date >= DATEADD(month, -30, GETDATE()) GROUP BY procedure HAVING COUNT(*) >= 2",
6767d8e3b7af5307480d3e8c,How many patients in 2100 received percutaneous abdominal drainage in the same hospital encounter after being diagnosed with unspecified viral hepatitis c with hepatic coma?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c with hepatic coma' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t.subject_id, t.diagnosis_date, t.had_surgery, t.surgery_date, t.complication FROM (SELECT t.subject_id, t.diagnosis_date, false AS had_surgery, NULL AS surgery_date, 'viral hepatitis c with hepatic coma' AS complication FROM (SELECT t.subject_id, t.diagnosis_date FROM (SELECT t.subject_id, DATE '2008-01-01' AS diagnosis_date FROM t1 WHERE t.diagnosis = 'unspecified viral hepatitis c with hepatic coma') AS t GROUP BY t.subject_id HAVING MIN(t.diagnosis_date) = t.diagnosis_date AND STRFTIME('%y', t.diagnosis_date) = '2100') AS t INNER JOIN (SELECT t.subject_id, t.surgery_date, t.had_surgery FROM (SELECT t.subject",
59b4f366d08a05218ec8287d,Tell me the top three most common lab tests since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.lab_test, COUNT(t1.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date > (CURRENT_DATE - INTERVAL '1 year')) AS t1 JOIN lab_results AS t2 ON t1.lab_test = t2.lab_test GROUP BY t1.lab_test ORDER BY COUNT(t1.lab_test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
8b3ac39d04cb2b0c9c7c2ef7,"How many patients underwent a extirpation of matter from left femoral vein, percutaneous approach during the same month after the diagnosis of other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM (SELECT subject_id, diagnosis = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure') AS t1 JOIN (SELECT subject_id, procedure_date FROM procedures WHERE procedures.type = 'extirpation of matter from left femoral vein, percutaneous approach') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date < t2.procedure_date AND DATETIME(t1.diagnosed_date, 'start of month') = DATETIME(t2.procedure_date, 'start of month')",
e15aa00add2d775e41bd5338,Has patient 10004720 been prescribed any prescription drugs since 09/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10004720 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-09'",[{'COUNT(*)>0': 1}]
a512e2c581e537c6e95d2626,Whats the pre serum transfusion nec checklist?,,,
70935d34cbc96deade5c1b18,"Is the value of patient 10007818's mesothelial cell, last measured on the first hospital visit, greater than the first value measured on the first hospital visit?",SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.value FROM lab WHERE lab.patient = 10007818 AND lab.measurement_date = (SELECT MIN(clinical.measurement_date) FROM clinical WHERE clinical.patient = 10007818 AND NOT clinical.dischtime IS NULL ORDER BY clinical.measurement_date NULLS FIRST LIMIT 1)) > (SELECT lab.value FROM lab WHERE lab.patient = 10007818 AND lab.measurement_date = (SELECT MIN(clinical.measurement_date) FROM clinical WHERE clinical.patient = 10007818 AND NOT clinical.dischtime IS NULL ORDER BY clinical.measurement_date NULLS FIRST LIMIT 1) AND lab.measurement_type = 'mesothelial cell'),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
f5897f6587ae16c7c674b41f,"Among patients in their 50s this year, what were the top three most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM diagnoses WHERE diagnoses.age IN (SELECT age FROM ages WHERE age > 50) AND DATETIME(diagnoses.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 3",
5d63012ba377b6abd13cc0ec,How much am I expected to pay for regional lymph node excision?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'regional lymph node excision' ) ),SELECT SUM(cost) FROM cost_estimate WHERE treatment = 'regional lymph node excision';,
68de14b96fc28cb3d5819bcb,"For the patients with age 60 or above, what are the top five most frequent diagnoses during this year?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM diagnoses INNER JOIN patients ON diagnoses.patient_id = patients.patient_id WHERE diagnoses.date = DATETIME(CURRENT_TIME, '-0 year') AND patients.age >= 60 GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 5",
d110cb39c939189ff2381a4e,Do you know how many operating rooms are currently available?,,SELECT COUNT(*) FROM Operating_Room WHERE Availability = 'available';,
fb7a0f8c9dc16e058b2fa6fb,What was the first drug prescribed since 07/2100 to patient 10039708 via the td route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM prescriptions WHERE patient_id = 10039708 AND route = 'td' AND date_prescribed >= '2000-07-21',[]
e157dcdbd534ede0dfd40a1f,What was the name of the organism found in the last microbiological examination of patient 10027602's mini-bal since 01/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10027602 AND examination_date >= '2100-01-01' AND device = 'mini-bal' ORDER BY examination_date DESC LIMIT 1,[]
3b684d2b82753b3d95f1dbc9,Tell me the blood type of patient 76327?,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 76327",
2ca1d1be2d4d07ebcd6b3235,Is patient 3403 subject to a covid-19 test?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_id = 3403 AND patients.covid_19_test = 'yes',
11f8c5631939928ad4f53641,What were the first phosphate results for patient 10039831 in 12/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(phosphate) FROM results WHERE patient = '10039831' AND date = '12/2100',[]
17bc287452c28a3ba71e2fe5,"Count the number of patients who received a excision of right internal mammary artery, percutaneous endoscopic approach procedure.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) )","SELECT COUNT(DISTINCT patient_id) FROM procedures WHERE procedures.procedure_name = 'Excision of right internal mammary artery, percutaneous endoscopic approach'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c3b20e163f22e9c64873825c,When was the last time yesterday that patient 10004733's respiratory rate was measured greater than 23.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 23.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(timestamp) FROM respiratory_rate WHERE patient_id = 10004733 AND respiratory_rate > 23.0 AND date = DATEADD(day, -1, CURRENT_DATE)",[]
53ad3791f3c9399dbc8de0c3,Calculate patient 10019172's length of stay for the first ICU stay in days.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT icu_days(patient_id, 1) FROM patient_table WHERE patient_id = 10019172","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.4558912040665746}]"
ba16c2749e29db98a6103a5f,And what was the first time patient 10038933 was prescribed medication using the iv drip route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(pharmacy_user_id) FROM patient_prescriptions WHERE patient_id = 10038933 AND prescription_route = 'iv drip',[]
45e96cdfdd32151dd3592509,What is the history of immuno cancer drugs in the last 5 years?,,SELECT * FROM documents WHERE document_type = 'immuno cancer drugs' AND date = '2015-01-01',
c26e31b284f5bd28c5239fc8,Tell me the name of the drug which patient 10021487 was prescribed within 2 days after having had a closed [endoscopic] biopsy of bronchus procedure since 9 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-9 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-9 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,
b6b8fff2d091a4950a8656fc,Did it happen on the last occasion that patient 16248 had a medicine they should take daily?,,"SELECT COUNT(*) FROM medication WHERE medication.patient_id = 16248 AND medication.type = 'daily' AND DATETIME(medication.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-1 day')",
1938b1fa4edd438feb5ae416,Tell me the count of other laparoscopic umbilical herniorrhaphy procedures that took place.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' ),"SELECT COUNT(*) FROM procedures WHERE procedures.category = ""Other laparoscopic umbilical herniorrhaphy""",[{'COUNT(*)': 0}]
ffdf7c7b7b7b047429a3497b,"What is the average total hospital expense that includes hemiplegia, unspecified affecting left nondominant side since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(hemiplegiaunspecifiedaffectingleftnondominantside) FROM patients WHERE hemiplegiaunspecifiedaffectingleftnondominantside = ""1 year ago""",
6dcff6961c5881f37f24c90d,Has patient 10008454 received any lab tests in this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10008454 AND DATETIME(lab_results.result_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')",[{'COUNT(*)>0': 0}]
003276cc7c1bc688813d5aca,Show me patient 10014354's total void output amount since 08/11/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-08-11'",SELECT SUM(output) FROM outputs WHERE patient_id = 10014354 AND type = 'void' AND date >= '2000-08-11',[{'SUM(outputevents.value)': None}]
5deee54b966c7e4660cedfb8,Tell me the total volume of input that patient 10004422 was given on 01/21/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-21'",SELECT SUM(input_volume) FROM input_table WHERE patient_id = 10004422 AND input_date = '01/21/this year',[{'SUM(inputevents.totalamount)': None}]
52b6906b922b93a286a69090,What is the average total cost of a hospital that involves a procedure named other diagnostic procedures on lung or bronchus during this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure_name = 'other diagnostic procedures on lung or bronchus' AND date BETWEEN '2010-01-01' AND '2010-12-31' GROUP BY patient_id) AS t1,
a02303e787c9c6d217b02035,Calculate the total volume of input for patient 10029291 on 02/26/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-26'",SELECT SUM(volume) FROM (,[{'SUM(inputevents.totalamount)': None}]
171cf2d1223b4c0cf47224a0,What was the duration in days of patient 10004235's last stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', icu.stay.end_time) - STRFTIME('%j', icu.stay.start_time) FROM icu WHERE icu.patient.id = 10004235 AND NOT icu.stay.end_time IS NULL ORDER BY icu.stay.start_time DESC LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.952106482349336}]"
ae2b2591d8e2e64d87cd4240,List the single rooms that are available now?,,SELECT DISTINCT room FROM rooms WHERE room_type = 'single' AND available = 'now';,
03cee97f39a5dbd735cc25ea,How many patients in 2100 were discharged from the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissed_date IS NULL AND STRFTIME('%y', dismissed_date) = '2100';",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
938fe2e5e3beaeff9c65cbe4,Retrieval of the top four most frequent outputs in this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT MIN(freq) FROM (SELECT COUNT(DISTINCT O.out) AS freq FROM OUTPUTS AS O WHERE O.out IN (SELECT OUT.out FROM OUTPUTS AS OUT GROUP BY OUT.out ORDER BY COUNT(DISTINCT O.out) DESC LIMIT 4) AND YEAR(O.date) = YEAR(CURDATE()) AND YEAR(CURDATE()) = 2017 GROUP BY O.out) AS T;,[]
b5d0db7b72d315ea5e4647b0,Get me patient 10004733's total gastric meds input amount on 12/24/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'",SELECT SUM(input_amount) FROM gastric_meds WHERE patient_id = 10004733 AND input_date BETWEEN '2012-12-24' AND '2012-12-24' AND gastric_meds.unit = 'brackets',[{'SUM(inputevents.totalamount)': None}]
90c0a4f23c31e61cee1395c2,Avapro - How much does it cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'avapro' ),SELECT DISTINCT cost FROM products WHERE product = 'Avapro';,
83e367047d0aa921f3cb6d91,When are dr. lail's rounds and procedures?,,SELECT procedures FROM dr_lail WHERE rounds = 'dr. lail',
5255f208c2e8f59e3a5737fd,What was the last prescription for patient 10005817?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10005817 ORDER BY prescriptions.date DESC LIMIT 1;,[{'drug': 'HYDROmorphone (Dilaudid)'}]
3fa74c4fb1defa83dd97682b,What was an insurance plan for patient 10005866 in their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,[{'insurance': 'Medicaid'}]
0939295415266bebd843029a,Can you show me the five most frequent outputs in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT 2000 FROM (SELECT COUNT(2000) AS 2000 FROM 2000s GROUP BY 2000) AS 2000s ORDER BY 2000 DESC LIMIT 5;,[]
1209cc6f2d89e79f32b5b025,Provide the sum total of inputs for patient 10029484 since 02/11/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-11'","SELECT SUM(input) FROM (SELECT patient_id, input FROM (SELECT 10029484 AS patient_id, 0.0 AS input FROM dual WHERE input IS NOT NULL AND patient_id IS NOT NULL) AS patient_inputs WHERE patient_id = 10029484 AND input IS NOT NULL) AS sum_inputs",[{'SUM(inputevents.totalamount)': 2540.0}]
fe412705ae90c13acf0a2033,Provide the count of hospital visits for patient 10009049 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10009049 AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(Hospital_Visits) FROM Visits WHERE Patient_ID = 10009049 AND Year >= 2100,[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
45cd303621fb1f3007600184,What are the prices of the drug propranolol?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'propranolol' ),,
257b96b1dd73002157d478e9,What output did patient 10038999 have for the last time since 04/14/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-14' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT COUNT(*) FROM output WHERE patient_id = 10038999 AND timestamp >= '2100-04-14',[{'label': 'Foley'}]
da5f3dae68433524c0462406,"For patients diagnosed with nontraumatic subarachnoid hemorrhage from left posterior communicating artery before, what are the top four most common treatments within the same month in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nontraumatic subarachnoid hemorrhage from left posterior communicating artery' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.treatment FROM (SELECT t3.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'nontraumatic subarachnoid hemorrhage from left posterior communicating artery') AS t1 JOIN (SELECT patient.name, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE STRFTIME('%y', treatment.treatment_date) = '2100') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.treatment_date, 'start of month') GROUP BY t3.treatment) AS t3 JOIN (SELECT t2.treatment",
1e7b6f713dc28ec89c51ea69,What are the three most frequently performed treatments for patients in their 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment, t.age FROM (SELECT patient_id, treatment_id, DATE(date_of_treatment, 'YYYY') AS date_of_treatment FROM treatment_table) AS t JOIN patient_table ON t.patient_id = patient_table.patient_id WHERE t.age BETWEEN 40 AND 49 AND DATE(date_of_treatment, 'YYYY') = 2100) AS t1 GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 3;",
51e820358aab679bf6555ec8,"Could you tell me the minimum total hospital cost that includes respiratory ventilation, greater than 96 consecutive hours since 1 year ago.","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost > 96 AND type = 'respiratory ventilation' AND date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY patient_id) AS t1,
44d5008230190a09f20e3682,Has patient 10022017 undergone a free calcium laboratory test since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*) FROM lab WHERE lab.patient_id = 10022017 AND lab.type = 'Free Calcium' AND STRFTIME('%y-%m', lab.date) >= '2100-04'",[{'COUNT(*)>0': 0}]
3f2bb642b30df18f43f0428a,Tell me the monthly maximum amount of patient 10006053's cryoprecipitate input.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cryoprecipitate' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MAX(Cryoprecipitate) FROM read_brackets WHERE Patient_ID = 10006053 GROUP BY Month;,[]
3b6ed4de3ab4d728ea08e28b,Show us the top three most common microbiology tests since 2100.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t.name, COUNT(t.name) FROM microbiology_tests t JOIN (SELECT microbiology_tests.name FROM microbiology_tests WHERE microbiology_tests.year >= 2100) AS recent_tests ON t.name = recent_tests.name GROUP BY t.name ORDER BY COUNT(t.name) DESC LIMIT 3;","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
65a61f863c5c62e515fe477a,"On 02/04/this year, what was the first respiratory rate value of patient 10020187?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-04' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(RespiratoryRate) FROM Brackets WHERE PatientID = 10020187 AND Date BETWEEN '2022-02-04' AND '2022-12-31',[]
7e6b0e29fe9f32760b7fcfc5,Tell me the name of the organism found in patient 10016742's last bronchial washings microbiology tests?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM microbiology_data WHERE patient_id = 10016742 AND microbiology_type = 'bronchial washings' ORDER BY microbiology_date DESC LIMIT 1,[]
fbbd2e1b86a772b593ee1bb9,Does patient 3125 have traveled abroad?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.id = 3125 AND patients.has_traveled_abroad = 'true',
b56a5ca8c263bc1137aded80,What are the immuno-cancer drugs of last 5 years.,,"SELECT DISTINCT t1.gene FROM (SELECT gene FROM drugs WHERE drug_category = 'immuno-cancer' AND date_of_approval = DATEADD(year, -5, GETDATE())) AS t1 JOIN (SELECT gene FROM drugs WHERE drug_category = 'immuno-cancer' AND date_of_approval = DATEADD(year, -5, GETDATE())) AS t2 ON t1.gene = t2.gene",
716b0a0b383a839c836a20ba,Can you tell me which were the top five most frequently tested specimens in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT t.specimen, COUNT(t.specimen) FROM (SELECT specimen FROM tbl WHERE year = 2100 GROUP BY specimen) t GROUP BY t.specimen ORDER BY COUNT(t.specimen) DESC LIMIT 5",[]
ffed9e72b74c6090bd75fda4,"Tell me the name of the drug which patient 10022041 was prescribed in the same day after having had a open reduction of fracture with internal fixation, humerus procedure since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.name FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10022041 AND treatment.type = 'open reduction of fracture with internal fixation, humerus' AND STRFTIME('%y-%m', treatment.date) >= '2100-03') AS t1 JOIN (SELECT patient.id, drug.name FROM drug JOIN patient ON drug.patient_id = patient.id WHERE patient.id = 10022041 AND STRFTIME('%y-%m', drug.date) >= '2100-03') AS t2 ON t1.id = t2.id WHERE t1.date LIKE t2.date",
834e30eb03b26e7bd61a9b19,How many times patient 10006053 came to the hospital this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10006053 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient_id) FROM appointments WHERE patient_id = 10006053 AND DATETIME(appointment_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
1550fe2c0834cad1b2dbef07,What was the dose of yellow cadd cassette that was last prescribed to patient 10014729 in 03/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND prescriptions.drug = 'yellow cadd cassette' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10014729 AND prescriptions.drug = 'Yellow Cadd Cassette' AND STRFTIME('%y-%m', prescriptions.date_prescribed) = '2100-03'",[]
411e30b09a68ac73906064aa,What are the current numbers of operating rooms available?,,SELECT COUNT(*) FROM operating_rooms WHERE room_status = 'operating';,
77ae0d9711456146d89f58ea,What was the organism found in patient 10021312's first bronchial washings test since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism FROM (,[]
61ac6587433ff400f0293adc,"Among patients who were given excision of left internal mammary artery, percutaneous endoscopic approach , what are the top three most common specimens tested afterward within the same month?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left internal mammary artery, percutaneous endoscopic approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT patient.specimen, MONTH(excision.date) AS month FROM excision JOIN patient ON excision.patient = patient.patient WHERE excision.type = 'excision of left internal mammary artery, percutaneous endoscopic approach') AS t1 JOIN (SELECT patient.specimen, MONTH(date) AS month FROM patient JOIN excision ON patient.patient = excision.patient WHERE excision.type = 'excision of left internal mammary artery, percutaneous endoscopic approach') AS t2 ON t1.specimen = t2.specimen WHERE t1.month = t2.month GROUP BY t2.specimen) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 3",
a8feb694e864b90b3695fce8,Can you tell me how many days patient 10015860 stayed in the ICU during their last stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT COUNT(DISTINCT ICU_DAY) FROM ICU WHERE PATIENT_ID = 10015860 AND NOT ICU_DEPARTMENT IS NULL ORDER BY ICU_DAY DESC LIMIT 1,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.6421874999068677}]"
65209ec4d53fcc5e5cd03c87,Calculate the total amount of or ebl of patient 10018081 since 10/03/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-03'","SELECT SUM(OR_EBL) FROM T1 WHERE T1.PATIENT_ID = 10018081 AND STRFTIME('%y-%m-%d', T1.DATE) >= '2100-10-03'",[{'SUM(outputevents.value)': None}]
30b60fadbc9e5ba919ab8f81,"What were the number of patients who received a total nucleated cells, csf test throughout this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, csf' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT t1.subject, t2.date FROM (SELECT subject, date FROM (SELECT patient_id, date FROM diagnoses WHERE diagnosis = 'total nucleated cells, csf') AS t1 JOIN (SELECT patient_id, date FROM procedures WHERE procedure = 'total nucleated cells, csf') AS t2 ON t1.subject = t2.subject) AS t1 JOIN (SELECT patient_id, date FROM measurements WHERE measurement = 'total nucleated cells, csf') AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of year') = DATETIME(t2.date, 'start of year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
2ca14c9e3ae55c6d467fa8c1,What was the total amount of furosemide that they prescribed to patient 10037861?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.drug = 'furosemide',SELECT SUM(Furosemide) FROM prescriptions WHERE prescriptions.patient_id = 10037861,[{'SUM(prescriptions.dose_val_rx)': None}]
42fee8cbef2d81610c0f6a7b,What is the blood type of patient 32168?,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 32168",
582b1e6739323885d6dd7148,What are the precautions to take after the packed cell transfusion procedure?,,SELECT * FROM procedures WHERE procedure = 'Packed cell transfusion';,
9f7b99f3d5e3095f6d354747,"Since 2100, what was patient 10016150 diagnosed with for the first time?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis FROM patients WHERE patient_id = 10016150 AND STRFTIME('%y', diagnosis_date) >= '2100' ORDER BY diagnosis_date NULLS FIRST LIMIT 1",
522b43ceabd524cfde7e3316,Are any new drugs prescribed to patient 10039831 today compared to the ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT SUM(CASE WHEN (SELECT prescriptions.drug_name FROM prescriptions WHERE prescriptions.patient_id = 10039831 AND DATETIME(prescriptions.date_prescribed, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day')) THEN 1 ELSE 0 END) > 0",[]
0874a8eb9ae4f8b6bb50a1d4,When was patient 10019777 prescribed for the first time a medication via ng route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.route = 'ng' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT ng.route FROM ng WHERE ng.patient_id = 10019777 ORDER BY ng.date_prescribed NULLS FIRST LIMIT 1;,[]
09a725954294822d94f728cd,How many hours has it been since the last time in the current hospital encounter that patient 10018081 was diagnosed with hypopotassemia?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypopotassemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosed_date)) FROM diagnoses WHERE patient_id = 10018081 AND diagnosis_description = 'hypopotassemia' AND hospital_dischtime IS NULL;",
af0bb751dca92abe9b101475,Count the number of patients who received a procedure in the previous year for closed [percutaneous] [needle] biopsy of kidney.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,
cc37854387e108740577c491,When was last time patient 65759 had a medication that is something to take all the time...,,SELECT MAX(date_submitted) FROM medication_requests WHERE patient_id = 65759 AND medication_duration = 'all the time',
ab6219b3365eb3a41f89b20b,How many drugs were given to patient 10036156 last year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM medication_usage WHERE patient_id = 10036156 AND date_sub('year', 1, current_date) = date_sub('year', 1, current_date);",[{'COUNT(*)': 0}]
ab2f0e488953985801236fef,Calculate the length of stay in days for the first stay of patient 10007928 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', INTERVAL TO DAY(EXTRACT(EPOCH FROM START DATE '2022-06-15'))) - STRFTIME('%j', INTERVAL TO DAY(EXTRACT(EPOCH FROM START DATE '2022-06-14'))) AS length_of_stay_days","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.859664352145046}]"
6c892975c433bd0b8960e8d5,What was the amount of lidocaine 1% dose prescribed to patient 10001217 since 03/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'lidocaine 1%' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT SUM(lidocaine_1_percent) FROM prescriptions WHERE prescriptions.patient_id = 10001217 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-03'",[{'SUM(prescriptions.dose_val_rx)': None}]
29a1dcd96e7a8c556183b81f,Tell me the protocol of anti cancer drugs?,,SELECT protocol FROM drugs WHERE category = 'anti cancer drugs',
b51511a676f74b3a0f868b97,What is the difference in patient 10021487's weights measured at 2100-12-22 04:00:00 compared to the value measured at 2100-12-20 00:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' ),SELECT (SELECT weight_kg FROM patients WHERE patient_id = 10021487 AND measurement_time = '2100-12-22 04:00:00') - (SELECT weight_kg FROM patients WHERE patient_id = 10021487 AND measurement_time = '2100-12-20 00:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' )"": None}]"
7b2aaf2bdc86d0afb00d3cef,What was the last respiratory rate value patient 10027602 had on 12/04/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-04' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(RespiratoryRate) FROM RespiratoryRate WHERE PatientID = 10027602 AND RespiratoryRateDate = '12/04/2100',[]
9f046b17ea9354be7cebea95,What was the total void output in patient 10023239 since 03/11/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-11'",SELECT SUM(output_void) FROM output WHERE patient_id = 10023239 AND output_date >= '2100-03-11',[{'SUM(outputevents.value)': None}]
de2dd163eefb7cd6f7fe4767,What are the four most common output instances since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
d736183a8eb133edc418c730,How many days have it been since the first stay of patient 10039831 on this hospital stay in the careunit surgical intensive care unit (sicu)?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'surgical intensive care unit (sicu)' ORDER BY transfers.intime ASC LIMIT 1",SELECT COUNT(DISTINCT DATE(CAREUNIT.STAYDATE)) FROM careunit WHERE CAREUNIT.PATIENTUNITID IN (SELECT PATIENT.PATIENTUNITID FROM patient WHERE PATIENT.PATIENTID = 10039831) AND CAREUNIT.STAYDATE IN (SELECT STAY.STAYDATE FROM stay WHERE STAY.PATIENTID = 10039831 AND STAY.Dischtime IS NULL),[]
1081d7abee1a338f85c00408,Did patient 10027602 take a gt flush medication on 12/06/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-06'","SELECT COUNT(*) FROM patient WHERE patient.id = 10027602 AND patient.medication = 'gt flush' AND STRFTIME('%y-%m-%d', patient.date) = '2100-12-06'",[{'COUNT(*)>0': 0}]
663817ca2281ed4ca55f52e3,What was the change in creatinine in patient 10039708 last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab_value FROM lab_measurements WHERE lab_measurements.patient_id = 10039708 AND lab_measurements.lab_name = 'creatinine' ORDER BY lab_measurements.measurement_date DESC LIMIT 1) - (SELECT lab_value FROM lab_measurements WHERE lab_measurements.patient_id = 10039708 AND lab_measurements.lab_name = 'creatinine' ORDER BY lab_measurements.measurement_date DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
340a6488743a4a60f4797d75,How many patients received a alanine aminotransferase (alt) lab test this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.lab_results.alt = 0 AND DATETIME(patient.lab_results.timestamp, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
b06238b6f95478036e95125a,What diagnosis did patient 10016742 receive in 2100 for the first time?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10016742 AND STRFTIME('%y', diagnoses.date) = '2100' ORDER BY diagnoses.date NULLS FIRST LIMIT 1",
63f037abd22df66334ece29c,What is the maximum total cost of the hospital which involves hyperplasia of renal artery?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperplasia of renal artery' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(t1.total_cost) FROM (SELECT SUM(ci.cost) AS total_cost FROM cost_info ci JOIN diagnosis_info di ON ci.diagnosis_id = di.diagnosis_id WHERE di.diagnosis = 'hyperplasia of renal artery' GROUP BY ci.cost_id) AS t1,
e5cad69b2c1bd6709789926f,"What is the number of patients that received a rbc, csf test during the previous year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, csf' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT ss.subject_id) FROM subjects ss INNER JOIN procedures p ON ss.subject_id = p.subject_id INNER JOIN parameters params ON p.parameters = params.parameters WHERE params.name = 'rbc, csf' AND DATETIME(p.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
bd1e0ce3084fab70f0a0f6db,Has any or colloid intake medication been given to patient 10039831 since 07/26/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-26'","SELECT COUNT(*) > 0 FROM intake_medication WHERE intake_medication.patient_id = 10039831 AND intake_medication.medication_name = 'or colloid' AND STRFTIME('%y-%m-%d', intake_medication.input_date) >= '2100-07-26'",[{'COUNT(*)>0': 0}]
f7f4a6f9abf6c8424b79c205,Count the current patients who are in the 60 or above.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT(DISTINCT patient_id) FROM patients WHERE age >= 60,
c57560772bbe0f01b4467b62,"Among patients who were diagnosed with calculus of bile duct without mention of cholecystitis, without mention of obstruction, what were the top five most common microbiology tests conducted in the same hospital encounter?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of bile duct without mention of cholecystitis, without mention of obstruction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t5.test_name FROM (SELECT t4.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t3.test_name, t3.subject_id, t3.date FROM (SELECT 'bile duct without mention of cholecystitis' AS test_name, 'subject1' AS subject_id, '2022-01-01' AS date FROM grades WHERE grade > 7 UNION ALL SELECT 'bile duct without mention of cholecystitis' AS test_name, 'subject2' AS subject_id, '2022-01-02' AS date FROM grades WHERE grade > 7) AS t3) AS t4 JOIN (SELECT t2.test_name, t2.subject_id, t2.date FROM (SELECT 'microbiology' AS test_name, 'subject1' AS subject_id, '2022-01-01' AS date FROM grades WHERE grade > 7 UNION ALL SELECT 'microbiology' AS test_name, 'subject2'",
7b319dcf4efec30297a50d9b,How many patients were given ezetimibe since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE ezetimibe >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 2}]
488d42291ce547168cdb32bb,Tell me the name of the prescription drug that patient 10018501 was prescribed within 2 days after having a alcohol detoxification procedure in 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT patient.prescriptions.drug FROM patient WHERE patient.id = 10018501) AS t1 JOIN (SELECT patient.prescriptions.drug FROM patient WHERE patient.id = 10018501) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.name = 'alcohol detoxification' AND DATETIME(t2.date, 'start of day') = DATETIME(t1.date, 'start of day', '-2 day')",
01270c1f37b90c29598b8e5c,Did patient 10001725 undergo repair of rectocele with graft or prosthesis in their last hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of rectocele with graft or prosthesis' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM repair_rectocele WHERE repair_rectocele.patient_id = 10001725 AND repair_rectocele.graft_or_prosthesis = 'prosthesis',[{'COUNT(*)>0': 0}]
f7778f20f71116c2c62f29b8,Calculate the sum of patient 10020944's input on 03/14/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '03-14'",SELECT SUM(input) FROM input_table WHERE patient_id = 10020944 AND input_date = '2022-03-14';,[{'SUM(inputevents.totalamount)': None}]
e40b14c3c51819949e2f549e,How long did it take to get spinal canal explor nec for patient 18877?,,SELECT COUNT(DISTINCT spinal_canal_explor_nec) FROM procedures WHERE patient_id = 18877,
01c441f58a97f89226067a93,When was the last time that patient 10031757 has had the maximum systolic blood pressure since 92 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-92 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(systolic_blood_pressure) FROM patient_10031757 WHERE systolic_blood_pressure IS NOT NULL AND DATETIME(current_timestamp) - DATETIME(systolic_blood_pressure) >= INTERVAL '92 day';,[]
8bc83605b6ede35754a1e843,Has there been any organism found in the first microbiological urine test of patient 10021118 in 12/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT COUNT(*) FROM microbiology WHERE microbiology.patient_id = 10021118 AND microbiology.test_type = 'urine' AND STRFTIME('%y-%m', microbiology.test_date) = '2100-12' ORDER BY microbiology.test_date NULLS FIRST LIMIT 1",[{'COUNT(*)>0': 0}]
6721130290e0d18224932b4d,What was the drug that was prescribed to patient 10027602 in the same hospital visit after the percutaneous [endoscopic] gastrostomy [peg] this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,
5cc361b3a9d1cee29ed3d437,"How many patients in 2100 were diagnosed with insomnia, unspecified within the same hospital visit after the diagnosis of other postprocedural status?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postprocedural status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'insomnia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date, t1.had_surgery FROM (SELECT subject_id, diagnosis_date, had_surgery FROM (SELECT subject_id, diagnosis_date FROM (SELECT * FROM diagnoses WHERE diagnosis = 'insomnia, unspecified') AS t2 JOIN (SELECT * FROM patient WHERE diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31') AS t1 ON t1.subject_id = t2.subject_id WHERE t2.diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND t1.had_surgery = 0) AS t1 JOIN (SELECT subject_id, diagnosis_date, had_surgery FROM (SELECT subject_id, diagnosis_date FROM (SELECT * FROM diagnoses WHERE diagnosis = 'other postprocedural status') AS t2 JOIN (SELECT *",
b5dcc8918a0bc3fb72bf3b6b,What is the maximum total cost for a hospital including tests in the granular casts laboratory since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'granular casts' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM tests WHERE cost IS NOT NULL AND year >= 2100 GROUP BY hospital) AS t1,
ace4be317f182e1697b40080,"Which were the three most commonly ordered procedures for patients previously diagnosed with acquired absence of organ, genital organs within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Acquired absence of organ, genital organs') AS t1 JOIN (SELECT patient.id, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.id) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t2.treatment_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.treatment) AS t3 WHERE t3.c1 <= 3",
17ff517f4cb7bc5330bbc4dd,How many hours have elapsed since patient 10018081's first stay in the careunit emergency department on this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.firststay)) FROM patient WHERE patient.subjectid = 10018081 AND patient.location = 'careunit emergency department' AND patient.hospitaldischtime IS NULL;",[]
7bd7e129fb3ef8370555bf1b,What specimen test was first given during their last hospital encounter to patient 10011398?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT specimen_test FROM (SELECT * FROM patient WHERE patient_id = 10011398 AND NOT last_hospital_encounter IS NULL ORDER BY last_hospital_encounter NULLS FIRST LIMIT 1) AS subquery;,[{'spec_type_desc': 'MRSA SCREEN'}]
09552895d2ca5e482d2b314f,Tell me the percentile for platelet count of 332.0 among patients in the same age as patient 10014729 on the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 332.0","SELECT MIN(Percentile) FROM (SELECT * FROM (SELECT 10014729 AS Patient, 332.0 AS PlateletCount, 0.0 AS HemoglobinCount, 0.0 AS WhiteBloodCount, 0.0 AS StemCellCount, 0.0 AS ProgenitorCellCount FROM Platelets WHERE Platelets.Patient = 10014729 AND NOT Platelets.Hospitalized = 0) AS T1 JOIN (SELECT * FROM (SELECT 10014729 AS Patient, 332.0 AS PlateletCount, 0.0 AS HemoglobinCount, 0.0 AS WhiteBloodCount, 0.0 AS StemCellCount, 0.0 AS ProgenitorCellCount FROM Platelets WHERE Platelets.Patient = 10014729 AND NOT Platelets.Hospitalized = 0) AS T2 ON T1.Patient = T2.Patient WHERE T1.PlateletCount = T2.Platelet",
e93f9ba8d8777339be3240be,What was the first lab test result of the absolute neutrophil count for patient 10014354 on the last hospital visit?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute neutrophil count' ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT MIN(lab_result) FROM lab_tests WHERE lab_name = ""Absolute neutrophil count"" AND patient_id = 10014354 AND NOT patient_id IS NULL ORDER BY patient_id DESC LIMIT 1;",[]
59217d3eca4038fcc33993f0,Tell me about all the medications that patient 99080 received in the other department.,,"SELECT json_extract(medication, '$.name') FROM medication WHERE json_extract(medication, '$.department') = 'other' AND patient_id = 99080;",
54422dbdbf89248bf6be26fb,What was the number of times rosuvastatin calcium was prescribed in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'rosuvastatin calcium' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Rosuvastatin Calcium' AND STRFTIME('%y', prescriptions.date) = '2100'",[{'COUNT(*)': 0}]
876c247db73f4411e78223a2,Retrieval of the top four most frequent outputs since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT COUNT(DISTINCT ""output"") FROM ""output"" WHERE ""year"" >= 2100 GROUP BY ""output"" ORDER BY COUNT(*) DESC LIMIT 4","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
4711ca09480e8240ce0059df,What was the organism detected in patient 10021487's last blood culture microbiology test since 12/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism FROM microbiology WHERE patient_id = 10021487 AND microbiology_type = 'blood culture' AND date >= '12/2100' ORDER BY date DESC LIMIT 1,[]
83ec58fae196e1e30c71c836,What was the name of the drug which was prescribed to patient 10009035 within 2 days after having received a extracorporeal circulation auxiliary to open heart surgery procedure in 05/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.subject, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.subject WHERE patient.subject = 10009035 AND treatment.type = 'extracorporeal circulation auxiliary to open heart surgery' AND STRFTIME('%y-%m', treatment.date) = '2100-05') AS t1 JOIN (SELECT patient.subject, drug.drug, drug.date FROM drug JOIN patient ON drug.patient = patient.subject WHERE patient.subject = 10009035 AND STRFTIME('%y-%m', drug.date) = '2100-05') AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
94e88227ead8378786e00436,Which are the four top specimens that were tested during this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",SELECT TOP(4) AS specimen FROM (SELECT specimen FROM postgres_db.specimens WHERE year = 2022) AS subquery;,[]
02a069698a803a8419fa294c,Tell me the count of the drugs patient 10021118 was prescribed in 11/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10021118 AND STRFTIME('%y-%m', prescriptions.date) = '2100-11'",[{'COUNT(*)': 0}]
70d4f706eb7c1197729174d6,What were the five most common drugs prescribed since 1 year ago?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE DATETIME(prescriptions.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
9b39448454fb368c2b7fb229,Can you tell me what patient 10007795's last heart rate was during the first ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(heart_rate) FROM (SELECT heart_rate FROM patient WHERE patient.icu_visits = 1) WHERE patient.patient_id = 10007795,[]
2aa7ae5c7002d9117a347f9e,Could you retrieve the top four diagnoses that have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",SELECT diagnosis FROM diagnoses ORDER BY 3-month mortality rate DESC LIMIT 4;,
44b3905875474271bf26457e,What are the reimbursement standards for cerebrovascular mri?,,SELECT MAX(reimbursement) FROM procedures WHERE procedure = 'Cerebrovascular MRI';,
a229a64f2bf74f9fc9dfa626,In what ways can nystatin cream be ingested?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin cream',"SELECT DISTINCT ON (ingredient) ingredient, preparation FROM ingredients JOIN preparations ON ingredients.id = preparations.ingredient_id WHERE ingredient = 'nystatin cream'",[]
42b32b8c9018073085ea61c5,How many operation rooms are now available?,,SELECT COUNT(*) FROM Operating_Rooms WHERE Available = 1;,
b491a9d1d8f94456fa46b689,Tell me the number of patients discharged from the hospital throughout this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient_id) FROM admissions WHERE NOT dismissed_date IS NULL AND DATETIME(dismissed_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
2a8475d3f201bfe0a949a29a,Has patient 10001217 since 2100 been given a l lab test?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y',labevents.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10001217 AND lab_results.lab_name = 'l' AND STRFTIME('%y', lab_results.result_date) >= '2100'",[{'COUNT(*)>0': 0}]
2c4e0725c06cb24d740f8090,Which immuno-cancer drugs were used for the last five years?,,"SELECT DISTINCT ON (drug_name) drug_name, classification, dosage, indication FROM drugs WHERE indication LIKE '%immuno-cancer%' AND dosage LIKE '%5 years%' ORDER BY drug_name;",
646e109b76831aec3246418b,What was the name of the procedure that was given two times to patient 10019777 since 13 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-13 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT d.procedure_name FROM (SELECT t.procedure_name, COUNT(t.date) AS call_count FROM (SELECT patient_id, procedure_name, date FROM procedures WHERE patient_id = 10019777) AS t WHERE t.date >= DATEADD(month, -13, CURRENT_DATE)) AS d WHERE d.call_count = 2",
5e26962b8d9bc2994ab47e5d,Can you calculate how many patients were prescribed ipratropium-albuterol neb during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium-albuterol neb' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",SELECT COUNT(DISTINCT patient.identifier) FROM patient WHERE patient.patient_type = 'PRESCRIBED' AND patient.date_prescribed >= (SELECT MAX(date_prescribed) FROM patient) - INTERVAL '1 year' AND patient.date_prescribed <= (SELECT MAX(date_prescribed) FROM patient) AND patient.prescription_name = 'Ipratropium-Albuterol Neb',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
5a9d2f417f6b862c0b7366e8,What was the last weight of patient 10002495 since 19 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(weight) FROM patients WHERE patient_id = 10002495 AND date > CURRENT_DATE - INTERVAL '19 month',[]
d15888d8cda931dc5035830d,Can you tell me which were the top three most frequent specimens tested?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(specimen) FROM testing GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
69c7281826029c1b41a34049,What is the dosage of an opioid given to patient 4469?,,SELECT opioid_dosage FROM patient_4469 WHERE opioid_dosage IS NOT NULL;,
86633ae70ad8fa5a8c7ee1ad,"Of the patients of age 40s , what were the top three most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM patients WHERE age BETWEEN 40 AND 49 GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 3",
e47e7e616f3d5838b2aa30eb,When was the first time that patient 10004422 was prescribed medication during their last hospital encounter via the sc route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(date_prescribed) FROM medication WHERE patient_id = 10004422 AND route = 'sc',[]
9e9c562a4ca1886263c6444c,"What was the name of the drug which patient 10007818 was prescribed during the same hospital visit after receiving a drainage of peritoneal cavity, percutaneous approach, diagnostic procedure in 07/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.id, treatment.start_time, patient.location FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10007818 AND treatment.treatment_type = 'drainage of peritoneal cavity, percutaneous approach, diagnostic' AND STRFTIME('%y-%m', treatment.start_time) = '2100-07') AS t1 JOIN (SELECT patient.id, prescription.drug, prescription.start_time, patient.location FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE patient.id = 10007818 AND STRFTIME('%y-%m', prescription.start_time) = '2100-07') AS t2 ON t1.id = t2.id WHERE t1.start_time < t2.start_time AND t1.location = t2.location",
22377f7f4ffda156f6c95713,Has patient 10012552 been diagnosed with any type of disease since 1 year ago?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10012552 AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')",
7f9686faa27e555657f81477,Show me the top five most commonly prescribed drugs since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.drug_name FROM (SELECT prescriptions.drug_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE DATETIME(prescriptions.date_prescribed) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY prescriptions.drug_name) AS t1 WHERE t1.c1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
657a58e806b8805fa2a4714d,How is trazodone typically taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'trazodone',SELECT AVG(duration) FROM medication WHERE medication.drug = 'trazodone';,[]
f35e3b8882888f20f738170e,Tell me what to prepare before the non-invasive mech vent procedure,,"SELECT ""to prepare before the non-invasive mech vent procedure"" FROM ""questions"" WHERE ""question"" = 'what to prepare before the non-invasive mech vent procedure'",
91e430cc8aa46185aee7b418,"What is the minimum total hospital cost for a patient suffering from collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.c1) FROM (SELECT SUM(CI_HOSP__TOTAL_COST) AS c1 FROM (SELECT CI_HOSP__TOTAL_COST FROM bracket_table WHERE collapsed_vertebra = 'collapsed vertebra, not elsewhere classified') AS T1 JOIN (SELECT CI_HOSP__TOTAL_COST FROM bracket_table WHERE thoracic_region = 'thoracic region, initial encounter for fracture') AS T2 ON T1.patient_id = T2.patient_id WHERE T1.year = 2100 GROUP BY T1.patient_id) AS T3",
1a35a4ed34f622e32e8c72ee,Tell me what the total foley output of patient 10020740 is on 03/24/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-24'",SELECT SUM(foley) FROM output WHERE patient = 10020740 AND date = '03/24/2100',[{'SUM(outputevents.value)': None}]
39a3cf3e83759a824ed64266,Has patient 10008287 been given any diagnosis since 1 year ago?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient = 10008287 AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')",
74693de7d313f1576fec3036,When was the first time that patient 10005909 has received a red blood cells lab test since 08/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(lab_date) FROM lab_table WHERE lab_patient_id = 10005909 AND lab_name = 'red blood cells' AND STRFTIME('%y-%m', lab_date) >= '2100-08'",[]
4e6d83c0c7ba1ea3a2bf658b,How many patients were diagnosed with acute diastolic (congestive) heart failure in the same month after the previous diagnosis with hypokalemia in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypokalemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute diastolic (congestive) heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'acute diastolic (congestive) heart failure') AS t1 JOIN (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'hypokalemia') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month') AND STRFTIME('%y', t1.diagnosis_date) = '2100') AS t3",
1770a690d77ad9ec94532a67,What was the admission type when patient 10018423 last entered the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018423 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1","SELECT ""admission_type"" FROM ""patient_table"" WHERE ""patient_id"" = 10018423 ORDER BY ""last_hospital_admission_date"" DESC LIMIT 1",[{'admission_type': 'EW EMER.'}]
49844eb3d519ede694dbad6b,List the top five most frequent specimens that patients were tested within 2 months after receiving percutaneous [endoscopic] gastrostomy [peg].,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.date FROM (SELECT patient.name, procedure.date FROM procedures JOIN patient ON procedures.patient = patient.name JOIN percutaneous_gastrostomy ON procedures.percutaneous_gastrostomy = percutaneous_gastrostomy.date) AS t1 JOIN (SELECT patient.name, specimen, date FROM specimens JOIN patient ON specimens.patient = patient.name) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.specimen) AS t3 JOIN (SELECT specimen, COUNT(specimen) FROM specimens GROUP BY specimen) AS t4 ON t3.specimen = t4.specimen ORDER BY t4.count DESC LIMIT 5",
513415b2f83b280737f76ca1,Retrieve the top four most frequent output occurrences throughout this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT COUNT(*) FROM duckdb_outputs WHERE output_occurrence IN (SELECT output_occurrence FROM duckdb_outputs GROUP BY output_occurrence ORDER BY COUNT(*) DESC LIMIT 1 OFFSET 0);,[]
22c001b4fbec510a6a36e644,What's the minimum monthly number of admissions for hesitancy of micturition since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hesitancy of micturition' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT MIN(admissions) FROM admissions WHERE hesitancy = 'micturition' AND year >= 2100 GROUP BY month,
17f20674ea38a822c7cb6788,What time was the first time the systolic blood pressure of patient 10005817 was less than 128.0 in the first ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 128.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(time) FROM intake WHERE patient = 10005817 AND icu_number = 1 AND systolic_blood_pressure < 128.0,[]
a491772e3c26b8dfc1137679,"Has patient 10038081 had a lab test for glucose, ascites in 10/this year?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'","SELECT COUNT(*) FROM lab_results WHERE lab_results.patient_id = 10038081 AND lab_results.lab_name = 'glucose, ascites' AND DATETIME(lab_results.result_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', lab_results.result_date) = '10'",[{'COUNT(*)>0': 0}]
acc452348f26357e7eee2d70,Calculate the total volume of input by patient 10019777 on 03/10/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-10'",SELECT SUM(volume) FROM input WHERE patient_id = 10019777 AND input_date = '2100-03-10';,[{'SUM(inputevents.totalamount)': None}]
72046d186a8821cf81d3fec7,What was patient 10009035's weight the last time it was measured since 28 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(weight) FROM patients WHERE patient_id = 10009035 AND measurement_date >= DATEADD(month, -28, CURRENT_DATE)",[]
6a258cd10ee1f1a03e0c9d23,How many patients stayed in careunit medical intensive care unit (micu) since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient) FROM careunit_medical intensive care unit (micu) WHERE DATETIME(careunit_medical.admittime) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
5e629ad0ef424581e32da93e,Count the current patients who are in the 50s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,SELECT COUNT(PATIENT) FROM current_patients WHERE PATIENT_AGE BETWEEN 50 AND 59;,
3cec04d92cd89035dc5758b1,What were the four most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT Event FROM output WHERE Frequency > (SELECT AVG(Frequency) FROM output WHERE Time > (CURRENT_TIMESTAMP - INTERVAL '1 year')) GROUP BY Event ORDER BY Frequency DESC LIMIT 4;,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
83a394225c13181e2fd82725,"List the top three most frequent specimens that patients were tested in the same month after receiving fluoroscopy of superior vena cava using other contrast, guidance since 1 year ago.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, DATETIMEFROMPARTS(t2.date, 0, 0, 0) AS date FROM (SELECT patient.uniquepid, treatment.date FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatment = 'Fluoroscopy of superior vena cava using other contrast, guidance' AND DATETIMEFROMPARTS(treatment.date, 0, 0, 0) >= DATETIMEFROMPARTS(CURRENT_DATE, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, specimen, DATETIMEFROMPARTS(date, 0, 0, 0) AS date FROM specimen JOIN patient ON specimen.patientid = patient.uniquepid WHERE DATETIMEFROMPARTS(date, 0, 0, 0) >= DATETIMEFROMPARTS(CURRENT_DATE, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date < t2.date AND DATETIMEFROMPART",
c9cf1ade991005f5fffbd47d,What's the total of glucagon prescriptions since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Glucagon' AND STRFTIME('%y', prescriptions.date) >= '2100';",[{'COUNT(*)': 0}]
2dd85238210fd7a67447c15c,"Calculate the number of patients with altered mental status, unspecified who were diagnosed in 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, 2000 AS diagnosis_year FROM diagnoses WHERE diagnosis = 'altered mental status, unspecified') AS t1 JOIN (SELECT subject_id, 2100 AS diagnosis_year FROM diagnoses WHERE diagnosis = 'altered mental status, unspecified') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_year = t2.diagnosis_year",
78f0e0fcc6e1ea0b7d221630,What was the name of the output which patient 10007818 had for the last time on 07/03/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-03' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT ""output_name"" FROM ""output_table"" WHERE ""patient_id"" = 10007818 AND STRFTIME('%y-%m-%d', ""output_date"") = '2100-07-03';",[]
dd2de211b42f9be113f51d60,What is patient 10020944's sex?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944,SELECT patients.sex FROM patients WHERE patients.ssn = 10020944,[{'gender': 'M'}]
9541827f1eee21fcc491d39d,What diagnosis did patient 10022880 have last since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",SELECT diagnosis FROM diagnoses WHERE patient = 10022880 AND date >= CURRENT_DATE - INTERVAL '1 year',
0de0194d965055a79103daf2,What does it cost to get cardiac arrest due to underlying cardiac condition diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) ),SELECT SUM(DISTINCT cardiac_arrest_cost) FROM cardiac_table WHERE cardiac_condition = 'underlying';,
a342759e5ce55cf378df2630,Has patient 10015272 come into the ER?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM patient WHERE patient.subject_id = 10015272 AND patient.location = 'emergency room admit',[{'COUNT(*)>0': 0}]
8fa8ed75a85186090d9db649,Has patient 10008287 been prescribed any prescription drugs since 28 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-28 month')","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10008287 AND DATETIME(prescriptions.date_prescribed) >= DATETIME(CURRENT_TIME, '-28 month')",[{'COUNT(*)>0': 1}]
6b24642366cb89db4096210b,What's the rank of the top four most common output events in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.event FROM (SELECT COUNT(*) AS c, event FROM (SELECT DISTINCT event FROM output WHERE year = 2100) AS t GROUP BY event ORDER BY c DESC LIMIT 4) AS t;",[]
0878aade13d38cab157cad47,"After receiving laparoscopic robotic assisted procedure this year, what are the four most common diagnoses that patients received within the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.month FROM (SELECT date_part('month', laparoscopic_robotic_assisted_procedure.date) AS month FROM laparoscopic_robotic_assisted_procedure WHERE date_part('year', laparoscopic_robotic_assisted_procedure.date) = 2021) AS t1 JOIN (SELECT date_part('month', diagnoses.date) AS month, diagnoses.diagnosis FROM diagnoses WHERE date_part('year', diagnoses.date) = 2021) AS t2 ON t1.month = t2.month) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 4",
6247e4ff884d2882517e9fa9,How much divalproex (delayed release) was first prescribed to patient 10038999 in 05/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.drug = 'divalproex (delayed release)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT 05 AS _2100 FROM duckdb_prescriptions WHERE prescription_name = 'divalproex (delayed release)' AND patient_id = 10038999,[]
613174eb83b532fe4e38b7fc,What is the name of the drug that should not be administered during the total splenectomy procedure?,,SELECT name FROM drugs WHERE administration_during_procedure = 'total splenectomy',
527f4ad3f397267a5cdd7622,Tell me about the most common three output events.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",SELECT FROM duckdb_functions WHERE function_name = 'most_common_three_output_events',"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
db075c3a76dad8cee21d6089,What kind of rooms are available now for singles?,,SELECT * FROM room WHERE single = true;,
356174c53f28f728dccdef72,List the top four most common events that happened since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT events.event_name, COUNT(*) FROM events WHERE events.event_year >= 2100 GROUP BY events.event_name ORDER BY COUNT(*) DESC LIMIT 4;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
a36cdf4e546071a6ffd31158,When was the first time patient 10020306 was discharged from hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(dischtime) FROM patient WHERE patient.subject = '10020306';,[{'dischtime': '2129-10-30 13:20:00'}]
eee4eef5cba60f4be092bcb9,"Was the calcium, total value second measured on the first hospital visit of patient 10019568 greater than first measured on the first hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT COUNT(*) > 0 FROM (SELECT calcium, total FROM 30_10019568 WHERE visit_number = 1) AS subquery JOIN (SELECT calcium, total FROM 30_10019568 WHERE visit_number = 2) AS subquery2 ON subquery.calcium = subquery2.calcium","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
252547601fd6f7de68d6ad35,"How much is performance of cardiac output, continuous?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) )","SELECT * FROM performance_brackets WHERE operation = 'cardiac output, continuous';",
edf4e6f3df6825947d302e8e,When was the last time patient 10020944 measured its respiratory rate less than 21.0 since 348 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-348 day') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(MeasurementDate) FROM RespiratoryRateMeasurements WHERE RespiratoryRate < 21.0 AND PatientId = 10020944 AND MeasurementDate >= (CURRENT_DATE - 348),[]
1fc3739dc0cf84ab7935fd38,What drug was the last drug prescribed for patient 10020786?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT array_pop_back(drug_prescriptions) FROM prescriptions WHERE patient_id = 10020786;,[{'drug': 'Ondansetron'}]
6a5d0066989fdc73a130b8c2,What were the name of the treatment received by patient 10005909 two or more times since 04/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t1.treatment, COUNT(t1.date) FROM (SELECT patient_id, treatment, date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE patient.patient_id = 10005909 AND diagnosis.date BETWEEN '2000-04-2100' AND '2000-04-2101') AS t1 GROUP BY t1.treatment HAVING COUNT(t1.date) >= 2",
242ad67d83b98dc87f0a257c,Has patient 10038999 been administered any nacl 0.9% since 03/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03'",SELECT COUNT(*) > 0 FROM history WHERE history.patient_id = 10038999 AND history.start_date >= '2000-03-2100' AND history.nacl_0.9% = 'administered',[{'COUNT(*)>0': 0}]
264556fad0e8f61d4b7fe7e9,What were the first alkaline phosphatase lab test results for patient 10019172 in 10/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(Alkaline Phosphatase) FROM lab WHERE Patient = 10019172 AND Date = '10/2100',[]
718c27e2ef2f6d9f2a3210f8,When was the last time that patient 10025612 had the minimum pco2 value on the last hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MAX(pco2) FROM (SELECT pco2 FROM patient_10025612 WHERE patient_10025612.hospital_ encounter_id = (SELECT encounter_id FROM patient_10025612 WHERE patient_10025612.hospital_dischtime IS NULL ORDER BY patient_10025612.hospital_admittime DESC LIMIT 1)),[]
f4efae356977c3e6db1d472e,What is the name of the medication that was prescribed to patient 10037975 for the last time via the iv route since 02/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT name FROM medication WHERE patient_id = 10037975 AND route = 'iv' AND date >= '2000-02-2100' ORDER BY date DESC LIMIT 1,[]
671afd8de1d5bdb9e0151ce2,When patient 10005817 was last discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = 10005817,[]
ddc7e149237d42b52700d717,What was the last value of the arterial blood pressure diastolic for patient 10008454 on their last ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(arterial_blood_pressure_diastolic) FROM icu WHERE icu.patient_id = 10008454 AND NOT icu.outflow = 1;,[]
7a01a7e71c780f176eb7b360,Can you give me the three most common output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",SELECT 3 AS _most_common_output_events FROM brackets WHERE _year > 2100,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
93736e989193b9f5bc0fbdff,Tell me the minimum respiratory rate of patient 10026406 in the last ICU stay.,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ),SELECT MIN(RespiratoryRate) FROM (SELECT RespiratoryRate FROM icu WHERE icu.PatientId = 10026406 AND NOT icu.Outdated IS NULL ORDER BY icu.AdmissionDate DESC LIMIT 1),[{'MIN(chartevents.valuenum)': None}]
362416f9fea1bf8466b44a48,Tell me the top three most frequently tested specimens in 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",SELECT top_three FROM (SELECT COUNT(specimen) AS top_three FROM 2100 GROUP BY specimen) subquery;,[]
f603f6954b5ed9f4cb1b3c15,"In 2100, how many patients underwent a venous catheterization, not elsewhere classified in the same month after the diagnosis of hepatic encephalopathy?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hepatic encephalopathy' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'hepatic encephalopathy') AS t1 JOIN (SELECT subject_id, catheterization_date FROM catheterizations WHERE catheterization_type = 'venous') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.catheterization_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.catheterization_date, 'start of month'))",
cf6c8c0873569e3fe49b7317,"Hey, what was patient 10019172's minimum fibrinogen, functional value in 11/this year?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11'","SELECT MIN(Fibrinogen, Functional) FROM patient WHERE patient.subject = 10019172 AND NOT patient.fibrinogen IS NULL AND DATETIME(patient.fibrinogen, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', patient.fibrinogen) = '11'",[{'MIN(labevents.valuenum)': None}]
163e20b7886f513a8897df5b,Can you tell me the name of the output patient 10004733 had for the last time on 12/28/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-28' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT name FROM outputs WHERE patient_id = 10004733 AND date_this_year = '12/28' ORDER BY id DESC LIMIT 1,[]
c1a94ccad673ddf5a68e93e3,What are the four most regularly ordered treatments for patients previously diagnosed with noncompliance with renal dialysis in the same hospital visit in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_date, patient.location FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'noncompliance with renal dialysis' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.name, treatment.treatment, treatment.treatment_date, patient.location FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE STRFTIME('%y', treatment.treatment_date) = '2100') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.treatment_date AND t1.location = t2.location GROUP BY t2.treatment) AS t3 WHERE t3.c1 <= 4",
5cb77adf0cc7efec9a38adba,Tell me the four most common diagnosis during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",SELECT diagnosis FROM diagnoses WHERE date BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 4,
723f3f4a1100077de462dfa3,Tell me the maximum total hospital cost that includes cefpodoxime proxetil in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'cefpodoxime proxetil' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.total_hospital_cost) FROM (SELECT SUM(T2.hospital_cost) AS total_hospital_cost FROM (SELECT 1 AS hospital_cost FROM prescriptions WHERE prescriptions.date = ""2100-01-01"") AS T1 JOIN prescriptions ON T1.prescription_id = prescriptions.prescription_id WHERE prescriptions.drug = ""Cefpodoxime Proxetil"") AS T2",
a4ead1605ee2cae02541b57b,How many people got prescriptions for adde last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'adde' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT id) FROM patients WHERE prescriptions LIKE '%adde%' AND date_prescribed BETWEEN DATEADD(year, -1, CURRENT_DATE) AND CURRENT_DATE",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
aa513e26eaa857febb6f4db0,What are the new drugs for patient 10004733 today compared to the earlier ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM drugs WHERE patient_id = 10004733 AND date = '2022-10-08',[]
b14e62dc0fdb8c7bba510c8a,Calculate patient 10019172's total output on 11/20/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-20'",SELECT SUM(output) FROM input WHERE patient = 10019172 AND input_date = '2100-11-20',[{'SUM(outputevents.value)': None}]
c6de512d1247fb7333ad1c80,What was the last time that patient 10031757 had a maximum systolic blood pressure since 92 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-92 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(systolic_blood_pressure) FROM read_brackets WHERE patient_id = 10031757 AND datatype = 'systolic' AND time_since = '92 days ago',[]
3717572f6b674f00be856aec,How many days have elapsed since patient 10018081 had received a red blood cells lab test for the last time on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_timestamp)) FROM lab_table WHERE lab_table.patient_id = 10018081 AND lab_table.lab_name = 'red blood cells' AND lab_table.hospital_id = (SELECT lab_table.hospital_id FROM lab_table WHERE lab_table.patient_id = 10018081 AND lab_table.lab_name = 'red blood cells' ORDER BY lab_timestamp DESC LIMIT 1)",[]
f482fa51f88bdcc934bc4754,Can you list the single rooms that are available for rent now?,,SELECT DISTINCT room_name FROM rooms WHERE room_type = 'single' AND available_since = 'now';,
88b0fb242af55f296a52b5d8,Can you tell me the first value of the bicarbonate test for patient 10001725 since 04/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(bicarbonate) FROM lab WHERE patient = 10001725 AND date >= '04/2100',[]
99248704a41adef41854911d,How much is the average total hospital cost associated with hyperkalemia since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperkalemia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(T1.cumulative_cost) FROM (SELECT SUM(cost) AS cumulative_cost FROM cost_table WHERE diagnosis = 'hyperkalemia' AND year >= 2100 GROUP BY patient_id) AS T1,
132aee5ba3480c54ca8cee44,What are the top three most frequent microbiology tests since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t.test_name, COUNT(t.test_name) FROM microbiology_tests t WHERE t.date >= '2100-01-01' GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
ced779d97cae41941721bd34,"What number of days has it been since the first time patient 10018081 was diagnosed with encephalopathy, unspecified in this hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encephalopathy, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosed_date)) FROM diagnoses WHERE patient_id = 10018081 AND diagnosis_type = ""Encephalopathy, unspecified""",
bde07b33be302a136b2699b4,When should patient 74392 visit the hospital next?,,SELECT next_visit FROM patients WHERE patient_id = 74392;,
7a6b657fddbeb52ba6d8450c,Show me the top three most common diagnoses of patients with age 30s during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT diagnosis, COUNT(diagnosis) FROM patients WHERE age BETWEEN 30 AND 39 AND DATETIME(diagnosis, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 3;",
2814f1edb1bea5a93666884f,Number of patients who were given a insertion or replacement of other neurostimulator pulse generator procedure.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of other neurostimulator pulse generator' ) ),"SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.device_id FROM (SELECT subject_id, device_id FROM patients WHERE device_type = 'neurostimulator pulse generator') AS t1 JOIN patients AS t2 ON t1.subject_id = t2.subject_id) AS t3 JOIN (SELECT device_id, COUNT(DISTINCT subject_id) AS install_count FROM patients GROUP BY device_id) AS t4 ON t3.device_id = t4.device_id WHERE t4.install_count > 1",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e11c8d2b04cdfacf76cca4dd,Has patient 29806 had any other stool tests?,,SELECT COUNT(*) FROM microbiology WHERE microbiology.patient_id = 29806 AND microbiology.stool_type = 'other stool',
1d5e1f6694e66a38eb9d48b3,Tell me the total number of patients who were diagnosed with open fracture of shaft of femur since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'open fracture of shaft of femur' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT patient_id) FROM diagnoses WHERE diagnosis = 'open fracture of shaft of femur' AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100'",
e96d3b106469bfd953cd2583,"Was the potassium, urine reading for patient 10014078 second measured on the last hospital visit less than the value first measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT COUNT(*) > 0 FROM (SELECT Potassium, Urine FROM lab WHERE lab.patient.id = 10014078 AND NOT lab.patient.hospitalized_on_date IS NULL ORDER BY lab.patient.hospitalized_on_date DESC LIMIT 1) AS subquery WHERE subquery.Potassium < Potassium, Urine FROM lab WHERE lab.patient.id = 10014078 AND NOT lab.patient.hospitalized_on_date IS NULL ORDER BY lab.patient.hospitalized_on_date DESC LIMIT 1","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
6e552f2daf5bcd6d9a143315,Can you tell me the name of the diagnosis patient 10019568 received last since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT diagnosis.name FROM diagnosis WHERE diagnosis.patient = 10019568 AND STRFTIME('%y', diagnosis.date) >= '2100' ORDER BY diagnosis.date DESC LIMIT 1",
3ee6a4091b6e165e3eab53d4,When is the earliest appointment for patient 14467 for other departments?,,SELECT MIN(Appointment_Date) FROM Appointment WHERE Patient_ID = 14467 AND Department <> 'IT',
4280ebde89a88a7f5565d9dd,W/is the code that corresponds to icd-11 for stomatits & mucosits nec in icd-10?,,SELECT icd_11 FROM icd_10 WHERE icd_10 = 'stomatits & mucosits nec';,
23d5a55f9d6248b8d743d970,When was the first time patient 10004422 was prescribed a medication in 01/this year via the pr route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM prescriptions WHERE patient_id = 10004422 AND route = 'pr' AND date_prescribed >= '2001-01-01' AND date_prescribed < '2001-01-01' + INTERVAL '1 year',[]
c9f31ddb9aad553f281fb072,Can you tell which medicine was last prescribed to patient 10021118 via the oral method in 12/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'oral' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10021118 AND method_of_prescription = 'oral' AND date_prescribed BETWEEN DATEADD(year, -0, DATEADD(month, -12, CURRENT_DATE)) AND DATEADD(year, -0, DATEADD(month, -12, CURRENT_DATE))",[]
2d72caa3a5dafdb3b343b78e,Tell me the maximum total hospital cost that involves unspecified glaucoma in 2100.,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified glaucoma' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(T1.c1) FROM (SELECT SUM(T2.c2) AS c1 FROM (SELECT c2 FROM (SELECT '2100' AS c3) AS T1 JOIN (SELECT 'glaucoma' AS c2 FROM dual) AS T2 ON T1.c3 = T2.c3 WHERE T2.c2 = 'unspecified') GROUP BY T1.c1) AS T3;,
233c13143fc7c9d92e63dbb4,What drugs are being added to the prescription of patient 10004733 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescription_additions FROM prescriptions WHERE patient_id = 10004733 AND date = '2022-03-01',[]
1f9b6689da5fdcc23879a5ac,What is the drug name that should not be administered during the above knee amputation procedure?,,SELECT prescription_name FROM prescriptions WHERE prescription_name = 'Drug Name',
73c5a29239e229c1e3d8d5f1,What was the first measurement of heart rate in patient 10004733's body since 22 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 day') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM '10004733'::patient WHERE heart_rate IS NOT NULL AND DATETIME(heart_rate) >= DATETIME(CURRENT_TIME, '-22 day'))",[]
3bf9272fcc3117ccfaed52f1,How much tamoxifen citrate was first prescribed to patient 10007795 since 10/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug = 'tamoxifen citrate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10007795 AND prescriptions.drug_name = 'Tamoxifen Citrate' AND STRFTIME('%y-%m', prescriptions.date_prescribed) >= '2100-10'",[]
858671065bb8f7d96bf37f64,How was patient 10018328 last admitted to the hospital in terms of admission type?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018328 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",SELECT TERM(admission_type) FROM admissions WHERE patient_id = 10018328 ORDER BY admissions.admission_date DESC LIMIT 1;,[{'admission_type': 'SURGICAL SAME DAY ADMISSION'}]
03e018e5065829295de0817f,When was patient 10022041 prescribed for the first time since 04/2100 a medication via sc route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM medication WHERE patient_id = 10022041 AND route = 'sc' AND date_prescribed >= '2000-04-2100',[]
eac7992d495c881955ae12b8,Was patient 10021666 treated with insertion of (naso-)intestinal tube in the last year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of (naso-)intestinal tube' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM treatment WHERE treatment.patient_id = 10021666 AND treatment.treatment_type = '(naso-)intestinal tube insertion' AND DATETIME(treatment.treatment_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
26b5659defc710e97b8055d7,What was the total amount of the output patient 10004733 had since 11/25/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-25'",SELECT COUNT(*) FROM output WHERE patient = 10004733 AND output_date >= '2100-11-25',[{'SUM(outputevents.value)': 17410.0}]
6084f134b156953797d6aff8,Can you tell me the name of the last output of patient 10004235?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),SELECT name FROM outputs WHERE id = (SELECT id FROM outputs WHERE patient = 10004235 ORDER BY id DESC LIMIT 1);,[{'label': 'Foley'}]
573ae8f84da94b97d13dd488,Tell me the average systolic blood pressure in patient 10021487 on 12/09/2100.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-09'","SELECT AVG(Systolic Blood Pressur) FROM patient10021487 WHERE Systolic Blood pressur = ""12/09/2100""",[{'AVG(chartevents.valuenum)': None}]
36ed6cc232d6795e6492644d,How many days has it been since the first rhabdomyolysis diagnosis of patient 10021487 on the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rhabdomyolysis' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT COUNT(*) FROM diagnoses WHERE diagnoses.patient_id = 10021487 AND diagnoses.diagnosis = 'rhabdomyolysis' AND DATETIME(diagnoses.diagnosis_date) = DATETIME(CURRENT_TIME, '-0 day')",
9bbd99cc180d65878b372ad9,Could you tell me the top three most common procedures for patients aged 30s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Name, COUNT(t1.Name) FROM (SELECT procedures.Name FROM procedures WHERE procedures.age BETWEEN 30 AND 39) AS t1 JOIN (SELECT procedures.Name FROM procedures WHERE procedures.age BETWEEN 30 AND 39 AND procedures.year = 2100) AS t2 ON t1.Name = t2.Name GROUP BY t1.Name ORDER BY COUNT(t1.Name) DESC LIMIT 3",
81ab57679b81047f17e36e2c,"What was the number of patients receiving venous catheterization, not elsewhere classified since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT patient_id) FROM procedures WHERE procedures.venueous_cath NEC = 'not elsewhere classified' AND STRFTIME('%y', procedures.date) >= '2100';",
4b2f2ac3530b71844f36b481,Show me the top four diagnoses with the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT diagnosis, MAX(six_month_mortality_rate) FROM (SELECT diagnosis, six_month_mortality_rate FROM (SELECT diagnosis, 1000000 * 12 / (SELECT SUM(1000000) FROM patients WHERE diagnosis = t.diagnosis) AS six_month_mortality_rate) AS t GROUP BY diagnosis) AS t ORDER BY six_month_mortality_rate DESC LIMIT 4;",
44e0c98b6f1723e728d1382d,Which are the top three most common lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.LabTest FROM (SELECT LabTest, COUNT(LabTest) AS cnt FROM lab GROUP BY LabTest) AS t1 ORDER BY cnt DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
99cc6b6a7018e6ce37338641,What are the top three common diagnoses since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank",
49da3f4c781d729017455057,How much am I expected to pay for central venous catheter placement with guidance?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) ),SELECT COUNT(*) FROM procedures WHERE procedures.name = 'central venous catheter placement with guidance';,
3dfb9565afee9c41fd63cc07,What is the percentile of 6.8 in the white blood cells lab test with the same age as patient 10009628 in their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 6.8","SELECT SUM(t1.c1) FROM (SELECT lab.c1, PERCENT_RANK() OVER (ORDER BY lab.c1 NULLS FIRST) AS c2 FROM lab WHERE lab.lab_name = 'white blood cells' AND lab.age = (SELECT lab.age FROM lab WHERE lab.lab_name = 'white blood cells' AND lab.patient_id = 10009628 AND NOT lab.age IS NULL ORDER BY lab.age DESC LIMIT 1)) AS t1 WHERE t1.c2 <= 6.8",
23016e3fbba29157468b85f0,What is the type of blood patient 10431 has.,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 10431;",
88eb5064597a8bdbd091db48,Does patient 7241 have a genetic test that they got?,,SELECT COUNT(*) FROM gamma WHERE patient = 7241,
4fb913f81273537cc819bba4,"Which were the five most commonly ordered procedures for patients previously diagnosed with other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle during the same hospital encounter, since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.Name FROM (SELECT t2.Name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.ID, diagnosis.diagnosis_time FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.ID WHERE diagnosis.diagnosis = 'Other motor vehicle traffic accident involving collision with motor vehicle' AND DATETIME(diagnosis.diagnosis_time) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.ID, treatment.treatment_time FROM treatment JOIN patient ON treatment.patient_id = patient.ID WHERE treatment.treatment_type = 'Other motor vehicle traffic accident involving collision with motor vehicle' AND DATETIME(treatment.treatment_time) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.ID = t2.ID WHERE t1.diagnosis_time < t2.treatment_time AND DATETIME(t1.diagnosis_time) BETWEEN DATETIME(t2.treatment_",
65de4c7841bdbd16627b5d55,What are the top five most frequently taken specimens for patients within the same hospital visit after receiving thoracentesis?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t5.specimen, COUNT(t5.specimen) FROM (SELECT t4.specimen, t4.hospital_visit_id FROM (SELECT t3.specimen, t3.hospital_visit_id FROM (SELECT 'patient1' AS specimen, 1 AS hospital_visit_id FROM t1 UNION ALL SELECT 'patient2' AS specimen, 2 AS hospital_visit_id FROM t1) AS t3) AS t4 WHERE t4.hospital_visit_id IN (SELECT t2.hospital_visit_id FROM (SELECT 'patient1' AS specimen, 1 AS hospital_visit_id FROM t1 UNION ALL SELECT 'patient2' AS specimen, 2 AS hospital_visit_id FROM t1) AS t2 WHERE t2.hospital_visit_id IN (SELECT t1.hospital_visit_id FROM t1 WHERE t1.treatment = 'thoracentesis')) GROUP BY t5.specimen ORDER BY COUNT(t5.specimen) DESC LIMIT 5",
9c85a8ada2ee0422d27bcb39,What were the top five most common diagnoses that followed within 2 months for those who received insertion of endotracheal tube in this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, procedures.date FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE procedures.procedure = 'Insertion of endotracheal tube' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, diagnoses.diagnosis, diagnoses.date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE DATETIME(diagnoses.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATET",
475d57ff575806d5690ed031,"During their first hospital encounter, what was the last time patient 10001217 had a medication via the iv route prescribed?",SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime DESC LIMIT 1,"SELECT MAX(t1.c1) FROM (SELECT patient.age, patient.weight, patient.height, patient.weight, patient.height, current_time FROM patient WHERE patient.patient_id = 10001217 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1) AS t1 JOIN (SELECT patient.patient_id, medication.d1 FROM medication JOIN patient ON medication.patient_id = patient.patient_id WHERE patient.patient_id = 10001217 AND medication.route = 'iv') AS t2 ON t1.patient_id = t2.patient_id",[]
20de623f537039c51aaf5c1a,Give me the top three most commonly prescribed medications.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",SELECT t1.name FROM (SELECT medication AS name FROM medication ORDER BY COUNT(*) DESC LIMIT 3) AS t1 JOIN (SELECT medication FROM medication ORDER BY COUNT(*) DESC LIMIT 3) AS t2 ON t1.name = t2.name;,"[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]"
5cf893b312b240832f404b18,What is the void output for patient 10018845 since 103 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-103 day')",SELECT void FROM output WHERE patient = 10018845 AND date = CURRENT_DATE - INTERVAL '103 days',[{'SUM(outputevents.value)': None}]
6c72b9c6d194e26c1ee7f466,Does patient 21134 have any history of depressive disorder nec in his / her family?,,SELECT COUNT(*) > 0 FROM diagnosis WHERE diagnosis.patient_id = 21134 AND diagnosis.diagnosis = 'DEPRESSIVE DISORDER NEC',
8dbbbd8602f5f3527cad26cd,"What is the average total cost of a hospital, which includes a drug called lactulose since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lactulose' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE year >= 2100 AND drug = 'lactulose' GROUP BY year) AS t1,
935b75442d1b950e70d20b8f,What was the name of the organism at the first sputum test of patient 10019777 since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM sputum_tests WHERE patient_id = 10019777 AND sample_date >= '2002-02-2100' ORDER BY sample_date NULLS FIRST LIMIT 1,[]
bf8b0be840875d402d706d58,Can you show me the top five most frequent lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT lab_test, COUNT(lab_test) FROM lab_results GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
c4d75676ab4ff43eaf58b28b,When did patient 10021938 receive mrsa screen microbiology test the last time in 11/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '11' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(date) FROM lab WHERE lab.patient = 10021938 AND lab.test = 'mrsa screen microbiology' AND DATETIME(lab.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', lab.date) = '11'",[]
1ab67d97d6f153a086427f61,What was the name of the specimen given to patient 10002495 for the first time since 04/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_name FROM specimens WHERE patient_id = 10002495 AND date_since = '04/2100' ORDER BY date_since NULLS FIRST LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}]
11a6356dddd6cc1e2a155810,Find out the number of hospital visits patient 10038933 had since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10038933 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT visit_date) FROM visit_table WHERE patient_id = 10038933 AND visit_date >= DATEADD(year, -1, CURRENT_DATE)",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
08ae61222ba27e2b2592fc0d,"During the last year, was patient 10001217 at the emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(*) FROM checkin_log WHERE patient_id = 10001217 AND location = 'emergency room admit' AND checkin_date >= (SELECT checkin_date FROM checkin_log WHERE patient_id = 10001217 ORDER BY checkin_date DESC LIMIT 1) - INTERVAL '1 year',[{'COUNT(*)>0': 0}]
bd0c2e34f79eadadf992f4e2,How was patient 10005348 admitted in terms of admission type for the last time at the hospital?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005348 ORDER BY admissions.admittime DESC LIMIT 1,"SELECT T1.AdmissionType FROM (SELECT * FROM admissions WHERE admissions.subjectId = 10005348 ORDER BY admissions.admittime DESC LIMIT 1) AS T1 JOIN admissions ON T1.admissionId = admissions.admissionId WHERE T1.AdmissionType = ""TERMS""",[{'admission_type': 'EW EMER.'}]
767f78eb035eac463d6a7505,Get me the top five most common diagnoses during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses WHERE date_part('year', CURRENT_DATE) = date_part('year', CURRENT_DATE) GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 5;",
71e9ec4174f7ac09f0636302,What are patient 10019385's changes in respiratory rate second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT respiratory_rate FROM icu_visits WHERE icu_visits.patient_id = 10019385 AND NOT icu_visits.first_visit = 0 AND icu_visits.measurement_number = 2) - (SELECT respiratory_rate FROM icu_visits WHERE icu_visits.patient_id = 10019385 AND NOT icu_visits.first_visit = 0 AND icu_visits.measurement_number = 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
e7e44b96a9f8a6f93d886bbd,What is the pricing for topiramate (topamax)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'topiramate (topamax)' ),"SELECT ""pricing"" FROM ""products"" WHERE ""product"" = 'Topiramate (Topamax)'",
55180086d87ad6ccdaca22f5,"For the last time since 03/2100, when was patient 10007818 prescribed vitamin d and aspirin at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10007818 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10007818 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT t1.date FROM (SELECT patient_id, prescription_date FROM prescriptions WHERE patient_id = 10007818 AND prescription_name = 'vitamin d') AS t1 JOIN (SELECT patient_id, prescription_date FROM prescriptions WHERE patient_id = 10007818 AND prescription_name = 'aspirin') AS t2 ON t1.patient_id = t2.patient_id WHERE DATETIME(t1.prescription_date) = DATETIME(t2.prescription_date) AND DATETIME(t1.prescription_date) >= '2003-03-2100' ORDER BY t1.prescription_date DESC LIMIT 1",[]
ad935ae937227d5927667234,What was the count of patients who were prescribed dexamethasone since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dexamethasone' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.had_dexamethasone = 'true' AND STRFTIME('%y', patient.dexamethasone_date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 7}]
181fd571160a6bf269e75dda,Could you tell me the first arterial blood pressure diastolic value that patient 10005817 had?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT 1 AS st_arterial_blood_pressure_diastolic FROM patients WHERE patient_id = 10005817,[]
6208d84a6a16f8ac2b720298,How many days have elapsed since patient 10004733 stayed in the careunit medical/surgical intensive care unit (micu/sicu) for the last time on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.staydate)) FROM patient WHERE patient.subjectid = 10004733 AND patient.dischdate IS NULL",[]
9935a33215fc04cc9ed9c438,How many cases involved the prescription of sulfameth/trimethoprim ss this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sulfameth/trimethoprim ss' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM sulfameth_trimethoprim_ss WHERE DATETIME(start_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT(*)': 0}]
228014642a9c756b378d10cc,What drug was prescribed to patient 10010471 for the last time in the first hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriber.drug FROM (SELECT patient.prescriber FROM patient WHERE patient.patient_id = 10010471 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay_start LIMIT 1) AS prescriber ORDER BY prescriber.start_date DESC LIMIT 1;,[{'drug': 'Levofloxacin'}]
7eb920ea8c935405a34f2187,What was the last time on their first ICU stay patient 10014078 had a minimum respiratory rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MIN(RespiratoryRate) FROM (SELECT RespiratoryRate FROM ICU WHERE PatientID = 10014078 WHERE NOT ICU.TransferTime IS NULL ORDER BY ICU.TransferTime NULLS FIRST LIMIT 1),[]
64d22396919485e14c973f06,What specimen test has patient 10038992 received for the last time since 10/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(specimen_date) FROM specimen_table WHERE patient_id = 10038992 AND date_since = '10/2100',[{'spec_type_desc': 'BLOOD CULTURE'}]
17a79ba0e1aeb153b34e461a,Tell me the dose of an opioid prescribed to patient 1258?,,SELECT SUM(dose) FROM prescriptions WHERE prescriptions.patient_id = 1258 AND prescriptions.drug_category = 'opioid',
4ce7bb3fe008b6d40897f421,When was patient 10020740 prescribed the drugs syringe (0.9% sodium chloride) and alteplase (catheter clearance) at the same time for the last time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'syringe (0.9% sodium chloride)' AND admissions.subject_id = 10020740 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase (catheter clearance)' AND admissions.subject_id = 10020740 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(prescription_date) FROM prescriptions WHERE prescriptions.patient_id = 10020740 AND prescriptions.drug_name = IN ('syringe (0.9% sodium chloride)', 'alteplase (catheter clearance)')",[]
2a09cc17e6b8947dbc425e98,How do i take precaution after the rt/left heart card cath procedure?,,SELECT * FROM brackets WHERE question = 'How do i take precaution after the rt/left heart card cath procedure?',
96e382017b141bc1518941f3,"Throughout this year, what are the three common diagnoses of patients of age 40s?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",SELECT 3 AS _common_diagnoses FROM patients WHERE age BETWEEN 40 AND 49,
9ff096e6083c879d4a6bfeb9,What is the name of the procedures that were given to patient 10015860 two or more times since 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t1.name FROM (SELECT name, COUNT(date) AS c1 FROM procedures WHERE patient = 10015860 AND date >= '05/2100' GROUP BY name) AS t1 WHERE t1.c1 >= 2",
f946291e703d6e542a4a7d37,Could you list the three most frequently prescribed medicines within the same hospital visit after a diagnosis of family history of ischemic heart disease was made during this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of ischemic heart disease' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_date, patient.patient_id FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis_date BETWEEN '2022-01-01' AND '2022-12-31' AND diagnosis.name = 'Family history of ischemic heart disease') AS t1 JOIN (SELECT patient.name, medication.name, medication.medication_date, patient.patient_id FROM medication JOIN patient ON medication.patient_id = patient.patient_id WHERE medication.medication_date BETWEEN '2022-01-01' AND '2022-12-31') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.medication_date AND t1.patient_id",
c98219f7cb3992603434bc25,Count the number of patients in neurology in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' AND strftime('%Y',transfers.intime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM procedures WHERE procedures.year = 2100 AND procedures.type = 'neurology';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
001613e40181055fecd8dc18,Tell me the prescriptions patient 88180 has received from the other department.,,"SELECT prescriptions FROM RIGHT JOIN (SELECT patient_id, prescriptions FROM prescriptions WHERE other_department = '88180') AS subquery ON subquery.patient_id = RIGHT.patient_id;",
4613327670f705e8aa839350,Tell me the top five most frequently tested specimens since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM brackets WHERE date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
83fcd6e49ddcd0e710cd01fb,Could you retrieve the top five most conducted lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT lab_test, COUNT(*) FROM lab_tests WHERE date >= (SELECT MAX(date) FROM lab_tests WHERE date < CURRENT_DATE - INTERVAL '1 year') GROUP BY lab_test ORDER BY COUNT(*) DESC LIMIT 5;","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
45147c4f6c84a8b896ec69ef,When since 07/2100 did patient 10007795 get the first microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM microbiology WHERE patient_id = 10007795 AND date >= '2007-01-01',[{'charttime': '2136-04-14 14:31:00'}]
3a5ab4d7328a4d17c25ac1f9,When was patient 10020740 last prescribed the medication via the td route in 05/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM medication WHERE patient_id = 10020740 AND route = 'td' AND date_prescribed BETWEEN '2000-05-01' AND '2000-05-21',[]
86c276704c3a408a1f31e367,"What is the total number of patients who underwent measurement of cardiac sampling and pressure, right heart, percutaneous approach?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, right heart, percutaneous approach' ) )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.cardiac_measuring_device FROM t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t2.cardiac_measuring_device = ""Cardiac Measuring Device"") AS t1 JOIN (SELECT t1.subject_id, t2.pressure_right_heart FROM t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t2.pressure_right_heart = ""Pressure Right Heart"") AS t2 ON t1.subject_id = t2.subject_id;",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
91985b654c4167748be8c66b,"During the first hospital encounter, was patient 10008454 admitted to an emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM encounters WHERE encounters.patient_id = 10008454 AND encounters.admission_location = 'emergency room admit' AND NOT encounters.dischtime IS NULL ORDER BY encounters.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
314918b25acf3b59dd2f8ad6,Can you tell me the top five most common treatments for patients in their 50s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT UNNEST(patients.treatments) AS treatment FROM patients WHERE patients.age BETWEEN 50 AND 59) AS t1 GROUP BY t1.treatment) AS t2 GROUP BY t2.treatment ORDER BY COUNT(t2.treatment) DESC LIMIT 5",
892b40885727ac07a5ca1a88,Has patient 10018081 had a lab test done during this hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ),"SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10018081 AND lab_tests.date_done = (SELECT date_trunc('day', current_localtimestamp()) FROM lab_tests WHERE lab_tests.patient_id = 10018081 AND lab_tests.date_done IS NOT NULL)",[{'COUNT(*)>0': 0}]
e595c43f7a0338c543bd80cb,Can you tell me when the last microbiology test for patient 10037975 was held since 29 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-29 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(microbiology_last_test_date) FROM microbiology WHERE microbiology_patient_id = 10037975 AND DATETIME(microbiology_last_test_date) >= DATETIME(CURRENT_TIME, '-29 month')",[{'charttime': '2185-01-22 02:55:00'}]
fbd014c02af79a2d9c53a9d0,When was the first time patient 10038999 was prescribed a medication in 05/this year via the iv route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(pharmacy_date) FROM iv_route WHERE patient_id = 10038999 AND pharmacy_date >= '2005-01-01' AND pharmacy_date < '2005-01-01' + INTERVAL '1 year',[]
9b0199c77936ada6960d0213,What was the last specimen test that was given to patient 10018328 since 17 months ago?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-17 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT specimen_type FROM specimen_table WHERE patient_id = 10018328 AND date_since = DATEADD(month, -17, CURRENT_DATE) ORDER BY date_since DESC LIMIT 1",[{'spec_type_desc': 'URINE'}]
bf638c88c79e23f84c8e2529,Tell me the number of patients who were prescribed methylnaltrexone since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.prescriptions >= '2100' AND patient.prescriptions LIKE '%methylnaltrexone%',[{'COUNT( DISTINCT admissions.subject_id )': 3}]
7a904ffff26972cedcca0166,What was the total amount of the output patient 10014078 had on 09/08/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-08'",SELECT SUM(output) FROM output WHERE patient = 10014078 AND date = '09/08/this year',[{'SUM(outputevents.value)': None}]
95f50999819423b14b82ff47,Calculate the number of patients who were in the vascular careunit in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT admissions.subject, vascular_careunit.year FROM admissions JOIN vascular_careunit ON admissions.admission_id = vascular_careunit.admission_id WHERE vascular_careunit.year = EXTRACT(YEAR FROM CURRENT_DATE) - 1) AS t1 JOIN (SELECT admissions.subject, vascular_careunit.year FROM admissions JOIN vascular_careunit ON admissions.admission_id = vascular_careunit.admission_id WHERE vascular_careunit.year = EXTRACT(YEAR FROM CURRENT_DATE)) AS t2 ON t1.subject = t2.subject WHERE t1.year = t2.year",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f308aa77cb5c6fd783755cf4,And what was the last time patient 10022017 was prescribed medication using the oral route on their last hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,"SELECT MAX(t1.date_prescribed) FROM (SELECT date_prescribed FROM patient WHERE patient.patient_id = 10022017 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay DESC LIMIT 1) AS t1 JOIN (SELECT patient_id, medication_id FROM patient WHERE patient.patient_id = 10022017 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay DESC LIMIT 1) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.route = 'ORAL'",[]
c871c7a5d78c361289609381,What was the name of the medicine prescribed to patient 10037861 for the last time since 8 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month') ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug_name FROM prescriptions WHERE prescriptions.patient_id = (SELECT patients.patient_id FROM patients WHERE patients.patient_name = '10037861') AND DATETIME(prescriptions.start_date) >= DATETIME(CURRENT_TIME, '-8 month') ORDER BY prescriptions.start_date DESC LIMIT 1",[{'drug': 'Influenza Vaccine Quadrivalent'}]
00fbe516569113decea8de73,When was patient 10013049's last microbiological examination on their first hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(microbiology_date) FROM microbiology WHERE microbiology.patient_id = 10013049 AND NOT microbiology.date_deleted IS NULL,[{'charttime': '2114-06-20 11:09:00'}]
fe5c43f286b65fdccd87ecbd,Calculate the number of cardiac mapping procedures performed in the last year.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'Cardiac Mapping' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year');",
2985f06b4e11ccad87836564,What percentile is chloride 104.0 among patients of the same age as patient 10002930 in their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 104.0","SELECT DISTINCT t1.c1 FROM (SELECT lab.c1, PERCENT_RANK() OVER (ORDER BY lab.c1 NULLS FIRST) AS c2 FROM lab WHERE lab.labname = 'chloride' AND lab.patientid IN (SELECT patient.patientid FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.patientid = 10002930 AND NOT patient.dischtime IS NULL ORDER BY patient.hospitaladmittime NULLS FIRST LIMIT 1))) AS t1 WHERE t1.c2 = 104.0",
5c2aa0525c14c528390437bc,When was the last time since 04/2100 that patient 10020740 was prescribed with vancomycin and 5% dextrose at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10020740 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10020740 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",,[]
3f3da5d3397a4a8fe3d6fa12,Could you provide the total volume of output for patient 10015931 since 10/05/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-05'",SELECT SUM(output_volume) FROM output WHERE patient_id = 10015931 AND output_date >= '2100-10-05',[{'SUM(outputevents.value)': 10179.0}]
bbb5e4ef8fa79866856181d3,Patient 99747 is subject to covid-19 testing,,SELECT COUNT(DISTINCT patient_99747) FROM patients WHERE patients.covid_19_testing = 'true',
3e18d6bc76b77c4f191e1259,"What is the price of a procedure named dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) )","SELECT price FROM procedures WHERE procedure_name = ""Dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic""",
c562491538e06939d07d281f,How much am I expected to pay for total esophagectomy?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) ),SELECT SUM(cost) FROM total_esophagectomy;,
202d3ee5d7d3e606014abe18,How much does it cost to get diagnostic of mechanical complication of automatic implantable cardiac defibrillator?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mechanical complication of automatic implantable cardiac defibrillator' ) ),SELECT DISTINCT cost FROM questions WHERE question = 'mechanical complication of automatic implantable cardiac defibrillator',
4d49aa5a44c5a8b00e811bf8,"On their last hospital encounter, what was patient 10006053's age?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patient WHERE patient.ssn = 10006053 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1,
2384e194896033ece54e7e01,How many levetiracetam prescriptions occurred?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'levetiracetam',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Levetiracetam',[{'COUNT(*)': 14}]
92360fdf128eef86912196c6,What is patient 10004235's minimum value of atypical lymphocytes in 03/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'atypical lymphocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",SELECT MIN(atypical_limphocytes) FROM patient_10004235 WHERE date = '03/2100',[{'MIN(labevents.valuenum)': None}]
7c2d471282f8777074560c57,What was the name of the output the first time patient 10007928 had on their first ICU stay?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),"SELECT ""Output"" FROM ""ICU Stays"" WHERE ""Patient"" = '10007928' AND NOT ""ICU Stays"".""end_time"" IS NULL ORDER BY ""ICU Stays"".""start_time"" NULLS FIRST LIMIT 1",[{'label': 'Foley'}]
91afc137c556b8c813b79b2a,"Since 03/2100, when did patient 10004235 receive the first sputum microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT date FROM sputum_microbiology WHERE patient_id = 10004235 AND date >= '2003-03-2100' ORDER BY date NULLS FIRST LIMIT 1,[]
ec318c164a262760140ba3ff,What is the number of drugs patient 10019172 was prescribed in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM drugs WHERE drugs.patient_id = 10019172 AND STRFTIME('%y', drugs.date) = '2100'",[{'COUNT(*)': 0}]
b1838eeaf67182e2d4080d5d,What were the top four most common specimens tested on patients in the same hospital encounter after the diagnosis of suicidal ideation?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT specimen FROM (SELECT t1.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_time, patient.patient_location FROM diagnosis JOIN patient ON diagnosis.patient_uniquepid = patient.uniquepid WHERE diagnosis.diagnosis = 'Suicidal ideation') AS t1 JOIN (SELECT patient.uniquepid, specimen FROM patient JOIN sample ON patient.patient_uniquepid = sample.patient_uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_time < t2.specimen_time AND DATETIME(t1.diagnosis_time, 'start of hospital') = DATETIME(t2.specimen_time, 'start of hospital') GROUP BY t1.specimen) AS t WHERE c1 <= 4",
3c0ac8693894186ae1e49461,Can you tell me the five most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT microbiology_test, COUNT(microbiology_test) FROM five_most_frequent_microbiology_tests GROUP BY microbiology_test ORDER BY COUNT(microbiology_test) DESC LIMIT 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
41a9d1565306cee37678be20,Can you tell me the name of the last output of patient 10009035 since 03/02/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-02' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT name FROM outputs WHERE patient = 10009035 AND output_date >= '2100-03-02' ORDER BY output_date DESC LIMIT 1,[{'label': 'Foley'}]
5cccb67414afa9206d2624db,What was the total or ebl output in patient 10027602 since 11/10/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10'","SELECT SUM(Total) FROM ""brackets"" WHERE ""Patient"" = '10027602' AND ""Date"" >= '2100-11-10'",[{'SUM(outputevents.value)': None}]
2a54dcb2e9a6ae1637d88ef8,When was the last time patient 10004422's SaO2 was less than 96.0 on 01/20/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 96.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-01-20' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT strftime(SaO2, '%y-%m-%d') FROM patients WHERE patient_id = 10004422 AND SaO2 < 96.0",[]
a0c6ba5a4eba9f8602ca88de,"In the last hospital encounter, was patient 10035185 diagnosed with any disease?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10035185 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.admittime DESC LIMIT 1,[{'COUNT(*)>0': 1}]
5c5679626e1a978f60f24793,What is the difference between weights last measured on the first hospital visit compared to the second to last value measured on the first hospital visit for patient 10004720?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT weights_last_measured FROM patient_weight_summary WHERE patient_id = 10004720 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1) - (SELECT weights_last_measured FROM patient_weight_summary WHERE patient_id = 10004720 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
6fede59c21de596953ecde6a,What was patient 10026354's total input amount of nacl 0.9% since 04/05/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-05'",SELECT SUM(input_amount) FROM input_table WHERE patient_id = 10026354 AND input_date >= '2100-04-05' AND input_nuclide = 'nacl 0.9%',[{'SUM(inputevents.totalamount)': None}]
f9e2b0a131460704a8a57a4f,What are the top three most frequently performed procedures for patients who are 60 or above?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, COUNT(t2.procedure) FROM (SELECT patient.age, treatment.procedure FROM treatment JOIN patient ON treatment.patient = patient.patient) AS t1 JOIN (SELECT patient.age, treatment.procedure FROM treatment JOIN patient ON treatment.patient = patient.patient WHERE patient.age >= 60) AS t2 ON t1.age = t2.age GROUP BY t2.procedure) AS t3 GROUP BY t3.procedure ORDER BY COUNT(t3.procedure) DESC LIMIT 3;",
ced75cfc467f5facf66e9200,"Was in their first hospital encounter acetaminophen, aspirin, or furosemide prescribed to patient 10012853?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'acetaminophen', 'aspirin', 'furosemide' )","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10012853 AND prescriptions.drug IN ('Acetaminophen', 'Aspirin', 'Furosemide') AND STRFTIME('%y-%m-%d', prescriptions.date) = (SELECT STRFTIME('%y-%m-%d', patient.date) FROM patient WHERE patient.patient_id = 10012853 AND NOT patient.dischtime IS NULL ORDER BY patient.date NULLS FIRST LIMIT 1)",[{'COUNT(*)>0': 0}]
bf54c19771c5bb94ae4d9258,How many iso-osmotic dextrose prescription instances took place this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic dextrose' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Iso-Osmotic Dextrose' AND DATETIME(prescriptions.start_time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)': 0}]
65c849c2aad2c56207e5cd6e,What's the minimum total cost of the hospital encounters that involved a procedure called endoscopic insertion of stent (tube) into bile duct since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic insertion of stent (tube) into bile duct' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure_name = 'endoscopic insertion of stent (tube) into bile duct' AND STRFTIME('%y', date) >= '2100' GROUP BY encounter_id) AS t1",
62161016f653e9cf862c97dd,"When did patient 10038999 last receive the total protein, pleural test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(datetime) FROM lab_data WHERE lab_data.patient_id = 10038999 AND lab_data.test_name = ""Total Protein, Pleural""",[]
07032b1d51ef6d34a32ed424,Give me the top three most commonly prescribed medications since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",SELECT t1.name FROM (SELECT medication AS name FROM procedures WHERE year >= 2100 GROUP BY medication ORDER BY COUNT(*) DESC LIMIT 3) AS t1 JOIN (SELECT medication AS name FROM prescriptions WHERE year >= 2100 GROUP BY medication ORDER BY COUNT(*) DESC LIMIT 3) AS t2 ON t1.name = t2.name,"[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]"
65026ec4c48a494f09194273,Retrieve the top three most frequent lab tests in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.LabTest FROM (SELECT LabTest, COUNT(LabTest) AS freq FROM (SELECT LabTest FROM (SELECT DISTINCT LabTest FROM lab WHERE YEAR(LabTest) = 2000) AS t1 JOIN lab ON t1.LabTest = lab.LabTest) GROUP BY LabTest) AS t2 JOIN (SELECT LabTest, COUNT(LabTest) AS freq FROM (SELECT LabTest FROM (SELECT DISTINCT LabTest FROM lab WHERE YEAR(LabTest) = 2000) AS t1 JOIN lab ON t1.LabTest = lab.LabTest) GROUP BY LabTest) AS t3 ON t2.LabTest = t3.LabTest WHERE t2.freq <= t3.freq ORDER BY freq DESC LIMIT 3;",[]
4a8d139fbdf3433a295f03d3,Can you get me the top four most conducted lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT lab_test, COUNT(*) FROM lab_test GROUP BY lab_test ORDER BY COUNT(*) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
2e7f18557b9d9530eddacca0,How many hours has it been since the first time patient 10004733 visited careunit neurology during their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', visit_time)) FROM visit_history WHERE patient_id = 10004733 AND visit_type = 'careunit neurology' AND database_name = 'main'",[]
a311fd7b15cb7682fb46dbca,Has patient 10019917 visited the hospital since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(*) > 0 FROM hospital_visits WHERE patient_id = 10019917 AND year >= 2100,[{'COUNT(*)>0': 1}]
476e4488035d145ab89ef7ae,How many patients stayed in careunit discharge lounge?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' ),"SELECT COUNT(DISTINCT patient) FROM patients WHERE careunit_discharge_lounge = ""1""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
42caec4ca4a8bdfb2bf0e159,How many patients were given a creatinine lab test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND strftime('%Y',labevents.charttime) = '2100' )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.lab_creatinine = 1 AND STRFTIME('%y', patient.lab_creatinine_date) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e14e80dd4ca4e48a6ecac19b,Can you tell me the average total hospital cost that involves lactated ringers this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.c1) FROM (SELECT SUM(T1.c1) AS c1 FROM (SELECT T2.c1 FROM (SELECT T1.c1 FROM (SELECT 1 AS c1) AS T1 JOIN (SELECT 1 AS c2) AS T2 ON T1.c2 = T2.c2) AS T1 JOIN (SELECT 1 AS c3) AS T2 ON T1.c3 = T2.c3) AS T1 JOIN (SELECT 1 AS c4) AS T2 ON T1.c4 = T2.c4 WHERE T1.c5 = 'lactated ringers' AND DATETIME(T1.c6, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY T1.c1) AS T1 JOIN (SELECT 1 AS c2) AS T2 ON T1.c2 = T2.c2) AS T1 JOIN (SELECT 1 AS c3) AS T2 ON T1.c3 = T2.c3) AS T1 JOIN (SELECT 1 AS c4",
8060993fd02e3caa91347361,"Provide the top four most frequent diagnoses that patients were assigned within 2 months after receiving respiratory ventilation, greater than 96 consecutive hours.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.name WHERE treatment.treatment = 'Respiratory ventilation, greater than 96 consecutive hours') AS t1 JOIN (SELECT patient.name, diagnosis.diagnosis, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.name) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 4",
7c84a7a9dd72cfd25b8b859c,"Count the number of patients who received a procedure since 2100 for extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date FROM t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t2.procedure = 'EXTIRPATION OF MATTER FROM RIGHT LOWER LUNG LOBE, VIA NATURAL OR ARTIFICIAL OPENING ENDOSCOPIC' AND STRFTIME('%y', t2.date) >= '2100') AS t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t2.date = t1.date",
40ce8982a0a966c5bbb74462,How much does the drug alprazolam cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'alprazolam' ),SELECT COST(drug) FROM drugs WHERE drug = 'alprazolam';,
e720394bdbfa2cd55a520dc3,"After getting diagnosed with depressive disorder, not elsewhere classified, how many patients were found to have asymptomatic human immunodeficiency virus [hiv] infection status within 2 months since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'depressive disorder, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM (SELECT subject_id, DATE '2021-01-01' AS diagnosed_date FROM patients WHERE diagnosed_date = DATE '2021-01-01' UNION ALL SELECT subject_id, DATE '2021-02-15' AS diagnosed_date FROM patients WHERE diagnosed_date = DATE '2021-02-15') AS t1 JOIN (SELECT subject_id, DATE '2021-01-01' AS diagnosed_date FROM patients WHERE diagnosed_date = DATE '2021-01-01' UNION ALL SELECT subject_id, DATE '2021-02-15' AS diagnosed_date FROM patients WHERE diagnosed_date = DATE '2021-02-15') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date < t2.diagnosed_date AND DATETIME(t2.diagn",
0f47e5f69b9a81be1ceeb52c,Can you tell me the last arterial blood pressure systolic of patient 10003046?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT systolic(arterial_blood_pressure) FROM patient WHERE patient.id = 10003046;,[]
e7d4c4eea0ceb55fc4a7b51f,"During this hospital visit has iso-osmotic sodium chloride, lactated ringers, or metronidazole (flagyl) been prescribed for patient 10018081?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'iso-osmotic sodium chloride', 'lactated ringers', 'metronidazole (flagyl)' )","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10018081 AND medication.prescription_date IS NOT NULL AND medication.drug IN ('iso-osmotic sodium chloride', 'lactated ringers', 'metronidazole (flagyl)')",[{'COUNT(*)>0': 0}]
2a3d19cceb7e76962f6d84e6,Tell me all the prescriptions that patient 13054 received at the other department.,,SELECT prescriptions FROM RX_DEPARTMENT_B WHERE patient_id = 13054,
3ac674efda7af01b7217b1a5,Tell me what the total foley output of patient 10006580 is since 03/10/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-10'",SELECT SUM(foley) FROM output WHERE patient = 10006580 AND date >= '2100-03-10',[{'SUM(outputevents.value)': None}]
3d1061a32eb79f759245bffb,What was the count of patients who were prescribed glucagon during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.had_prescription_this_year('glucagon'),[{'COUNT( DISTINCT admissions.subject_id )': 0}]
742e8151840906cdb2000fee,"Tell me the number of cases of extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic that occurred during this year.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(*) FROM procedures WHERE procedures.lobe = 'left lower lung lobe' AND procedures.natural OR procedures.artificial = 'endoscopic' AND procedures.year = 2016,
e5dcbea951b8bc21c9c8bccf,What is the minimum total cost of the hospital visits which include medicines called ampicillin sodium since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM medicines AS t1 JOIN patient_visits AS t2 ON t1.patient_id = t2.patient_id WHERE t1.medicine_name = 'ampicillin sodium' AND STRFTIME('%y', t2.visit_date) >= '2100' GROUP BY t1.patient_id) AS t3",
fb466f1f12c24c1faea2fb13,"For the first time , how much lorazepam was prescribed to patient 10021487?",SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'lorazepam' ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT SUM(pharmacy.lorazepam) FROM pharmacy WHERE pharmacy.patient_id = 10021487 AND DATETIME(pharmacy.date) = DATETIME(CURRENT_TIME, '-1 year')",[]
99327791c62b40dd242f407a,How much does the drug phenobarbital alcohol withdrawal dose taper (days 2-7) cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' ),SELECT DISTINCT cost FROM drugs WHERE drug = 'Phenobarbital Alcohol Withdrawal Dose Taper (days 2-7)',
a77b1077b6a8778b2e1e5123,Was any free water medication given to patient 10024043 on 12/24/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'","SELECT COUNT(*) > 0 FROM inventory WHERE item = 'free water medication' AND patient_id = 10024043 AND date_administered = DATEADD(year, -1, DATEADD(month, 12, DATEADD(day, 24, NULL)))",[{'COUNT(*)>0': 0}]
0a8995a9063c29d358b7b288,Tell me the average total hospital cost that involves atenolol in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'atenolol' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(2100) FROM patients WHERE atenolol = ""true""",
fa30ead3c41cae309bafcade,"What is the maximum total hospital cost including a rbc, pleural lab test since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, pleural' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost >= 0 AND year >= 2100 AND lab = ""rbc, pleural"" GROUP BY patient.subject) AS t1",
ae715e89afd0fb60fdd2b53c,"Currently, how many patients are in the hospital?",SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE hospitalized = true;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
11e07c7cfecad5cb89401830,Give a count of the number of ICU visits of patient 10025612 in the first hospital visit.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
0f29c76985468daa67aa9e6d,What are the charges for a procedure called replacement of stent (tube) in biliary or pancreatic duct?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of stent (tube) in biliary or pancreatic duct' ) ),SELECT SUM(charges) FROM procedures WHERE procedure_name = 'replacement of stent (tube) in biliary or pancreatic duct';,
38cab6c7f7f7fe731b55ebde,What is the code that corresponds to icd-11 for ac dvt/emb distl low ext in icd-10?,,"SELECT icd_11 FROM icd_10 WHERE icd_10 = ""AC DVT/emb distl low ext""",
9d89c1083e101a847c24df5f,What is the percentile of 96.0 for a po2 test given the same age as patient 10003400 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 96.0","SELECT DISTINCT t1.c1 FROM (SELECT lab.value, PERCENT_RANK() OVER (ORDER BY lab.value NULLS FIRST) AS c1 FROM lab WHERE lab.label = 'po2' AND lab.patient = (SELECT patient.id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.id = 10003400 AND NOT patient.dischtime IS NULL ORDER BY patient.hospitaladmittime DESC LIMIT 1))) AS t1 WHERE t1.value = 96.0",
c1a661557ac7c238626ba6d2,What was the count of patients who were tested for base excess?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) ),SELECT COUNT(DISTINCT patient_id) FROM results WHERE result_type = 'base excess';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
0a7229f1e72f42ee2dc14404,When was the first time patient 10008287 had an maximum po2 in their first hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT MIN(po2) FROM vital_signs WHERE vital_signs.patient_id = 10008287 AND NOT vital_signs.hospital_dischtime IS NULL ORDER BY vital_signs.hospital_admittime NULLS FIRST LIMIT 1,[]
713395a9d49099e4643f0ba9,When did patient 10029291 last get blood culture's microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT date(blood_culture_microbiology.date) AS microbiology_date,[]
b8f95a496d90e442273b2a33,"What was the last time that patient 10022041 was prescribed acetaminophen iv and phosphorus in 06/2100, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen iv' AND admissions.subject_id = 10022041 AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phosphorus' AND admissions.subject_id = 10022041 AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(TIMESTAMP '2000-06-2100 10:30:00') FROM patients WHERE patients.id = 10022041 AND patients.prescriptions = 'Acetaminophen IV, Phosphorus'",[]
f9b43f1daa9180b4970abafe,Calculate the total volume of patient 10010471's input since 12/19/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19'",SELECT SUM(input_volume) FROM input_data WHERE patient_id = 10010471 AND input_date >= '2100-12-19';,[{'SUM(inputevents.totalamount)': 37625.0}]
3018865bd3e3ef7fcede4eb2,Could you list the five most common specimen tests carried out since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen_test, COUNT(*) FROM microbiology WHERE year >= 2100 GROUP BY specimen_test ORDER BY COUNT(*) DESC LIMIT 5;","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
7f006b94d6653a3b89d33cc2,How many patients stayed on emergency department observation since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) >= '2100' )",SELECT COUNT(DISTINCT patient_id) FROM emergency_department_observation WHERE year >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
96762825c5cbfa3426dc79a2,Is patient 10006580's hematocrit second measured on the first hospital visit less than the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT hematocrit FROM diagnoses WHERE patient_id = 10006580 AND NOT visit_number = 1) < (SELECT hematocrit FROM diagnoses WHERE patient_id = 10006580 AND NOT visit_number = 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
f2d594c951cd6c02275e0a17,Has there been any organism detected in the first microbiological examination of patient 10020944's sputum in 03/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT COUNT(*) > 0 FROM microbiology WHERE microbiology.patient_id = 10020944 AND microbiology.examination_date BETWEEN '2022-03-01' AND '2022-03-31' AND microbiology.examination_type = 'sputum',[{'COUNT(*)>0': 0}]
449a8617caa34f297b5f7f4a,When did patient 10015272 last take the microbiology test in 06/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT date FROM microbiology_test WHERE patient_id = 10015272 AND STRFTIME('%y-%m', microbiology_test.date) = '2100-06' ORDER BY microbiology_test.date DESC LIMIT 1",[]
f9d583c499e7bd1c044a24a0,What was the drug that was prescribed to patient 10018501 within the same hospital visit after the alcohol detoxification since 10 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-10 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-10 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.id, treatment.date, patient.patient_name FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10018501 AND treatment.drug = 'Alcohol Detoxification' AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-10 month')) AS t1 JOIN (SELECT patient.id, treatment.date, patient.patient_name FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10018501 AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-10 month')) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND t1.patient_name = t2.patient_name;",
9b8533703ff8eab23578f84c,Was patient 10022041 given a test on rdw in 06/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'","SELECT 06, 2100 FROM patients WHERE patients.name = '10022041' AND patients.rdw = '06/2100'",[{'COUNT(*)>0': 0}]
ae863d8431919bbfb1dca0db,What is the outpatient schedule today for dr. solis?,,SELECT * FROM appointments WHERE dr_name = 'dr. solis' AND apt_type = 'outpatient' AND apt_date = CURRENT_DATE;,
91a1b7d722fd22c60cb7f9c7,"What are patient 10027602's changes in glucose, csf second measured on the first hospital visit compared to the first value measured on the first hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 )",,"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
f41dd60cef49db205a9a109e,What was the name of the drug that was last prescribed for patient 10027445 since 06/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.drug_name FROM prescriber WHERE prescriber.patient_id = 10027445 AND STRFTIME('%y-%m', prescriber.date) >= '2100-06' ORDER BY prescriber.date DESC LIMIT 1",[{'drug': 'Potassium Chloride'}]
cd2f14c6acbcef17dcbd4989,What's the maximum yearly number of patients who had edema of male genital organs?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",SELECT MAX(YearlyNumberOfPatients) FROM patients WHERE GenitalOrganEdema = 'Male',
9d58a5b47d175751dafd7e2b,Reveal the drug name that was first prescribed to patient 10004235 via the po route in 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT drug_name FROM prescriptions WHERE patient_id = 10004235 AND prescription_date BETWEEN '2000-07-2100' AND '2000-07-2100' AND prescription_route = 'po' ORDER BY prescription_date NULLS FIRST LIMIT 1,[]
812b9c3cb24eb55cbd0989b6,What was the procedure conducted on patient 10020740 two or more times in 04/this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '04' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT date_sub('month', TIMESTAMP '2002-04-01', TIMESTAMP '2002-04-01') FROM procedures WHERE patient_id = 10020740 GROUP BY date_sub('month', TIMESTAMP '2002-04-01', TIMESTAMP '2002-04-01') HAVING COUNT(*) >= 2",
4741dccccfea59439b0c12b8,What is the maximum total hospital cost that involved a procedure called fluoroscopy of multiple coronary arteries using other contrast since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedures.name = 'fluoroscopy of multiple coronary arteries using other contrast' AND STRFTIME('%y', procedures.date) >= '2100' GROUP BY procedures.id) AS t1",
db1b480d2286ade3469fa410,What is the body weight change of patient 10038933 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT patient.weight FROM patient WHERE patient.patient_id = 10038933 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1) - (SELECT patient.weight FROM patient WHERE patient.patient_id = 10038933 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
9f7246b3b545ea28dc8ff5ad,What was the minimum value of the respiratory rate of patient 10021666?,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ),SELECT MIN(RespiratoryRate) FROM respiratory_rate WHERE PatientID = 10021666;,[{'MIN(chartevents.valuenum)': None}]
78784fbf49277b83517b9dba,Has patient 10026406 been to the er since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(*) > 0 FROM patients WHERE patients.date_of_last_contact = '2100-01-01' AND patients.unique_patient_id = 10026406 AND patients.location = 'emergency room admit',[{'COUNT(*)>0': 0}]
507c98230efbbf1d84008059,Is it patient 10003046's o2 saturation pulseoxymetry last measured on the last ICU visit greater than second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT o2_saturation_pulseoxymetry FROM (SELECT icu_data FROM icu WHERE icu_data.patient_id = 10003046) WHERE NOT icu_data.outcome IS NULL ORDER BY icu_data.admittime DESC LIMIT 1) > (SELECT o2_saturation_pulseoxymetry FROM (SELECT icu_data FROM icu WHERE icu_data.patient_id = 10003046) WHERE NOT icu_data.outcome IS NULL ORDER BY icu_data.admittime DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
5bdb71007a2f5b2c33e4bd71,What was the organism detected in patient 10016742's first swab microbiology test since 07/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'swab' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism FROM microbiology WHERE patient_id = 10016742 AND swab_microbiology_date > '2000-07-2100' ORDER BY swab_microbiology_date NULLS FIRST LIMIT 1,[]
23186572a878a351ae7acf5b,How many days have passed since patient 10018081's first hematocrit laboratory test on this hospital stay?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', hematocrit_data.timestamp)) FROM hematocrit_data WHERE hematocrit_data.patient_id = 10018081 AND hematocrit_data.timestamp = (SELECT MIN(timestamp) FROM hematocrit_data WHERE hematocrit_data.patient_id = 10018081)",[]
8652b04e3fb0b55bfcabf37a,What was the count of patients who were prescribed phosphorus during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.had_phosphorus = true AND DATETIME(patient.phosphorus_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c26a679f2556db96814fe4aa,What was the name of that first specimen test patient 10016742 got in 08/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT specimen_type FROM patients WHERE patient_id = 10016742 AND specimen_date = ""08/2020""",[]
c88b6042bd98d9ea98a91f19,What percentile is the value of 13.0 in anion gap among patients of the same age as patient 10024043 on the first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.0","SELECT DISTINCT t1.c1 FROM (SELECT lab.value, PERCENT_RANK() OVER (ORDER BY lab.value NULLS FIRST) AS c1 FROM lab WHERE lab.lab_name = 'anion gap' AND lab.patient_id IN (SELECT patient.id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE id = 10024043 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1))) AS t1 WHERE t1.value = 13.0",
665268e8c88a193b5ec8005f,Please retrieve the daily maximum amount of patient 10022880's po intake input.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT MAX(intake.amount) FROM intake WHERE intake.patient_id = 10022880 AND intake.type = 'po intake' GROUP BY intake.date;,[]
0e480dd5efb5afb7821bf264,What did patient 10018081 first have as output on 12/31/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-31' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT 12 AS _31_2100 FROM patients WHERE patients.output_date = '12/31/2100' AND patients.patient_id = 10018081,[]
34477f844c8389585cdcabca,Has there been any organism detected during the first mrsa screen microbiology test of patient 10021118 since 05/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT COUNT(*) > 0 FROM microbiology WHERE patient_id = 10021118 AND test_type = 'mrsa screen microbiology' AND date >= '2000-05-21',[{'COUNT(*)>0': 0}]
774301e86755e13414d55d0b,What number of patients were in the emergency department since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient_id) FROM emergency_department WHERE visit_date >= (CURRENT_DATE - INTERVAL '1 year');,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
a2e230e390689e566a02bb77,Can you show me the three most frequently taken lab test?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT lab_test, COUNT(lab_test) FROM lab_results GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
6277902bacde54e836a5d433,What are the four most commonly taken specimens for patients that received central venous catheter placement with guidance previously in the same hospital visit this year?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t3.subject, t3.specimen, t3.date, t2.date AS previous_date FROM (SELECT t1.subject, t1.specimen, t1.date FROM (SELECT SUM(CASE WHEN t1.specimen = 'blood' THEN 1 ELSE 0 END) AS specimen, t1.date FROM (SELECT patient.subject, specimen, date FROM patients JOIN specimens ON patients.specimen = specimens.specimen WHERE specimens.date BETWEEN '%2020-01-01%' AND '%2020-12-31%') AS t1 GROUP BY t1.subject, t1.specimen, t1.date) AS t2 JOIN (SELECT patient.subject, specimen, date FROM patients JOIN specimens ON patients.specimen = specimens.specimen WHERE specimens.date BETWEEN '%2020-01-01%' AND '%2020-12-3",
150dcba6b064df151fc6eaf3,How much is the difference of patient 10004235's weight last measured on the first hospital visit compared to the value first measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
e96433c5e849a24c421d221b,"What was prescribed to patient 10015931 during the same hospital visit following their replacement of aortic valve with zooplastic tissue, percutaneous approach during this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t3.prescriptions FROM (SELECT t2.prescriptions, t1.hospital_id, t1.hospital_dischtime FROM (SELECT patient_id, hospital_id, hospital_dischtime FROM (SELECT * FROM patient WHERE patient_id = 10015931) AS t1 JOIN (SELECT * FROM repair WHERE repair_type = 'replacement of aortic valve with zooplastic tissue, percutaneous approach') AS t2 ON t1.patient_id = t2.patient_id) AS t3 WHERE t3.hospital_id = t2.hospital_id AND t3.hospital_dischtime = t2.hospital_dischtime AND DATETIME(t2.hospital_dischtime, 'start of month') = DATETIME(t3.hospital_dischtime, 'start of month')",
03d2b60423371ca98d1a99bc,"On their first hospital visit, was patient 10015272 given any diagnosis?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10015272 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
877f60bb26ea0d5229a4665b,What is the minimum total cost for the hospital when a rheumatoid factor lab test is involved since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.lab_test = 'rheumatoid factor' AND DATETIME(cost_table.date) >= DATETIME(CURRENT_DATE, '-1 year') GROUP BY cost_table.patient_id) AS t1",
82b62524391ca6823ef4cd75,How much does it cost to purchase diltiazem extended-release?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'diltiazem extended-release' ),SELECT DISTINCT cost FROM products WHERE product = 'diltiazem extended-release';,
01bc93ed00df686c5593006f,"For the last time, what was the medication that patient 10016150 was prescribed in 05/2100 via the im route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT medication FROM prescriptions WHERE patient_id = 10016150 AND route = 'im' AND prescription_date = '2100-05-01',[]
b6b449e2a6346dfeed443761,What were the three most frequently given diagnoses for patients who received anastomosis of hepatic duct to gastrointestinal tract previously within 2 months in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmentdate BETWEEN '2100-01-01' AND '2100-12-31' AND treatment.procedure = 'anastomosis of hepatic duct to gastrointestinal tract') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosisdate BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosisdate) BETWEEN DATET",
51cdecbb594a8e0b5f169388,What was the last time on their current hospital visit patient 10021487 had the maximum plasma cells.,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'plasma cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(plasma_cells) FROM patient WHERE patient_id = 10021487 AND hospital_dischtime IS NULL;,[]
5e86d97c72cc49ff2ce98709,"List the top five most frequent diagnoses that patients were diagnosed with within 2 months after receiving bypass coronary artery, one artery from left internal mammary, open approach throughout this year.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatment = 'Bypass Coronary Artery, one artery from left internal mammary, open approach' AND DATETIME(treatment.treatmentdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE DATETIME(diagnosis.diagnosisdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosis",
f8a7c82b3eb920c707fa250b,"On this month/10, when was the first input time for patient 10021487?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '10' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT MIN(input_time) FROM input_table WHERE patient_id = 10021487 AND input_time >= MONTH(CURRENT_TIME, '-0 month') AND input_time < MONTH(CURRENT_TIME, '-0 month', '+10 day')",[]
7b5324a4c69137200e0d74e2,What was the total amount of output from patient 10018081 since 12/19/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-19'",SELECT SUM(output) FROM port WHERE patient = 10018081 AND date >= '12/19/2100',[{'SUM(outputevents.value)': 66945.0}]
3751ff2eb0be4c22f7a8f752,How many days has it been since patient 10021487 first received the po2 lab test during their current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 FROM lab_results WHERE lab_results.patient_id = 10021487 AND lab_results.lab_name = 'po2' AND DATETIME(lab_results.result_date) = DATETIME(CURRENT_TIME, '-0 day')",[]
21b5d63e1046e143cef88adf,When was the first time that patient 10007818 has been prescribed medication via the subcut route since 05/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'subcut' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM medication_usage WHERE patient_id = 10007818 AND route = 'subcut' AND date_prescribed >= '2000-05-2100',[]
bfda4e34737d0530a461ae0a,What was the total amount of chlorhexidine gluconate 0.12% oral rinse prescribed to patient 10011398 in the first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse',"SELECT SUM(Chlorhexidine_Gluconate_0.12%_Oral_Rinse) FROM ""prescriptions"" WHERE ""patient_id"" = 10011398 AND NOT ""hospital_dischtime"" IS NULL ORDER BY ""hospital_admittime"" NULLS FIRST LIMIT 1;",[{'SUM(prescriptions.dose_val_rx)': None}]
a7a3de424d31c00f89567ff3,What are the five most frequently tested specimens for patients that received other incision of brain previously within 2 months in 2100?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t1.specimen, COUNT(t1.id) FROM (SELECT t1.id, t2.specimen FROM (SELECT t1.id, AVG(t2.weight) AS specimen FROM (SELECT t1.id, t2.weight FROM (SELECT t1.id FROM (SELECT t2.weight FROM patients WHERE t2.weight > 0) AS t1 JOIN procedures AS t2 ON t1.id = t2.patient_id WHERE t2.procedure = 'other incision of brain') AS t1 JOIN (SELECT t3.id, t3.specimen FROM patients AS t3 JOIN procedures AS t4 ON t3.id = t4.patient_id WHERE t4.procedure = 'other incision of brain') AS t2 ON t1.id = t2.id WHERE t1.incision_date < t2.incision_date AND DATETIME(t2.incision_date) BETWEEN DATETIME(t1.incision_date) AND DATETIME(t1.incision_date, '+2 month') GROUP BY t1.specimen ORDER BY",
8acb279371aec9d2ef64ac77,What treatment were provided to patient 10007795 two or more times in 08/this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '08' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",SELECT COUNT(DISTINCT t1.date) FROM (SELECT date FROM appointments WHERE appointment_id = 10007795 AND date BETWEEN '2008-01-01' AND '2008-12-31') AS t1 JOIN (SELECT date FROM appointments WHERE appointment_id = 10007795 AND date BETWEEN '2008-01-01' AND '2008-12-31') AS t2 ON t1.date = t2.date GROUP BY t1.date HAVING COUNT(DISTINCT t2.date) >= 2,
5732b3a1da02702d943f84d4,What output did patient 10018081 have for the first time since 04/07/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT STRFTIME('%m/%d/%Y', '2000-04-07') FROM patients WHERE patient_id = 10018081",[{'label': 'OR Urine'}]
b5bfc514c70281b00a67544d,When was the last time patient 10004720 was measured respiratory rate greater than 9.0 on this month/06?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 9.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '06' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(MeasurementDate) FROM RespiratoryRate WHERE PatientId = 10004720 AND RespiratoryRate > 9.0 AND DATETIME(MeasurementDate, 'start of month') = DATETIME(CURRENT_DATE, 'start of month', '-0 month') AND STRFTIME('%d', MeasurementDate) = '06'",[]
56a8d8e09edb2cee2e4d93a3,What is the medication that patient 4469 takes after that other department gives them?,,SELECT medication FROM patients WHERE patient_id = 4469 AND date_other_department > (SELECT date_medication FROM patients WHERE patient_id = 4469 AND medication = 'other department'),
632459fd456c31f024bdf938,How many times did patient 10004720 go to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(*) FROM hospital_visits WHERE patient_id = 10004720 AND STRFTIME('%y', visit_date) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
1d1103ae4c20715e6f0ae678,Tell me the total clopidogrel dose that patient 10015931 has been prescribed since 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = 'clopidogrel' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'","SELECT SUM(CLOPIDOGREL) FROM medication WHERE medication.patient_id = 10015931 AND STRFTIME('%y-%m', medication.start_date) >= '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}]
338a9d532066c9b092d97b39,Patient 10018328's age on their first hospital encounter was what?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT demographics.age FROM demographics WHERE demographics.patient_id = 10018328 AND demographics.hospital_number = 1,
1e7f92fd5a7fad376555b6c5,When was patient 10004720 prescribed with a drug via the sc route for the first time in 12/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT strftime(brackets.prescription_date, '%Y-%m') as prescription_year_month FROM brackets WHERE brackets.patient_id = 10004720 AND strftime(brackets.prescription_date, '%m') = '12' AND strftime(brackets.prescription_date, '%Y') = strftime(CURRENT_DATE, '%Y') AND brackets.prescription_route = 'sc' ORDER BY prescription_year_month DESC LIMIT 1",[]
a431657836c3ed7ccacaf64a,What was the name of the outputs that patient 10038933 first had since 03/26/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-26' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM duckdb_outputs WHERE patient_id = 10038933 AND date_first_seen >= '2000-03-26',[{'label': 'Foley'}]
17f65319b8a03eaeeb2840a5,What is dr. koch's outpatient treatment schedule today?,,"SELECT T1.date, T1.patient, T2.doctor, T2.treatment FROM (SELECT date, patient, doctor, treatment FROM appointments WHERE date = CURRENT_DATE AND type = 'outpatient') AS T1 JOIN (SELECT employee_id, first_name, last_name FROM employees WHERE department = 'treatment') AS T2 ON T1.doctor = T2.employee_id;",
9b0dc7c21af10bc7f1f0ef8b,How many patients were let go from hospitals in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",SELECT COUNT(*) FROM patients WHERE DischargeYear = 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d7a8e332af537a76ab296df1,What was patient 10023239's total volume of output since 03/06/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06'","SELECT SUM(output) FROM ""output"" WHERE patient_id = 10023239 AND date >= '2100-03-06'",[{'SUM(outputevents.value)': 10250.0}]
f460b01f60e21810e3c0e875,What would the average yearly number of patients diagnosed with coronary atherosclerosis of autologous vein bypass graft be since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(t1.c1) FROM (SELECT COUNT(DISTINCT diagnose.patient_id) AS c1 FROM diagnose WHERE diagnose.diagnosis = 'coronary atherosclerosis of autologous vein bypass graft' AND STRFTIME('%y', diagnose.diagnosis_date) >= '2100' GROUP BY STRFTIME('%y', diagnose.diagnosis_date)) AS t1",
b4067b5953f2f9bf38f0cf12,"How many patients in 2100 were diagnosed with body mass index 35.0-35.9, adult within 2 months after the first diagnosis with anemia, unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM (SELECT subject_id, STRFTIME('%y', diagnosis_date) AS diagnosis_year FROM (SELECT subject_id, STRFTIME('%m', diagnosis_date) AS diagnosis_month FROM (SELECT subject_id, STRFTIME('%d', diagnosis_date) AS diagnosis_day FROM (SELECT subject_id, body_mass_index FROM (SELECT subject_id, NULL AS body_mass_index FROM (SELECT subject_id, 1 AS body_mass_index FROM (SELECT subject_id, 2 AS body_mass_index FROM (SELECT subject_id, 3 AS body_mass_index FROM (SELECT subject_id, 4 AS body_mass_index FROM (SELECT subject_id, 5 AS body_mass_index FROM (SELECT subject_id, 6 AS body_mass_index FROM (SELECT subject_id, 7 AS body_mass_index FROM (SELECT subject_id, 8 AS body_mass_index FROM (SELECT subject_id, 9 AS body_mass_",
59e81ba463402dfebb19a04b,What's the cost to get other endovascular procedures on other vessels?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) ),SELECT * FROM procedures WHERE procedure_type = 'other endovascular procedures on other vessels';,
cd7621aeaf5bf1a22ca8394e,Has patient 91768 ever had any additional blood culture tests done.,,SELECT COUNT(*) FROM culture_additional WHERE culture_additional.patient_id = 91768 AND culture_additional.blood_type = 'any additional blood',
da332c7d00584e07d7258bc1,How many hours have passed since patient 10018081 last received a laboratory test of calculated total co2 in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_test.test_date)) FROM lab_test WHERE lab_test.patient_id = 10018081 AND lab_test.test_name = 'calculated total co2' AND lab_test.hospital_id = (SELECT lab_test.hospital_id FROM lab_test WHERE lab_test.patient_id = 10018081 AND lab_test.test_name = 'calculated total co2' ORDER BY lab_test.test_date DESC LIMIT 1);",[]
044289b85d5894aef9a9825d,When did patient 10039831 receive a mrsa screen microbiology test for the first time since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT screen_date FROM microbiology_data WHERE patient_id = 10039831 AND microbiology_test = 'mrsa screen microbiology' AND STRFTIME('%d/%Y', screen_date) >= '03/2100' ORDER BY screen_date NULLS FIRST LIMIT 1",[]
6f8c9bec861a6567d7a9b284,When did patient 10029291's first input on 03/08/2100 occur?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-08' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT MIN(input_date) FROM input_table WHERE patient_id = 10029291 AND STRFTIME('%d/%m/%Y', input_date) = '03/08/2100'",[]
e80cfa3eba8292aa667080e9,"In 2100, what are the top four most frequent medications prescribed during the same month to the patients in their 60 or above after they were diagnosed with atrial fibrillation?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t4.medication FROM (SELECT t3.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'atrial fibrillation') AS t1 JOIN (SELECT patient.id, medication.medication, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age >= 60) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_date, 'start of month') GROUP BY t3.medication) AS t4 WHERE t4.c1 <= 4",
64cfab5e3bed0dbdd7d74834,When heparin and aspirin were prescribed to patient 10016150 for the last time in 05/this year at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT COUNT(DISTINCT t1.start_date) FROM (SELECT patient_id, prescription_start_date FROM prescriptions WHERE prescription_start_date IN (SELECT T1.prescription_start_date FROM (SELECT patient_id, prescription_start_date FROM prescriptions WHERE patient_id = 10016150 AND prescription_start_date BETWEEN DATETIME(1992, 05, 15) AND DATETIME(1992, 05, 16))) AS t1 JOIN (SELECT patient_id, prescription_start_date FROM prescriptions WHERE prescription_start_date IN (SELECT T2.prescription_start_date FROM (SELECT patient_id, prescription_start_date FROM prescriptions WHERE patient_id = 10016150 AND prescription_start_date BETWEEN DATETIME(1992, 05, 15) AND DATETIME(1992, 05, 16))) AS t2 ON t1.patient_id = t2",[]
c11781d3de0756093079a3b6,Give me the five most common microbiology tests since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t1.Microbiology, COUNT(t1.Microbiology) FROM (SELECT Microbiology, FROM t2 WHERE t2.Year >= 2100) AS t1 GROUP BY t1.Microbiology ORDER BY COUNT(t1.Microbiology) DESC LIMIT 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
3f24154f91b27bdc47594852,What are some of the immunocancerous drugs of the last 5 years,,SELECT product FROM products WHERE category = 'immunocancerous drugs' AND year >= EXTRACT(YEAR FROM CURRENT_DATE) - 5,
85c4cb07f011b2641b16c688,"What are the four most common diagnoses for patients who previously had the dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic procedure within 2 months since 1 year ago?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d.diagnosis, COUNT(d.diagnosis) FROM diagnoses d INNER JOIN procedures p ON d.diagnosis = p.diagnosis WHERE p.procedure_name = 'Dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic procedure' AND DATETIME(p.date) >= DATETIME(CURRENT_TIME, '-1 year') AND DATETIME(p.date) <= DATETIME(CURRENT_TIME, '-1 year') + INTERVAL '2 month' GROUP BY d.diagnosis ORDER BY COUNT(d.diagnosis) DESC LIMIT 4",
32041f1a421a46a1ede56482,Calculate patient 10029484's total input amount of magnesium sulfate (bolus) on last month/23.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '23'","SELECT SUM(input_amount) FROM input_table WHERE patient_id = 10029484 AND input_type = 'magnesium sulfate (bolus)' AND input_date >= (SELECT input_date FROM input_table WHERE patient_id = 10029484 AND input_type = 'magnesium sulfate (bolus)' AND patient_id = 10029484) AND DATETIME(input_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month') AND STRFTIME('%d', input_date) = '23';",[{'SUM(inputevents.totalamount)': None}]
3b483bc7971f9931801a356e,What are the top four commonly ordered treatments for patients in their 40s in this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT patient.name, treatment.treatment FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE treatment.treatment_year = 2016 AND patient.age BETWEEN 40 AND 49) AS t1 JOIN (SELECT patient.name, treatment.treatment FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE treatment.treatment_year = 2016 AND patient.age BETWEEN 40 AND 49 GROUP BY treatment.treatment ORDER BY COUNT(*) DESC LIMIT 4) AS t2 ON t1.name = t2.name GROUP BY t1.treatment",
5a251e4eca446bc174bf6ee3,Can you show me the three most frequently taken lab test since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT lab_test, COUNT(lab_test) FROM lab_table WHERE date >= (SELECT CURRENT_DATE - INTERVAL '1 year') GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
4f945a0ea52625d2facbf443,What was the minimum platelet count value for patient 10021118 on their first hospital visit?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ),"SELECT MIN(platelet_count) FROM ""brackets"" WHERE ""patient_id"" = 10021118 AND NOT ""dischtime"" IS NULL ORDER BY ""admittime"" NULLS FIRST LIMIT 1;",[{'MIN(labevents.valuenum)': None}]
8714a2c8bbdfbe82b744586d,When did patient 10008454 last have a maximum value of diastolic blood pressure on 12/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-06' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(diastolic_blood_pressure) FROM patient WHERE patient_id = 10008454 AND measurement_date = '12/06/2100',[]
13742e41da6ed8f3b472927c,"What are the five most typically ordered procedures for patients previously diagnosed with other symbolic dysfunction, which took place within 2 months in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other symbolic dysfunction' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.Name FROM (SELECT t2.Name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.Id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.Id WHERE diagnosis.diagnosis = 'Other symbolic dysfunction') AS t1 JOIN (SELECT patient.Id, procedure.Name, procedure.procedure_date FROM procedure JOIN patient ON procedure.patient_id = patient.Id WHERE STRFTIME('%y', procedure.procedure_date) = '2100') AS t2 ON t1.Id = t2.Id WHERE t1.diagnosis_date < t2.procedure_date AND DATETIME(t2.procedure_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.Name) AS t3 WHERE t3.c1 <= 5",
882e8bdaae60f6bdfa661677,"Give me the top three most frequent procedures that patients were given in the same hospital visit after receiving extirpation of matter from left common iliac vein, percutaneous approach since 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, COUNT(t2.treatment) FROM (SELECT patient.uniquepid, treatment.treatmentdate, patient.patientinfo->'name' AS name FROM treatment JOIN patient ON treatment.patientuniqueid = patient.uniquepid WHERE treatment.treatment = 'Extirpation of matter from left common iliac vein, percutaneous approach') AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment, treatment.treatmentdate, patient.patientinfo->'name' AS name FROM treatment JOIN patient ON treatment.patientuniqueid = patient.uniquepid WHERE STRFTIME('%y', treatment.treatmentdate) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.treatmentdate AND t1.patientinfo->'name' = t2.patientinfo->'name' GROUP BY t2.treatment) AS t3 GROUP BY t3.treatment ORDER BY COUNT(t",
9273f8ff183822a0ce4f95be,Ciprofloxacin iv - How much does it cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' ),SELECT DISTINCT cost FROM products WHERE name = 'Ciprofloxacin iv';,
d0821c0025ab0c979c7f89c2,"When was the last time that patient 10015860 on the last hospital encounter was given a creatine kinase, mb isoenzyme lab test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1",SELECT MAX(Creatine_Kinase__MB_Isoenzyme) FROM (SELECT Creatine_Kinase__MB_Isoenzyme FROM lab_results WHERE Patient_ID = 10015860 AND NOT Last_Hospital_Encounter IS NULL),[]
339d3163e8bea1c8f13aabf3,What was the dose of insulin human regular that patient 10035185 was last prescribed?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND prescriptions.drug = 'insulin human regular' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriptions.dose FROM prescriptions WHERE prescriptions.patient_id = 10035185 AND prescriptions.drug = 'insulin human regular' ORDER BY prescriptions.date DESC LIMIT 1,[]
84bfcde2dd95748732f9e8a4,When was patient 10019172 prescribed a medication via the po route the last time in 11/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM medication_usage WHERE patient_id = 10019172 AND route = 'po' AND date_prescribed BETWEEN '2011-11-2100' AND '2011-11-2100',[]
60d0f145200cc583dc1c9dbb,What genetic test did patient 70234 undergo?,,,
80b96b20149664dff5b51fb1,"In 2100, what are the three frequently ordered treatments for patients who were diagnosed with personal history of other venous thrombosis and embolism within the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other venous thrombosis and embolism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'personal history of other venous thrombosis') AS t1 JOIN (SELECT patient.name, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE treatment.treatment = 'embolism') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.treatment_date, 'start of month') GROUP BY t2.treatment) AS t3 WHERE t3.c1 <= 3",
0468c52ae504e3db09fd4e8d,Tell me what the top four most commonly prescribed drugs are in 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE STRFTIME('%y', prescriptions.date) = '2100' GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 4",[]
73a651d26844c7e023b2bfc1,Share the four most frequently performed procedures since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.CATEGORY, COUNT(t1.CATEGORY) FROM (SELECT t2.CATEGORY FROM (SELECT * FROM procedures WHERE DATE >= CURRENT_DATE - INTERVAL '1 year') AS t1 JOIN procedures AS t2 ON t1.ID = t2.ID GROUP BY t2.CATEGORY) AS t3 GROUP BY t3.CATEGORY ORDER BY COUNT(t3.CATEGORY) DESC LIMIT 4",
964c6e643ec90bc499a92aea,What are the three most common specimen tests that occurred in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen_test, COUNT(*) FROM crimes WHERE year = 2100 GROUP BY specimen_test ORDER BY COUNT(*) DESC LIMIT 3",[]
dc2ea06004264d56a9d2fc41,What are the five most frequently ordered laboratory tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.Test, COUNT(t1.Test) FROM (SELECT Test, COUNT(Test) FROM lab GROUP BY Test) AS t1 JOIN lab ON t1.Test = lab.Test WHERE lab.Year >= 2100 GROUP BY t1.Test ORDER BY COUNT(t1.Test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
b704681115ed8cf6b288919f,"Has patient 10016150 got a prescription for trazodone, rosuvastatin calcium, or metformin xr (glucophage xr) since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.drug IN ( 'trazodone', 'rosuvastatin calcium', 'metformin xr (glucophage xr)' ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10016150 AND prescriptions.drug IN ('trazodone', 'rosuvastatin calcium', 'metformin xr (glucophage xr)') AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)>0': 0}]
966d1ead03418408fd0eccc1,How many patients were diagnosed with paroxysmal atrial fibrillation in 2100 after previously being diagnosed with pain in left shoulder within 2 months?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in left shoulder' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paroxysmal atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed FROM (SELECT subject_id, 1 AS diagnosed FROM ""brackets"" WHERE diagnosis = 'paroxysmal atrial fibrillation') AS t1 JOIN (SELECT subject_id, 1 AS diagnosed FROM ""brackets"" WHERE diagnosis = 'pain in left shoulder') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed = 1 AND DATETIME(t1.diagnosed) BETWEEN DATETIME(t2.diagnosed) AND DATETIME(t2.diagnosed, '+2 month') AND STRFTIME('%y', t1.diagnosed) = '2100'",
233eeb75a432587011a6b1bc,Has patient 10024043 entered the hospital?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10024043,SELECT COUNT(*) > 0 FROM patient WHERE patient.subject_id = 10024043,[{'COUNT(*)>0': 1}]
47a339f3ee10d0098dafc8bd,Has patient 10038992 received a laboratory test since 08/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08'","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10038992 AND STRFTIME('%y-%m', lab_tests.date) >= '2100-08'",[{'COUNT(*)>0': 1}]
a4ca19a5c33291f0beacd6c2,"What was the first time that the heart rate of patient 10018081 was, in the current ICU encounter, less than 85.0?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 85.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM icu WHERE icu.patient_id = 10018081 AND icu.outlet = 'heart rate') WHERE heart_rate < 85.0,[]
dc972f955fcddfb8a89d6ba2,"List the top four most frequent microbiology tests given to patients after being diagnosed with accidental puncture or laceration during a procedure, not elsewhere classified in the same hospital visit throughout this year.","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental puncture or laceration during a procedure, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t3.Microbiology, COUNT(t3.Microbiology) FROM (SELECT t2.Microbiology, t1.Diagnosis, t1.Hospital, t1.Hospital_Location FROM (SELECT Diagnosis, Hospital, Hospital_Location FROM (SELECT Accidental_Puncture_or_Laceration AS Diagnosis, Hospital, Hospital_Location FROM patients WHERE Accidental_Puncture_or_Laceration = 'Accidental_Puncture_or_Laceration') AS t1 JOIN (SELECT Microbiology, Hospital, Hospital_Location FROM patients WHERE Microbiology = 'Microbiology') AS t2 ON t1.Diagnosis = t2.Microbiology) AS t3 GROUP BY t3.Microbiology ORDER BY COUNT(t3.Microbiology) DESC LIMIT 4",
f59080441b975f79286dcd09,Tell me the top five most common lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.lab_test, COUNT(t1.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE year >= 2100) AS t1 JOIN lab_results ON t1.lab_test = lab_results.lab_test GROUP BY t1.lab_test ORDER BY COUNT(t1.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
11974f52e559145ce9f812f2,"Since 1 year ago, has patient 10009035 undergone a lab test?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM lab_test WHERE lab_test.patient_id = 10009035 AND DATETIME(lab_test.lab_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 1}]
e6c07526b6246ff9377949ba,"Since 07/2100, what was the last drug that patient 10004720 was prescribed through the po/ng route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM patient_10004720 WHERE route = 'po/ng' AND date_prescribed >= '2007-02-11',[]
e24e59d7e21364890399468e,How much is the difference of patient 10003046's mean blood pressure measured at 2100-01-17 14:00:00 compared to the value measured at 2100-01-17 13:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 13:00:00' ),SELECT (SELECT mean_blood_pressure FROM patient_blood_pressure WHERE patient_id = 10003046 AND measurement_time = '2100-01-17 14:00:00') - (SELECT mean_blood_pressure FROM patient_blood_pressure WHERE patient_id = 10003046 AND measurement_time = '2100-01-17 13:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 13:00:00' )"": None}]"
0ff24db141cbffff8252d7e6,When did the last discharge from the hospital happen for patient 10025612?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10025612 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(disch_date) FROM patient WHERE patient_id = 10025612;,[{'dischtime': '2125-10-03 12:24:00'}]
d4677f8cd4b45df639326bef,Get the count of hospital visits by patient 10000032 since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10000032 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(Hospital_Visits) FROM Visits WHERE Patient_ID = 10000032 AND DATETIME(Visits.Visit_Date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 4}]
5af27d478c355763b0000b8b,What are the precautions to take after the inc/exc/destr in ear nec procedure?,,"SELECT ""precautions"" FROM ""procedures"" WHERE ""type"" = 'inc/exc/destr in ear nec';",
12fbd03c50369014a82f4756,How many patients were let go from hospitals since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM patients WHERE status = ""let go"" AND date_since > CURRENT_DATE - INTERVAL '1 year'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
493f197a6d56dbacf99556ab,What are the three most regularly ordered treatments for patients previously diagnosed with anemia in other chronic diseases classified elsewhere during the same month in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in other chronic diseases classified elsewhere' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t1.treatment, t2.date FROM (SELECT patient_id, treatment_date FROM diagnoses WHERE diagnosis = 'anemia in other chronic diseases classified elsewhere') AS t1 JOIN (SELECT patient_id, treatment_date FROM treatments WHERE treatment_date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.date BETWEEN '2100-01-01' AND '2100-12-31' AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month')) AS t3 GROUP BY t3.treatment ORDER BY c1 NULLS FIRST",
facfba9ab5edcbd30634f5b1,What was the average value of the SaO2 of patient 10023239?,SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ),"SELECT AVG(SaO2) FROM ""patient_10023239""",[{'AVG(chartevents.valuenum)': None}]
d06643d034d4d04e5457cae5,What are the total number of other and unspecified pneumonectomy procedures performed in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures WHERE procedureType = ""Other and unspecified pneumonectomy"" AND year = 2100",
a962b9d8317a6e4edbdd29f0,What are the three most frequently prescribed drugs in the same hospital encounter to the patients aged 40s after they were diagnosed with acute embolism and thrombosis of left iliac vein in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute embolism and thrombosis of left iliac vein' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'acute embolism and thrombosis of left iliac vein' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.uniquepid, drug.drug, drug.drug_date FROM drug JOIN patient ON drug.patient_id = patient.patient_id WHERE patient.age BETWEEN 40 AND 49 AND STRFTIME('%y', drug.drug_date) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.drug_date AND DATETIME(t1.diagnosis_date, 'start of day') = DATETIME(t2",
a40c239f553ad63c5c40cc4c,Can anyone tell me how many operating rooms are there now?,,SELECT COUNT(*) FROM inventory WHERE part_name = 'operating room',
c5b41500133543c1bd41eb66,How many patients were given metoprolol succinate xl prescriptions since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.had_prescription >= 2100 AND patient.prescription_details LIKE '%metoprolol succinate xl%',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
24ad21be2a942f6c761d77d7,"During the first ICU stay, what was the first heart rate value of patient 10036156?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM icu_heart_rate WHERE icu_id IN (SELECT icu_id FROM icu_stay WHERE patient_id = 10036156 AND NOT icu_out_date IS NULL ORDER BY icu_admission_date NULLS FIRST LIMIT 1),[]
42a736dc3448b6c72bebe5a9,What's the minimum daily number of patients who were diagnosed with essential and other specified forms of tremor in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential and other specified forms of tremor' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT MIN(t.c) FROM (SELECT COUNT(p.p) AS c FROM patient p WHERE p.diagnosis = 'ESSENTIAL AND OTHER SPECIFIED FORM(S) OF TREMOR' AND STRFTIME('%y', p.diagnosis_date) = '2100' GROUP BY STRFTIME('%y-%m-%d', p.diagnosis_date)) AS t;",
825c5c877128209aef4d391e,"Tell me the cost of a procedure known as excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic.","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic'",
1e8e254a1ff71001475df244,What are the top five most frequent microbiology tests that patients were diagnosed with operating room of hospital as the place of occurrence of the external cause in the same month?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.microbiology_test, COUNT(t3.microbiology_test) FROM (SELECT t2.microbiology_test, DATE_TRUNC('month', t2.date_of_test) AS month FROM (SELECT patient.uniquepatientid, diagnosis.date_of_test, diagnosis.microbiology_test FROM diagnosis JOIN patient ON diagnosis.patient_uniquepatientid = patient.uniquepatientid WHERE diagnosis.microbiology_test = 'External Cause') AS t1 JOIN (SELECT patient.uniquepatientid, microbiology_test, date_of_test FROM microbiology JOIN patient ON microbiology.patient_uniquepatientid = patient.uniquepatientid) AS t2 ON t1.uniquepatientid = t2.uniquepatientid WHERE t1.date_of_test < t2.date_of_test AND DATETIME(t1.date_of_test, 'start of month') = DATETIME(t2.date_of_test, 'start of month') GROUP BY t2.microbiology",
90ca159192db0f36dc910080,"What are the three most commonly ordered procedures for patients who were previously diagnosed with abdominal pain, unspecified site, which occurred within 2 months since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.code, COUNT(t3.code) FROM (SELECT t2.code, COUNT(t2.code) FROM (SELECT patient.id, diagnosis.diagnosis_time FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'abdominal pain, unspecified site' AND STRFTIME('%y', diagnosis.diagnosis_time) >= '2100') AS t1 JOIN (SELECT patient.id, procedure.code, procedure.procedure_time FROM procedure JOIN patient ON procedure.patient_id = patient.id WHERE STRFTIME('%y', procedure.procedure_time) >= '2100') AS t2 ON t1.id = t2.patient.id WHERE t1.diagnosis_time < t2.procedure_time AND DATETIME(t2.procedure_time) BETWEEN DATETIME(t1.diagnosis_time) AND DATETIME(t1.diagnosis_time, '+2 month') GROUP BY t2.code) AS t3 WHERE COUNT(t",
b3d362f74a925702dfbb0a1d,"How many days have passed since the last time patient 10018081 received a lab test of sodium, urine during this hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_test_date)) FROM lab_tests WHERE lab_test_type = 'sodium, urine' AND patient_id = 10018081 AND hospital_dischtime IS NULL;",[]
fbb2af617d1dcbd3c073bbe0,What were the top five frequent laboratory tests that patients had after they were diagnosed with paralytic ileus during the same hospital visit?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paralytic ileus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_location FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'PARALYTIC ILEUS') AS t1 JOIN (SELECT admissions.subject_id, lab_test, lab_date, admissions.admission_location FROM lab_tests JOIN admissions ON lab_tests.admission_id = admissions.admission_id) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.lab_date AND t1.admission_location = t2.admission_location GROUP BY t2.lab_test) AS t3 WHERE t3.c1 <= 5",
b9e107def562596e07c5c476,What is the average total hospital cost including a ck-mb index lab test?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb index' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(t1.c1) FROM (SELECT SUM(h.cost) AS c1 FROM patient p JOIN hospital h ON p.hospital = h.hospital WHERE p.patient = 'CK-MB Index' GROUP BY p.patient) AS t1,
9e1a47f578512d0f3910fa36,Tell me the number of operating rooms available?,,SELECT COUNT(*) FROM 'operating_rooms.csv';,
fe615a9fbe3f8b13bb56bbdf,How many days have elapsed since patient 10021487 has first received a other lab test on this hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result_date)) FROM lab_results WHERE lab_results.patient_id = 10021487 AND lab_results.lab_result_type = 'other' AND lab_results.hospital_location = (SELECT lab_results.hospital_location FROM lab_results WHERE lab_results.patient_id = 10021487 AND lab_results.lab_result_type = 'other' ORDER BY lab_result_date NULLS FIRST LIMIT 1)",[]
271c09dde1ad0ae0ce21d6e5,Can you list patient 10009628's daily maximum weight since 1 year ago?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10009628 AND date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY date,[]
c578a495c2dae5a5b4a612bd,Can you get me the top five most conducted lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT top(5) FROM lab_tests WHERE year = 2100 GROUP BY lab_tests.conducted;,[]
b6d57a0c15272dbc69e39fc2,How many days has it been since the last time patient 10018081 visited careunit emergency department in this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1","SELECT COUNT(DISTINCT CAST(visit_date AS DATE)) FROM visit_table WHERE patient_id = 10018081 AND visit_type = ""EMERGENCY DEPARTMENT"" AND visit_date >= (SELECT MAX(visit_date) FROM visit_table WHERE patient_id = 10018081 AND visit_type = ""EMERGENCY DEPARTMENT"")",[]
d24509cc1ab0dd341bb53f33,What was the last sodium chloride 0.9% dose that patient 10022880 was prescribed in 04/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND prescriptions.drug = 'sodium chloride 0.9%' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10022880 AND prescriptions.drug = 'sodium chloride 0.9%' AND DATETIME(prescriptions.date_prescribed, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date_prescribed) = '04';",[]
06f4ed18e0175feb847ceb18,Calculate the number of patients prescribed aluminum-magnesium hydrox.-simethicone in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aluminum-magnesium hydrox.-simethicone' AND strftime('%Y',prescriptions.starttime) = '2100' )","SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE prescriptions.drug = 'Aluminum-Magnesium Hydrox.-Simethicone' AND STRFTIME('%y', prescriptions.date) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c1b05b990820fdea69b71d1a,What are the five most commonly diagnosed diagnoses for patients who had previously received parenteral infusion of concentrated nutritional substances within 2 months since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT t2.diagnosis, t1.month FROM (SELECT STRFTIME('%y', patient.date) AS month FROM patients WHERE patient.id IN (SELECT diagnosis.patient_id FROM diagnoses WHERE diagnosis.diagnosis = 'parenteral infusion of concentrated nutritional substances')) AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis FROM diagnoses JOIN patients ON diagnoses.patient_id = patients.id WHERE STRFTIME('%y', diagnosis.date) >= '2100') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.month BETWEEN t2.month - 2 AND t2.month + 2 GROUP BY t3.diagnosis) AS t3 WHERE t3.rank <= 5",
d47700b1f0c8efe72117c59e,Tell me the five most common diagnoses since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(*) FROM diagnoses WHERE year >= 2100 GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 5",
c68f338d371ce9d209a15844,Reveal the drug name that was first prescribed to patient 10007818 via the iv route since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT iv_drug FROM prescriptions WHERE patient_id = 10007818 AND iv_drug IN (SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10007818 AND prescriptions.route = 'iv' AND STRFTIME('%y-%m', prescriptions.date) >= '2100-05') ORDER BY iv_drug NULLS FIRST LIMIT 1",[]
bfa5ac0d983d25c1bae0ffdb,"Was yellow cadd cassette, docusate sodium, or naloxone prescribed on the last hospital encounter for patient 10019568?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'yellow cadd cassette', 'docusate sodium', 'naloxone' )","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10019568 AND prescriptions.date_trunc = (SELECT MAX(date_trunc) FROM prescriptions WHERE prescriptions.patient_id = 10019568 AND NOT prescriptions.date_discontinued IS NULL) AND prescriptions.drug IN ('Yellow Cadd Cassette', 'Docusate Sodium', 'Naloxone')",[{'COUNT(*)>0': 0}]
2d4e78fac89671a4c99a7d95,Can you tell me when the last microbiology test for patient 10015931 was held since 9 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-9 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(microbiology_date) FROM microbiology WHERE patient_id = 10015931 AND microbiology_type = 'holding time' AND date_sub('month', microbiology_date, CURRENT_DATE) < 9",[{'charttime': '2177-03-27 11:54:00'}]
2c0f498a16183e884d741e15,What were the last alkaline phosphatase values of patient 10004733 in their current hospital visit?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT ALKALINE_PHOSPATASE_CURRENT FROM duckdb_patients WHERE PATIENT_ID = 10004733 AND HOSPITAL_CURRENT = true ORDER BY ALKALINE_PHOSPATASE_CURRENT DESC LIMIT 1;,[]
8940911fa3f2d95d03fc272e,Show me the top three most common treatments for patients aged 40s in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT * FROM patients WHERE age BETWEEN 40 AND 49) AS t1 JOIN (SELECT * FROM treatment_logs WHERE treatment_date BETWEEN '2000-01-01' AND '2000-12-31') AS t2 ON t1.treatment_id = t2.treatment_id) AS t3 GROUP BY t3.treatment ORDER BY COUNT(t3.treatment) DESC LIMIT 3;",
eb2f419e7f09df1b43df8f92,Tell me what the total foley output of patient 10039831 is since 07/14/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-14'","SELECT SUM(foley) FROM output WHERE patient = 10039831 AND date >= ""07/14/2100""",[{'SUM(outputevents.value)': None}]
af6abe939c498f156e856916,How much morphine sulfate (oral solution) 2 mg/ml was first prescribed to patient 10021312 in 08/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 08 AS _year, 'morphine sulfate (oral solution) 2 mg/ml' AS _drug FROM prescriptions WHERE prescriptions.patient_id = 10021312 AND DATETIME(prescriptions.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date_prescribed) = '08' ORDER BY prescriptions.date_prescribed NULLS FIRST LIMIT 1",[]
299ef20e44a70d1ce5af952a,What are the new prescriptions for patient 10004733 today compared to those received yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.new_prescriptions FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND DATETIME(prescriptions.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescriptions.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
aafe7bc8473b0240ac6c912c,What is the maximum total cost of the hospital visits that included a medicine named heparin in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM medicine WHERE name = 'heparin' AND year = 2100 GROUP BY patient_id) AS t1,
0cfe903dde7855d41478137f,How many patients had a ntprobnp lab test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ntprobnp' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.lab_ntprobnp > (SELECT INTERVAL '1 year' FROM dual),[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e8f9739dbbd0348fee454966,"During their last hospital encounter, what was patient 10037975's insurance plan?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance_plan FROM patients WHERE patient.hospital_dischtime = (SELECT MAX(hospital_admittime) FROM admissions WHERE admissions.subject_id = 10037975),[{'insurance': 'Medicare'}]
5ccf5c391f79452b6224e1f6,What was the name of the output that patient 10015860 got first?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) ORDER BY outputevents.charttime ASC LIMIT 1 ),SELECT output_name FROM patient_outputs WHERE patient_id = 10015860 ORDER BY output_time NULLS FIRST LIMIT 1,[{'label': 'Void'}]
3932e19e4ed3b0175cec67c4,Has patient 10007818 had a hospital admission in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007818 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10007818 AND STRFTIME('%y', admissions.admission_date) = '2100'",[{'COUNT(*)>0': 0}]
56f862020ab17a92aac5b864,When did patient 10027602 get input for the first time since 06/13/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-13' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT input_date FROM input_table WHERE patient_id = 10027602 AND input_date >= '2100-06-13' ORDER BY input_date NULLS FIRST LIMIT 1,[{'starttime': '2201-10-30 12:08:00'}]
1a393a5c12d21a7f7e392418,Retrieve the monthly minimum amount of patient 10001725's pre-admission/non-icu intake input since 03/12/2100.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission/non-icu intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MIN(intake_amount) FROM intake WHERE patient_id = 10001725 AND intake_type = 'pre-admission/non-icu' AND date >= '2100-03-12',[]
c6a7a43a376d92df5f420f3d,Has patient 10009628 got a lab test in 09/this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '09'","SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10009628 AND DATETIME(lab_tests.test_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', lab_tests.test_date) = '09'",[{'COUNT(*)>0': 0}]
09defcd24314b8496fb3d74c,What is the dosage of the prescribed opioid for patient 9619?,,SELECT prescriber_info.dosage FROM prescriber_info WHERE prescriber_info.patient_id = 9619 AND prescriber_info.prescription_type = 'opioid',
207e6d0a6a9b812afab27ac7,Was the absolute eosinophil count value of patient 10038999 second measured on the first hospital visit less than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT (SELECT EOSINOPHIL_COUNT FROM ""tenancy"" WHERE ""Patient"" = 10038999 AND NOT ""Hospital Dischtime"" IS NULL ORDER BY ""Hospital Admittime"" NULLS FIRST LIMIT 1 OFFSET 1) < (SELECT EOSINOPHIL_COUNT FROM ""tenancy"" WHERE ""Patient"" = 10038999 AND NOT ""Hospital Dischtime"" IS NULL ORDER BY ""Hospital Admittime"" NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
4ba1843465e5f775b2a892a8,What specimen test was last given in 11/2100 to patient 10005909?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT specimen_test FROM microbiology_history WHERE patient_id = 10005909 AND date_last_given = ""11/2100""",[]
7f1d3e5201103ad28842a180,Please tell me what to prepare for the flexible sigmoidoscopy procedure,,SELECT * FROM procedures WHERE procedure = 'Flexible Sigmoidoscopy';,
5407c72b5374049d5ff42574,Can you tell me how much lansoprazole oral disintegrating tab costs?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lansoprazole oral disintegrating tab' ),SELECT DISTINCT cost FROM products WHERE product = 'lansoprazole oral disintegrating tab',
d531eb280735fb30a757905a,"Will patient 7165 be provided with any additional urine,kidney test?",,SELECT COUNT(*) > 0 FROM urine_kidney_test WHERE patient_id = 7165,
64873d6508dd0dea262a7cd7,"Throughout this year, what are the top five most common microbiology tests that patients were diagnosed with within 2 months after being diagnosed with saddle embolus of pulmonary artery with acute cor pulmonale?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'saddle embolus of pulmonary artery with acute cor pulmonale' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.microbiology_test FROM (SELECT t2.microbiology_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Saddle embolus of pulmonary artery with acute cor pulmonale') AS t1 JOIN (SELECT patient.uniquepid, microbiology.microbiology_test, microbiology.microbiology_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.patient_id) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.microbiology_date AND DATETIME(t2.microbiology_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.microbiology_",
692d3013b67039704bfb1551,What was the total amount of output from patient 10021312 since 252 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-252 day')",SELECT SUM(output) FROM output WHERE patient = 10021312 AND days_since_output >= 252,[{'SUM(outputevents.value)': 2675.0}]
88c671a2840f4530415bcdf6,"What were the number of patients who received a hematocrit, calculated test?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) )","SELECT COUNT(DISTINCT t.subject) FROM (SELECT t.subject, t.hematocrit FROM (SELECT subject, hematocrit FROM (SELECT subject, CAST(hematocrit AS FLOAT) / 100 AS hematocrit FROM (SELECT subject, CAST(hemoglobin AS FLOAT) / 100 AS hemoglobin FROM (SELECT subject, CAST(hemoglobin AS FLOAT) / 100 AS hemoglobin FROM (SELECT subject FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM (SELECT STATE1 FROM",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
1697a8cad9b6a471e01ec05a,"What was the name of the organism discovered in the first fluid,other test of patient 10021487 since 9 months ago?","SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-9 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT organism_name FROM organism_discovery WHERE patient_id = 10021487 AND sample_type = 'fluid,other' AND discovery_date > DATEADD(month, -9, CURRENT_DATE) ORDER BY discovery_date NULLS FIRST LIMIT 1",[]
05ffeff678368c17b77078d6,When did patient 10022017 depart hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_departure_date) FROM patient WHERE patient_id = 10022017,[]
a96ef9e34778c695552e52c6,What is the sex of patient 10010471?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10010471,SELECT patients.sex FROM patients WHERE patients.id = 10010471;,[{'gender': 'F'}]
a7deec7678c37db84888ba96,"What new medications are there for patient 10018081 today, compared to the prescriptions given yesterday?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.new_medications FROM prescriptions WHERE prescriptions.patient_id = 10018081 AND DATETIME(prescriptions.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescriptions.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day');",[]
09d05723516e1dd76fa1efe3,What is the cost of thoracoscopic lobectomy of lung?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure = 'thoracoscopic lobectomy of lung';,
4ef144ef1e3cc810f42069d1,When was the last time the diastolic blood pressure of patient 10018081 registered less than 56.0 since 02/28/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 56.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-28' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(blood_pressure_diastolic) FROM blood_pressure_diastolic WHERE blood_pressure_diastolic.patient_id = 10018081 AND blood_pressure_diastolic.reading_date >= '2000-02-28' AND blood_pressure_diastolic.reading_date < '2000-02-28' AND blood_pressure_diastolic.value < 56.0,[]
e8162ad0bfd3adb9a2c2f908,Does patient 13473 have a report of stricture of artery in his / her family?,,SELECT COUNT(*) > 0 FROM patient WHERE patient.family_member_id IN (SELECT patient.family_member_id FROM patient WHERE patient.patient_id = 13473) AND patient.diagnosis = 'stricture of artery',
3b5a20289fcb449af1962529,Can you tell me the name of the output patient 10018081 had for the first time today?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(outputevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM outputs WHERE patient_id = 10018081 AND NOT name IN (SELECT name FROM outputs WHERE patient_id = 10018081 AND time < '2022-01-01 00:00:00') ORDER BY time DESC LIMIT 1,[]
82ed4968374026cba4624178,How many patients were diagnosed with asymptomatic human immunodeficiency virus [hiv] infection status within 2 months after first being diagnosed with mononeuritis of unspecified site in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mononeuritis of unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,
799e3b8dccd0212e2b71456d,When was patient 10022017 first urine microbiologic test since 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM urine_microbiology WHERE patient_id = 10022017 AND date >= '2000-07-2100',[]
2fa869cf56451cb9220ecb8a,How much lorazepam was prescribed to patient 10019777 first in 03/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.drug = 'lorazepam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT SUM(Lorazepam) FROM prescriptions WHERE prescriptions.patient_id = 10019777 AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '03' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[]
55f66285eac844245d46c2a6,When was the first hospital discharge time for patient 10007058?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007058 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(hospital_dischtime) FROM hospital WHERE patient_id = 10007058,[{'dischtime': '2167-11-11 14:23:00'}]
8236653d88c7fec0c10aeb71,"On the current hospital visit, how many hours have passed since patient 10004733's first diagnosis of blood in stool?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE patient_id = 10004733 AND diagnosis = 'blood in stool'",
4de48cd89d593e47d6e93688,Tell me the four most common lab tests in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.lab_test FROM (SELECT lab_test, COUNT(lab_test) FROM lab_tests WHERE year = 2100 GROUP BY lab_test) AS t1 JOIN (SELECT lab_test, COUNT(lab_test) FROM lab_tests WHERE year = 2000 GROUP BY lab_test) AS t2 ON t1.lab_test = t2.lab_test ORDER BY COUNT(lab_test) DESC LIMIT 4",[]
a041560dafe724349feb959f,How many patients currently in the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE hospital_current = true;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
367b2116257001fe013bc048,When is the earliest next visit of patient 8773 for other departments?,,SELECT MIN(visit_date) FROM visit_table WHERE patient_id = 8773 AND department <> 'pharmacy',
a46388d3c77f04af56eb9f4a,What was the last famotidine dose that patient 10001725 was prescribed on their last hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'famotidine' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(dose) FROM prescriptions WHERE prescriptions.patient_id = 10001725 AND prescriptions.drug = 'famotidine',[]
6b3c9e4d732df9f3eda20c41,Has patient 10026354 been provided with any medication since 7 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-7 month')","SELECT COUNT(*) > 0 FROM medication_usage WHERE medication_usage.patient_id = 10026354 AND DATETIME(medication_usage.date) >= DATETIME(CURRENT_TIME, '-7 month')",[{'COUNT(*)>0': 1}]
57e26730a40f2a68869265ef,Has patient 10031404 undergone any procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10031404 AND STRFTIME('%y', procedures.date) >= '2100'",
7af1e69b20b9be325402ee3c,Is the creatinine value last measured on the last hospital visit in patient 10023239 greater than the value from the first measurement on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10023239 AND lab_data.measurement_date = (SELECT MAX(lab_data.measurement_date) FROM lab_data WHERE lab_data.patient_id = 10023239 AND NOT lab_data.measurement_date IS NULL)) > (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10023239 AND lab_data.measurement_date = (SELECT MIN(lab_data.measurement_date) FROM lab_data WHERE lab_data.patient_id = 10023239 AND NOT lab_data.measurement_date IS NULL)) AND lab_data.lab_name = 'creatinine'),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
29c36a36cc9362584821e13f,When were patient 10007795 last prescribed for gemfibrozil and heparin at the same time in 05/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10007795 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT COUNT(DISTINCT t1.start_date) FROM (SELECT patient.subject_id, prescriptions.start_date FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.subject_id WHERE prescriptions.drug = 'Gemfibrozil' AND patient.subject_id = 10007795 AND DATETIME(prescriptions.start_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.start_date) = '05') AS t1 JOIN (SELECT patient.subject_id, prescriptions.start_date FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.subject_id WHERE prescriptions.drug = 'Heparin' AND patient.subject_id = 10007795 AND DATETIME(prescriptions.start_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescri",[]
73275404fad47edb177ee8d4,When was patient 10021487 prescribed a 5% dextrose and furosemide at the same time for the first time this month?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT MIN(pharmacy_time) FROM (SELECT T1.id, T1.pharmacy_time FROM (SELECT patient_id, prescriptions.pharmacy_time FROM prescriptions JOIN patients ON prescriptions.patient_id = patients.id WHERE patients.patient_id = 10021487) AS T1 JOIN (SELECT patient_id, prescriptions.pharmacy_time FROM prescriptions JOIN patients ON prescriptions.patient_id = patients.id WHERE patients.patient_id = 10021487) AS T2 ON T1.id = T2.id WHERE T1.pharmacy_time < T2.pharmacy_time AND DATETIME(T1.pharmacy_time, 'start of month') = DATETIME(T2.pharmacy_time, 'start of month') GROUP BY T1.id)",[]
f51f73add40fa25cc0d3936a,What was the amount of insulin human regular that was prescribed to patient 10009035 for the last time since 05/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND prescriptions.drug = 'insulin human regular' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(insulin) FROM insulin WHERE insulin = 'human regular' AND patient = 10009035 AND date >= '2000-05-2100',[]
9073e579594a4c3f92dad212,What were the top five diagnoses most frequently diagnosed in this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) as rank",
f8c81bc0c7a1707c6d543598,Tell me the name of the prescription drug that patient 10007058 was prescribed in the same hospital visit after having a fluoroscopy of multiple coronary arteries using other contrast procedure in 11/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '11' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.name FROM (SELECT patient.uniquecarrier, treatment.timestamp FROM treatment JOIN patient ON treatment.patient = patient.uniquecarrier WHERE patient.patient = 10007058 AND treatment.treatment = 'fluoroscopy of multiple coronary arteries using other contrast' AND DATETIME(treatment.timestamp, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', treatment.timestamp) = '11') AS t1 JOIN (SELECT patient.uniquecarrier, prescription.name FROM prescription JOIN patient ON prescription.patient = patient.uniquecarrier WHERE patient.patient = 10007058 AND DATETIME(prescription.timestamp, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescription.timestamp) = '11') AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.timestamp < t2.timestamp AND DATETIME(t1",
236ef17c9fdf9071b7c4a6b4,"What are the five most frequently prescribed drugs within 2 months to the patients aged 40s after they were diagnosed with constipation, unspecified?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Constipation, unspecified') AS t1 JOIN (SELECT patient.id, prescription.drug, prescription.prescription_date FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE patient.age BETWEEN 40 AND 49) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.prescription_date AND DATETIME(t2.prescription_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.drug) AS t3 WHERE t3.c1 <= 5",
479ae3deb06c95266bad80c8,What was patient 10027602's arterial blood pressure systolic for the first time since 244 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-244 day') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(arterial_blood_pressure_systolic) FROM patient WHERE patient.id = 10027602 AND date < (CURRENT_DATE - INTERVAL '244 day'),[]
bedebf884aabb5a8dcfaed9a,"Number of patients who were diagnosed in 2100 with urinary tract infection, site not specified.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT j.subjectId) FROM patients j WHERE j.diagnosisYear = 2100 AND j.diagnosis = 'URINARY TRACT INFECTION, SITE NOT SPECIFIED'",
99c9abca99f18fa8ddc1f20a,How old was patient 10006053 during their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patient WHERE patient.id = 10006053 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1;,
0dd4139bd1f8141dabb5746b,When will patient 92846 be next seen by the hospital?,,SELECT patient.next_visit FROM patient WHERE patient.id = 92846,
89b3f7739b080ee0246b9f58,"In this year, has patient 10003046 received a diagnosis?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10003046 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
df5256f4811843aaeca939a2,"For the last time , how much 0.9% sodium chloride (mini bag plus) was prescribed to patient 10026255?",SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND prescriptions.drug = '0.9% sodium chloride (mini bag plus)' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10026255 AND prescriptions.drug = '0.9% Sodium Chloride (Mini Bag Plus)',[]
9535260fe83b84161cfcbef0,What are the three commonly taken specimens for patients that received insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s) previously within the same month in this year?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen FROM (SELECT t2.specimen, DATE_TRUNC('month', t2.date) AS month FROM (SELECT patient.specimen, DATE_TRUNC('month', date) AS month FROM patients JOIN patient ON patients.staff_id = patient.staff_id WHERE patient.role = 'patient') AS t1 JOIN (SELECT patient.specimen, DATE_TRUNC('month', date) AS month FROM patients JOIN patient ON patients.staff_id = patient.staff_id WHERE patient.role = 'patient') AS t2 ON t1.specimen = t2.specimen WHERE t1.month = t2.month AND DATETIME(t1.date, 'start of year') = DATETIME(t2.date, 'start of year')) AS t3 GROUP BY t3.specimen ORDER BY COUNT(*) DESC LIMIT 1",
618d392ae43e6fe30006328e,When did patient 10020187 have the maximum value of SaO2 for the first time during their first ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT STRFTIME('%y-%m-%d %H:%M:%S', MIN(SaO2)) FROM ICU WHERE patient_id = 10020187 AND NOT icu_out_date IS NULL ORDER BY SaO2 DESC LIMIT 1;",[]
a1faad0653a8f9dc687564e5,Could you calculate the total amount of output from patient 10012552 since 04/02/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-02'","SELECT SUM(output) FROM (SELECT patient_id, output FROM output_table WHERE patient_id = 10012552 AND date >= '2000-04-02')",[{'SUM(outputevents.value)': 8408.0}]
0d6abd33276d5170877ee1fa,How much is the difference of heart rate of patient 10000032 last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT heart_rate FROM icu_visits WHERE icu_visits.patient_id = 10000032 AND NOT icu_visits.outgoing = 0 ORDER BY icu_visits.measurement_time NULLS FIRST LIMIT 1) - (SELECT heart_rate FROM icu_visits WHERE icu_visits.patient_id = 10000032 AND NOT icu_visits.outgoing = 0 ORDER BY icu_visits.measurement_time DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
d683e1297440d54816fb0549,"On 06/14/2100, what was the last value of heart rate of patient 10009049?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-06-14' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM patient_10009049 WHERE date_of_entry = '06/14/2100';,[]
e0871385561b20faaecfa48c,What is the total number of patients who were discharged from the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",SELECT COUNT(DISTINCT id) FROM patients WHERE NOT dismissed FROM hospital ORDER BY total_discharges DESC LIMIT 1,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
92eed7c2713d3eb38d53dcd1,What is the maximum total cost of the hospital visits that include hemodialysis since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.total_cost) FROM (SELECT SUM(ci.cost) AS total_cost FROM (SELECT c.cost FROM cost_table c WHERE c.year >= 2100) AS ci JOIN patient_table p ON ci.patient_id = p.patient_id JOIN hospital_table h ON p.hospital_id = h.hospital_id JOIN (SELECT record_id, hemodialysis_date FROM hemodialysis_table WHERE hemodialysis_date >= 2100) AS hd ON h.hospital_id = hd.hospital_id GROUP BY ci.patient_id) AS t1",
65a768c5a05156a43362b231,"In 11/2100, what was the last time patient 10029484 had a medication via the po/ng route prescribed?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(T1.date_prescribed) FROM (SELECT date_prescribed FROM medication_table WHERE medication_table.patient_id = 10029484 AND route = 'po/ng') AS T1 WHERE T1.date_prescribed BETWEEN '2011-02-10' AND '2011-12-31',[]
78805907705a4fd44978901b,When was patient 10005817 prescribed 0.9% sodium chloride and insulin human regular at the same time for the last time in this month?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin human regular' AND admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10005817 AND prescription_type = 'insulin human regular' AND date_prescribed >= (SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10005817 AND prescription_type = '0.9% sodium chloride') AND date_prescribed <= (SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10005817 AND prescription_type = 'insulin human regular') AND date_prescribed >= (SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10005817 AND prescription_type = 'insulin human regular') AND date_prescribed <= (SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10005817 AND prescription_type = 'insulin human regular'),[]
5452c625522e88957199e9f0,Tell me the total number of patients who were diagnosed with acute pyelonephritis since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pyelonephritis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT patient_id) FROM diagnoses WHERE diagnosis = ""acute pyelonephritis"" AND STRFTIME('%y', diagnosis_date) >= '2100'",
40073884463d17bc3702a2fc,Did patient 10038999 undergo a c3 laboratory test in 06/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c3' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'","SELECT COUNT(*) FROM lab_data WHERE lab_data.patient_id = 10038999 AND lab_data.test_name = 'c3' AND STRFTIME('%y-%m', lab_data.date) = '2100-06'",[{'COUNT(*)>0': 0}]
6fd61e60148bb599c1a2a048,What is the sex of patient 10009035?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10009035,SELECT MIN(SEX) FROM PATIENT WHERE PATIENT.ID = 10009035;,[{'gender': 'M'}]
6dfb148b96ec46dd4baf1399,What is the minimum total hospital cost which includes a drug named phenobarbital alcohol withdrawal dose taper (days 2-7) since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost >= (SELECT SUM(cost) FROM cost WHERE name = 'phenobarbital alcohol withdrawal dose taper (days 2-7)') AND DATETIME(cost.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY cost.patient_id) AS t1",
1f9d4e5d9ff5a5dce1860541,"What were the top four most common microbiology tests for patients who were previously diagnosed with spinal stenosis, lumbar region, without neurogenic claudication within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'spinal stenosis, lumbar region without neurogenic claudication') AS t1 JOIN (SELECT patient.id, microbiology.test_name, microbiology.test_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.id) AS t2 ON t1.id = t2.patient_id WHERE t1.diagnosis_date < t2.test_date AND DATETIME(t2.test_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.test_name) AS t3 WHERE t3.rank <= 4",
bcf8bddfe8dcd3e449454450,So how many hours has passed since patient 10021487's first traumatic hemothorax without mention of open wound into thorax diagnosis during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic hemothorax without mention of open wound into thorax' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = 10021487 AND diagnosis.diagnosis_type = ""Traumatic hemothorax without mention of open wound into thorax"" AND diagnosis.dischtime IS NULL",
c3cb7b770179052c67712e37,Patient 10009628's age during their last hospital visit was what?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT COUNT(DISTINCT patient.age) FROM patient WHERE patient.id = 10009628 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1,
1a89de1d88c68408b38a9c56,"In 2100, how many medications were prescribed to patient 10006053?","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10006053 AND STRFTIME('%y', medications.date) = '2100';",[{'COUNT(*)': 0}]
7c5c504415d7c151349eda86,When did patient 10019385 have a last free calcium laboratory test?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ORDER BY labevents.charttime DESC LIMIT 1,"SELECT LastFreeCalciumLaboratory FROM ""Patient"" WHERE ""Patient ID"" = 10019385;",[]
65f468deef71db0042d17c04,Provide the monthly maximum weight of patient 10005909 during the first hospital visit.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10005909 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1;,[]
a0fe46cb093192a88d6cf061,When did patient 10010471 last receive a lab test for troponin t during the first hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(lab_result_date) FROM lab_results WHERE lab_result_troponin_t IS NOT NULL AND patient_id = 10010471 AND NOT patient_id IN (SELECT patient_id FROM patient WHERE NOT patient_id IN (SELECT patient_id FROM patient WHERE patient_age < 18)),[]
deb0649dc5dfba070e57b20a,"What were the top four most common procedures that occurred within the same hospital visit for patients who had extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic before since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.code, COUNT(t4.code) FROM (SELECT t3.code, COUNT(t3.code) FROM (SELECT t2.code, COUNT(t2.code) FROM (SELECT patient.uniquepid, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' AND DATETIME(treatment.treatmenttime) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 GROUP BY t2.code) AS t3 JOIN (SELECT t4.code, COUNT(t4.code) FROM (SELECT patient.uniquepid, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' AND DATETIME(treatment.treatmenttime) >= DATETIME(CURRENT_TIME",
9c7b53fbe9d379b7315c6ec8,What was the organism's name found in the last blood culture test of patient 10038999 in the last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM blood_culture_last_hospital_entry WHERE patient_id = 10038999 AND organism_name IS NOT NULL;,[]
f17da97011f380b6bc7c87eb,Show me the top five most common diagnoses of patients aged 60 or above this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",SELECT diagnosis FROM patients WHERE age >= 60 AND year = 2012 GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 5;,
c1ae78fc2d85e6eca4bb40d9,How many patients had thoracoscopic lobectomy of lung done in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT t.subject_id) FROM (SELECT t.subject_id, t.procedure_date FROM (SELECT t.subject_id, DATE '2100-01-01' AS procedure_date FROM thoracoscopic_lobectomy_of_lung t GROUP BY t.subject_id HAVING MIN(procedure_date) = DATE '2100-01-01') AS t GROUP BY t.subject_id) AS t;",
bd3f5f6c3bbd8425f3cceaf4,What was the last time in 03/this year patient 10019777 had the maximum absolute monocyte count.,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute monocyte count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(AbsoluteMonocyteCount) FROM (SELECT Monocytes FROM Patient WHERE Patient.Id = 10019777 AND Monocytes.MeasurementDate BETWEEN '2003-01-01' AND '2003-12-31'),[]
5067e04f2073e7595e4a57ad,When did patient 10039708 receive the last blood culture microbiology test during the first hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiology.blood_culture FROM microbiology WHERE microbiology.patient_id = 10039708 AND NOT microbiology.blood_culture IS NULL ORDER BY microbiology.blood_culture DESC LIMIT 1,[]
09c4726f77bd8073eeb8d985,Calculate the number of medicines that patient 10015860 was prescribed since 10/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'","SELECT COUNT(*) FROM medicines WHERE medicines.patient_id = 10015860 AND STRFTIME('%y-%m', medicines.date) >= '2100-10'",[{'COUNT(*)': 644}]
ffbd9d197177ca7b317f66cb,Can I know the total output amount for patient 10039997 since 04/16/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-16'",SELECT SUM(output_amount) FROM output WHERE patient_id = 10039997 AND output_date >= '2004-04-16',[{'SUM(outputevents.value)': 5735.0}]
c99ab73b237415f36d5185ab,Reveal the three most frequently prescribed medications during this year.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.name FROM (SELECT medication.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM medication WHERE DATETIME(medication.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY medication.name) AS t1 WHERE t1.c1 <= 3;",[]
bf8467e0d8948ac0db8f7fa1,"What are the three most frequently taken specimens for patients diagnosed with spinal stenosis, lumbar region, without neurogenic claudication previously within 2 months, in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'spinal stenosis, lumbar region, without neurogenic claudication' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.name, specimen, specimen_date FROM specimen JOIN patient ON specimen.patient_id = patient.patient_id WHERE STRFTIME('%y', specimen_date) = '2100') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.specimen_date AND DATETIME(t2.specimen_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month')",
341d7a85d3366d8be3f55673,"Among patients who were administered fluoroscopy of superior vena cava using other contrast, guidance in 2100, what were the top three most common treatments that they received within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'other contrast' AND STRFTIME('%y', treatment.treatmenttime) = '2100') AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'fluoroscopy of superior vena cava' AND STRFTIME('%y', treatment.treatmenttime) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.treatmenttime AND DATETIME(t2.treatmenttime) BETWEEN DATETIME(t1.treatmenttime) AND DATETIME(t1.treatmenttime, '+2",
6fa5f1bd8164edcb10243287,What is the ward id that patient 10278 may be admitted?,,SELECT SUM(ward_id) FROM admissions WHERE patient_id = 10278,
890eb501221e32541f524d63,What are the three most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]"
f294c7fe72b5826f97ff068a,Can you tell me the average respiratory rate for patient 10018501's body in their first ICU visit?,SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ),SELECT AVG(respiratory_rate) FROM icu_visits WHERE icu_visits.patient_id = 10018501 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.in_time NULLS FIRST LIMIT 1,[{'AVG(chartevents.valuenum)': None}]
4eafb35434eb46de4c718a26,What was the name of the drug which was prescribed to patient 10020740 within 2 days after having received a endoscopic removal of stone(s) from biliary tract procedure since 9 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic removal of stone(s) from biliary tract' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-9 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-9 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT patient.id FROM patient WHERE patient.id = 10020740) AS t1 JOIN (SELECT patient.id, prescription.name FROM prescription JOIN patient ON prescription.patientId = patient.id WHERE date(prescription.date) >= date(current_date, '-9 month')) AS t2 ON t1.id = t2.patient WHERE t1.id = t2.patient AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
ee73ce9db61eca17bccfc7ee,Does patient 57050 have a past overseas travel experience?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_id = 57050 AND patients.past_overseas_travel = 'yes',
d5331cbc78765c496545988f,Retrieve the top four most common lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT lab_test, COUNT(lab_test) FROM lab_results GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 4;","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
9a6863fb555783adad183af6,Has patient 10006580 undergone any laboratory tests since 13 months ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(labevents.charttime) >= datetime(current_time,'-13 month')","SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10006580 AND DATETIME(lab_tests.test_date) >= DATETIME(CURRENT_TIME, '-13 month')",[{'COUNT(*)>0': 1}]
cfc537434f52b06b620d9254,What is the minimum total expenditure of a hospital that involves the medication clarithromycin since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'clarithromycin' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(expenditure) AS c1 FROM medication WHERE medication = 'clarithromycin' AND year >= 2100 GROUP BY patient_id) AS t1,
11bbd36c75760dc9c37a98e7,"What was the maximum value of patient 10038999's total protein, pleural since 03/2100?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, pleural' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'",SELECT MAX(protein_pleural) FROM patient WHERE patient_id = 10038999 AND measurement_date >= '2000-03-2100',[{'MAX(labevents.valuenum)': None}]
98703366748022f38c396dfa,How much is the difference of patient 10027602's heart rate second measured on the last ICU visit compared to the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT HEART_RATE FROM patient 10027602 WHERE NOT patient 10027602.ICU IS NULL ORDER BY patient 10027602.ICU DESC LIMIT 1) - (SELECT HEART_RATE FROM patient 10027602 WHERE NOT patient 10027602.ICU IS NULL ORDER BY patient 10027602.ICU DESC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
bb88168bfe852b10ec4208d8,How many patients since 2100 left the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT(*) FROM patients WHERE NOT left_hospital_date IS NULL AND STRFTIME('%y', left_hospital_date) >= '2100';",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
306f0ab7b65335f49a4bfc03,What was patient 10029291's insurance name on their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance_name FROM patient WHERE patient.patient_id = 10029291 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay DESC LIMIT 1,[{'insurance': 'Medicare'}]
09b0a7c875a861f6dca89576,What is patient 10011398's difference in heart rate from the value measured at 2100-12-27 10:00:00 compared to the value measured at 2100-12-27 09:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' ),SELECT (SELECT heart_rate FROM patient_heart_rate WHERE patient_id = 10011398 AND measurement_time = '2100-12-27 10:00:00') - (SELECT heart_rate FROM patient_heart_rate WHERE patient_id = 10011398 AND measurement_time = '2100-12-27 09:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' )"": None}]"
14b3bbee2a55aa5ae2fdf038,What's the maximum total cost of a hospital that involves type 2 diabetes mellitus with diabetic polyneuropathy?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with diabetic polyneuropathy' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(t1.total_cost) FROM (SELECT SUM(diabetic_cost) AS total_cost FROM diagnoses WHERE diagnosis_name = 'TYPE 2 DIABETICS' INTERSECT SELECT SUM(diabetic_cost) AS total_cost FROM diagnoses WHERE diagnosis_name = 'MELLITUS WITH DIABETIC POLYNEURPATHTY') AS t1,
5d5d324fca23706de226e43a,"First time, what drug was prescribed for patient 10014729 since 02/2100?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10014729 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-02' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[{'drug': 'Milk of Magnesia'}]
5542edc6eab94af30e250d96,What was the name of the drug that in the last hospital encounter patient 10038992 was first prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT,[{'drug': 'Sodium Chloride 0.9%  Flush'}]
8cdc13df0df6b0ba2bfeed8c,I want to know the ward id that patient 1784 can go in and get in?,,SELECT ward_id FROM patient WHERE patient_id = 1784,
f46e8931e74e00facf2ddbd7,Could you tell me how many patients stayed in the neuro surgical intensive care unit (neuro sicu) careunit during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro surgical intensive care unit (neuro sicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient) FROM neuro_surgical_intensive_care_unit neuro_sicu WHERE neuro_sicu.unit_type = 'neuro surgical intensive care unit (neuro sicu)' AND DATETIME(neuro_sicu.stay_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
0d3e4b5300ddd4eb6f8b7629,Tell me the total number of patients in neurology.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' ),"SELECT COUNT(DISTINCT patient_id) FROM patients WHERE treatment_category = ""neurology""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4d42e61430e34d4e1be887dc,What was the organism found in the first mrsa screen test of patient 10020740 since 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT organism FROM screens WHERE patient_id = 10020740 AND screen_date >= ""2000-05-21"" ORDER BY screen_date NULLS FIRST LIMIT 1",[]
6b877eb6c1fe51cbc74bc649,How many times was midazolam prescribed during the last year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",,[{'COUNT(*)': 0}]
2e778bf667b5fbe90f44ef33,"Has patient 10040025 been prescribed with the medication clonidine patch 0.2 mg/24 hr, avapro, or spironolactone?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND prescriptions.drug IN ( 'clonidine patch 0.2 mg/24 hr', 'avapro', 'spironolactone' )","SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 10040025 AND patients.prescriptions = (SELECT prescriptions FROM prescriptions WHERE prescriptions.drug_name = 'clonidine patch 0.2 mg/24 hr, avapro, or spironolactone')",[{'COUNT(*)>0': 0}]
f375194eb5908ee511e720c4,"What was the first reticulocyte count, automated value during the last month for patient 10039708?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'reticulocyte count, automated' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(reticulocyte_count) FROM lab_data WHERE lab_data.patient_id = 10039708 AND lab_data.type = 'automated' AND DATETIME(lab_data.date) >= DATETIME(CURRENT_DATE, '-1 month')",[]
4562721f05a7c2b2666b8324,When was the last time that patient 10029291 in their last ICU visit had a mean blood pressure that was greater than 110.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 110.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(mean_blood_pressure) FROM (SELECT mean_blood_pressure FROM icu WHERE icu.patient_id = 10029291 AND NOT icu.outgoing) AS last_icu_data WHERE last_icu_data.mean_blood_pressure > 110.0,[]
9d188dcdbafa3802c326bff0,Do you know the ward id of patient 31854 to which they are admitted?,,SELECT wardid FROM admissions WHERE patientid = 31854,
032dbf61616563e773c37078,"During this year, what are the top three most common medications prescribed during the same month to the patients aged 60 or above after they were diagnosed with leukocytosis, unspecified?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'leukocytosis, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id FROM patient WHERE patient.age >= 60) AS t1 JOIN (SELECT patient.id, medication.name FROM medication JOIN patient ON medication.patient = patient.id WHERE diagnosis = 'leukocytosis, unspecified') AS t2 ON t1.id = t2.patient WHERE DATETIME(t2.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 3",
6e94c2a9ff1a11c41777ecf8,How much heparin was prescribed to patient 10036156 last since 05/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug = 'heparin' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT COUNT(DISTINCT heparin) FROM medications WHERE medications.patient_id = 10036156 AND STRFTIME('%y-%m', medications.date) >= '2100-05'",[]
0aab4dbdaf2cafdd4466a80a,Could you list the three most common specimen tests carried out?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
2cf073ab2616ed40e6caa63d,Which medication was patient 10004235 prescribed during the same hospital encounter following the simple excision of other lymphatic structure procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.name FROM (SELECT patient.name, procedure.date FROM procedure JOIN patient ON procedure.patient = patient.patient WHERE patient.patient = 10004235 AND procedure.name = 'simple excision of other lymphatic structure') AS t1 JOIN (SELECT patient.name, medication.name FROM medication JOIN patient ON medication.patient = patient.patient WHERE patient.patient = 10004235) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of hour') = DATETIME(t2.date, 'start of hour')",
65e654ff18e5887458e5aa25,Could you tell me the three most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS test_rank FROM (SELECT patient.uniquepid, microbiology.test_date FROM microbiology JOIN patient ON microbiology.patientid = patient.uniquepid) AS t1 JOIN (SELECT test_name, COUNT(*) AS test_count FROM microbiology GROUP BY test_name) AS t2 ON t1.test_date = t2.test_date) AS t3 WHERE t3.test_rank <= 3;","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
9628d71c349327c8e53e3df4,Could you provide me with the three most frequent output events this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT Event, COUNT(Event) FROM brackets.output WHERE Event IN (SELECT Event FROM brackets.output GROUP BY Event ORDER BY COUNT(Event) DESC LIMIT 3) GROUP BY Event",[]
bb9f9e41ece52e577d67ea85,Is there a code that matches icd-11 for male gen inflam dis nec in icd-10?,,SELECT COUNT(*) FROM icu_diagnoses WHERE diagnosis = 'ICD-11 FOR MALE GEN INFLAM DIS NEC IN ICD-10';,
f1e1021aefe5f99b0283d0b0,How much is the maximum total cost of the hospital visits that involve a drug named bisacodyl since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bisacodyl' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE name = 'bisacodyl' AND year >= 2100 GROUP BY visit_id) AS t1,
e1e117c17a8d654329d349cf,Give me the top three most frequent treatments patients received within 2 months after being diagnosed with other abnormal glucose in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal glucose' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, COUNT(t2.treatment) FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Other abnormal glucose' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.id, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE STRFTIME('%y', treatment.treatment_date) = '2100') AS t2 ON t1.id = t2.patient_id WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t2.treatment_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t",
8f2bc494dad4b896a4fa2912,What are the top five most common specimens tested after receiving hemodialysis in the same month in 2100?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT hemodialysis.specimen, COUNT(hemodialysis.specimen) FROM hemodialysis WHERE hemodialysis.month = (SELECT month FROM received_hemodialysis WHERE received_hemodialysis.year = 2100 GROUP BY received_hemodialysis.month ORDER BY COUNT(received_hemodialysis.specimen) DESC LIMIT 1) GROUP BY hemodialysis.specimen ORDER BY COUNT(hemodialysis.specimen) DESC LIMIT 5",
7e545989763b5dd9c6a9df0b,What is the percentile of the anion gap value of 25.0 among patients of the same age as patient 10007818 during their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 25.0","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, MIN(patient.hospital_age) AS c1 FROM patient WHERE patient.hospital_age = (SELECT MIN(hospital_age) FROM patient WHERE patient.age = (SELECT age FROM patient WHERE patient.id = 10007818)) GROUP BY patient.age) AS t1 WHERE t1.age = 25.0",
819929d03e825e64c34b20ad,Tell me about the most common five output events since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT COUNT(DISTINCT ""output"") FROM ""output"" WHERE ""year"" > 2100 GROUP BY ""output"" ORDER BY COUNT(DISTINCT ""output"") DESC LIMIT 1","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
f12b990bb88ff1470ae0fbd2,What was the admission type during patient 10023239's first entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023239 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023239 ORDER BY admissions.admission_date NULLS FIRST LIMIT 1;,[{'admission_type': 'EW EMER.'}]
e238659bcf9847845f0c8f30,Give me patient 10007928's length of stay in days for the last ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT patient.length_of_stay_days FROM patient WHERE patient.patient_id = 10007928 AND NOT patient.icu_start_date IS NULL ORDER BY patient.icu_start_date DESC LIMIT 1;,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.859664352145046}]"
7d6cd973b881473d4b309a26,Provide the count of ICU visits for patient 10022017 last year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(ICU_VISITS) FROM (SELECT ICU_VISITS FROM icu_visits WHERE PATIENT_ID = 10022017) WHERE DATETIME(ICU_VISITS.VISIT_DATE, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}]
77bf5aa2f4ab92df9d557a77,What was the drug name that patient 10037861 was first prescribed through the ih route on the last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT first(drug_name) FROM prescriptions WHERE prescriber_route = 'ih' AND patient_id = 10037861 AND NOT patient_id IS NULL ORDER BY hospital_visit_date DESC LIMIT 1,[]
9dbe9323c793aa4ded67391f,"Tell me the maximum total cost of a hospital visit involving a total nucleated cells, csf lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, csf' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.total_cost) FROM (SELECT SUM(ci.cost) AS total_cost FROM cost_info ci JOIN lab_info li ON ci.lab_id = li.lab_id WHERE li.lab_name = 'total nucleated cells, csf' GROUP BY ci.lab_id) AS t1",
e6fc71341c7764ba95e7f656,What's the cost of a drug known as ranitidine (liquid)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)' ),"SELECT DISTINCT cost FROM drugs WHERE name = ""Ranitidine (Liquid)""",
b081cbc08146d7b9ab265566,Does patient 69761 have a scheduled appointment in another department?,,"SELECT SCHOOL_DEPT, APPOINTMENT_DATE FROM APPOINTMENTS WHERE PATIENT_ID = 69761 AND DEPT_NAME <> 'Cardiology'",
503c5dc62ab633d813594e59,What was the last specimen test given to patient 10007818 during their last hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT specimen_type FROM visit_log WHERE patient_id = 10007818 AND NOT visit_log.dischtime IS NULL ORDER BY visit_log.admittime DESC LIMIT 1;,[{'spec_type_desc': 'BLOOD CULTURE'}]
4bb969590b7a2c2464c7bb44,Tell me the length of time in days for patient 10019172's last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', ICU.OUTTAGE.LASTSTAY) FROM icu WHERE ICU.PATIENT.ID = 10019172 AND NOT ICU.OUTTAGE.LASTSTAY IS NULL","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.4558912040665746}]"
db4af3e1cff04a496f2168cb,"Among patients who underwent excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic since 2100, what were the top four diagnoses they received within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t1.diagnosis FROM (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis LIKE '%excision of right main bronchus, via natural or artificial opening endoscopic%' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t1.",
1f7e6a11b09b66d4eb7904e1,Which drug was the last one prescribed for patient 10037861 since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.drug FROM prescriber WHERE prescriber.patient_id = 10037861 AND STRFTIME('%y-%m', prescriber.date) >= '2100-07' ORDER BY prescriber.date DESC LIMIT 1",[{'drug': 'Influenza Vaccine Quadrivalent'}]
416bb5f6b916ace9fd639fbc,Retrieve patient 10015272's daily average weight on their last hospital visit.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10015272 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime DESC LIMIT 1;,[]
7824e920bc0ac651cb49b706,Which immunocauteries have been used for the last five years?,,"SELECT * FROM brackets WHERE ""immunocautery"" = 'last five years';",
6bffa26dd035a9778fad2e76,Can you confirm what was the last heart rate for patient 10016150?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(heart_rate) FROM vital_signs WHERE patient_id = 10016150;,[]
17c962c6c3323c0e76fe972c,Just a quick look closed bronchial biopsy but how long did it take for patient 28443??????,,SELECT date_closed - date_opened FROM biopsy WHERE patient_id = 28443 AND closure_type = 'closed bronchial biopsy',
0385a3df53040e9eb91837ff,What is the procedure that patient 10007795 received two times?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",SELECT procedures.name FROM procedures WHERE procedures.patient_id = 10007795 GROUP BY procedures.name HAVING COUNT(*) = 2,
5d325bcbd050d7d6eabfcab9,Have any procedures been performed on patient 10019568 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10019568 AND STRFTIME('%y', procedures.date) >= '2100'",
113cd45e55e5ce4b019aad28,What's the total of phenytoin infatab prescriptions since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' AND STRFTIME('%y', prescriptions.date) >= '2100';",[{'COUNT(*)': 0}]
aaf18ebab994cddb6afcd715,"On the first hospital stay, what was the last diagnosis for patient 10038081?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT MAX(diagnoses) FROM (SELECT diagnoses FROM admissions WHERE admissions.subject_id = 10038081 AND NOT admissions.dischtime IS NULL ORDER BY admissions.admittime NULLS FIRST LIMIT 1),
45fcb3df912430805e7d3f94,What was the medication patient 10005817 was prescribed for the last time on the last hospital encounter via the ng route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ng' ORDER BY prescriptions.starttime DESC LIMIT 1,"SELECT ng FROM (SELECT patient.id, medication.date FROM medication JOIN patient ON medication.patient = patient.id WHERE patient.id = 10005817 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1) AS subquery ORDER BY subquery.date DESC LIMIT 1;",[]
5fb41130df29e6ca3349cd41,What is the difference between respiratory rate second measured on the last ICU visit compared to the first value measured on the last ICU visit for patient 10019172?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT (SELECT respiratory_rate FROM icu_respiratory_rate WHERE icu_number = (SELECT MAX(icu_number) FROM icu WHERE patient_id = 10019172) AND measurement_time = ""last visit"") - (SELECT respiratory_rate FROM icu_respiratory_rate WHERE icu_number = (SELECT MAX(icu_number) FROM icu WHERE patient_id = 10019172) AND measurement_time = ""first visit"")","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
f361e5d739050e86c0f5c75f,"On 10/22/this year, what was the average value of the diastolic blood pressure for patient 10031757?","SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '10-22'",SELECT AVG(Diastolic Blood Pressures) FROM this_table WHERE Patient 10031757 AND Date 1022 = 10 AND Time 1022 = 11,[{'AVG(chartevents.valuenum)': None}]
781a848c0f1a072d4667722d,Is patient 21074 subject to tests involving covid-19?,,SELECT COUNT(*) > 0 FROM tests WHERE tests.patient_id = 21074 AND tests.covid_19_involved = 'true',
653d08c20f74e5bc126dbcac,"Get me the top five most frequent medications that patients were prescribed with during the same month after being diagnosed with personal history of other endocrine, nutritional and metabolic disease.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other endocrine, nutritional and metabolic disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Personal history of other endocrine, nutritional and metabolic disease') AS t1 JOIN (SELECT patient.id, medication.medication, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.id) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_date, 'start of month') GROUP BY t2.medication) AS t3 WHERE t3.c1 <= 5",
c62375c94b9f079a0f6c7c91,When was the first time when patient 10020187 was prescribed 0.9% sodium chloride and levetiracetam at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10020187 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levetiracetam' AND admissions.subject_id = 10020187 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",SELECT MIN(prescription_date) FROM prescriptions WHERE prescriptions.patient_id = 10020187 AND prescriptions.drug_name = '0.9% sodium chloride' AND prescriptions.drug_name = 'levetiracetam',[]
ad87f821d1417e88606b21d0,What are the five most commonly diagnosed diagnoses for patients who had previously received laparoscopic lysis of peritoneal adhesions within 2 months in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic lysis of peritoneal adhesions' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE treatment.treatment_date BETWEEN '2100-01-01' AND '2100-12-31' AND treatment.diagnosis = 'laparoscopic lysis of peritoneal adhesions') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.id = t2.id WHERE t1.treatment_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) BETWEEN",
85d696e2a18d54f7bdd92de8,What was the last instance when the respiratory rate of patient 10018501 was less than 35.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 35.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(respiratory_rate) FROM patient WHERE patient.id = 10018501 AND respiratory_rate < 35.0,[]
b6ac0c7fa5f88067047b90e0,When was the last time patient 10004720 had the maximum ptt since 12/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1","SELECT MAX(ptt) FROM patient WHERE patient.id = 10004720 AND STRFTIME('%y-%m', ptt) >= '2100-12'",[]
238589d4d2a414a0aa04c9b5,Can you tell me about patient 10000032's age during the first hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,"SELECT demographics.age FROM demographics WHERE demographics.patient_id = ""10000032"" AND NOT demographics.dischtime IS NULL ORDER BY demographics.admittime NULLS FIRST LIMIT 1",
b9dd894208060adb71afcbfc,What was the drug first prescribed to patient 10013049 in the first hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug_name FROM prescriptions WHERE prescriptions.patient_id = 10013049 AND NOT prescriptions.hospital_id IS NULL ORDER BY prescriptions.date_prescribed NULLS FIRST LIMIT 1;,[{'drug': '5% Dextrose'}]
adfe9182219ecbbfa21f841f,Tell me the name of the output patient 10004235 had for the first time on 03/24/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-24' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM outputs WHERE patient_id = 10004235 AND date = '03/24/2016' ORDER BY date NULLS FIRST LIMIT 1,[]
eeac21ba672f8b7b97fbede4,Can you tell me when the first microbiology test for patient 10027445 was held since 16 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT MIN(microbiology_date) FROM microbiology WHERE patient_id = 10027445 AND date_sub('month', microbiology_date, CURRENT_TIMESTAMP) >= 16",[{'charttime': '2142-07-31 06:07:00'}]
d83c205b14f14e3bcf90bd5a,What are the four most frequently administered procedures for patients aged 20s in this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.ClinicalSetting, t1.Admissions, t2.Frequency FROM (SELECT t1.ClinicalSetting, t1.Admissions FROM (SELECT COUNT(DISTINCT Admissions) AS Admissions FROMBrackets WHERE Age BETWEEN 20 AND 29 GROUP BY ClinicalSetting) AS t1 JOIN (SELECT COUNT(DISTINCT Admissions) AS Frequency FROMBrackets WHERE Age BETWEEN 20 AND 29 AND DATETIME(CURRENT_TIME, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.Admissions = t2.Admissions GROUP BY t1.ClinicalSetting ORDER BY t2.Frequency DESC LIMIT 4",
5a676f9bd9eb81f901577ab1,Tell me the price of diazepam.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'diazepam' ),SELECT price FROM products WHERE name = 'diazepam',
db74cd1a2f794e17f35ddec4,When was patient 10021666 last mrsa screen microbiologic test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(mrsa_screen_date) FROM lab_data WHERE patient_id = 10021666,[]
5cd6bddbc341bdc7d39bab2f,When did on their first hospital visit patient 10038933 take the first microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT MIN(MicrobiologyDate) FROM Microbiology WHERE Microbiology.PatientID = 10038933 AND NOT Microbiology.Date IS NULL,[{'charttime': '2148-09-10 15:29:00'}]
7b58a0880a46238d4e9722c0,What to prepare for the pulmon art wedge monitor procedure?,,SELECT * FROM procedures WHERE procedure_name = 'pulmon art wedge monitor';,
48d5f819ed7042b8dca4b7e5,How many days elapsed since patient 10004733 received his red blood cells lab test for the last time in the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT COUNT(DISTINCT t1.c1) FROM (SELECT datetrunc('day', lab.labresultdate) as c1 FROM lab WHERE lab.patientid = 10004733 AND lab.labresulttype = 'red blood cells') as t1 WHERE t1.c1 = (SELECT datetrunc('day', current_date) FROM patient WHERE patient.patientid = 10004733 AND patient.hospitaldischdate IS NULL);",[]
c1ead7f66a477b8a69f1baea,Patient 10009628's hyaline casts second measured on the last hospital visit is less than the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, hyaline_casts.measured_value FROM admissions JOIN hyaline_casts ON admissions.admission_id = hyaline_casts.admission_id WHERE admissions.subject_id = 10009628 AND NOT admissions.dischtime IS NULL ORDER BY admissions.admittime DESC LIMIT 1) AS t1 JOIN (SELECT admissions.subject_id, hyaline_casts.measured_value FROM admissions JOIN hyaline_casts ON admissions.admission_id = hyaline_casts.admission_id WHERE admissions.subject_id = 10009628 AND NOT admissions.dischtime IS NULL ORDER BY admissions.admittime DESC LIMIT 1) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.measured_value < t2.measured_value","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
a40106b94aad93108e39fdbe,What was the drug prescribed to patient 10031757 for the first time via po route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT po FROM prescriptions WHERE patient_id = 10031757 ORDER BY prescription_date NULLS FIRST LIMIT 1;,[]
fcd6e9ee48fbda60a4afb671,Has patient 10039831 taken a or colloid intake drug since 12/29/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-29'","SELECT COUNT(*) > 0 FROM intake WHERE intake.patient = 10039831 AND intake.drug = 'or colloid' AND STRFTIME('%y-%m-%d', intake.date) >= '2100-12-29'",[{'COUNT(*)>0': 0}]
3df2ee46a071840f122d563f,"What's the minimum total cost of a hospital that involves other and unspecified alcohol dependence, in remission in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM hospital WHERE disease = 'other and unspecified alcohol dependence' AND remission = '2100' GROUP BY hospital.id) AS t1,
6349f71964ff7e144cdd2cba,Retrieve the top four most common lab tests since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT lab_test, COUNT(lab_test) FROM lab_tests WHERE date > CURRENT_DATE - INTERVAL '1 year' GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 4;","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
76c3866059784b87210a1f13,What was the total amount of input for patient 10015931 since 07/04/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04'",SELECT SUM(input) FROM input WHERE patient = 10015931 AND date >= '2100-07-04',[{'SUM(inputevents.totalamount)': 57765.0}]
bc08d5ab35121023062e0264,What was the drug that patient 10004235 was prescribed for in the same hospital encounter after the procedure of laparoscopic cholecystectomy in 07/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.uniquepid, procedure.date FROM procedure JOIN patient ON procedure.patient_id = patient.uniquepid WHERE patient.uniquepid = 10004235 AND procedure.date = '2100-07-21') AS t1 JOIN (SELECT patient.uniquepid, drug.drug FROM drug JOIN patient ON drug.patient_id = patient.uniquepid WHERE patient.uniquepid = 10004235 AND drug.date = '2100-07-21') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of hospital') = DATETIME(t2.date, 'start of hospital')",
83f52912d78ee9b03c4a66a7,"Did patient 10018423 have a introduction of other therapeutic substance into heart, open approach on the first hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",SELECT COUNT(*) > 0 FROM introductions WHERE introductions.patient_id = 10018423 AND introductions.therapeutic_substance = 'other therapeutic substance' AND NOT introductions.heart_open_approach IS NULL ORDER BY introductions.date DESC LIMIT 1,[{'COUNT(*)>0': 0}]
f224a6e013d318ebe61083f8,What was the drug first prescribed to patient 10039708 in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10039708 AND STRFTIME('%y-%m', prescriptions.date) = '2100-11' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[]
2dfbec4e54ac5d6edf34216d,What was patient 10002495's first measured rdw-sd in 06/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(RDW_SD) FROM patient WHERE patient.id = 10002495 AND DATETIME(RDW_SD, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', RDW_SD) = '06'",[]
9fec7adf6776835d66f06d90,What specimen test has patient 10038999 received for the last time since 06/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_test FROM received_specimens WHERE patient_id = 10038999 AND date_received >= '2000-06-2100' ORDER BY date_received DESC LIMIT 1,[{'spec_type_desc': 'PLEURAL FLUID'}]
a8e86dcf95b5f3203f351589,What was the total number of drugs patient 10039997 was prescribed during their first hospital encounter?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) FROM drugs WHERE drugs.patient_id = 10039997 AND NOT drugs.prescription_date IS NULL ORDER BY drugs.prescription_date NULLS FIRST LIMIT 1;,[{'COUNT(*)': 45}]
60460642bc6fa663ac944b18,What kind of diagnosis did patient 10019385 receive last since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT MAX(diagnosis_date) FROM diagnoses WHERE patient_id = 10019385 AND STRFTIME('%y', diagnosis_date) >= '2100'",
26ce902d74db9f732e88776c,What was the total number of patients staying in hematology/oncology since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient_id) FROM hematology_oncology WHERE stay_duration > '1 year',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f9adfa5449b4f14c535921e5,Has any free water medication been given to patient 10018081 since 1 day ago?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-1 day')","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10018081 AND medication.type = 'free water' AND DATETIME(medication.date) >= DATETIME(CURRENT_TIME, '-1 day')",[{'COUNT(*)>0': 0}]
0f4c478ccc115578767ec3fb,When was patient 10004733 last given an input since 03/10/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-10' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(INPUT_DATE) FROM INPUT_TABLE WHERE PATIENT_ID = 10004733 AND INPUT_DATE >= '2100-03-10',[{'starttime': '2174-12-12 18:00:00'}]
2ca6827b5997d6850fe15912,Has patient 10007058 got a lab test during this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10007058 AND DATETIME(lab_tests.test_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
949e6e0fe8bdf465a1964e73,How was patient 10005348 first admitted to the hospital in terms of admission type?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005348 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT MIN(admission_type) FROM admissions WHERE patient_id = 10005348,[{'admission_type': 'ELECTIVE'}]
1a8c4898fa6341d62be1f722,What was the name of the last medication that was prescribed to patient 10031757 since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT medication_name FROM prescriptions WHERE patient_id = 10031757 AND date_prescribed >= '07/2100' ORDER BY date_prescribed DESC LIMIT 1,[{'drug': 'Potassium Chloride (Powder)'}]
36961c041d723a40cd3af9bc,"How many instances of lumbar and lumbosacral fusion of the posterior column, posterior technique procedures have been completed?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'lumbar and lumbosacral fusion of the posterior column, posterior technique' )","SELECT COUNT(*) FROM procedures WHERE procedures.technique = 'lumbar and lumbosacral fusion of the posterior column, posterior technique';",[{'COUNT(*)': 0}]
7c25dcee711f95e8760994eb,What are the ways to consume caphosol?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'caphosol',SELECT DISTINCT caphosol FROM food WHERE consumption_mode = 'brackets',[]
48a5e161532f3acc6752f577,Tell me the top three most prevalent procedures for patients aged 20s in this year.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Name FROM (SELECT procedures.Name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM procedures WHERE procedures.age BETWEEN 20 AND 29 AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY procedures.Name) AS t1 WHERE t1.c1 <= 3",
74d964eb743c57b2e97f9876,Have any diagnoses been made for patient 10003400 since 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10003400 AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100'",
073c3923948729f403a5e5a3,Can you tell me patient 10031404's daily maximum weight since 2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10031404 AND date >= 2100 GROUP BY date,[]
3c79d8c37eae0b006674c9c6,Count the number of patients who took glucose gel since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucose gel' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.patienttype = 'glucose gel' AND DATETIME(patient.startdate) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
cac51b303e4b48200febb2a0,Could you provide the total volume of output for patient 10035185 since 02/02/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-02'",SELECT SUM(output_volume) FROM output WHERE patient_id = 10035185 AND output_date >= '2100-02-02',[{'SUM(outputevents.value)': 3905.0}]
3890e55b1b0c07ff2b11bb35,How many hours have it been since patient 10039831 had received a ptt laboratory test during this hospital encounter for the last time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab.date)) FROM lab WHERE lab.patient = 10039831 AND lab.type = 'ptt' AND lab.date BETWEEN (SELECT date FROM lab WHERE lab.patient = 10039831 AND lab.type = 'ptt' ORDER BY lab.date DESC LIMIT 1) AND (SELECT date FROM lab WHERE lab.patient = 10039831 AND lab.type = 'ptt' ORDER BY lab.date DESC LIMIT 1)",[]
d5306618a151094326d339bc,What was the total foley volume that patient 10026354 had since 10/04/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04'",SELECT SUM(Foley) FROM intake WHERE Patient_ID = 10026354 AND Date >= '2100-10-04',[{'SUM(outputevents.value)': None}]
5750149e3e7fafb11a1a5090,Can you list patient 10037975's daily maximum weight during the first hospital encounter?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10037975 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1;,[]
d6dcd3648703a4fe15c42513,Have any lab tests been performed on patient 10008287 in 10/this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'",SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10008287 AND lab_tests.date = '10/this year',[{'COUNT(*)>0': 0}]
fb25b72d8fbcca4ca0b23169,What is the cost of a closed fracture of lumbar vertebra without mention of spinal cord injury diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of lumbar vertebra without mention of spinal cord injury' ) ),"SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = ""CLOSED FRACTURE OF LUMBAR VERTEBRA WITHOUT MENTION OF SPINAL CORD INJURY""",
a6e53a5c90ec55b54a024a95,When are dr. young's rounds and procedures?,,"SELECT r.round, r.procedure, r.round_start_time, r.round_end_time, p.age, p.weight, p.height, p.weight, p.height, p.weight FROM rounds AS r JOIN procedures AS p ON r.procedure = p.procedure_id WHERE r.round = 'dr. young'",
1d3f884b7931238b1dbb1779,Show me the top three most common diagnoses of patients with age 40s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT diagnosis FROM diagnoses WHERE age BETWEEN 40 AND 49) AS t1 JOIN (SELECT diagnosis FROM diagnoses WHERE age BETWEEN 40 AND 49) AS t2 ON t1.diagnosis = t2.diagnosis WHERE DATETIME(t1.date, 'start of year') = DATETIME(t2.date, 'start of year') GROUP BY t1.diagnosis ORDER BY COUNT(t1.diagnosis) DESC LIMIT 3;",
0abf006890a1a4993c0e275b,Give me patient 10023239's total d5lr input since 230 days ago.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-230 day')",SELECT SUM(d5lr) FROM input WHERE patient = 10023239 AND date >= CURRENT_DATE - INTERVAL '230 day',[{'SUM(inputevents.totalamount)': None}]
0994bfb0d80d586c3e6b991b,How much is the average total cost of a hospital that involves a drug named amitriptyline in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost <> 0 AND date BETWEEN '2100-01-01' AND '2100-12-31' AND drug = 'amitriptyline' GROUP BY cost) AS t1,
861a7b73edbd60ca44e59f7c,"How many patients with candidal stomatitis were diagnosed in the same month after previously being diagnosed with anxiety disorder, unspecified in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anxiety disorder, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidal stomatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'candidal stomatitis' AND STRFTIME('%y', diagnosis_date) = '2100') AS t1 JOIN (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'anxiety disorder, unspecified' AND STRFTIME('%y', diagnosis_date) = '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month')",
af7b45da0507ce22b22901c2,Tell me the insurance plan in place for patient 10000032 on the first hospital encounter.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,"SELECT insurance_plan FROM (SELECT patient_id, encounter_id, insurance_plan FROM (SELECT patient_id, encounter_id, NULL FROM patient_insurance WHERE patient_id = 10000032) AS T1 JOIN (SELECT patient_id, encounter_id, NULL FROM patient_insurance WHERE patient_id = 10000032 AND NOT encounter_id IS NULL ORDER BY encounter_id NULLS FIRST LIMIT 1) AS T2 ON T1.patient_id = T2.patient_id AND T1.encounter_id = T2.encounter_id) AS T3 WHERE T3.insurance_plan IS NOT NULL",[{'insurance': 'Other'}]
d9d32742eb8e9436fd593092,What is a drug that should not be administered during cont inv mec ven 96+ hrs?,,"SELECT ""drug"" FROM ""contract"" WHERE ""event"" = 'cont inv mec ven 96+ hrs'",
31fc326ca001513cb405a126,What are the newly prescribed drugs for patient 10039831 today compared to those prescribed yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM drugs WHERE patient_id = 10039831 AND date = '2022-01-01' EXCEPT SELECT * FROM drugs WHERE patient_id = 10039831 AND date = '2022-01-01' - INTERVAL '1 day';,[]
6cd24d0a30123968e0158324,"For the last time since 2100, what was patient 10006580 diagnosed with?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",SELECT diagnosis FROM patients WHERE patient_id = 10006580 AND date_since >= 2100,
bca05145ac82b49ae8acc4b4,What's the count of patients who left the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE date_left >= '2100-01-01';,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
773553bf367568bb392e4143,How many patients stayed at the trauma sicu (tsicu) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'trauma sicu (tsicu)' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, events.year FROM admissions JOIN events ON admissions.admission_id = events.admission_id WHERE events.type = 'trauma sicu (tsicu)' AND STRFTIME('%y', events.year) >= '2100') AS t1",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
1d64d81dcd56c92b92cf34ad,Did patient 10021938 have any diagnoses during the first hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10021938 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
3ab088d1de4a0ae537c766a2,What was the last time that patient 10004733 had a minimum heart rate on this month/30?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM vital_signs WHERE patient_id = 10004733 AND measurement_time BETWEEN '2022-03-30 00:00:00' AND '2022-03-30 23:59:59',[]
a5f1e48fb3c060e9e95251f2,"Total number of patients who had drainage of peritoneal cavity, percutaneous approach in 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id FROM (SELECT patient_id FROM patients WHERE birthdate BETWEEN '1990-01-01' AND '1990-12-31') AS t1 JOIN (SELECT patient_id FROM procedures WHERE procedure_date BETWEEN '2000-01-01' AND '2000-12-31' AND procedure_type = 'drainage of peritoneal cavity, percutaneous approach') AS t2 ON t1.subject_id = t2.patient_id WHERE STRFTIME('%y', t2.procedure_date) = '2100'",
f0220d6aa14301805fc7e420,Is that patient 15945 has an appointment in another department?,,SELECT COUNT(*) FROM appointment WHERE appointment.patient_id = 15945 AND appointment.department_id <> (SELECT department_id FROM patient WHERE patient.patient_id = 15945),
b91fff10d613c5660031b070,Tell me the dose of an opioid prescribed to patient 13897?,,SELECT SUM(dose) FROM prescriptions WHERE prescriptions.patient_id = 13897 AND prescriptions.drug_category = 'opioid',
efc40de8a506d0e04de52dd0,When and where are the rounds and procedures of dr. coburn?,,"SELECT DATE('1992-03-07'), ROUND(1.5, 2) FROM DrCoburn;",
4862ed4025ee2b4c353f6545,How much is the minimum total hospital cost with other cysts of jaws since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cysts of jaws' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost.year >= 2100 AND cost.description = 'other cysts of jaws' GROUP BY cost.year) AS t1,
f21b3abcfb7c410d3b31bc30,Number of patients who were diagnosed with multiple myeloma not having achieved remission.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'multiple myeloma not having achieved remission' ) ),"SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM diagnoses WHERE diagnosis = ""MULTIPLE MYELOMA"") AS t1 JOIN (SELECT subject_id, date_remitted FROM remissions WHERE remission_date IS NOT NULL) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date < t2.date_remitted",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
8419db544e116248cf67bf17,Count the number of patients who had their nucleated red cells tested in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'nucleated red cells' ) AND strftime('%Y',labevents.charttime) = '2100' )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.nucleated_red_cells IS NOT NULL AND STRFTIME('%y', patient.nucleated_red_cells_date) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
cc7cd55d5065328b8c5164e1,What amount of neostigmine has been prescribed to patient 10011398 for the first time since 01/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.drug = 'neostigmine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT neostigmine FROM prescriptions WHERE patient_id = 10011398 AND date_prescribed >= '2000-01-2100' ORDER BY date_prescribed NULLS FIRST LIMIT 1;,[]
f3adc97fcfd46233a705b0b8,What was patient 10007818's first peritoneal fluid's microbiology test time during their first hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT MIN(peritoneal_fluid_microbiology_time) FROM microbiology_data WHERE microbiology_data.patient_id = 10007818 AND MIN(peritoneal_fluid_microbiology_time) IS NOT NULL GROUP BY patient_id,[]
2bc57e6b3e44d9ecf6f1c242,When did patient 10016742 get their last input?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) ORDER BY inputevents.starttime DESC LIMIT 1,SELECT input_date FROM input_table WHERE patient_id = 10016742 ORDER BY input_date DESC LIMIT 1;,[{'starttime': '2178-07-25 14:05:00'}]
a14b794e12f6637f98c72ade,"Among patients aged 40s , what are the top three most common diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT * FROM patients WHERE age BETWEEN 40 AND 49) AS t1 JOIN (SELECT * FROM diagnoses) AS t2 ON t1.diagnosis = t2.diagnosis GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 3",
f5b78cf9f326f6c6ae745067,How many patients were discharged from the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT date_discharged IS NULL AND STRFTIME('%y', date_discharged) = '2100';",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
381c1509334fff03b367f5e0,When did patient 10035185 have a base excess lab test for the first time in 05/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.charttime ASC LIMIT 1","SELECT lab.date FROM lab WHERE lab.patient = 10035185 AND lab.lab_name = 'base excess' AND STRFTIME('%y-%m', lab.date) = '2100-05' ORDER BY lab.date NULLS FIRST LIMIT 1",[]
7d56993bcf3d2b526fae33a7,"In 04/2100, did patient 10007928 undergo a lab test?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',labevents.charttime) = '2100-04'","SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10007928 AND STRFTIME('%y-%m', lab_tests.date) = '2100-04'",[{'COUNT(*)>0': 0}]
4775d3a9d0fb326081985b5e,How was patient 10031404 admitted in terms of admission type for the first time?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10031404 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT patient.admission_type FROM patient WHERE patient.subject_id = 10031404 ORDER BY patient.admission_date NULLS FIRST LIMIT 1,[{'admission_type': 'URGENT'}]
728bd4f1812fb837f2f3ff6b,What was the first value of a epithelial cells lab test of patient 10016150?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT MIN(lab_value) FROM lab WHERE lab.patient_id = 10016150 AND lab.lab_name = 'epithelial cells',[]
aeb553a68c282c81e16d7c44,Have you seen patient 47460 receiving additional blood (ebv) tests?,,"SELECT COUNT(DISTINCT patient.patient_id) FROM patient WHERE patient.patient_id = 47460 AND patient.additional_blood_tests = ""Extra blood (EBV)""",
f52d83becf30a588f36e34f3,Has any gastric meds been given to patient 10029291 in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*) > 0 FROM input_table WHERE patient_id = 10029291 AND input_date BETWEEN DATEADD(year, -1, DATEADD(month, 12, DATE '1992-09-20')) AND DATEADD(year, -1, DATEADD(month, 12, DATE '1992-03-07'))",[{'COUNT(*)>0': 0}]
08f5481de0c251a808376406,"During the last hospital encounter, what was the insurance plan of patient 10015931?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT policy FROM patients WHERE patient_id = 10015931 AND NOT last_hospital_encounter IS NULL,[{'insurance': 'Medicare'}]
ccc5d12c1c88d7a708f03f70,"What are the four most frequently taken specimens for patients diagnosed with iatrogenic pneumothorax previously in the same month, in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'iatrogenic pneumothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.date FROM (SELECT patient.name, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.diagnosis = 'iatrogenic pneumothorax') AS t1 JOIN (SELECT patient.name, specimen, date FROM specimen JOIN patient ON specimen.patient = patient.name WHERE date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.name = t2.name WHERE t1.date BETWEEN t2.date AND t2.date + INTERVAL '1 month' GROUP BY t3.specimen) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 4",
3b2a3869e8ca4ddc183bfbfe,What is the number of patients that received a thyroxine (t4) test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4)' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patienttype = 'thyroxine (t4)' AND DATETIME(patient.lasttestdate) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4556bf5fa6cf416c4f84dfea,When did patient 10004733 last have a maximum SaO2 on this month/29?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT MAX(SaO2) FROM patient WHERE patient.id = 10004733 AND DATETIME(SaO2, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month') AND STRFTIME('%d', SaO2) = STRFTIME('%d', CURRENT_TIME)",[]
a6c506df1317e23580129055,Does patient 6921 have an overseas history of travel?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.id = 6921 AND patients.history_overseas = 'Yes',
9330e1bf456cb3ad13b7333e,Which are the five most commonly taken lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT lab_test, COUNT(*) FROM lab_results GROUP BY lab_test ORDER BY COUNT(*) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
fe2b896743388c3285fd2973,What's the rank of the top three most common output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT e.event_name, COUNT(e.event_name) FROM (SELECT u.event_name FROM (SELECT a.event_name FROM (SELECT t.event_name FROM (SELECT s.event_name FROM (SELECT n.event_name FROM (SELECT w.event_name FROM (SELECT x.event_name FROM (SELECT 1.event_name FROM (SELECT 2.event_name FROM (SELECT 3.event_name FROM (SELECT 4.event_name FROM (SELECT 5.event_name FROM (SELECT 6.event_name FROM (SELECT 7.event_name FROM (SELECT 8.event_name FROM (SELECT 9.event_name FROM (SELECT 10.event_name FROM (SELECT 11.event_name FROM (SELECT 12.event_name FROM (SELECT 13.event_name FROM (SELECT 14.event_name FROM (SELECT 15.event_name FROM (SELECT 16.event_name FROM (SELECT 17.event_name FROM (SELECT 18.event_name FROM (SELECT 19.event_name FROM (SELECT","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
99ffb7abd20ff1b14fcdae61,Provide the count of hospital visits for patient 10008287 in the previous year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10008287 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(Hospital_Visits) FROM (SELECT HOSP_VISITS FROM (SELECT PATIENT_ID FROM patients WHERE PATIENT_ID = 10008287) AS T1 JOIN (SELECT DATE_FROM FROM (VALUES (CURRENT_DATE - INTERVAL '1 year')) AS T2(DATE_FROM) ON T1.DATE_TO = T2.DATE_FROM) AS T3;,[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
b562038e8a76b7d15b8694eb,What was the organism detected during the last abscess microbiology test of patient 10001217 in the last hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism FROM microbiology_data WHERE patient_id = 10001217 AND organism IS NOT NULL ORDER BY microbiology_date DESC LIMIT 1;,[]
a4aa999285ef6d36e9f1f2b6,When was patient 10019568 prescribed a yellow cadd cassette and bupivacaine 0.1% at the same time for the last time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'yellow cadd cassette' AND admissions.subject_id = 10019568 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bupivacaine 0.1%' AND admissions.subject_id = 10019568 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM (SELECT date_prescribed FROM prescriptions WHERE prescriptions.patient_id = 10019568 AND prescriptions.drug_name = 'Yellow Cadd Cassette') AS t1 JOIN (SELECT date_prescribed FROM prescriptions WHERE prescriptions.patient_id = 10019568 AND prescriptions.drug_name = 'Bupivacaine 0.1%') AS t2 ON t1.date_prescribed = t2.date_prescribed,[]
3fcd3dd1926914800ea40cbb,What was the drug prescribed to patient 10016150 for the last time since 04/2100 via the im route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber FROM prescriptions WHERE patient = ""10016150"" AND route = ""IM"" AND date >= ""2100-04-01"" ORDER BY date DESC LIMIT 1;",[]
b2f9b52ce74d61a7d5f2395b,How many days was patient 10022281's last stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT MAX(days) FROM intake WHERE patient_id = 10022281 AND location = 'intensive care unit',"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.4465393517166376}]"
28a983d2c071ad3739459886,Provide the count of ICU visits for patient 10004733 during this year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(DISTINCT icu_visits) FROM visit_table WHERE patient_id = 10004733 AND visit_date BETWEEN DATE '2022-01-01' AND DATE '2022-12-31';,[{'COUNT( DISTINCT icustays.stay_id )': 0}]
8155288647172c49b5a66196,What was the first output during their first ICU visit for patient 10025612?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),"SELECT STRFTIME(icu.first_visit, '%Y-%m-%d %H:%M:%S') AS first_visit_time",[{'label': 'Foley'}]
a01e64e03c8ea6881cad8b6c,What was the name of patient 10012853's insurance during the last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance FROM patient WHERE patient.hospital_stay_id IN (SELECT patient.hospital_stay_id FROM patient WHERE patient.name = 'John Doe' AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1),[{'insurance': 'Medicare'}]
9bae33f8c355733757e36325,What are the top three diagnoses of patients in their 60 or above since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.uniquepid WHERE diagnosis.age >= 60 AND DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 WHERE t1.c1 <= 3",
42b510fee11c5b77449a9840,What is the maximum total cost of the hospital visits that included injection of anesthetic into spinal canal for analgesia in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection of anesthetic into spinal canal for analgesia' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.total_cost) FROM (SELECT SUM(cost.cost) AS total_cost FROM cost WHERE cost.cost_type = 'hospital visit' AND cost.year = 2100 AND cost.description = 'injection of anesthetic into spinal canal for analgesia') AS t1,
47b3d7f69bda0102d243c44b,Could you provide the top four most common output events in this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT 4 AS _th_year, 'Top Four' AS _output_events FROM brackets WHERE 4 = 'Top Four'",[]
193a8bd008df2bc9ae99adf8,What are the top five most frequently prescribed drugs in this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 5;",[]
e7d1fbad4727f90f548eeaae,How much does patient 10007818 weigh difference last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT weight_diff FROM (SELECT Weight_kg FROM patients WHERE patient_id = 10007818 AND NOT patient_info.hospital_info IS NULL ORDER BY patient_info.hospital_info->>'admission_date' NULLS FIRST LIMIT 1) AS t1 ORDER BY t1.Weight_kg DESC LIMIT 1) - (SELECT weight_diff FROM (SELECT Weight_kg FROM patients WHERE patient_id = 10007818 AND NOT patient_info.hospital_info IS NULL ORDER BY patient_info.hospital_info->>'admission_date' NULLS FIRST LIMIT 1) AS t1 ORDER BY t1.Weight_kg DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
c30028359953f37651a81962,Has patient 10019172 been admitted into the hospital in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019172 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10019172 AND STRFTIME('%y', admissions.admission_date) = '2100'",[{'COUNT(*)>0': 0}]
68abea0b746f09a1730c8a20,Give me the total amount of output since 12/01/2100 for patient 10005817.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-01'",SELECT SUM(output) FROM portals WHERE patient = 10005817 AND date >= '2012-01-2100';,[{'SUM(outputevents.value)': 41303.0}]
06082342b67bc9539dd5dce6,What are the prices for the drug called lidocaine 5% patch?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine 5% patch' ),SELECT COUNT(DISTINCT price) FROM products WHERE product_name = 'lidocaine 5% patch',
77eb3ba985eb3df7b7b03d98,What was the oxycodone-acetaminophen dose that patient 10022281 was last prescribed in 06/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND prescriptions.drug = 'oxycodone-acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.drug_name, date_sub('month', prescriber.date, TIMESTAMP '2000-01-01 00:00:00') as month_supply",[]
362ddfa50f43176eb146320b,"Among patients who underwent excision of other bile duct , what were the top four diagnoses they received within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT t.diagnosis, t.time FROM (SELECT diagnosis, time FROM (SELECT * FROM patient WHERE patient.diagnosis = 'EXACERBATION OF OTHER BILE DUCT') AS t GROUP BY t.diagnosis HAVING MIN(t.time) = t.time) AS t1 JOIN (SELECT t.diagnosis, t.time FROM (SELECT diagnosis, time FROM patient WHERE patient.diagnosis = 'EXACERBATION OF OTHER BILE DUCT') AS t GROUP BY t.diagnosis HAVING MIN(t.time) = t.time) AS t2 ON t1.diagnosis = t2.diagnosis WHERE t1.time < t2.time AND DATETIME(t2.time) BETWEEN DATETIME(t1.time) AND DATETIME(t1.time, '+2 month') GROUP BY t1.diagnosis ORDER BY COUNT(t1.diagnosis) DESC LIMIT 4",
15e6224c6a4f4b69e45e2059,What was the amount of bag that patient 10012853 were prescribed in total in 04/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.drug = 'bag' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'",SELECT SUM(bag) FROM prescriptions WHERE patient_id = 10012853 AND date_prescribed BETWEEN '2000-04-01' AND '2000-04-21',[{'SUM(prescriptions.dose_val_rx)': None}]
72ad619b7c1288429ab0e7e8,Does patient 32163 have any abscess left?,,SELECT COUNT(*) > 0 FROM wound_history WHERE patient_id = 32163 AND wound_type = 'abscess',
acf918458c8addc978e6c8d7,Can you tell me the cost for the procedure called extracorporeal circulation auxiliary to open heart surgery?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ),"SELECT cost FROM procedures WHERE procedure_name = ""Extracorporeal circulation auxiliary to open heart surgery""",
5132adcd87a30d937fa216b4,Can you please share with me the name of the diagnosis that patient 95909 received in the other department?,,SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 95909 AND diagnoses.location = 'other department',
0097bca5984143bf4c458509,What were the top three most common lab tests done this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date_part('year', current_date) = date_part('year', t.date)) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 3",[]
3ba76ddc2f81e4273838d8ae,"What is the average total hospital cost that involved ileostomy, not otherwise specified since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(Total) FROM (SELECT SUM(Cost) AS Total FROM PosteriorIleostomy WHERE Ileostomy = 'not otherwise specified' AND STRFTIME('%y', OperatingDate) >= '2100' GROUP BY OperatingDate) AS T",
3859ca46fafef561a7272be8,Can you tell me patient 10015272's daily maximum weight in this year?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10015272 AND date_assigned TO '2022-01-01' GROUP BY date_assigned;,[]
b60a37507f5ac0a7a99bb5b2,What was the dose of clonidine patch 0.2 mg/24 hr that was first prescribed to patient 10040025 on the last hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'clonidine patch 0.2 mg/24 hr' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(clonidine_patch_0_2_mg_24_hr) FROM prescriptions WHERE prescriptions.patient_id = 10040025 AND NOT prescriptions.had_interactions = true,[]
70419e78d304638558059cf9,"When was the first time patient 10005817, since 12/02/2100, had the maximum systolic blood pressure?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-02' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",SELECT MAX(systolic_blood_pressure) FROM patient_10005817 WHERE date_since = '12/02/2100',[]
315fe7012ff34a06a1448165,Did patient 10009035 receive any solution on 05/12/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '05-12'","SELECT COUNT(*) > 0 FROM patient WHERE patient.patient_id = 10009035 AND DATETIME(patient.date_of_current_treatment, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m-%d', patient.date_of_current_treatment) = '05-12'",[{'COUNT(*)>0': 0}]
82db68532c1fe0fc76c6c017,Calculate the number of hospital visits made by patient 10015272 since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10015272 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT visit_date) FROM hospital_visits WHERE patient_id = 10015272 AND DATETIME(visit_date) >= DATETIME(CURRENT_DATE, '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
ffd78170fcf2def8a4cfe87e,Can you get me the top four most conducted lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT TOP(4) FROM Lab_Tests WHERE Year > 2100 ORDER BY Conducted_Lab_Tests DESC,"[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
f750f0fa41e0b4e4dbe37ba3,Tell me the amount of multivitamins input that patient 10021666 received.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'multivitamins' AND d_items.linksto = 'inputevents' ),SELECT SUM(Multivitamins) FROM input WHERE Patient = 10021666,[{'SUM(inputevents.totalamount)': None}]
74758a7e91cabecd02edc1c8,"What was the name of the drug patient 10021118 was prescribed with within 2 days after having received a performance of cardiac output, continuous procedure in this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.id FROM patient WHERE patient.id = 10021118) AS t1 JOIN (SELECT patient.id, prescriber.drug FROM prescriber JOIN patient ON prescriber.patient_id = patient.id WHERE patient.id = 10021118) AS t2 ON t1.id = t2.patient_id WHERE t2.drug_date > (SELECT patient.date_of_performance FROM patient WHERE patient.id = 10021118 AND patient.performance_type = 'cardiac output, continuous') AND t2.drug_date < (SELECT patient.date_of_performance FROM patient WHERE patient.id = 10021118 AND patient.performance_type = 'cardiac output, continuous') + INTERVAL '2 day')",
4534d3ce04ba517f06d9eeec,"What is the average total hospital cost, which includes other alteration of consciousness since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other alteration of consciousness' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM operations WHERE year >= 2100 GROUP BY patientId) AS t1,
22e1a21fc783d4bd45120187,Could you tell me the first heart rate value that patient 10008454 had on this month/03?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '03' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime(patient.heart_rate, '%f') AS heart_rate_value",[]
ba956e22bb92d02f3abbcb3c,How much does phenytoin infatab cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' ),SELECT DISTINCT phenytoin_infatab FROM brackets;,
fabc6fda184e4c3f17a6f07e,What are the top five most common specimens being tested for patients who were diagnosed with transfusion related acute lung injury (trali) within 2 months since 1 year ago?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'transfusion related acute lung injury (trali)' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT specimen, COUNT(specimen) FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate, patient.patientname, diagnosis.specimen FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate, patient.patientname, diagnosis.specimen FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis LIKE '%transfusion related acute lung injury%') AS T GROUP BY T.uniquepid, T.diagnosisdate) AS T GROUP BY T.specimen ORDER BY COUNT(T.specimen) DESC LIMIT 5",
5ce9e6b643c409ca7510c4f0,How many patients were administered syringe (iso-osmotic dextrose) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'syringe (iso-osmotic dextrose)' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient_id) FROM administration_table WHERE administration_type = 'syringe (iso-osmotic dextrose)' AND date >= '2100-01-01',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
08b21636e8a003182b06159f,When was the first hospital discharge for patient 10035185?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10035185 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(hospital_dischtime) FROM hospital WHERE patient_id = 10035185,[]
1d5758a11b098e86ecfcc86d,What was the total amount of insulin that they prescribed to patient 10012552 in 04/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND prescriptions.drug = 'insulin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'",SELECT SUM(insulin) FROM prescriptions WHERE patient_id = 10012552 AND date_prescribed BETWEEN '2004-01-01' AND '2004-12-31',[{'SUM(prescriptions.dose_val_rx)': None}]
3c902daacd4588721711f210,Give me the top five most commonly prescribed medications.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.name FROM (SELECT prescriptions.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions GROUP BY prescriptions.name) AS t1 WHERE t1.c1 <= 5;","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
11b1d4acc1e68f70deb1fd99,What is the total number of patients who underwent fiber-optic bronchoscopy throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.location = 'fiber-optic bronchoscopy' AND DATETIME(patient.fiber_optic_bronchoscopy_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
bf1e8983b1cc3c09f253f07c,Tell me the top three most commonly prescribed medications.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.name FROM (SELECT prescriptions.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions GROUP BY prescriptions.name) AS t1 WHERE t1.c1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]"
0c6cdc444ee911941bfd23f0,Calculate the number of medicines that patient 10039708 was prescribed during the last month.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10039708 AND DATETIME(medications.date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month')",[{'COUNT(*)': 0}]
e1e75ab26d91e343b7b0ea17,What was the last value of patient 10038933's lab test for glucose in their last hospital encounter?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1,"SELECT lab.glucose FROM (SELECT lab.glucose, lab.patient_id, lab.timestamp_column, patient.hospital_dischtime FROM lab JOIN patient ON lab.patient_id = patient.patient_id WHERE patient.patient_id = 10038933 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1)",[]
16ca0a5e17d4cb11df70a0d0,What was the diagnosis for patient 10015931 the first time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE patient_id = 10015931 ORDER BY diagnosis_date NULLS FIRST LIMIT 1,
8647d1bf21a4ae9c764a0b98,What was patient 10027602's average value of mch in 11/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11'",SELECT AVG(mch) FROM patient_10027602 WHERE date = '11/2100',[{'AVG(labevents.valuenum)': None}]
4ca27aac7d23ace022562d03,What was the first time patient 10020944 received wbc in a lab test on the last hospital stay?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT patient.name, lab.result, lab.date FROM patient WHERE patient.id = 10020944 AND lab.label = 'wbc' ORDER BY lab.date NULLS FIRST LIMIT 1",[]
c0abdf612c0f0fba7baee7ec,Can you inform me of the first neutrophils test result for patient 10002495 in 06/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1",SELECT,[]
b72b79de6cb86da03d64e09c,Was there any diagnosis that patient 10029291 was received in the first hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10029291 AND diagnoses.hospital_encounter_id = 1,[{'COUNT(*)>0': 1}]
1bd7abf7a8f3aefc71dd2357,What was the drug last prescribed to patient 10019568 since 11 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_part('month', current_timestamp)) - date_part('month', prescription_date) AS months_since_prescription",[{'drug': 'HYDROmorphone (Dilaudid)'}]
a762ae81d4a2a3d7d99c19e7,Tell me the amount of total foley that patient 10010471 had since 07/14/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-14'",SELECT SUM(FOLEY) FROM duckdb_columns WHERE patient_id = 10010471 AND date >= '2000-07-14',[{'SUM(outputevents.value)': None}]
258a0365b34cfcb6501ad3c2,How much did patient 10026354 weigh when measured for the last time since 14 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT patient.weight FROM patient WHERE patient.patient_id = 10026354 AND DATETIME(patient.weight_date) >= DATETIME(CURRENT_TIME, '-14 month') ORDER BY patient.weight_date DESC LIMIT 1",[]
f18a1ffa1752d917bfb094ac,Is the pt value of patient 10018081 second measured on the current hospital visit greater than the value from the first measurement on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT pt FROM patients WHERE patient_id = 10018081 AND hospital_pt_type = 'pt2') > (SELECT pt FROM patients WHERE patient_id = 10018081 AND hospital_pt_type = 'pt1'),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
5035c14e77fc86f7e758328a,"In total, how many patients were prescribed potassium chloride (powder) since 1 year ago?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chloride (powder)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.identifier) FROM patient WHERE patient.patient_type = 'prescriber' AND patient.prescriber_info.drug = 'Potassium Chloride (Powder)' AND DATETIME(patient.prescriber_info.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4222a76175b0c9d9dbc75006,"Has there been a performance of cardiac output, continuous procedure performed on patient 10021118 since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10021118 AND procedures.procedure_name = 'cardiac output, continuous' AND STRFTIME('%y', procedures.procedure_date) >= '2100'",
72666450524051b2095429f8,Is it patient 10012552's arterial blood pressure mean last measured on the first ICU visit less than first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT arterial_blood_pressure_mean FROM icu_visits WHERE icu_visits.patient_id = 10012552 AND NOT icu_visits.first_visit) < (SELECT arterial_blood_pressure_mean FROM icu_visits WHERE icu_visits.patient_id = 10012552 AND icu_visits.first_visit),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
1175293359f3af457f69e353,Was any magnesium sulfate (bolus) medication provided to patient 10019172 on the first ICU visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM icu_visits WHERE icu_visits.patient_id = 10019172 AND icu_visits.stay_length = 1 AND icu_visits.admittime = (SELECT MIN(admittime) FROM icu_visits WHERE icu_visits.patient_id = 10019172) AND icu_visits.medication = 'Magnesium Sulfate (Bolus)',[{'COUNT(*)>0': 0}]
f6bc08951df014b4c74d7be6,What was patient 10009628's maximum systolic blood pressure reading on 10/03/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03'",SELECT MAX(systolic_blood_pressure) FROM read_brackets_pressure WHERE patient_id = 10009628 AND measurement_date = '10/03/2100',[{'MAX(chartevents.valuenum)': None}]
8b3bbb2614914b69a0d35d7f,What was the admission type for patient 10027445's first entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10027445 ORDER BY admissions.admission_date NULLS FIRST LIMIT 1;,[]
f59622e4ac592f700d2dbc87,Have any procedures been performed on patient 10005817 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10005817 AND STRFTIME('%y', procedures.date) >= '2100'",
5b550bcb1829cb627ed0e4b7,Which drug was the last one prescribed for patient 10008454 since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescription_date FROM prescriptions WHERE patient_id = 10008454 AND STRFTIME('%y-%m', prescription_date) >= '2100-12' ORDER BY prescription_date DESC LIMIT 1",[{'drug': 'Labetalol'}]
113ee06f4d8c5df754253b48,How many drugs were given to patient 10023239 since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM drugs WHERE drugs.patient_id = 10023239 AND STRFTIME('%y', drugs.date) >= '2100'",[{'COUNT(*)': 148}]
04d6acb457c7debd55705e51,Is the value of respiratory rate of patient 10010471 second measured on the last ICU visit greater than the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT respiratory_rate FROM (SELECT icu_visits FROM patient WHERE patient_id = 10010471) AS t2 WHERE t2.icu_visits = (SELECT MAX(icu_visits) FROM (SELECT icu_visits FROM patient WHERE patient_id = 10010471) AS t1)) AS t3 > (SELECT respiratory_rate FROM (SELECT icu_visits FROM patient WHERE patient_id = 10010471) AS t2 WHERE t2.icu_visits = (SELECT MIN(icu_visits) FROM (SELECT icu_visits FROM patient WHERE patient_id = 10010471) AS t1)),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
e8d600176ca42258e8ab175a,How many aspirin prescriptions were administered since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'aspirin' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Aspirin' AND STRFTIME('%y', prescriptions.date) >= '2100';",[{'COUNT(*)': 12}]
8478e6de5e5ee9e5033f7355,How many patients since 2100 were diagnosed with bacteremia within the same month after the diagnosis of unspecified essential hypertension?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'bacteremia' AND STRFTIME('%y', diagnosis_date) >= '2100') AS t1, (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'unspecified essential hypertension' AND STRFTIME('%y', diagnosis_date) >= '2100') AS t2 WHERE t1.subject_id = t2.subject_id AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month')",
3968a40f9da4c7f52e8f7dea,What is the dose of the prescribed opioid for patient 76372??,,SELECT SUM(opioid_dose) FROM prescriptions WHERE prescriptions.patient_id = 76372,
26e74aadac80448d7df8bab6,What immuno-cancer medications have been used for the last five years?,,"SELECT DISTINCT ON (drug_name) drug_name, date_first_used FROM immuno_cancer_medications WHERE date_first_used >= (SELECT current_date - INTERVAL '5 years');",
41edf4dce9244c624133d08a,What was the output of patient 10018423 for the first time since 03/06/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT STRFTIME('%m/%d/%Y', CURRENT_TIMESTAMP) FROM patients WHERE patient_id = 10018423 AND CURRENT_TIMESTAMP >= '2100-03-06' ORDER BY current_timestamp NULLS FIRST LIMIT 1;",[{'label': 'Foley'}]
a4ae3581ae94bfe56b9a4d3e,Has patient 10007058 received a laboratory test for anion gap in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10007058 AND lab_data.test_name = 'anion gap' AND STRFTIME('%y', lab_data.test_date) = '2100'",[{'COUNT(*)>0': 0}]
02c83f838a71d8a05881f29c,Count the number of patients in med/surg since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE location = 'med/surg' AND date_since >= CURRENT_DATE - INTERVAL '1 year';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
eec94693605289856658f678,Show me the daily maximum weight of patient 10003046 in 01/this year.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '01' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10003046 AND date BETWEEN '2001-01-01' AND '2001-01-31' GROUP BY date,[]
afa0e569514d9221f0ed8ad6,How much is the drug named tobramycin sulfate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' ),"SELECT COUNT(DISTINCT ""id"") FROM ""drug"" WHERE ""drug_name"" = 'Tobramycin Sulfate'",
d27110d877b8d72776989d66,Please count the hospital visits made by patient 10027445 in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(HOSP_VISITS) FROM (SELECT HOSP_VISITS FROM visit_table WHERE PATIENT_ID = 10027445 AND STRFTIME('%y', HOSP_VISIT_DATE) = '2100')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
9f95244492614327ffaf076b,How many hours has it been since patient 10018081's first abnormal coagulation profile diagnosis in the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = 'abnormal coagulation profile' AND patient_id = 10018081 AND hospital_dischtime IS NULL",
535fb807f200d61057c1b7a0,"What was the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving inspection of tracheobronchial tree, via natural or artificial opening endoscopic?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosistime FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.diagnosistime AND DATETIME(t2.diagnosistime) BETWEEN DATETIME(t1.treatmenttime) AND DATETIME(t1.treatmenttime, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 3",
c5f4c7e6139e15ca5adacd50,Show me the top three microbiology tests.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3",,"[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
d19f3fd4aedf7fd997534d9e,When did patient 10021487 have the first systolic blood pressure observed to be greater than 100.0 since 12/05/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 100.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-05' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(blood_pressure_sys) FROM systolic_blood_pressure WHERE patient_id = 10021487 AND blood_pressure_sys > 100.0 AND measurement_date >= '2100-12-05',[]
1b5f2850fe93f1eb4438b9dd,When are dr. holmes's rounds and procedures?,,"SELECT dr.holmes.rounds, dr.holmes.procedures FROM drums_repair dr INNER JOIN drums d ON dr.drums = d.drums WHERE d.player = ""Dave Holmes""",
af69042027761577e56622e9,What is the length of time patient 89875 had to undergo packed cell transfusion?,,"SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 89875 AND procedures.procedure_name = ""Packed cell transfusion""",
44de7bcceae079f9e8bfdaaf,"Among patients who underwent replacement of aortic valve with zooplastic tissue, percutaneous approach since 2100, what were the top five most common procedures that followed within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.code FROM (SELECT t2.code, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, repair.date FROM repair JOIN patient ON repair.patient = patient.uniquepid WHERE repair.date >= '2100-01-01' AND repair.type = 'replace aortic valve with zooplastic tissue, percutaneous approach') AS t1 JOIN (SELECT patient.uniquepid, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.uniquepid WHERE treatment.date >= '2100-01-01' AND treatment.type = 'other procedures') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.code) AS t3 WHERE t3.c1 <= 5",
4c511e76ad5fcd971a417e7f,Tell me the number of patients diagnosed with fibromyalgia since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fibromyalgia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.diagnosis = 'FIBROMYALGIA' AND STRFTIME('%y', patient.diagnosisdate) >= '2100'",
0544bc6c320c47d80b7b3c78,Calculate the total number of medications that patient 10023117 was prescribed on the first hospital encounter.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10023117 AND NOT medications.hospital_dischtime IS NULL ORDER BY medications.hospital_admittime NULLS FIRST LIMIT 1;,[{'COUNT(*)': 18}]
bfc0ef948f41f613e7769bc1,Does patient 23070 have overseas travel history?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 23070 AND patients.overseas_travel_history = 'Yes',
f2f331a5387ccf3bfd476a39,Was patient 10037861 through any surgery in the first hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),"SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10037861 AND STRFTIME('%j', procedures.date) = 10037861 AND procedures.dischtime IS NULL ORDER BY procedures.date NULLS FIRST LIMIT 1",[{'COUNT(*)>0': 1}]
903fa8b66fbddfcd2c54d16c,Has patient 49176 ever experienced a side effect during a blood transfusion?,,SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 49176 AND diagnoses.side_effect = 'side effect during a blood transfusion',
e44cd0b41cda6c3cab6b967e,How many hours have elapsed since patient 10018081 stayed in the careunit emergency department for the last time on this hospital stay?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.staydate)) FROM patient WHERE patient.subjectid = 10018081 AND patient.staydate IS NOT NULL AND patient.dischdate IS NULL",[]
177414b028ffe63adf88e436,What is the checklist before the therapeu plasmapheresis procedure?,,SELECT checklist_before FROM procedures WHERE procedures.procedure = 'Therapeu Plasmapheresis';,
ee59f6b32fc0b17f2e1e888b,Can you tell how many times patient 10031757 visited the ICU since 1 year ago?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT patient_id) FROM icu_visits WHERE patient_id = 10031757 AND DATETIME(icu_visits.visit_time) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 2}]
2eec2f8d9b73d99dd0701546,What are the five most commonly taken specimens for patients that received insertion of one vascular stent previously within 2 months this year?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of one vascular stent' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t3.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT t2.subject, t2.date FROM (SELECT t1.subject, t1.date FROM (SELECT 'Alice' AS subject, '2022-01-01 00:00:00' AS date) AS t1 JOIN (SELECT 'Alice' AS subject, '2022-01-03 12:00:00' AS date) AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.subject, t2.date) AS t3 WHERE rank <= 5",
d12cf57d8405a554dab7fa15,What are the five most frequently ordered medications that patients in their 60 or above were prescribed within 2 months after being diagnosed with abnormal coagulation profile in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'abnormal coagulation profile' AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100') AS t1 JOIN (SELECT admissions.subject_id, medications.name, medications.dispense_date FROM medications JOIN admissions ON medications.admission_id = admissions.admission_id WHERE admissions.age >= 60 AND STRFTIME('%y', medications.dispense_date) = '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.dispense_date AND DATETIME(t2.dispense_date) BETWEEN DATETIME(t1.diagn",
c08a8ca378cac26a4872dd1c,What were the top four most common lab tests done this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date_part('year', current_date) = date_part('year', t.date)) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 4",[]
1d73f76e9729625f5d313029,Is the white blood cells level of patient 10001725 last measured on the first hospital visit less than the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab_result FROM lab_measurements WHERE lab_measurements.patient_id = 10001725 AND NOT lab_measurements.hospital_visit_number IS NULL ORDER BY lab_measurements.measurement_date NULLS FIRST LIMIT 1) < (SELECT lab_result FROM lab_measurements WHERE lab_measurements.patient_id = 10001725 AND NOT lab_measurements.hospital_visit_number IS NULL ORDER BY lab_measurements.measurement_date NULLS FIRST LIMIT 1) AND lab_measurements.lab_name = 'white blood cells'),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
f727d26ce2437b323535a192,"For the patients with age 50s, what are the top five most frequent diagnoses since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM patients WHERE age BETWEEN 50 AND 59 AND STRFTIME('%y', patient.date) >= '2100' GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 5",
3203c674e0262061c0e9ecc5,Provide the sum total of inputs for patient 10007818 since 03/02/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02'",SELECT SUM(input) FROM bracket_input WHERE patient = 10007818 AND input_date >= '2003-02-2100',[{'SUM(inputevents.totalamount)': 162565.80000305176}]
8f4606909a78a1bbf2992c5c,"In their first hospital encounter, what was the last recorded weight for patient 10038081?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT patient.weight FROM patient WHERE patient.patient_id = 10038081 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1,[]
d792cf5775c1f4e850ffcde0,What was the last weight of patient 10004720 recorded?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(Weight) FROM Weight WHERE Patient = 10004720,[]
943c84d543c4adfc73e1771b,What was the cost of the drug sodium glycerophosphate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium glycerophosphate' ),SELECT DISTINCT cost FROM drugs WHERE name = 'sodium glycerophosphate';,
76752df29fef2ffe6127c97b,Was patient 10040025's chloride last measured on the last hospital visit greater than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.chloride FROM lab WHERE lab.patient = 10040025 AND NOT lab.hospital_visit IS NULL ORDER BY lab.date DESC LIMIT 1) > (SELECT lab.chloride FROM lab WHERE lab.patient = 10040025 AND NOT lab.hospital_visit IS NULL ORDER BY lab.date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
e98f22d20d446f796e001b97,I want to know the total volume of input patient 10019777 has received on 03/03/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-03'",SELECT SUM(volume) FROM intake WHERE patient = 10019777 AND date = '2100-03-03',[{'SUM(inputevents.totalamount)': None}]
b9fee2e62bcc843043e0a954,What output did patient 10026354 last have on 10/30/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-30' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT STRFTIME('%Y-%m-%d', CURRENT_DATE) FROM patients WHERE patient_id = 10026354 AND CURRENT_DATE LIKE '10/30/%'",[]
a773e86681735be6c53a92b5,"Count the number of patients who received a procedure this year for bypass coronary artery, two arteries from coronary artery, open approach.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patientprocedurecount > 0 AND DATETIME(patient.patientproceduredate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND patient.patientproceduretype = 'bypass coronary artery, two arteries from coronary artery, open approach'",
39d97a0dad007c5882b2d34b,"For patients who received destruction of right main bronchus, via natural or artificial opening endoscopic in 2100, what are the top three most frequent diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'destruction of right main bronchus, via natural or artificial opening endoscopic' AND STRFTIME('%y', treatment.treatmenttime) = '2100') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosistime FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE STRFTIME('%y', diagnosis.diagnosistime) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.diagnosistime AND DATETIME(t2.diagnosistime) BETWEEN DATETIME(t1.treatmenttime) AND DATETIME(t1.treatmenttime",
94b0437ac528f3909e945a5f,Tell me the four most common diagnosis since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses WHERE DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 4",
f11bfe4033fc6ace5d5cf382,"Did patient 10021312 receive any destruction of left main bronchus, via natural or artificial opening endoscopic treatment in the previous year?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of left main bronchus, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM endoscopic_treatment WHERE endoscopic_treatment.patient_id = 10021312 AND endoscopic_treatment.treatment_type = 'destruction of left main bronchus' AND DATETIME(endoscopic_treatment.treatment_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
eae749337c708ec5697cf97e,What was the name of the medicine prescribed to patient 10020740 for the first time since 03/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriber.name FROM prescriber JOIN patient ON prescriber.patient_id = patient.patient_id WHERE patient.patient_id = 10020740 AND STRFTIME('%y-%m', prescriber.date) >= '2100-03' ORDER BY prescriber.date NULLS FIRST LIMIT 1",[{'drug': 'Sodium Chloride 0.9%  Flush'}]
662a8bb09520c819a88e24a6,How many hours has it been since the last unspecified septicemia diagnosis of patient 10018081 during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified septicemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE patient_id = 10018081 AND diagnosis_type = 'unspecified septicemia' AND hospital_visit = 1;",
a30a6f58cc091f3a0949184c,What were the five most commonly ordered lab tests for patients who were previously diagnosed with acute and subacute necrosis of liver within 2 months?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS lab_rank FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Acute and subacute necrosis of liver') AS t1 JOIN (SELECT patient.id, lab_test, lab_date FROM lab WHERE patient.id IN (SELECT t1.patient_id FROM t1 WHERE t1.diagnosis = 'Acute and subacute necrosis of liver')) AS t2 ON t1.id = t2.patient_id WHERE t1.diagnosis_date < t2.lab_date AND DATETIME(t2.lab_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.lab_test) AS t3 WHERE t3.lab_rank <= 5",
e88b565b3eebfa84d07aba21,How much glyburide has patient 10015860 been prescribed in 10/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug = 'glyburide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10015860 AND prescriptions.drug = 'GlyBURIDE' AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '10'",[{'SUM(prescriptions.dose_val_rx)': None}]
4e87cca0b7f4f1c42928e016,How much will it cost me to get laparoscopic robotic assisted procedure done?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) ),SELECT SUM(price) FROM procedures WHERE procedure = 'Laparoscopic Robotic Assisted Procedure';,
08777eb92c5be85c5613f0dd,When did the last hospital discharge of patient 10007795 occur?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM (SELECT admissions.dischtime FROM admissions WHERE admissions.subject = 10007795),[]
c1adc1dd4db93616537a4296,Tell me the insurance plan of patient 10025612 on the first hospital visit.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT InsurancePlan FROM (SELECT * FROM Patient WHERE Patient.ID = 10025612 AND NOT Patient.HospitalVisitID IS NULL ORDER BY Patient.HospitalVisitID NULLS FIRST LIMIT 1),[{'insurance': 'Medicare'}]
31792c8a6ad3a8418c47001b,What was the name of the drug that was prescribed to patient 10001217 during the same hospital encounter after having had a spinal tap procedure during this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t3.drug FROM (SELECT t1.drug, t1.date FROM (SELECT patient.drug, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.patient WHERE diagnosis.diagnosis = 'spinal tap') AS t1 GROUP BY t1.drug HAVING MIN(t1.date) = DATEADD(MONTH, -5, CURRENT_DATE)) AS t2 JOIN (SELECT patient.drug, prescriber.date FROM prescriber JOIN patient ON prescriber.patient = patient.patient WHERE patient.patient = 10001217) AS t3 ON t2.drug = t3.drug WHERE t2.date < t3.date AND DATETIME(t2.date, 'start of month') = DATETIME(t3.date, 'start of month')",
85cf7ff0c55460da32489392,Has patient 10006580 been through any surgery?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ),SELECT COUNT(*) > 0 FROM procedures WHERE patient_id = 10006580,[{'COUNT(*)>0': 1}]
884dee5de94299004db9a1f2,How many current patients fall into the 60 or above age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT(*) FROM patients WHERE age >= 60,
e5b93830a2376294094a1f1b,What was the amount of ezetimibe that was prescribed to patient 10021666 for the last time in 03/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'ezetimibe' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(etimibe) FROM patients WHERE patient_id = 10021666 AND prescription_date BETWEEN '2000-03-21' AND '2000-03-21',[]
bbe597ef5bc885d0751caef3,Tell me the name of the last specimen test patient 10002495 had received in 06/this year.,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '06' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT name FROM specimen_tests WHERE patient_id = 10002495 AND date_test = '06/' + strftime(CURRENT_DATE, '%y')",[]
366e4fe872705e8dbb87ae20,How many pseudoephedrine prescription instances took place during the previous year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'pseudoephedrine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Pseudoephedrine' AND DATETIME(prescriptions.start_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT(*)': 0}]
cc628d6e0b5a259cf31aa0cf,When has patient 10029291 had the last input on 02/28/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-28' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT input_date FROM input_table WHERE patient_id = 10029291 AND input_date = CURRENT_DATE - INTERVAL '02/28/' + INTERVAL '0' YEAR TO DATE,[]
e156f73b1bfc7f7069b386b3,Which are the four most commonly taken lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.LabTest, COUNT(t1.LabTest) FROM (SELECT LabTest FROM lab_tests WHERE year >= 2100 GROUP BY LabTest) AS t1 JOIN lab_results ON t1.LabTest = lab_results.LabTest GROUP BY t1.LabTest ORDER BY COUNT(t1.LabTest) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
3438f141d7038a0bf312f74b,What was patient 10012552's last measured po2?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(po2) FROM read_brackets.patient_po2 WHERE patient_id = 10012552,[]
b9709f43c5ff64a2dd1b4d47,When was the last time that patient 10037975's SaO2 was measured at less than 90.0 on their last ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 90.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(brackets.stay_date) FROM (SELECT stay_date FROM icu WHERE patient_id = 10037975 AND SaO2 < 90.0) AS brackets;,[]
5d7c5f7770c961d7c84c8499,When did patient 10019172 have the maximum ph value the last time in 11/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1","SELECT MAX(ph) FROM patient WHERE patient.patient_id = 10019172 AND STRFTIME('%y-%m', ph.timestamp) = '2100-11'",[]
c3f33ef0036d9efd71c23adc,What is the cost for the medicine phytonadione?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phytonadione' ),SELECT DISTINCT cost FROM medicines WHERE medicine = 'phytonadione';,
fb08961df2b632f9644c112c,When was patient 10015860's last hospital discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10015860 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_dischtime) FROM patient WHERE patient_id = 10015860,[{'dischtime': '2193-11-27 21:58:00'}]
f7175ad460d1ff7aae62b0fa,What is patient 10038933's ketone change last measured on the first hospital visit compared to the value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10038933 AND lab_data.label = 'ketone change' ORDER BY lab_data.date NULLS FIRST LIMIT 1) - (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10038933 AND lab_data.label = 'ketone change' ORDER BY lab_data.date NULLS FIRST LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
cce128d8f29c8e7564cc8cc8,Patient 10015931 was diagnosed on the first hospital encounter for the first time with what?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT MIN(visits) FROM (SELECT COUNT(DISTINCT visit_id) AS visits FROM visit_table WHERE patient_id = 10015931 AND NOT hospital_dischtime IS NULL ORDER BY visit_id NULLS FIRST LIMIT 1),
5b7ca8d49d2817d537c89baa,When were patient 10021938 first prescribed for nifedipine cr and calcium acetate at the same time since 09/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'nifedipine cr' AND admissions.subject_id = 10021938 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'calcium acetate' AND admissions.subject_id = 10021938 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",,[]
b11ba285107d208de9e518f1,"Since the last diagnosis of patient 10018081 with overflow incontinence in this hospital encounter, how many hours have passed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'overflow incontinence' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = 10018081 AND diagnosis.diagnosis_date = (SELECT diagnosis_date FROM diagnosis WHERE patient_id = 10018081 AND diagnosis.diagnosis = 'overflow incontinence') AND diagnosis.diagnosis_date >= (SELECT diagnosis_date FROM diagnosis WHERE patient_id = 10018081 AND diagnosis.diagnosis = 'overflow incontinence' ORDER BY diagnosis.diagnosis_date DESC LIMIT 1)",
9645c89ce0e75ea8d9ab156a,Do you know the average alanine aminotransferase (alt) value of patient 10004733 in 12/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'",SELECT AVG(alt) FROM 12 WHERE patient = '10004733',[{'AVG(labevents.valuenum)': None}]
0edf383920d07410f686cb96,"In 03/this year, when did patient 10019777 first receive the immature granulocytes test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immature granulocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.charttime ASC LIMIT 1",SELECT DATE '2003-01-01' FROM patients WHERE patients.id = 10019777 ORDER BY patients.date_immature_granulocytes NULLS FIRST LIMIT 1,[]
5933a57b83835c59ed518dbf,Can you tell me the first heart rate of patient 10007928 on the last ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT patient.heart_rate FROM patient WHERE patient.patient_id = 10007928 AND NOT patient.unit_id IS NULL ORDER BY patient.unit_id DESC LIMIT 1,[]
2ec6cb1efc895f9201b5cf60,How many days have elapsed since the first time during their current hospital visit patient 10021487 got a other lab test?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT COUNT(DISTINCT ""date"") FROM lab_results WHERE ""patient_id"" = 10021487 AND ""lab_name"" = 'Other'",[]
fbb777a428c35d8695cc62d5,What is the minimum value of ketone on patient 10036156 in 07/this year?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'",SELECT MIN(Ketone) FROM patient WHERE patient.patient_id = 10036156 AND Ketone.kettone_date BETWEEN '2007-07-01' AND '2007-07-31',[{'MIN(labevents.valuenum)': None}]
621f1abf8ceb45784a8a62b6,How many prescriptions for albumin 25% (12.5g / 50ml) were made last year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Albumin 25% (12.5g / 50ml)' AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT(*)': 0}]
aad14eeea5e885e1009d3b1e,Has there been a procedure that patient 10001217 had since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10001217 AND STRFTIME('%y', procedures.date) >= '2100'",
7a9d8c4e3514be8609110241,How much does a hospital typically spend minimum on a drug named morphine sr (ms contin)?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'morphine sr (ms contin)' ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(Spend) FROM (SELECT Spend FROM hospital WHERE Spend > 0 AND Name = 'morphine sr (ms contin)'),
c70087e768a59793cb584211,Can you tell me the top five most common lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date > (CURRENT_DATE - INTERVAL '1 year')) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
a990c12b1e421dffb6cca4e2,What are the five most frequently ordered medications that patients in their 30s were prescribed during the same month after being diagnosed with unspecified essential hypertension in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'unspecified essential hypertension' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.id, medication.name, medication.prescription_date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age BETWEEN 30 AND 39 AND STRFTIME('%y', medication.prescription_date) = '2100') AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.prescription_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.prescription_date, 'start of month') GROUP BY t2.name",
167a500ff70d846339538bb9,When was the first time that patient 10023239 was prescribed medication via the iv drip route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(date_prescribed) FROM medication_table WHERE patient_id = 10023239 AND route = 'iv drip',[]
1c66f7fcfad7cbff26b54abe,"What are the top five most common microbiology tests for people who were diagnosed with respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia earlier within 2 months, since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t5.Microbiology, COUNT(t5.Microbiology) FROM (SELECT t4.Microbiology, t4.Hypoxia, t4.Hypercapnia, t4.Age FROM (SELECT t3.Microbiology, t3.Hypoxia, t3.Hypercapnia, t3.Age FROM (SELECT STRFTIME('%y', Date) AS Microbiology, STRFTIME('%y', Date) AS Hypoxia, STRFTIME('%y', Date) AS Hypercapnia, STRFTIME('%y', Date) AS Age FROM (SELECT Microbiology, Hypoxia, Hypercapnia, Age FROM (SELECT STRFTIME('%y-%m-%d', Date) AS Microbiology, STRFTIME('%y-%m-%d', Date) AS Hypoxia, STRFTIME('%y-%m-%d', Date) AS Hypercapnia, STRFTIME('%y-%m-%d', Date) AS Age FROM RespiratoryFailure, Unspecified, UnspecifiedHypoxia, UnspecifiedHypercapnia WHERE Res",
acb8470937bc4a7d0d9b622d,Can you confirm the gender of patient 10027602?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10027602,"SELECT ""gender"" FROM ""patients"" WHERE ""patient_id"" = 10027602",[{'gender': 'F'}]
adcbe9f6b33c50d6f8540cda,When was the first hospital discharge time for patient 10022017?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(hospital_dischtime) FROM hospital WHERE patient_id = 10022017,[]
18d972f8815b6dbf2e9141c3,What was the admission type for patient 10039708's last admission to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039708 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039708 ORDER BY admissions.admission_date DESC LIMIT 1,[{'admission_type': 'OBSERVATION ADMIT'}]
c7af43822b2032b4d685af10,"Among patients who took other repair of vessel in 2100, what are the top five most frequent diagnoses that followed in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.month FROM (SELECT date_part('month', diagnosis_date) AS month, diagnosis FROM repair_other_vessel) AS t1 JOIN (SELECT date_part('month', diagnosis_date) AS month, diagnosis FROM repair_other_vessel) AS t2 ON t1.month = t2.month WHERE t1.diagnosis <> t2.diagnosis) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 5",
cc5fbcfde89a0973970e7397,What was the total length of excise diaphragm lesion procedure for patient 594?,,SELECT SUM(length) FROM procedures WHERE patient = 594 AND procedure = 'excise diaphragm lesion',
eb588610d7a73daedf0f76c1,Was the value of patient 10001217's monocytes last measured on the first hospital visit greater than the value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab.monocytes FROM lab WHERE lab.patient = 10001217 AND NOT lab.hospital_visit IS NULL ORDER BY lab.measurement_time NULLS FIRST LIMIT 1) > (SELECT lab.monocytes FROM lab WHERE lab.patient = 10001217 AND NOT lab.hospital_visit IS NULL ORDER BY lab.measurement_time DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
ceb8a5c222865829ffc00ea9,At what time did the last incident of patient 10019172 having a maximum SaO2 occur on last month/20?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '20' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT MAX(SaO2) FROM Brackets WHERE PatientID = 10019172 AND date = DATEADD(month, -2, GETDATE())",[]
a4da025718f83d20130260ea,When was patient 10004235's first discharge from the hospital?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 ORDER BY admissions.dischtime ASC LIMIT 1,SELECT patients.discharge_date FROM patients WHERE patients.subject_id = 10004235 ORDER BY patients.discharge_date NULLS FIRST LIMIT 1,[{'dischtime': '2196-03-04 14:02:00'}]
e73df961ffb6ab9df8d8eeab,What specimen test was given in their last hospital encounter to patient 10013049 for the last time?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT specimen_type FROM visit_details WHERE patient_id = 10013049 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime DESC LIMIT 1;,[{'spec_type_desc': 'MRSA SCREEN'}]
b5ce6c822904c206071d56a5,How many hours elapsed since patient 10004733 received his sodium lab test for the last time during the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_date)) FROM lab_results WHERE lab_name = 'sodium' AND patient_id = 10004733 AND hospital_id = (SELECT hospital_id FROM patient WHERE patient_id = 10004733 AND patient.hospital_location = 'current hospital') ORDER BY lab_date DESC LIMIT 1;",[]
c566bb57a34d5a1e6092531a,When did patient 10018081 have the maximum respiratory rate the first time since 76 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-76 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT MAX(respiratory_rate) FROM patient WHERE patient.id = 10018081 AND DATETIME(respiratory_rate) >= DATETIME(CURRENT_TIME, '-76 day') ORDER BY respiratory_rate DESC LIMIT 1;",[]
f96633ec8fc87fce8f72854a,What is patient 10008287's gender?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10008287,SELECT patients.gender FROM patients WHERE patients.ssn = 10008287,[{'gender': 'F'}]
d8a47bc9987e7055d48e418b,Show me the top three most frequent output instances during this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",SELECT,[]
762190765b6e9b306ee94b34,What is the earliest visit of patient 97834 to other departments?,,SELECT MIN(Visit_OtherDept) FROM visit_table WHERE Patient_ID = 97834,
0b6c432395ef9fcbfe105e93,Has any side effects been experienced by patient 3267 during a blood transfusion,,SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 3267 AND diagnoses.description = 'Blood transfusion',
3b3ec25a9c5acf7aca6a592b,Have any procedures been carried out on patient 10008287 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10008287 AND STRFTIME('%y', procedures.date) >= '2100'",
3922a8bf089907b9a543783e,"After receiving enteral infusion of concentrated nutritional substances during this year, what are the three most common diagnoses that patients received within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.subject_id WHERE treatment.treatment_type = 'enteral infusion of concentrated nutritional substances' AND DATETIME(treatment.treatment_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.subject_id, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.treatment_date < t2.diagnosis_date AND DATETIME",
6ef2fe833cee5960612ae052,Does patient 10211 have an appointment in other department?,,SELECT COUNT(*) FROM appointments WHERE appointments.patient_id = 10211 AND appointments.appointment_date <> (SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10211),
c3ec8c1023fa687bb2624e68,Can you provide me the daily average amount of or colloid intake that patient 10039831 received in their current hospital visit?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT AVG(amount) FROM intake WHERE patient_id = 10039831 AND intake_type = 'or colloid',[]
6ef2183a66a1c25b6446eee9,How long did patient 18457 receive below knee amputat nec?,,"SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 18457 AND procedures.procedure_name = ""Below knee amputat NEC""",
6fbc822299d5ed6324fb6280,What immuno-cancer drugs have been in use for the last five years?,,SELECT * FROM drugs WHERE usage_duration >= '5 years' AND drug_category = 'immuno-cancer',
98f2f619a8c325c797be99a3,What was the name of that first specimen test patient 10003046 got in the first hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT specimen_type FROM patients WHERE patient_id = 10003046 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}]
fff1f1751b80965886ad5fbd,What was the total number of drugs patient 10000032 was prescribed since 03/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*) FROM drugs WHERE drugs.patient_id = 10000032 AND STRFTIME('%y-%m', drugs.date) >= '2100-03'",[{'COUNT(*)': 81}]
20b78d286ce05435b56b849f,What was patient 10026354's first measurement for arterial blood pressure diastolic since 06/24/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-24' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(arterial_blood_pressure_diastolic) FROM patient WHERE patient_id = 10026354 AND measurement_date >= '2100-06-24',[]
b84f8bef2656a98e1a21f179,What is the percentile of 42.0 in the laboratory test with platelet count at the same age of patient 10000032 in the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 42.0","SELECT t1.c1 FROM (SELECT lab.result, PERCENT_RANK() OVER (ORDER BY lab.result NULLS FIRST) AS c1 FROM lab WHERE lab.name = 'platelet count' AND lab.age = (SELECT lab.age FROM lab WHERE lab.name = 'platelet count' AND lab.age IS NOT NULL ORDER BY lab.age NULLS FIRST LIMIT 1)) AS t1 WHERE t1.result = 42.0",
72faafda75d4e4a844d6cd9d,Please provide the three most common tests performed on specimens since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT t1.test_name, COUNT(t1.test_name) FROM (SELECT test_name FROM tests WHERE date_run > (CURRENT_DATE - INTERVAL '1 year')) AS t1 JOIN results AS t2 ON t1.test_name = t2.test_name GROUP BY t1.test_name ORDER BY COUNT(t1.test_name) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
15b58da2d88da3aa6b767f4e,What was the last diagnosis for patient 10012853?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT MAX(diagnosis) FROM diagnoses WHERE diagnoses.patient_id = 10012853;,
db398e1ac2a8d286cc4b53bb,"What is the minimum total cost of a hospital stay involving adverse effect of unspecified antiepileptic and sedative-hypnotic drugs, initial encounter?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of unspecified antiepileptic and sedative-hypnotic drugs, initial encounter' ) ) GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.hospital_stay_id IN (SELECT hospital_stay_id FROM diagnosis_table WHERE diagnosis_table.diagnosis = 'adverse effect of unspecified antiepileptic') OR cost_table.hospital_stay_id IN (SELECT hospital_stay_id FROM diagnosis_table WHERE diagnosis_table.diagnosis = 'sedative-hypnotic drugs') GROUP BY cost_table.hospital_stay_id) AS t1,
064e1e18ab989d89c93ed694,How many patients were diagnosed with acute post-thoracotomy pain within 2 months after first being diagnosed with accidents occurring in residential institution in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in residential institution' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute post-thoracotomy pain' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM (SELECT subject_id, DATE '2100-01-01' AS diagnosed_date FROM ACCIDENTS WHERE accidents_occurring_in_residential_institution = 'true') AS t1 JOIN (SELECT subject_id, diagnosed_date FROM (SELECT subject_id, DATE '2100-01-01' AS diagnosed_date FROM ACCIDENTS WHERE accidents_occurring_in_residential_institution = 'true') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date < t2.diagnosed_date AND DATETIME(t2.diagnosed_date) BETWEEN DATETIME(t1.diagnosed_date) AND DATETIME(t1.diagnosed_date, '+2 month')",
053a84a3939291b5875a4bb2,Tell me the amount of kcl (bolus) input that patient 10004235 received on 03/21/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-21'","SELECT COUNT(kcl.bolus) FROM kcl WHERE kcl.patient = 10004235 AND STRFTIME('%m/%d/%Y', kcl.date) = '03/21/2100'",[{'SUM(inputevents.totalamount)': None}]
74800adca8d5382b227f11fc,When was the last time the heart rate of patient 10027602 was measured to be greater than 95.0 on last month/26?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '26' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM patient_heart_rate WHERE patient_id = 10027602 AND measurement_date = (CURRENT_DATE - INTERVAL '1 month/26') AND heart_rate > 95.0,[]
3a8edca352170e0eec95d919,Give me the top three most common lab tests throughout this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT lab_test, COUNT(lab_test) FROM lab_results WHERE date_result = ""2011-01-01"" GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 3",[]
79d16bbe75c1b79b191237dd,Can you tell the three most frequent lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.LabTest, COUNT(t1.LabTest) FROM (SELECT LabTest FROM LabTests WHERE YEAR(LabTestDate) = 2000 GROUP BY LabTest) AS t1 JOIN LabResults AS t2 ON t1.LabTest = t2.LabTest GROUP BY t1.LabTest ORDER BY COUNT(t1.LabTest) DESC LIMIT 3",[]
60ea85db45d1ad1ad72cf62a,Has patient 10010471 received any lab tests since 07/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07'","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10010471 AND STRFTIME('%y-%m', lab_tests.date) >= '2100-07'",[{'COUNT(*)>0': 1}]
cf057692f01ed1e43b7ab26f,What is the value of patient 10018845's monthly average or crystalloid intake input during their first hospital visit?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT AVG(CAST(input AS FLOAT)) FROM input_table WHERE patient_id = 10018845 AND input_type = 'monthly average or crystalloid intake' AND NOT patient_input_history IS NULL ORDER BY patient_input_history.entry_date NULLS FIRST LIMIT 1,[]
99ba97a4365a81e47395a5e1,Has patient 10026255 experienced any surgeries since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10026255 AND STRFTIME('%y', procedures.date) >= '2100'",
babb2410ee949a2d7a609b15,Give me the total volume of output for patient 10011398 since 01/19/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'",SELECT SUM(output_volume) FROM output WHERE patient_id = 10011398 AND output_date >= '2100-01-19',[{'SUM(outputevents.value)': 4314.0}]
c9d8cdde8cb8a16012cdc065,What was the drug that was last prescribed to patient 10019568 via the ivpca route in the first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'ivpca' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(drug_id) FROM prescriptions WHERE patient_id = 10019568 AND route = 'ivpca' AND hospital_visit = 1;,[]
fede243c3b7b2698d441af96,The first time patient 10004733 was prescribed lidocaine 1% and heparin flush (10 units/ml) at the same time in 12/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (10 units/ml)' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 1%' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT COUNT(DISTINCT t1.uniquepatientid) FROM (SELECT patient.uniquepatientid, prescriber.startdate FROM prescriber JOIN patient ON prescriber.patientid = patient.uniquepatientid WHERE prescriber.drug = 'lidocaine 1%' AND patient.uniquepatientid = 10004733) AS t1 JOIN (SELECT patient.uniquepatientid, prescriber.startdate FROM prescriber JOIN patient ON prescriber.patientid = patient.uniquepatientid WHERE prescriber.drug = 'heparin flush (10 units/ml)' AND patient.uniquepatientid = 10004733) AS t2 ON t1.uniquepatientid = t2.uniquepatientid WHERE DATETIME(t1.startdate) = DATETIME(t2.startdate)",[]
218a35d3fd0012d75ff34412,Show me the top four microbiology tests.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4",SELECT * FROM microbiology_tests WHERE id IN (SELECT id FROM microbiology_tests ORDER BY volume DESC LIMIT 4);,"[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]"
e3ef5dc86e154039d7839324,When was the last time patient 10021118 had the minimum monocytes in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MIN(Monocytes) FROM patients WHERE Patient_ID = 10021118 AND Date = '12/07/2020',[]
7c14ad97c239a78381bd7174,Has patient 10002495 gotten any medication since 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",SELECT COUNT(*) > 0 FROM patient_medication WHERE patient_id = 10002495 AND start_date >= '2003-03-2100',[{'COUNT(*)>0': 1}]
4fd17cfcc175d92c67e22fdb,When last did patient 10004422 have the maximum respiratory rate on 01/19/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '01-19' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(RespiratoryRate) FROM RespiratoryHistory WHERE PatientID = 10004422 AND Date >= '01/19/2022' AND Date < '01/19/2023';,[]
592fc15a830589ea90962e04,How many patients were present in the emergency department observation in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM emergency_department_observations WHERE year = 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
feb492e9caf0343b3c2f2166,Count the total number of hospital visits made by patient 10021118 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(DISTINCT ""hospital_visit_id"") FROM ""patient_hospital_visits"" WHERE ""patient_id"" = 10021118 AND STRFTIME('%y', ""hospital_visit_date"") >= '2100';",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
d0c0f7766e9f698b1439c34e,"What are the three commonly ordered medications for patients who were diagnosed with atrial fibrillation previously in the same hospital visit, in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Atrial fibrillation"" AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, medications.name, medications.date_administered FROM medications JOIN admissions ON medications.admission_id = admissions.admission_id WHERE DATETIME(medications.date_administered, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.date_",
07a08dc4b74589ad11ceabfd,Can you show me the top four frequent output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT Event, COUNT(Event) FROM output GROUP BY Event ORDER BY COUNT(Event) DESC LIMIT 4;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
ee1994bbfcf913af08ad4dd8,Can you tell me which were the top four most frequent specimens tested in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT specimen, COUNT(specimen) FROM 2100 GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 4",[]
fd8bbc85aa480d84c446fef0,Tell me the maximum respiratory rate for patient 10039831's body since 06/29/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-29'",SELECT MAX(RespiratoryRate) FROM (SELECT RespiratoryRate FROM 'patient_10039831' WHERE BodyDate >= '2000-06-29'),[{'MAX(chartevents.valuenum)': None}]
15f218ddc4b0e3bc25f8f534,Was patient 10026255 checked into the hospital in the previous year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026255 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM patient WHERE patient.subject_id = 10026255 AND DATETIME(patient.checked_in, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT(*)>0': 0}]
80a3a1b02bca2873dc0308c4,"This year, has patient 10031757 been diagnosed with any disease?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10031757 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
b94c880fccb8435757f8e05b,Calculate patient 10008454's length of stay in days for the first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT patient 10008454's length of stay in days FROM ICU WHERE NOT patient 10008454's length of stay in days IS NULL ORDER BY patient 10008454's length of stay in days NULLS FIRST LIMIT 1;,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.983888888731599}]"
2869bb3db5897f9d72d506b0,What are the five most commonly prescribed medications for patients who were previously diagnosed with other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle within 2 months?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id FROM patient WHERE patient.diagnosis = 'OTHER MOTOR VEHICLE TRAFFIC ACCIDENT INVOLVING COLLISION WITH MOTOR VEHICLE OTHER THAN MOTICYCLE') AS t1 JOIN (SELECT patient.id, medication.name FROM medication JOIN patient ON medication.patient = patient.id) AS t2 ON t1.id = t2.id LEFT JOIN (SELECT patient.id FROM patient WHERE patient.diagnosis = 'MOTORCYCLE') AS t3 ON t1.id = t3.id WHERE t3.name = 'Ibuprofen' GROUP BY t2.name) AS t WHERE t.c1 <= 5",
38d26509efa287e305910833,"Since 1 year ago, how many patients required dorzolamide 2%/timolol 0.5% ophth.?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE date_of_requirement > (SELECT date_of_requirement FROM patients WHERE patient_name = 'DORZOLAMIDE 2%/TIMOLOL 0.5% OPHTH.') AND patient_name = 'DORZOLAMIDE 2%/TIMOLOL 0.5% OPHTH.',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
cd0bcb070c47177a7ad4ff35,"In the last year, how many patients were provided with vancomycin oral liquid?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin oral liquid' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patienttype = ""Vancomycin Oral Liquid"" AND DATETIME(patient.lastmodified, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
cefa3a76e1b80de7cca8cbf1,"What are the three frequently prescribed medications within 2 months to the patients aged 60 or above after diagnosed with chronic kidney disease, unspecified since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'chronic kidney disease, unspecified' AND DATETIME(diagnosis.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age >= 60 AND DATETIME(medication.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 3",
12f5279f948c5fccb5f94517,What were the total amount of magnesium sulfate (bolus) input that patient 10005817 received since 12/25/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-25'","SELECT SUM(input.magnesium_sulfate_bolus) FROM input WHERE input.patient_id = 10005817 AND STRFTIME('%y-%m-%d', input.date) >= '2100-12-25'",[{'SUM(inputevents.totalamount)': None}]
725d74abd24c1af33ef5d212,When did patient 10002428's first microbiological test occur?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT MIN(date) FROM microbiology WHERE patient_id = 10002428,[{'charttime': '2155-07-15 02:00:00'}]
24155b9f4c00416b2b4a02d5,Can you tell me the first time on last month/12 patient 10005909 had a maximum heart rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '12' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT MIN(heart_rate) FROM patients WHERE patient_id = 10005909 AND date_part('month', date_of_entry) = 12 AND date_part('day', date_of_entry) = 26",[]
0925d99c93fdf4626caf71cc,Get the count of hospital visits by patient 10019777 during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019777 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(visit_id) FROM visits WHERE patient_id = 10019777 AND visit_date BETWEEN '2022-01-01' AND '2022-12-31',[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
c2e4f992fdf2b0fe03106e5a,Tell me the total number of patients in neuro stepdown since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date FROM t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t2.date >= (CURRENT_DATE - INTERVAL '1 year') AND t2.site = 'neuro stepdown')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e39761455f93b4f0ebb90b4e,Retrieve the top four most frequent diagnoses of patients with age in their 20s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.diagnosis, COUNT(t4.diagnosis) FROM (SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, COUNT(t2.diagnosis) FROM t2 WHERE t2.age BETWEEN 20 AND 29 GROUP BY t2.diagnosis) AS t3) AS t4 WHERE t4.age BETWEEN 20 AND 29 AND DATETIME(t4.diagnosis, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY t4.diagnosis ORDER BY COUNT(t4.diagnosis) DESC LIMIT 4;",
60c25b9b360a4037bd94de94,When was the last time that patient 10027602 has had the maximum diastolic blood pressure in their last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(diastolic_blood_pressure) FROM patient WHERE patient_id = 10027602 AND NOT patient_info.unit_status = 'last icu',[]
2bbc414d187b0af13c72744e,"Tell me the top four most commonly prescribed medications in the same month to patients in their 60 or above who were diagnosed with congestive heart failure, unspecified since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t4.name FROM (SELECT t3.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'congestive heart failure, unspecified' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age >= 60 AND STRFTIME('%y', medication.date) >= '2100') AS t2 ON t1.id = t2.id JOIN (SELECT t2.id, t2.name, t2.date FROM t2 JOIN (SELECT t1.id, MIN(diagnosis_date) AS diagnosis_date FROM diagnosis JOIN t1 ON diagnosis.patient_id = t1.patient_id GROUP BY t1.id)",
b17a81cf82fe8e6f3d0705eb,What is the average value of absolute eosinophil count in patient 10019385's body in 03/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'","SELECT AVG(ABS(-13.9)) FROM patients WHERE patients.name = '10019385' AND DATETIME(patients.admission_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND DATETIME(patients.admission_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')",[{'AVG(labevents.valuenum)': None}]
d9de692b97657d92d074c361,How many times did patient 10006580 attend the hospital in the previous year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10006580 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM attendance WHERE patient_id = 10006580 AND DATETIME(date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
179e0c7223f1d82e5c946ad0,"How many congestive heart failure, unspecified patients in this year were diagnosed during the same month after being diagnosed with other nonspecific abnormal finding of lung field?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific abnormal finding of lung field' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_month FROM (SELECT subject_id, diagnosed_month FROM (SELECT * FROM diagnoses WHERE diagnosis_type = ""CONGESTIVE HEART FAILURE, UNKNOWN"") AS t1 JOIN (SELECT * FROM diagnoses WHERE diagnosis_type = ""OTHER NONSPECIFIC ABSOLUTE FINDING OF LUNG FIELD"") AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_month = t2.diagnosed_month) AS t3 JOIN (SELECT * FROM diagnoses WHERE diagnosis_type = ""CONGESTIVE HEART FAILURE, UNKNOWN"") AS t4 ON t3.subject_id = t4.subject_id WHERE t3.diagnosed_month = t4.diagnosed_month AND DATETIME(t3.diagnosed_month, 'start of year') = DATETIME(t4.diagnosed_month, 'start of year')",
6ee64a55e047a6157abffad9,Has any prescriptions been given to patient 10006580 since 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10006580 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-03'",[{'COUNT(*)>0': 1}]
e93b96a3e733e74dba4a0f26,Tell me the number of patients diagnosed with type 2 diabetes mellitus with unspecified complications.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with unspecified complications' ) ),"SELECT COUNT(DISTINCT diagnosis.patient_id) FROM diagnosis INNER JOIN complications ON diagnosis.patient_id = complications.patient_id WHERE diagnosis.diagnosis = ""TYPE 2 DIABETICS MELLITUS WITH UNSPECIFIED COMPLICATIONS""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
261c55328ac8ffc4792c6e5e,What is the maximum total cost for a hospital visit that involved a uric acid lab test in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'uric acid' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.item = 'uric acid' AND STRFTIME('%y', cost_table.date) = '2100' GROUP BY cost_table.patient_id) AS t1",
394a6722595bd4c93789a2b6,"Metoprolol tartrate, phytonadione, or vitamin d has been prescribed for patient 10003400.","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND prescriptions.drug IN ( 'metoprolol tartrate', 'phytonadione', 'vitamin d' )","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10003400 AND prescriptions.drug IN ('Metoprolol Tartrate', 'Phytonadione', 'Vitamin D')",[{'COUNT(*)>0': 0}]
0ad44ecce7e9c2eea3028673,Has patient 10009049 undergone any laboratory tests since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10009049 AND STRFTIME('%y-%m', lab_tests.date) >= '2100-04'",[{'COUNT(*)>0': 1}]
cdd34197e0de15595e116b81,Can you tell me the last o2 saturation pulseoxymetry of patient 10020740 on 04/04/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-04-04' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT last(o2_saturation_pulseoxymetry) FROM patient WHERE patient.id = 10020740 AND measurement_date = '2100-04-04',[]
34bcde5942f36df939445209,How are the precautions after the creat esophagastr sphinc procedure?,,"SELECT p.tube_id, p.type, p.diameter, p.length, p.distance, p.duration, p.kink, p.crew, p.tool_id, p.time FROM procedures p WHERE p.type = 'creat esophagastr sphinc';",
6e7eea4d83bc22c485bd34f3,What is the maximum monthly number of people diagnosed with compression of brain since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of brain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT MAX(monthly_number) FROM (SELECT COUNT(*) AS monthly_number FROM diagnoses WHERE compression_of_brain = 'compressed' AND year(diagnosis_date) >= 2100 GROUP BY EXTRACT(MONTH FROM diagnosis_date)),
8df09dad6578de1a0c901527,Did patient 10006580 have any prescriptions for medicines on their last hospital encounter?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10006580 AND NOT prescriptions.dischtime IS NULL ORDER BY prescriptions.admittime DESC LIMIT 1;,[{'COUNT(*)>0': 1}]
54cf4ad46263c89423b40945,Tell me the top five most frequent procedures that patients were given within the same hospital visit after receiving repair of other hernia of anterior abdominal wall since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of other hernia of anterior abdominal wall' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.repair_other_hernia FROM (SELECT t2.repair_other_hernia, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatdate FROM treatment JOIN patient ON treatment.patient = patient.uniquepid WHERE treatment.treatment = 'repair of other hernia of anterior abdominal wall' AND STRFTIME('%y', treatment.treatdate) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, treatment.repair_other_hernia, treatment.treatdate FROM treatment JOIN patient ON treatment.patient = patient.uniquepid WHERE STRFTIME('%y', treatment.treatdate) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatdate < t2.treatdate AND DATETIME(t1.treatdate, 'start of hospital') = DATETIME(t2.treatdate, 'start of hospital') GROUP BY t2.repair_other_hernia)",
1607c40d51d24cbf1164290b,Has any prescription drug been given to patient 10022880 since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10022880 AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)>0': 1}]
827992b8de480860fb744924,"On the current hospital visit, how many days passed since the first other fluid overload diagnosis of patient 10021487?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnoses.patient_id = 10021487 AND diagnoses.diagnosis_type = 'other fluid overload' ORDER BY diagnosis_date NULLS FIRST LIMIT 1;",
329d0bb92a0e71548c78f544,Can you tell me how many days patient 10007818 stayed in the ICU during their last stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT COUNT(DISTINCT ICU_DAY) FROM patient WHERE patient.stay_length = (SELECT MAX(stay_length) FROM patient WHERE patient.subject_id = 10007818),"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 20.528680555988103}]"
6ad5a9078781b4734aa37e35,What is the total count of patients who stayed in careunit vascular in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE careunit = ""vascular"" AND stay_year = 2100",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ac606737f9bd303254cf3a86,"After getting diagnosed with hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side, how many patients were found to have bradycardia, unspecified in the same hospital visit since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, diagnoses.chart_date, admissions.admission_location FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side"" AND STRFTIME('%y', diagnoses.chart_date) >= '2100') AS t1 JOIN (SELECT admissions.subject_id, diagnoses.chart_date, admissions.admission_location FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Bradycardia, unspecified"" AND STRFTIME('%y', diagnoses.chart_date) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.chart_date < t2.chart_date AND t1.admission_location = t2.admission_location",
ebbbea82024643bb7a0d0271,Show me the top three most commonly prescribed drugs within 2 months to the patients aged 60 or above after diagnosed with do not resuscitate since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'do not resuscitate' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.age, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'do not resuscitate since 2100') AS t1 JOIN (SELECT patient.age, prescription.drug, prescription.prescription_date FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE patient.age >= 60) AS t2 ON t1.age = t2.age AND t1.diagnosis_date < t2.prescription_date AND DATETIME(t2.prescription_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.drug) AS t3 WHERE t3.c1 <= 3",
dff52a931ff5d9812d2e68c8,"How many patients were diagnosed with bradycardia, unspecified since 2100 after previously being diagnosed with polyneuropathy, unspecified in the same month?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'bradycardia, unspecified' AND t1.diagnosis_date >= '2100-01-01') AS t1 JOIN (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'polyneuropathy, unspecified' AND t1.diagnosis_date >= '2100-01-01') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date = t2.diagnosis_date",
323d3cb95ad2c7d62dfd8cb3,Tell me the name of the output patient 10039831 had for the first time since 12/29/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-29' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM outputs WHERE patient_id = 10039831 AND date_since = '12/29/2100' ORDER BY date_since NULLS FIRST LIMIT 1,[{'label': 'OR EBL'}]
45e515311022b0e3085d278f,When was the first time in which patient 10016742 had the minimum heart rate on 08/02/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-02' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(heart_rate) FROM patients WHERE patient_id = 10016742 AND date = '2022-08-02',[]
22386e52d5ee964fb29ac28b,Calculate the total quantity of output of patient 10004235.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ),SELECT SUM(output_quantity) FROM output WHERE patient_id = 10004235;,[{'SUM(outputevents.value)': 9553.0}]
7c03a7d1027f6d34619316ee,Will patient 739 get any blood (ebv) tests???,,"SELECT COUNT(*) > 0 FROM tests WHERE patient_id = 739 AND blood_type = ""Blood (EBV)""",
a14c0a5446f2f1b57b2a4c07,How much is the price for glycerin supps?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'glycerin supps' ),"SELECT COUNT(*) FROM products WHERE product_name = ""Glycerin Supps""",
c9769b44044478c7148aed85,What's the diastolic blood pressure difference of patient 10021118's body last measured on the last ICU visit compared to the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT diastolic_bp FROM icu_diagnoses WHERE icu_diagnoses.patient_id = 10021118 AND NOT icu_diagnoses.dischtime IS NULL ORDER BY icu_diagnoses.admittime DESC LIMIT 1) - (SELECT diastolic_bp FROM icu_diagnoses WHERE icu_diagnoses.patient_id = 10021118 AND NOT icu_diagnoses.dischtime IS NULL ORDER BY icu_diagnoses.admittime DESC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
4be47d4fcbaf07a2f5b1d8ac,"Among patients diagnosed with bite of other animal except arthropod in 2100, what are the top five most common lab tests that followed afterward during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'Bite of other animal except arthropod' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.subject_id, lab_test.lab_test, lab_test.diagnosis_date FROM lab_test JOIN patient ON lab_test.patient_id = patient.subject_id WHERE STRFTIME('%y', lab_test.diagnosis_date) = '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagn",
4be515e40345fb288dd58aa5,When was the first time of input time of patient 10007818 on 07/10/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-07-10' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10007818 AND input_time BETWEEN '07/10/2100 00:00:00' AND '07/10/2100 23:59:59',[]
279b2975d141762b456cd18d,Tell me the name of the diagnosis that patient 10855 received in the other department,,SELECT diagnosis_name FROM diagnoses WHERE patient_id = 10855 AND department_id <> (SELECT department_id FROM departments WHERE name = 'other department'),
9c7986d4a90c81c0aaaf986f,When was the first blood culture microbiology test of patient 10039708's performed since 23 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-23 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT MIN(Microbiology_Date) FROM microbiology WHERE Microbiology_Type = 'Blood Culture' AND Patient_ID = 10039708 AND DATETIME(Microbiology_Date) >= DATETIME(CURRENT_TIME, '-23 month')",[]
2c1c7ca9c89b574bbf2e0995,What was the minimum monthly number of patients who had hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT MIN(monthly_count) FROM diagnoses_stats WHERE diagnosis = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (LUTS)' AND year = 2100,
88fdf3da1ae1fa49b61efe01,What was the number of times trimethoprim was prescribed since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Trimethoprim' AND DATETIME(prescriptions.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)': 0}]
94556faa4ba7d0ff0917653d,When did patient 10002428 get a blood culture microbial test for the first time since 05/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT date FROM blood_culture_microbial WHERE patient_id = 10002428 AND date >= '2000-05-2100' ORDER BY date NULLS FIRST LIMIT 1,[]
5e25f7703857496eb27b9a2a,Has patient 13329 experienced any side effects during a blood transfusion?,,SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 13329 AND diagnoses.side_effects = 'experienced' AND diagnoses.type = 'blood transfusion',
6ad09c06402234bbbe81de49,"What was the last time, on this month/06, that patient 10008454's mean blood pressure was less than 108.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 108.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '06' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(time) FROM (SELECT time FROM patient_10008454 WHERE blood_pressure_mean < 108.0 AND time BETWEEN '2022-04-06 00:00:00' AND '2022-04-06 23:59:59'),[]
59c00de184347b5897bcc303,Can you tell me the cost of mediastinoscopy?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'mediastinoscopy' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure = 'mediastinoscopy';,
44ccda4ff4ceaa8e1e95040c,When was the first microbiology test that was given to patient 10027445 since 08/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT MIN(brackets.test_date) FROM brackets WHERE brackets.patient_id = 10027445 AND brackets.test_category = 'microbiology' AND STRFTIME('%y-%m', brackets.test_date) >= '2100-08'",[{'charttime': '2142-07-31 06:07:00'}]
64633965444f470a4ca586e8,How soon is patient 4758's next hospital visit?,,SELECT xtime - current_time FROM patient WHERE patient.id = 4758,
99db8d08ce7c7dc5e23bb2ab,Has patient 10007928 had a hospital admission during this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM hospital WHERE hospital.patient_id = 10007928 AND DATETIME(hospital.admission_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
c0f3de8a38ca15677c20c16d,"Tell me, was magnesium sulfate (bolus) given to patient 10007818 during the first ICU visit?",SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ),,[{'COUNT(*)>0': 0}]
c1052714fdc43216d8caaaa3,What are the four diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",SELECT diagnosis FROM diagnoses ORDER BY 3-month mortality rate DESC LIMIT 4;,
22a17e0cd02cf807c470a259,Can you tell me the total volume of pre-admission output for patient 10037975 since 351 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-351 day')","SELECT COUNT(DISTINCT t2.volume) FROM (SELECT t1.volume, t1.rowid FROM (SELECT SUM(volume) AS volume FROM 'pre_admission_output.csv' WHERE patient_id = 10037975) AS t1 JOIN (SELECT rowid, volume FROM 'pre_admission_output.csv' WHERE patient_id = 10037975) AS t2 ON t1.rowid = t2.rowid WHERE t1.volume > 351",[{'SUM(outputevents.value)': None}]
980016183fee2c1f4ae611ae,Has patient 10007818 undergone laboratory tests since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',labevents.charttime) >= '2100'","SELECT COUNT(*) FROM lab_results WHERE lab_results.patient_id = 10007818 AND STRFTIME('%y', lab_results.date) >= '2100'",[{'COUNT(*)>0': 1}]
5bf08c9869d070204f3790e2,When was the first time that in 05/2100 patient 10018423 was prescribed a medication via nu?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.route = 'nu' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM medication_usage WHERE patient_id = 10018423 AND prescription_method = 'nu' AND date_prescribed BETWEEN '2000-05-21' AND '2000-05-21',[]
dc086ae27c1b78b95332d217,Is the o2 saturation pulseoxymetry level of patient 10011398 last measured on the first ICU visit less than the first measurement on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT (SELECT o2_saturation, pulseoxymetry FROM icu_o2_saturation WHERE icu_o2_saturation.patient_id = 10011398 AND NOT icu_o2_saturation.unit_number IS NULL ORDER BY icu_o2_saturation.measurement_time DESC LIMIT 1) < (SELECT o2_saturation, pulseoxymetry FROM icu_o2_saturation WHERE icu_o2_saturation.patient_id = 10011398 AND NOT icu_o2_saturation.unit_number IS NULL ORDER BY icu_o2_saturation.measurement_time NULLS FIRST LIMIT 1);","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
f95edd83ff3d509561310e88,How many days have it been since patient 10021487 had received a mch laboratory test during this hospital visit for the first time?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_mch.date)) FROM lab_mch WHERE lab_mch.patient = 10021487 AND lab_mch.date = SELECT MIN(lab_mch.date) FROM lab_mch WHERE lab_mch.patient = 10021487 AND lab_mch.date = SELECT MIN(lab_mch.date) FROM lab_mch WHERE lab_mch.patient = 10021487",[]
646dc3c2d9906fbf675e6443,How many hours have it been since patient 10004733 had received a hematocrit laboratory test on the current hospital encounter for the last time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', Hematocrit_Date)) FROM Hematocrit_Data WHERE Hematocrit_ID = (SELECT MAX(Hematocrit_ID) FROM Hematocrit_Data WHERE Patient_ID = 10004733 AND Hospital_ID = 1)",[]
a7bf9a18f2ed133ccc62c5c3,"In 2100, has patient 10039708 been diagnosed with anything?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10039708 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100'",
ff717f132bef7b20380c93f7,What was the name of the organism that was found in the last microbiology test on patient 10021487's abscess since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10021487 AND sample_type = 'abscess' AND date >= '2000-02-21' ORDER BY date DESC LIMIT 1,[]
bcda489a731952e657ccee47,When was the last time that patient 10027445 had a minimum respiratory rate on 09/09/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-09-09' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MAX(respiratory_rate) FROM patient_respiratory WHERE patient_id = 10027445 AND measurement_date = '2100-09-09',[]
110ca8ef52a592fe8201ca1c,What diagnosis did patient 10005866 have last in the first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10005866 AND NOT diagnoses.hospital_dischtime IS NULL ORDER BY diagnoses.hospital_admittime NULLS FIRST LIMIT 1;,
a035bf3a134c3a5f16e7e841,"How many hours elapsed since the first time patient 10021487 received a rbc, pleural lab test on this hospital visit?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', rbc.lab_date)) FROM RBC rbc WHERE rbc.patient_id = 10021487 AND rbc.lab_date IS NOT NULL",[]
89aa1f3b263599aa7da317e8,What was the name of the output which patient 10018081 had last had since 10/31/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-31' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT ""output"" FROM ""patient_outputs"" WHERE ""patient_id"" = 10018081 AND ""date"" >= '2100-10-31' ORDER BY ""date"" DESC LIMIT 1",[{'label': 'Foley'}]
103007809bffe0c602448146,How many patients were let go from hospitals in the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(*) FROM patients WHERE NOT hospitals.census IN (SELECT hospitals.census FROM hospitals WHERE hospitals.discharge_date IS NULL);,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
2add4b6f52a7f92255a99795,Could you list patient 10021938's daily average weight since 07/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10021938 AND date >= '2000-07-2100' GROUP BY date,[]
0f415abf215849df3c74d8fb,What is the average value of bicarbonate in patient 10025612's body?,SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ),SELECT AVG(Bicarbonate) FROM,[{'AVG(labevents.valuenum)': None}]
3f720ea93f94700efe7fe7ee,What is the percentile of 4.46 for a red blood cells test given the same age as patient 10026406 on the first hospital stay?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 4.46","SELECT SUM(t1.c1) FROM (SELECT c1, c2 FROM (SELECT STATUS, DATE_FROM FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = 'Jane Doe' LIMIT 1)) AS t1 JOIN (SELECT STATUS, DATE_FROM FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = 'Jane Doe' LIMIT 1)) AS t2 ON t1.status = t2.status WHERE t1.date_from < t2.date_from) AS t3 WHERE t3.c1 > 4.46",
b6e5095ddd979d4bfc1eecfb,Could you retrieve the top four most conducted lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT lab_test, COUNT(*) FROM lab_results WHERE date_data > CURRENT_DATE - INTERVAL '1 year' GROUP BY lab_test ORDER BY COUNT(*) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
51e8f8f67f2e66a1e780c1a3,What are the five most common prescriptions since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.prescriptions FROM (SELECT prescriptions, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT prescriptions FROM scripts WHERE date >= '2000-01-01') AS t1 GROUP BY prescriptions) AS t2 WHERE t2.c1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
9c16ed565a5fe37955e8407d,Was a procedure performed on patient 10015860 during the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10015860 AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
e72c9c21aabd74b3648906ef,"When was the first time that in 04/2100 patient 10024043 had the maximum of total protein, urine?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, urine' ) AND strftime('%Y-%m',labevents.charttime) = '2100-04' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT MAX(protein_urine) FROM 10024043 WHERE measurement_date = ""04/2100""",[]
49d1bd3a4560ab072f7825a7,What was the last heart rate value patient 10004720 had?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(heart_rate) FROM patient WHERE patient.id = 10004720;,[]
bfd437d57f4e32153e438f0c,What was the organism found in patient 10037975's first sputum test since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism FROM Sputum WHERE patient_id = 10037975 AND date >= '2002-01-01' ORDER BY date NULLS FIRST LIMIT 1,[]
30604ac94506d0892a2fd65e,"How many instances of the dilation of left common iliac vein with intraluminal device, percutaneous approach procedure were there during the last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.description = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",
d7f6b7afdf1779d271fed4bc,What is the total count of patients who stayed in careunit med/surg/gyn during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.careunit = ""MED/SURG/GYN"" AND DATETIME(patient.staydate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
59ecedfe8f2703a51503c566,Tell me the name of the specimen test that patient 10009049 first received since 02/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_test FROM requests WHERE patient_id = 10009049 AND date_received >= '2000-02-2100' ORDER BY date_received NULLS FIRST LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}]
6cd63183970459480e3afa9b,"After receiving simple excision of other lymphatic structure in this year, what are the four most common diagnoses that patients received in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT t1.id, t2.diagnosis FROM (SELECT id, diagnosis FROM diagnoses WHERE diagnosis = 'simple excision of other lymphatic structure') AS t1 JOIN (SELECT id, diagnosis FROM diagnoses GROUP BY id, diagnosis ORDER BY COUNT(*) DESC LIMIT 4) AS t2 ON t1.id = t2.id WHERE DATETIME(t1.diagnosis, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 GROUP BY t1.diagnosis ORDER BY COUNT(*) DESC LIMIT 4",
d5e1e8e66d78933ac955b076,When did patient 10021487 have the last respiratory rate observed to be less than 14.0 since 09/07/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 14.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-07' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT strftime(RespiratoryRate.Timestamp, '%y-%m-%d') as LastRespiratoryRateDate",[]
46ff832eeb6e9d538497577e,What's the count of patients who left the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT(DISTINCT patient_id) FROM patient_table WHERE NOT left_hospital IS NULL;,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
7f130db92be0aad49a7104a6,What new drugs are prescribed for patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT * FROM prescriptions WHERE patient_id = 10004733 AND date_sub('day', CURRENT_DATE, yesterday()) = 0",[]
40adf249c767a37afb9398c6,What do you do to disinfect the quarantine room?,,SELECT * FROM sanitation WHERE task = 'disinfect quarantine room';,
c327e43875d95df50f74425e,"When was the first time that patient 10005817 had the hematocrit, calculated maximum value?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT hematocrit, MAX(calculated_value) FROM lab_data WHERE patient_id = 10005817 AND lab_name = 'hematocrit' GROUP BY hematocrit ORDER BY COUNT(*) NULLS FIRST LIMIT 1",[]
897c83c8728e2e3ada59235e,List the top four most frequent microbiology tests given to patients after being diagnosed with physical restraints status within 2 months.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'physical restraints status' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t3.test, COUNT(t3.test) FROM (SELECT t2.test, COUNT(t2.test) FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'physical restraints status') AS t1 JOIN (SELECT patient.uniquepid, microbiology.test, microbiology.microbiology_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.microbiology_date AND DATETIME(t2.microbiology_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.test) AS t3 GROUP BY t3.test ORDER BY COUNT(t3.test) DESC LIMIT 4",
1d22e6440ebc8254221ff9ab,What is the type of blood that patient 18457 has?,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 18457",
a789bf245942cca833ba3d9e,How much does a hospital typically spend maximum on a drug named guaifenesin since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM pharmaceutical_company WHERE name = 'guaifenesin' AND date_produced > DATEADD(year, -1, CURRENT_DATE) GROUP BY date_produced) AS t1",
fc0310f4a0e6c3791fc800f8,"What is the average expense for assistance with cardiac output using balloon pump, continuous?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) )","SELECT AVG(Expense) FROM procedures WHERE Assistant = 'Cardiac Output using Balloon Pump, Continuous';",
c921232bb890d4227c27bc79,Get the count of the number of hospital visits of patient 10023117 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(Hospital_Visits) FROM Visits WHERE Patient_ID = 10023117 AND Year >= 2100;,[{'COUNT( DISTINCT admissions.hadm_id )': 7}]
878e753f48874ad8f8ceab3c,Tell me the minimum total hospital cost that involves closed [endoscopic] biopsy of bronchus?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) ) GROUP BY cost.hadm_id ) AS T1,,
a5661f4d9bc983fe089c2f6d,Was patient 10010471 given any drugs in the previous year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM patient WHERE patient.patient_id = 10010471 AND DATETIME(patient.last_drug_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT(*)>0': 0}]
e76aa0d663560abbc03fe1a7,What was a drug that patient 10004733 was prescribed for within 2 days after receiving enteral infusion of concentrated nutritional substances on the current hospital encounter?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.subject, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.subject WHERE patient.subject = 10004733 AND treatment.treatment_type = 'enteral infusion of concentrated nutritional substances') AS t1 JOIN (SELECT patient.subject, drug.drug, drug.date FROM drug JOIN patient ON drug.patient_id = patient.subject WHERE patient.subject = 10004733 AND patient.hospital_dischtime IS NULL) AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
d8f75bffa5cc49d6e7389a89,I need the total volume of input for patient 10005909 since 07/05/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-05'",SELECT SUM(volume) FROM input WHERE patient = 10005909 AND date >= '2100-07-05',[{'SUM(inputevents.totalamount)': 16695.0}]
10379bc71183afe73e396f57,What percentile is 0.9 creatinine in a patient of the same age as patient 10020740 during the first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.9",SELECT,
e44f5a7695147c0b38ec316e,What was the last hospital admission type for patient 10018845?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018845 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018845 ORDER BY admissions.admission_date DESC LIMIT 1;,[{'admission_type': 'EW EMER.'}]
e54a1e3c51bc1b0c7bca37f7,"Since 2100, what are the top five most frequently ordered lab tests for patients in the same hospital visit after being diagnosed with flatulence, eructation, and gas pain?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'flatulence, eructation, and gas pain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3. lab_test FROM (SELECT t2. lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Flatulence, eructation, and gas pain' AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100') AS t1 JOIN (SELECT admissions.subject_id, lab_test, lab_date FROM lab_results JOIN admissions ON lab_results.admission_id = admissions.admission_id WHERE STRFTIME('%y', lab_date) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.lab_date AND t1.admission_date = t2.admission_date GROUP BY t2.lab_test) AS t3 WHERE",
86e644ff0d66b3aee390fc72,What was the total dosage of polyethylene glycol prescribed to patient 10021312 since 05/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'polyethylene glycol' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'","SELECT SUM(dosage) FROM medication WHERE patient_id = 10021312 AND medication.type = 'polyethylene glycol' AND STRFTIME('%m/%Y', medication.date) >= '05/2100';",[{'SUM(prescriptions.dose_val_rx)': None}]
75054e4a84c29aca4b3607df,What was the total number of input patient 10021487 has received since 09/07/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07'","SELECT COUNT(DISTINCT t2.my_column) FROM (SELECT t1.my_column FROM (SELECT patient_id, visit_date FROM visit_table WHERE patient_id = 10021487) AS t1 JOIN (SELECT patient_id, visit_date FROM visit_table WHERE patient_id = 10021487) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.visit_date < t2.visit_date AND DATE(t2.visit_date) >= DATE('2100-09-07')",[{'SUM(inputevents.totalamount)': 169730.0}]
9e442d16828a578f4b27bb6f,What is the difference in patient 10019777's weights last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT patient.weight FROM patient WHERE patient.patient_id = 10019777' AND NOT patient.hospital_info.start_date IS NULL ORDER BY patient.hospital_info.start_date NULLS FIRST LIMIT 1) - (SELECT patient.weight FROM patient WHERE patient.patient_id = 10019777' AND NOT patient.hospital_info.start_date IS NULL ORDER BY patient.hospital_info.start_date DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
7fafde7941ee8321b6875326,"Tell me the number of cases of dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic that occurred in 2100.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.year = 2100 AND procedures.name = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic'",
736dfe17a5c5844830732c5c,What was the name of the drug that patient 10001217 was prescribed with during the same hospital visit after undergoing spinal tap since 30 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-30 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug_name FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10001217 AND treatment.treatment_type = 'spinal tap' AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-30 month')) AS t1 JOIN (SELECT patient.id, drug.drug_name, treatment.date FROM drug JOIN patient ON drug.patient_id = patient.id WHERE patient.id = 10001217 AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-30 month')) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND t1.patient_id = t2.patient_id",
ef9e46557f7fe863d42a695e,Provide the total input volume for patient 10020786 on 07/01/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-01'",SELECT SUM(input_volume) FROM intake_table WHERE patient_id = 10020786 AND intake_date = '07/01/2020',[{'SUM(inputevents.totalamount)': None}]
cae94b9b74b0ff5b8f016878,"For patients who undertook dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic within the same hospital visit, what are the top three most frequent specimens tested afterward this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen FROM (SELECT t2.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT patient.subject_id, procedures.date FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.procedure = 'Dilation of lower esophagus with intraluminal device' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.subject_id, specimen, date FROM biomaterial JOIN patient ON biomaterial.patient_id = patient.subject_id WHERE DATETIME(biomaterial.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date GROUP BY t2.specimen) AS t3 WHERE t3.rank <= 3",
962f54bae45dac154aceeff8,Can you tell me how many days patient 10005909 stayed in the ICU during their last stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT COUNT(DISTINCT ICU_DAY) FROM ICU WHERE PATIENT_ID = 10005909 AND NOT ICU_DEPARTMENT IS NULL ORDER BY ICU_DAY DESC LIMIT 1,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.677384258713573}]"
12fb8402b00499381bd3ff8c,What was the drug patient 10008287 was prescribed for the first time using the po/ng route since 06/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(drug_date) FROM (SELECT patient_id, drug_date FROM prescriptions WHERE route = 'po/ng' AND patient_id = 10008287)",[]
e60e3b0dd9bb998ce08e850c,"Since 30 months ago, what was patient 10004720's first weight measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-30 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(weight) FROM patients WHERE patient_id = 10004720 AND measurement_date >= DATEADD(month, -30, CURRENT_DATE)",[]
02885cc1fb11efec74cb16fd,When did first patient 10021487 have the maximum value of amylase during this hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT patient.hospital.admittime FROM patient WHERE patient.hospital.dischtime IS NULL AND patient.amylase = (SELECT MAX(patient.amylase) FROM patient WHERE patient.hospital.dischtime IS NULL) AND patient.hospital.admittime IS NOT NULL AND patient.id = 10021487,[]
5bfa8dfb474aab488d477069,"Did patient 10021118 undergo the excision of right saphenous vein, percutaneous endoscopic approach procedure in the last year?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right saphenous vein, percutaneous endoscopic approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10021118 AND procedures.procedure_name = 'excision of right saphenous vein, percutaneous endoscopic approach' AND DATETIME(procedures.date_procedure, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",
ac29c708a74c9c79fcbab164,Count the number of current patients who are in their 30s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT(*) FROM patients WHERE current_patient = true AND age BETWEEN 30 AND 39,
e9a36293a5d2d223562338c9,What was the name of the organism that was found during the last mini-bal test of patient 10021487 since 11/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM organism_table WHERE patient_id = 10021487 AND date_last_mini_bal >= '2000-11-21' ORDER BY date_last_mini_bal DESC LIMIT 1,[]
3e6c40802e7951b28402583b,When was the last input time of patient 10027602 since 11/26/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10027602 AND input_time >= '2100-11-26',[{'starttime': '2201-12-13 16:51:00'}]
1f89610cbce4f404c0d528e6,When did patient 10002428's last microbiological test occur since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology WHERE patient_id = 10002428 AND date BETWEEN '2000-03-2100' AND '2000-03-2100',[{'charttime': '2156-05-17 19:58:00'}]
fb44777e76712299533eaf79,What is the cost for the procedure right heart cardiac catheterization?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'right heart cardiac catheterization';,
e1b0ecc193437991940016e6,"Has patient 10029484 been on glipizide xl, 0.9% sodium chloride, or insulin human regular as prescribed?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.drug IN ( 'glipizide xl', '0.9% sodium chloride', 'insulin human regular' )","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10029484 AND prescriptions.drug IN ('glipizide xl', '0.9% sodium chloride', 'insulin human regular')",[{'COUNT(*)>0': 0}]
b51cf6ccd388a090596b77a3,When was patient 10004720's first hospital discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patients.hospital_discharge_date FROM patients WHERE patients.subject_id = 10004720,[{'dischtime': '2186-11-17 18:30:00'}]
a6dfce8ef3e5a14b57bd2d11,What is the correct dosage of the prescribed opioid to patient 19428?,,"SELECT ""dosage"" FROM ""prescriptions"" WHERE ""patient_id"" = 19428 AND ""prescription_type"" = 'opioid'",
26e67a0d26da3791abc625a2,How many times was olanzapine prescribed during this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine' AND DATETIME(prescriptions.start_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)': 0}]
5941ed9f1a4d31ed438338d9,"Throughout this year, what are the top four most frequently ordered lab tests for patients in the same month after being diagnosed with unspecified essential hypertension?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'unspecified essential hypertension') AS t1 JOIN (SELECT patient.uniquepid, lab_test.lab_test, lab_test.lab_date FROM lab_test JOIN patient ON lab_test.patient_id = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.lab_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_date, 'start of month') GROUP BY t2.lab_test) AS t3 WHERE t3.c1 <= 4",
9ecd148b83207e3fbed2a937,What was the condition patient 10020740 was diagnosed with first time since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis.condition FROM diagnosis WHERE diagnosis.patient = 10020740 AND DATETIME(diagnosis.date) >= DATETIME(CURRENT_TIME, '-1 year') ORDER BY diagnosis.date NULLS FIRST LIMIT 1",
778dec17c4569dd7f4da476a,What kind of medicine does patient 17638 take after they got the instruction of another department at our hospital,,SELECT TYPE FROM medication WHERE patient_id = 17638 AND instructions FROM medication WHERE patient_id = 17638 AND role = 'pharmacist',
a5e6297c3b4d206acb9998da,When was the first microbiology test that was given to patient 10014354 since 4 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-4 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT MIN(microbiology_date) FROM microbiology WHERE microbiology.patient_id = 10014354 AND DATETIME(microbiology_date) >= DATETIME(CURRENT_TIME, '-4 month')",[{'charttime': '2146-10-09 03:13:00'}]
32bd2842efa8e518c4f30155,"How many times was a drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure done?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' )","SELECT COUNT(*) FROM procedures WHERE procedures.drainage_route = 'right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic'",[{'COUNT(*)': 0}]
024e5c4760ca03ad0215c516,When was patient 10001725 first prescribed the medication via the im route during their last hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(date_prescribed) FROM medication WHERE medication.patient_id = 10001725 AND medication.route = 'im',[]
b280ebdb1c738becbca7cc1d,When was the last time that patient 32755 had a medication that was regularly taken?,,SELECT MAX(date_last_taken) FROM medication WHERE medication.patient_id = 32755 AND date_regularity = 'regular';,
2ca4465dba3c16260aab1d62,Calculate the number of loratadine prescriptions in 2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'loratadine' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Loratadine' AND STRFTIME('%y', prescriptions.date) = '2100';",[{'COUNT(*)': 0}]
a8f04b428e4feaac42d610de,Has patient 10015860 come to the ER during this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(*) FROM visit_brackets WHERE patient_id = 10015860 AND visit_type = 'emergency room admit' AND visit_date BETWEEN '2012-01-01' AND '2012-12-31',[{'COUNT(*)>0': 0}]
b6cd8d8d63a88cfb0db6d978,What are the four commonly taken specimens for patients that were diagnosed with other late effects of cerebrovascular disease previously during the same month?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other late effects of cerebrovascular disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT specimen, COUNT(specimen) FROM (SELECT patient.name, diagnosis.month FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.type = 'Other late effects of cerebrovascular disease') AS subquery GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 1",
3c7c50f6746a47772cb02cbf,Did patient 10007928 take a nacl 0.9% medication in their first hospital visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),"SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10007928 AND medication.drug_name = 'NACL 0.9%' AND STRFTIME('%y', medication.start_date) = '2012' AND STRFTIME('%y', medication.start_date) = '2012'",[{'COUNT(*)>0': 0}]
902c95e30f8c9752224d22f9,Are there any changes in the prescribed drugs of patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM drugs WHERE patient_id = 10039831 AND date = CURRENT_DATE - INTERVAL '1 day',[]
b64781d0b4bde8ed18b8cb5d,Show me the monthly maximum weight of patient 10018081 since 2100.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10018081 AND year(date) >= 2100 GROUP BY month(date);,[]
d701f4d1d856c591e1e4c95d,What is the number of patients who had a globulin test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'globulin' ) AND strftime('%Y',labevents.charttime) = '2100' )","SELECT COUNT(DISTINCT ""patient_id"") FROM ""test_results"" WHERE ""test_name"" = 'globulin' AND ""year"" = 2100",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
40e8dd3b84d22a385983c8f7,Can you tell me the maximum SaO2 for patient 10016742's body on 08/03/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-08-03'","SELECT MAX(SaO2) FROM ""body"" WHERE ""patient_id"" = 10016742 AND ""date"" = '08/03/2100'",[{'MAX(chartevents.valuenum)': None}]
2207f2b9a9690a68915d6ab4,What are the four most common treatments for patients who are 50s this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT UNNEST(treatments) AS treatment FROM patients WHERE age BETWEEN 50 AND 59) AS t1 JOIN (SELECT UNNEST(treatments) AS treatment FROM patients WHERE age BETWEEN 50 AND 59) AS t2 ON t1.treatment = t2.treatment WHERE YEAR(t1.date) = YEAR(CURRENT_DATE) GROUP BY t1.treatment) AS t3 GROUP BY t3.treatment ORDER BY COUNT(t3.treatment) DESC LIMIT 4",
4202b117d324f6285ecaf255,How many hours have elapsed since patient 10004733's first stay in the careunit medical/surgical intensive care unit (micu/sicu) during their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.first_stay_date)) FROM patient WHERE patient.subject_id = 10004733 AND patient.dischtime IS NULL",[]
bd799ac5e9eb3fc8ae226402,What was the organism's name of the last foreign body microbiology test done on patient 10007795?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'foreign body' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT Organism FROM microbiology WHERE PatientID = 10007795 AND TestName = 'Foreign Body' ORDER BY Date DESC LIMIT 1;,[]
6a6845f8f10630a1084755dd,What is the cost of the drug named nicardipine iv?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nicardipine iv' ),SELECT cost FROM drugs WHERE name = 'nicardipine iv',
94c416e60fecdda4973a6173,Has there been any organism detected during the last mrsa screen microbiology test of patient 10015860 since 05/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*) FROM organism_detected WHERE patient_id = 10015860 AND screen_date >= '2000-05-2100',[{'COUNT(*)>0': 0}]
e219db6bec1a6b0c74699c00,"When did patient 10039831 last have the minimum amount of sodium, whole blood in 12/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1","SELECT strftime(1254.0, '%W/%Y') as last_min_sodium_date",[]
9eaee8b12a9d726c44201f25,Do you remember which immuno-cancer drugs have been used over the past five years?,,SELECT DISTINCT drug_name FROM immuno_cancer_drugs WHERE date_used > CURRENT_DATE - INTERVAL '5 year';,
27b1b0cb6cac06060411bcfb,How many patients were in neurology?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' ),SELECT COUNT(*) FROM patients WHERE diagnosis = 'NEUROLOGY';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f1501b008c57806e4fdc437f,Can you tell me the name of the diagnosis patient 10020740 received first in their last hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis.diagnosis_name FROM diagnosis WHERE diagnosis.patient_id = 10020740 AND diagnosis.hospital_rank = (SELECT COUNT(DISTINCT diagnosis.diagnosis_name) FROM diagnosis WHERE diagnosis.patient_id = 10020740 AND NOT diagnosis.hospital_id IS NULL ORDER BY diagnosis.diagnosis_name NULLS FIRST LIMIT 1),
4c0c525de0bed58277a23a11,What was the aggregate input volume for patient 10021312 since 07/16/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-16'",SELECT AVG(input_volume) FROM input_table WHERE patient_id = 10021312 AND input_date >= '2100-07-16';,[{'SUM(inputevents.totalamount)': 3300.0}]
341a4ea74a6802ad1a55e2ff,When was the first microbiology test that was given to patient 10015931 since 05/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM microbiology WHERE patient = 10015931 AND date >= '2000-05-2100',[{'charttime': '2176-11-15 22:07:00'}]
44091b4ad36dad1ed6a3d8b1,What changes were made in the prescription of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT * FROM patient WHERE patient.id = 10018081 AND DATETIME(prescription.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescription.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
d1c26e1486ac8b878082f4ea,Retrieval of the top three most frequent outputs in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT 2000 FROM (SELECT 2000, COUNT(*) FROM 2000 GROUP BY 2000 ORDER BY COUNT(*) DESC LIMIT 3) AS T;",[]
c1b3f37142e9c9cf9ba75b12,What was the condition patient 10014729 was diagnosed with last time during the first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis_condition FROM diagnoses WHERE patient_id = 10014729 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.diagntime NULLS FIRST LIMIT 1,
3de9617a7e8dcc80de879fc5,What was the name of the output that patient 10039831 got first since 12/23/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-23' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT output_name FROM duckdb_outputs WHERE patient_id = 10039831 AND date_since = '12/23/2100' ORDER BY date_since NULLS FIRST LIMIT 1,[{'label': 'OR EBL'}]
ae6519f14e5f7700af940f59,Has patient 10004235 received any treatment of laparoscopic cholecystectomy since 1 year ago?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM treatment WHERE treatment.patient_id = 10004235 AND treatment.treatment_name = 'laparoscopic cholecystectomy' AND DATETIME(treatment.treatment_date) >= DATETIME(CURRENT_TIME, '-1 year')",
2ff2e805ec42ef3feedcd1aa,What was the number of patients receiving thoracoscopic decortication of lung during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic decortication of lung' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date FROM (SELECT subject_id, date FROM patients WHERE date = SELECT date FROM patients WHERE date BETWEEN '2021-01-01' AND '2021-12-31') AS t1 JOIN procedures ON t1.subject_id = procedures.subject_id WHERE procedures.procedure = 'thoracoscopic decortication of lung') AS t2 ON t1.subject_id = t2.subject_id AND t1.date = t2.date",
a00afef4fe749df9db791752,What is the maximum cost to the hospital that involves other fluid overload?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(COST(100000000)) FROM (SELECT 100000000 AS COST FROM diagnoses WHERE diagnosis = 'other fluid overload') AS T;,
5e93d590379eb00b3a76b6aa,When has patient 10020740 been prescribed medication for the last time in 04/2100 via the po route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10020740 AND route = 'po' AND date_prescribed BETWEEN '2000-04-01' AND '2000-04-2100',[]
455145565c06c0334318ab67,"On this month/18, when was the last input time of patient 10010471?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '18' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT MAX(input_time) FROM input_table WHERE patient_id = 10010471 AND date_part('month', input_time) = date_part('month', CURRENT_TIME, '-18 month') AND date_part('day', input_time) = date_part('day', CURRENT_TIME, '-18 month');",[]
9ae1e99a336fdea068c22d52,What was the first drug that was prescribed to patient 10021312 via the po/ng route in 09/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(drug_start_date) FROM prescriptions WHERE prescriptions.patient_id = 10021312 AND prescriptions.route = 'po/ng' AND DATETIME(prescriptions.drug_start_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.drug_start_date) = '09'",[]
ac99a2f4b7ce6677c8f21cf0,What are the five most frequently ordered medications that patients in their 40s were prescribed within 2 months after being diagnosed with esophageal reflux in this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'esophageal reflux' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age BETWEEN 40 AND 49 AND DATETIME(medication.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.di",
06b1eef22357320dc0f8a64a,"For the first time, what was the medication that patient 10026255 was prescribed during the first hospital encounter via the ih route?",SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MEDICATION FROM prescriptions WHERE patient_id = 10026255 AND route = 'ih' AND medication_date = (SELECT MIN(medication_date) FROM prescriptions WHERE patient_id = 10026255 AND NOT patient_hospital_info.dischtime IS NULL ORDER BY patient_hospital_info.admittime NULLS FIRST LIMIT 1),[]
69d6df3a555ac16f922234f9,What was the first specimen test that was given to patient 10023239 since 04/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",,[{'spec_type_desc': 'MRSA SCREEN'}]
1e3b44203311b415f4712cc6,"During their last hospital encounter, was patient 10031404 given any diagnosis?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10031404 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.admittime DESC LIMIT 1,[{'COUNT(*)>0': 1}]
91405986ac7029c89c4e111c,Tell me the name of an output that patient 10013049 has first had since 03/07/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM output WHERE patient = '10013049' AND date_first_had > '2100-03-07',[{'label': 'OR Urine'}]
3ce0aee35413ee29a66136d0,What was the last drug prescribed to patient 10007058 during the last month via the iv route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(drug_date) FROM patient WHERE patient.id = 10007058 AND iv_route = 'last month',[]
26aa4388a8897474b77aa481,What was the total number of drugs patient 10005817 was prescribed since 08/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10005817 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-08'",[{'COUNT(*)': 435}]
a07f951288594d0721e53be7,Has patient 10021938 come into the ER in this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM patient WHERE patient.date_entered_emergency_room = DATETIME(CURRENT_TIME, '-0 year') AND patient.unique_ patient_id = 10021938",[{'COUNT(*)>0': 0}]
cb26c31984006b29f2c93878,Does patient 83038 have a family history of any disease?,,"SELECT COUNT(*) > 0 FROM patients WHERE patients.family_history = ""Yes"" AND patients.unique_patient_id = 83038",
8b4571147c610648de61a6ab,"On 05/08/this year, what was the first o2 saturation pulseoxymetry reading for patient 10018328?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '05-08' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(O2_SATURATION_PULSEOXYMETRY) FROM pulseoxymetry WHERE PATIENT_ID = 10018328 AND STUDY_DATE = '2005-08-20',[]
56eab13d0583a58c43247431,How many drugs have been prescribed to patient 10008454 since 2 months ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month')","SELECT COUNT(*) FROM medication_table WHERE medication_table.patient_id = 10008454 AND DATETIME(medication_table.date) >= DATETIME(CURRENT_TIME, '-2 month')",[{'COUNT(*)': 139}]
ac7bf3a501336d2c4fb93d27,"What were the three most commonly ordered lab tests for patients who were previously diagnosed with edema of male genital organs in the same month, this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnoses.diagnosis_date FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.patient_id WHERE diagnoses.diagnosis = 'edema of male genital organs' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, lab_test, lab_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.patient_id WHERE DATETIME(lab_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.lab_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATET",
b3a9bd9b492cf5ebf684f04b,What were the four most common lab tests given since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT lab_test, COUNT(lab_test) FROM lab_results WHERE date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
ae10b786bdd68be86808411b,"What is the total count of performance of cardiac output, continuous procedures that were done since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM cardiac_output, continuous_procedures WHERE cardiac_output.output_time >= 2100 AND continuous_procedures.procedure_time = cardiac_output.output_time",
67ea2ec7c02ee83ea4a04d59,Tell me the total input for patient 10016742 since 07/23/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-23'",SELECT COUNT(input) FROM brackets WHERE patient = 10016742 AND input_date >= '2000-07-23',[{'SUM(inputevents.totalamount)': 36640.0}]
95b288888e266b0b15c485fd,Retrieve the top three most common diagnoses for patients with age 50s during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM patients WHERE age BETWEEN 50 AND 59 AND DATETIME(diagnosis, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 3",
4f42b7f15b57fa921a5c03ea,How many hours has it been since the first other chronic nonalcoholic liver disease diagnosis of patient 10021487 on the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = 10021487 AND diagnosis.diagnosis_category = 'Other chronic nonalcoholic liver disease'",
e1dd13daac1ecaf666f55bc2,"Hey, what was patient 10029291's maximum ptt value in 03/2100?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",SELECT MAX(ptt) FROM patients WHERE patient_id = 10029291 AND measurement_date BETWEEN '2003-03-2100' AND '2003-03-2100',[{'MAX(labevents.valuenum)': None}]
54ecb54032c2c4402da787c8,"Of the patients aged 30s since 1 year ago, what are the top three most common procedures?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT * FROM patients WHERE age BETWEEN 30 AND 39) AS t1 JOIN (SELECT * FROM procedures WHERE date >= CURRENT_DATE - INTERVAL '1 year') AS t2 ON t1.treatment = t2.treatment GROUP BY t2.treatment) AS t3 WHERE t3.c1 <= 3",
8a3f528d01b5216685826b2a,What number of patients stayed in medicine/cardiology during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine/cardiology' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.dischtime FROM (SELECT subject_id, diagnosis, dischtime FROM (SELECT subject_id, diagnosis, dsdgen(dischdate, '-1 year') as dsdgen_dischdate FROM (SELECT subject_id, diagnosis, dsdgen(diagnosis, '-1 year') as dsdgen_diagnosis FROM (SELECT subject_id, diagnosis FROM (SELECT subject_id, 'Medicine/Cardiology') as diagnosis GROUP BY subject_id HAVING MIN(dischdate) = dsdgen_dischdate) AS t1 JOIN (SELECT subject_id, dsdgen(dischdate, '-1 year') as dsdgen_dischdate FROM (SELECT subject_id, diagnosis, dsdgen(diagnosis, '-1 year') as dsdgen_diagnosis FROM (SELECT subject_id, diagnosis FROM (SELECT subject_id, 'Medicine/Cardiology') as diagnosis GROUP BY subject_id HAVING MIN(dischdate",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d3c7771380374c5d73ffd28f,Tell me the amount of foley patient 10021487 had on 12/21/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-21'",SELECT SUM(Foley) FROM MyDatabase WHERE PatientID = 10021487 AND Date = '2021-12-21',[{'SUM(outputevents.value)': None}]
921bedddb3b4dad89ed751aa,"What were the five most frequently ordered procedures for patients who had also received drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.procedure FROM (SELECT t2.procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquecarrier, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquecarrier WHERE treatment.procedure = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic') AS t1 JOIN (SELECT patient.uniquecarrier, treatment.procedure, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquecarrier WHERE treatment.procedure = 'other procedures') AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.treatmentdate < t2.treatmentdate AND DATETIME(t2.treatmentdate) BETWEEN DATETIME(t1.treatmentdate) AND DATETIME(t1.treatmentdate, '+2 month') GROUP BY t2.procedure) AS t3 WHERE t3.c1 <= 5",
fc990cb9419776227c9994e7,Show me patient 10014078's total amount of magnesium sulfate (bolus) input on 09/07/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-07'",SELECT SUM(input_magnesium_sulfate_bolus) FROM input_table WHERE patient_id = 10014078 AND input_date = '2100-09-07',[{'SUM(inputevents.totalamount)': None}]
73a58a83894d2589594daf4a,What were the five most frequent output events in this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT event FROM output WHERE date BETWEEN '2015-01-01' AND '2015-12-31' GROUP BY event ORDER BY COUNT(*) DESC LIMIT 5;,[]
163d3f81e0ca38daf1f919a2,"When was the last time the mean blood pressure of patient 10021118 was greater than 74.0, on this month/05?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 74.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '05' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT strftime(last_modified, 'Month/05') as LastModified",[]
47ca8eab856cae1f24914f04,What were the last pt lab test results for patient 10022880 in 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1","SELECT PT_LAB(10022880, '03/2100') FROM results WHERE PT_LAB(10022880, '03/2100') IS NOT NULL ORDER BY PT_LAB(10022880, '03/2100') DESC LIMIT 1",[]
ce36c547c1a37852e65fc5c3,Can you get me the top four diagnoses that have the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT t4.diagnosis, t4.6month_mortality_rate FROM (SELECT t3.diagnosis, t3.6month_mortality_rate FROM (SELECT t2.diagnosis, t2.6month_mortality_rate FROM (SELECT t1.diagnosis, t1.6month_mortality_rate FROM (SELECT 'All diagnoses and their 6-month mortality rate' AS diagnosis, 6month_mortality_rate FROM t1 UNION ALL SELECT diagnosis, 6month_mortality_rate FROM t2 UNION ALL SELECT diagnosis, 6month_mortality_rate FROM t3 UNION ALL SELECT diagnosis, 6month_mortality_rate FROM t4) AS t1 GROUP BY t1.diagnosis) AS t2 GROUP BY t2.diagnosis) AS t3 GROUP BY t3.diagnosis) AS t4 ORDER BY t4.6month_mortality_rate DESC LIMIT 10",
e86ed01755d7638dbad6517f,"Has patient 10016742 received any treatment of respiratory ventilation, greater than 96 consecutive hours?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 )","SELECT COUNT(*) > 0 FROM treatment_table WHERE patient_id = 10016742 AND treatment_type = 'respiratory ventilation, greater than 96 consecutive hours'",[{'COUNT(*)>0': 0}]
3d81d416bd9cb490c9afa856,How often was morphine sulfate (oral solution) 2 mg/ml prescribed since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)': 0}]
2ca8e56caf706c6147547a1a,During what first time did patient 10020944 have the minimum basophils level?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT MIN(Basophils) FROM ""Patient 10020944""",[]
72f7cf565eac6853d4a5f4bc,Can you show me the drug that patient 10007058 was first prescribed since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10007058 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-07' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[{'drug': '5% Dextrose'}]
fd430b3bc6f281ccc988453c,How many days have passed since the last time patient 10021487 has received a glucose-lab test on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', Test_Date)) as Days_Since_Last_Test",[]
239fb5f5541fdf88fed6bf3c,What was patient 10004733's respiratory rate for the last time on 12/23/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-23' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT respiratory_rate FROM read_parquet('patient_10004733.parquet') WHERE measurement_date = '12/23/2100',[]
e66bc926c13901e2b96e1418,What were the four most common drugs prescribed this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t.drug FROM (SELECT d.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS cn FROM drugs d WHERE DATETIME(d.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY d.drug) t WHERE t.cn <= 4;",[]
d86c1530c01a8065fe956df5,What was the drug patient 10010471 was prescribed for the last time using the po route since 03/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_po) FROM patient WHERE patient.id = 10010471 AND route = 'po' AND date_po >= '2000-03-2100',[]
01f974128b8f1c4383263191,What was the aggregate input volume for patient 10027602 since 09/26/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-26'",SELECT AVG(input_volume) FROM input_table WHERE patient_id = 10027602 AND input_date >= '2100-09-26',[{'SUM(inputevents.totalamount)': 81320.0}]
34b93ea1246f25eeebd0e8c9,Provide me with the name of the diagnosis patient 3277 received in the other department.,,SELECT diagnosis FROM other_department WHERE patient_id = 3277,
d83c8510ff1184c1d92ff459,What was patient 10014354's first measurement for respiratory rate on 10/20/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '10-20' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(respiratory_rate) FROM measurements WHERE patient_id = 10014354 AND measurement_date BETWEEN '2022-10-20' AND '2022-10-20' AND measurement_type = 'respiratory rate',[]
ea46c6446f611ab80789ec15,Give me patient 10007058's total lr input on last month/23.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '23'","SELECT SUM(input_lr) FROM patient WHERE patient_id = 10007058 AND input_date = DATEADD(month, -1, DATEADD(day, 23, DATE '1992-03-07'))",[{'SUM(inputevents.totalamount)': None}]
96c87d6620403ab5197e010c,"For the last time in 08/this year, what was the drug that patient 10027445 was prescribed via sc route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10027445 AND prescriptions.route = 'sc' AND DATETIME(prescriptions.created_at, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.created_at) = '08' ORDER BY prescriptions.created_at DESC LIMIT 1",[]
296ec4ec76a62cac4fd007bb,Tally up the number of patients who received a red blood cells lab test in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND strftime('%Y',labevents.charttime) = '2100' )",SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.lab_red_blood_cells = '2100',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
13bbb7977ea8096ece5542dc,Which are the top four most frequent procedures patients had within 2 months after being diagnosed with personal history of other malignant neoplasm of skin since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other malignant neoplasm of skin' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, COUNT(t2.procedure) FROM (SELECT patient.id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Personal history of other malignant neoplasm of skin' AND STRFTIME('%y', diagnosis.date) >= '2100') AS t1 JOIN (SELECT patient.id, procedure.procedure, procedure.date FROM procedure JOIN patient ON procedure.patient_id = patient.id WHERE STRFTIME('%y', procedure.date) >= '2100') AS t2 ON t1.id = t2.patient_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.procedure) AS t3 WHERE COUNT(t3.procedure) > 4",
c1d67292940ffad4ade361e9,Whats the reimbursement standard for a cerebrovascular mri?,,"SELECT ""Reimbursement Standard"" FROM ""Clinical Procedures"" WHERE ""Procedure"" = 'Cerebrovascular MRI'",
b822898d1d41ded52d61fbed,What were the top four most common diagnoses that followed within 2 months for those who received diagnostic ultrasound of digestive system since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT diagnosis, COUNT FROM (SELECT patient.uniquepid, diagnosis, TIMESTAMPDIFF(MONTH, diagnosis, TIMESTAMP) AS month FROM patient INNER JOIN diagnosis ON patient.uniquepid = diagnosis.uniquepid WHERE diagnosis.diagnosis = 'DIAGNOSIS OF ULTRASOUND OF DIGESTIVE SYSTEM' AND STRFTIME('%y', diagnosis.timestamp) >= '2100') AS embedded_data WHERE month <= 2 GROUP BY diagnosis ORDER BY COUNT DESC LIMIT 4",
89ef9c7f4b5b2407980dfada,Was patient 10019777 on any vital high protein (full) in 03/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-03'",SELECT COUNT(*) FROM vital_high_protein WHERE patient_id = 10019777 AND measurement_date BETWEEN '2000-03-2100' AND '2000-03-2100' AND protein_category = 'full',[{'COUNT(*)>0': 0}]
ba4c239a6efd2a45b4fd4c15,What are the four most frequent microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT test, COUNT(test) FROM microbiology_tests WHERE date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY test ORDER BY COUNT(test) DESC LIMIT 4;","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]"
bec56d5d887095fdec4a748d,How many prescriptions were prescribed in 2100 for iso-osmotic sodium chloride?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Iso-Osmotic Sodium Chloride' AND STRFTIME('%y', prescriptions.date) = '2100';",[{'COUNT(*)': 0}]
37e1a7e88398803e5188be91,How many patients stayed on cardiac vascular intensive care unit (cvicu) during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac vascular intensive care unit (cvicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",SELECT COUNT(DISTINCT patient_id) FROM cardiac_vascular_intensive_care_unit WHERE year = (SELECT EXTRACT(YEAR FROM CURRENT_DATE) - 1),[{'COUNT( DISTINCT admissions.subject_id )': 0}]
6a0ee1b4229838dcbe29e41a,What was the number of times cepacol (menthol) was prescribed in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cepacol (menthol)' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cepacol (menthol)' AND STRFTIME('%y', prescriptions.date) = '2100';",[{'COUNT(*)': 0}]
e1ea16fb2fe09b1b73839ca3,Show me the top four most frequent lab tests in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.Lab_Test, COUNT(t1.Lab_Test) FROM (SELECT Lab_Test FROM Lab_Tests WHERE Year = 2000 GROUP BY Lab_Test) AS t1 JOIN (SELECT Lab_Test FROM Lab_Tests WHERE Year = 2010 GROUP BY Lab_Test) AS t2 ON t1.Lab_Test = t2.Lab_Test GROUP BY t1.Lab_Test ORDER BY COUNT(t1.Lab_Test) DESC LIMIT 4",[]
e346948b183416231db2bb3c,Count the number of hospital visits that patient 10019917 had in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(VisitID) FROM Visits WHERE PatientID = 10019917 AND STRFTIME('%y', VisitDate) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
a5b1c0e43266c3abbd391cf4,Tell me the number of patients who were prescribed ferric gluconate since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ferric gluconate' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patientname = 'ferric gluconate' AND STRFTIME('%y', patient.date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
17c8391662dfc6e28aa56464,How many drugs have been prescribed to patient 10023239 in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10023239 AND STRFTIME('%y', prescriptions.date) = '2100'",[{'COUNT(*)': 0}]
561c6a4161ac2feb86d80aed,How many times phosphorus was ordered in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND strftime('%Y',prescriptions.starttime) = '2100'",SELECT COUNT(*) FROM orders WHERE ordered_date BETWEEN '2021-01-01' AND '2021-12-31' AND product_name = 'phosphorus',[{'COUNT(*)': 0}]
04572e0972a7993db0621881,When was the last microbiological test of patient 10037861 since 01/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(microbiological_test_date) FROM microbiology_tests WHERE patient_id = 10037861 AND microbiological_test_date >= ""01/2100""",[{'charttime': '2117-03-20 11:30:00'}]
c296b026cf38437fb7dfc933,How many people were given prescriptions for albumin 25% (12.5g / 50ml) since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.patientunit = 'prescriptions' AND prescriptions.drug = 'Albumin 25% (12.5g / 50ml)' AND DATETIME(prescriptions.startdate) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
bae6bdda5b9a9cb808040a25,How much does patient 10019777 weigh difference last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT weight_difference FROM (SELECT weight FROM patients WHERE patient_id = 10019777 AND NOT last_hospital_visit IS NULL ORDER BY last_hospital_visit DESC LIMIT 1) AS T1 JOIN (SELECT weight FROM patients WHERE patient_id = 10019777 AND NOT last_hospital_visit IS NULL ORDER BY last_hospital_visit DESC LIMIT 1) AS T2 ON T1.date = T2.date),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
ca4e42b32f0b7c47922fe65e,Has patient 10003046 experienced any surgeries during this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10003046 AND DATETIME(procedures.procedure_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
72aa0a8195cef04d785d835c,When was patient 10029291's last input time since 03/05/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10029291 AND input_time >= '2100-03-05',[{'starttime': '2123-03-04 21:45:00'}]
85e40ee7c74d7603718dca90,"Among patients who were administered dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic this year, what were the top three most common treatments that they received in the same hospital encounter?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatment = 'Dilation of left main bronchus with intraluminal device' AND DATETIME(treatment.treatmenttime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE DATETIME(treatment.treatmenttime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.treatmenttime AND t1.patientname = t2.",
b6cb5bc47c02678729d05510,Are there new medications in the prescription of patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT COUNT(*) > 0 FROM prescription WHERE prescription.patient_id = 10039831 AND DATETIME(prescription.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescription.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
44f2c9be4fc4e3268e1c8ba0,What was the last time of patient 10019385 staph aureus swab microbiology test since 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(microbiology_date) FROM microbiology WHERE patient_id = 10019385 AND microbiology_type = 'staph aureus swab' AND STRFTIME('%y-%m', microbiology_date) >= '2100-02'",[]
98f8d45306d4c05c5916a214,What were the most frequent diagnoses among the top five in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.uniquepid WHERE STRFTIME('%y', diagnosis.diagnosisdate) = '2100') AS t1 WHERE t1.c1 <= 5;",
5182aaa70c734958ef8e43ba,"Since 10/2100, when did patient 10038992 last get prescribed vitamin d and felodipine at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'felodipine' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM (SELECT date_prescribed FROM prescriptions WHERE patient_id = 10038992 AND prescription_name = 'vitamin d' AND date_prescribed >= '2021-02-10' UNION SELECT date_prescribed FROM prescriptions WHERE patient_id = 10038992 AND prescription_name = 'felodipine' AND date_prescribed >= '2021-02-10'),[]
32eaf17262d5b8862394bdba,What was the name of the drug prescribed for patient 10004235 within the same day after having received a anastomosis of hepatic duct to gastrointestinal tract procedure in 07/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patientId = patient.id WHERE patient.id = 10004235 AND treatment.type = 'anastomosis of hepatic duct to gastrointestinal tract' AND STRFTIME('%y-%m', treatment.date) = '2100-07') AS t1 JOIN (SELECT patient.id, prescription.drug FROM prescription JOIN patient ON prescription.patientId = patient.id WHERE patient.id = 10004235 AND STRFTIME('%y-%m', prescription.date) = '2100-07') AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day')",
c3771288ef450c465644693b,What was the first drug that was prescribed to patient 10021487 via the pr route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(drug_date) FROM prescriptions WHERE prescriptions.patient_id = 10021487 AND prescriptions.route = 'pr',[]
f06393ab8b048f69f34b0dd2,When was the last time since 141 days ago patient 10010471's SaO2 was less than 100.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 100.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-141 day') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(current_timestamp) FROM patient WHERE patient.id = 10010471 AND patient.sao2 < 100.0 AND DATETIME(current_timestamp) - DATETIME(patient.last_modified) > INTERVAL '141 day',[]
a39b48bf94054784fed63d35,What is today's outpatient schedule with dr. welling?,,SELECT * FROM appointments WHERE dr_name = 'welling' AND apt_type = 'outpatient' AND apt_date = CURRENT_DATE;,
03a5a6bba8bab1a26a453a24,Count the number of patients who were discharged during the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissed_date IS NULL AND DATETIME(dismissed_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year');",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
853d39a04eeeedbb0a28a7d6,How much was the difference in weight of patient 10004422 measured at 2100-01-25 05:00:00 compared to the value measured at 2100-01-24 06:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-24 06:00:00' ),SELECT (SELECT weight_kg FROM patient_weight WHERE patient_id = 10004422 AND measurement_time = '2100-01-25 05:00:00') - (SELECT weight_kg FROM patient_weight WHERE patient_id = 10004422 AND measurement_time = '2100-01-24 06:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-24 06:00:00' )"": None}]"
614926ee15e952ef06fec83f,What does a procedure under the name procedure on single vessel cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) ),"SELECT procedure.name, procedure.return_type, procedure.parameters, procedure.parameter_types",
f7259128c751b9fb354668d9,When was patient 10016150's last discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10016150 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = '10016150';,[{'dischtime': '2142-05-15 19:49:00'}]
72544e79d8ced4be6541a0a1,"What were the four most commonly performed lab tests for patients who were previously diagnosed with other primary cardiomyopathies within 2 months, since 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other primary cardiomyopathies' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.LabTest, COUNT(t3.LabTest) FROM (SELECT t2.LabTest, t1.Date FROM (SELECT Date, LabTest FROM (SELECT DATE '2000-01-01' + INTERVAL '1 month' * d.months AS Date FROM (VALUES (1), (2), (3)) AS d(months)) AS t1 JOIN (SELECT d.Date, t.LabTest FROM (VALUES ('2022-01-01'), ('2022-02-01'), ('2022-03-01')) AS t2(Date) ON t1.Date = t2.Date) AS t3 JOIN (SELECT Date, LabTest FROM (VALUES ('2022-01-01'), ('2022-02-01'), ('2022-03-01')) AS t2(Date) ON t3.Date = t2.Date GROUP BY t3.LabTest ORDER BY COUNT(t3.LabTest) DESC LIMIT 4",
409925c52ea74d305cc42742,Tell me the name of an output that patient 10007058 has last had on last month/25?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',outputevents.charttime) = '25' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT name FROM outputs WHERE patient_id = 10007058 AND date = CURRENT_DATE - INTERVAL '1 month 25',[]
549e20a8edaac5f7b05ecb41,Did patient 68280 experience side effects during a blood transfusion?,,SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 68280 AND diagnoses.type = 'side effects' AND procedures.type = 'blood transfusion',
1013430fc9817f02c815005a,Tell me the cost of a procedure known as continuous invasive mechanical ventilation for 96 consecutive hours or more.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for 96 consecutive hours or more' ) ),SELECT DISTINCT cost FROM procedures WHERE name = 'continuous invasive mechanical ventilation for 96 consecutive hours or more',
51beaf6f4ac792c505183c8f,Could you list the top three most common lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Test, COUNT(t1.Test) FROM (SELECT lab_tests.Test FROM lab_tests WHERE lab_tests.Year = 2000) AS t1 JOIN (SELECT lab_tests.Test FROM lab_tests WHERE lab_tests.Year = 2010) AS t2 ON t1.Test = t2.Test GROUP BY t1.Test ORDER BY COUNT(t1.Test) DESC LIMIT 3",[]
e0d6ebb9ae85186bd60eadb3,What are the four most commonly ordered medications since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.name FROM (SELECT medication AS name, COUNT(medication) AS c FROM medication WHERE STRFTIME('%y', current_date) >= '2100' GROUP BY medication) AS t1 JOIN (SELECT medication AS name FROM medication WHERE STRFTIME('%y', current_date) >= '2100' ORDER BY c DESC LIMIT 4) AS t2 ON t1.name = t2.name","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]"
b208f8a2d2336ea49139fb02,Give me the top three most frequent lab tests that patients were given after being diagnosed with knee joint replacement in the same month in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'knee joint replacement' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'knee joint replacement' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.name, lab_test.lab_test, lab_test.lab_test_date FROM lab_test JOIN patient ON lab_test.patient_id = patient.patient_id WHERE STRFTIME('%y', lab_test.lab_test_date) = '2100') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.lab_test_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_test_date, 'start of month') GROUP BY",
bbfa77367f4475e333c7a834,What is today's outpatient schedule with dr. burgess?,,SELECT * FROM appointments WHERE provider = 'dr. burgess' AND appointment_type = 'outpatient' AND date = CURRENT_DATE;,
0ef02974483ac960722b84f8,How much does the mcv change in patient 10021312 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT mcv FROM patients WHERE patient_id = 10021312 AND NOT patient_info->>'last_hospital_visit' IS NULL ORDER BY patient_info->>'last_hospital_visit' DESC LIMIT 1) - (SELECT mcv FROM patients WHERE patient_id = 10021312 AND NOT patient_info->>'last_hospital_visit' IS NULL ORDER BY patient_info->>'last_hospital_visit' NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
a7913ace036061bcf8f67934,Is patient 10037975's hemoglobin value last measured on the first hospital visit less than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT (SELECT hemoglobin FROM ""patients"" WHERE patient_id = 10037975 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime NULLS FIRST LIMIT 1) < (SELECT hemoglobin FROM ""patients"" WHERE patient_id = 10037975 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
ab8619ab9a2d54411ff482fb,What was the name of the drug patient 10021487 was prescribed with within the same hospital visit after having received a enteral infusion of concentrated nutritional substances procedure throughout this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.name FROM (SELECT patient.name, treatment.timestamp FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10021487 AND treatment.treatment_type = 'enteral infusion of concentrated nutritional substances' AND DATETIME(treatment.timestamp, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')) AS t1 JOIN (SELECT patient.name, prescription.name, prescription.timestamp FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE patient.id = 10021487 AND DATETIME(prescription.timestamp, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')) AS t2 ON t1.name = t2.name WHERE t1.timestamp < t2.timestamp AND DATETIME(t2.timestamp, 'start of month') = DATETIME(t1.timestamp, 'start of month')",
bf0f46e8fb7361b565f0acd6,Tell me patient 10005817's total volume of output on 12/25/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-25'","SELECT SUM(output) FROM patient WHERE patient_id = 10005817 AND DATETIME(output_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m-%d', output_date) = '12-25'",[{'SUM(outputevents.value)': None}]
1e6bb4278191e2e7636f9b0b,"What were the five most frequently ordered procedures for patients who had also received drainage of left pleural cavity, percutaneous approach within the same month this year?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, DATE_TRUNC('month', t2.date) AS month FROM (SELECT p.tissue, DATE_TRUNC('month', d.date) AS date FROM patients p JOIN diagnoses d ON p.diagnosis_id = d.diagnosis_id WHERE d.diagnosis = 'drainage of left pleural cavity, percutaneous approach') AS t1 JOIN (SELECT p.tissue, DATE_TRUNC('month', d.date) AS date FROM patients p JOIN procedures d ON p.procedure_id = d.procedure_id WHERE d.procedure = 'procedure') AS t2 ON t1.tissue = t2.tissue WHERE t1.date = t2.date) AS t3 GROUP BY t3.procedure ORDER BY COUNT(t3.procedure) DESC LIMIT 5",
4aeee894b32b67b1daf7f21d,I need the total volume of input for patient 10027602 since 06/23/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'",SELECT SUM(volume) FROM input WHERE patient = 10027602 AND date >= '2100-06-23',[{'SUM(inputevents.totalamount)': 81320.0}]
1f9a407aceb5f8d72e3a565a,"Since 1 year ago, has patient 10022041 been to an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",SELECT COUNT(*) > 0 FROM emergency_room_admission WHERE patient_id = 10022041 AND admission_date >= (CURRENT_DATE - INTERVAL '1 year'),[{'COUNT(*)>0': 0}]
7f8e8713a9f47bec5ebb47bb,What is the total number of patients discharged from the hospital in the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(DISTINCT patient_id) FROM admissions WHERE NOT date_discharged IS NULL AND date_discharged >= (SELECT MAX(date_admitted) FROM admissions) - INTERVAL '1 year';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ddbdcf0355e30978ef2bda62,How many prescriptions for tramadol were made throughout this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND DATETIME(prescriptions.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)': 0}]
61467a096265ec16474e107e,What are the five most frequently administered procedures for patients aged 50s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.Name, COUNT(t1.Name) FROM procedures AS t1 JOIN patients AS t2 ON t1.patientId = t2.patientId WHERE t2.age BETWEEN 50 AND 59 AND DATETIME(t1.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY t1.Name ORDER BY COUNT(t1.Name) DESC LIMIT 5",
cd943bf7074ac723717f6ade,"Tell me the minimum total cost of a hospital that involved subarachnoid hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness since 1 year ago.","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'subarachnoid hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.total_cost) FROM (SELECT SUM(DISTINCT j.cost) AS total_cost FROM hospital AS h JOIN diagnosis AS j ON h.diagnosis_id = j.diagnosis_id WHERE j.diagnosis = 'subarachnoid hemorrhage following injury without mention of open intracranial wound' AND DATETIME(h.admission_date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY h.hospital_id) AS T1",
e1b2ba03357e942fcffc9832,What was the name of that output that patient 10039831 first had since 10/23/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-23' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM output WHERE patient = '10039831' AND date >= '2100-10-23' ORDER BY date NULLS FIRST LIMIT 1,[{'label': 'OR EBL'}]
9b97c77977d5e0060179aa15,What is the number of operating rooms available at this time?,,SELECT COUNT(*) FROM OperatingRooms WHERE status = 'available';,
7ae9d2ebad321231f55eb04c,Has patient 10015860 received any laboratory testing in 10/last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10015860 AND DATETIME(lab_results.result_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year') AND STRFTIME('%m', lab_results.result_date) = '10'",[{'COUNT(*)>0': 0}]
195ea0933db24ed2ac3c0a71,"What were the first chloride, urine values of patient 10009049 during their first hospital encounter?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, urine' ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(Chloride, Urine) FROM patients WHERE Patient_ID = 10009049 AND NOT Hospital_Dischtime IS NULL ORDER BY Hospital_Admittime NULLS FIRST LIMIT 1",[]
f07f334bbccde1c7406d1f43,When did patient 10027602 last have a mini-bal microbiology test since 10/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM mini_bal_microbiology WHERE patient_id = 10027602 AND date >= '10/2100',[]
e1c8e8780d98ea2f4d439813,Gather the total number of times patient 10019917 visited the hospital in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(DISTINCT patient.hospital_id) FROM patient WHERE patient.unique_patient_id = 10019917 AND STRFTIME('%y', patient.hospital_admission_date) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
bf9ce789f4d2ca8fc80ad3e1,Can you tell which medicine was first prescribed to patient 10027445 via the ih method in 08/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'ih' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM prescriptions WHERE patient_id = 10027445 AND prescriber_name = 'ih' AND date_prescribed >= '2008-01-01' AND date_prescribed < '2008-12-31',[]
fc1d2f78dd540b2cf1aed9b9,So what are the types of blood patient 8016 has.,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 8016;",
523f9419c20f37e75f17f229,What was the amount of ondansetron that patient 10027445 were prescribed in total?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'ondansetron',SELECT SUM(ondansetron) FROM prescriptions WHERE prescriptions.patient_id = 10027445;,[{'SUM(prescriptions.dose_val_rx)': None}]
1eb6a80e3bcffd099385b474,When did patient 10020944 have the maximum sodium value for the last time in their first hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(patient.sodium) FROM patient WHERE patient.patient_id = 10020944 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1,[]
cff67763de893e7028b45382,Is there any genetic test that patient 53392 received?,,SELECT COUNT(*) > 0 FROM genetic_test WHERE patient_id = 53392,
726a0de52d59010c160bbe92,What was the minimum bicarbonate value for patient 10006580 on the last hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ),SELECT MIN(Bicarbonate) FROM lab_results WHERE PatientID = 10006580 AND NOT HospitalDischtime IS NULL ORDER BY HospitalAdmittime DESC LIMIT 1;,[{'MIN(labevents.valuenum)': None}]
06aaefb80b31fdff1837ad61,Has any medicine been prescribed to patient 10029291 since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) > 0 FROM medication_prescriptions WHERE medication_prescriptions.patient_id = 10029291 AND STRFTIME('%y', medication_prescriptions.date) >= '2100'",[{'COUNT(*)>0': 1}]
cbf01f06a75320ed354d25af,What was the first prescription for patient 10021118 since 17 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-17 month') ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug_name FROM prescriptions WHERE prescriptions.patient_id = 10021118 AND DATETIME(prescriptions.date_prescribed) >= DATETIME(CURRENT_TIME, '-17 month') ORDER BY prescriptions.date_prescribed NULLS FIRST LIMIT 1",[{'drug': '5% Dextrose'}]
97d179e16fffa9fb76504042,Are patient 10009035's bicarbonate levels second measured on the first hospital visit less than the levels first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT (SELECT bicarbonate_level FROM ""patient_10009035"" WHERE NOT patient_10009035.hospital_dischtime IS NULL ORDER BY patient_10009035.hospital_admittime NULLS FIRST LIMIT 1) < (SELECT bicarbonate_level FROM ""patient_10009035"" WHERE NOT patient_10009035.hospital_dischtime IS NULL ORDER BY patient_10009035.hospital_admittime NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
d0ae32ba9d0feee58d99a6bc,Calculate the sum of patient 10018423's input since 03/21/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-21'",SELECT SUM(input) FROM input WHERE patient = 10018423 AND input_date >= '2100-03-21';,[{'SUM(inputevents.totalamount)': 18250.0}]
d8839ecf07fe219f65ec8de5,What is the price of a diagnosis for cellulitis and abscess of trunk?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cellulitis and abscess of trunk' ) ),"SELECT ""price"" FROM ""diagnoses"" WHERE ""diagnosis"" = 'cellulitis and abscess of trunk'",
0679067bdc3a032cbc68f962,Tell me the average total cost of a hospital that contains personal history of methicillin resistant staphylococcus aureus?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of methicillin resistant staphylococcus aureus' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.total_cost) FROM (SELECT SUM(T2.quantity * T2.unit_price) AS total_cost FROM PERSONAL_HISTORY AS T1 JOIN CHEMICAL_INFO AS T2 ON T1.chemical_id = T2.chemical_id WHERE T1.personal_history = 'methicillin resistant staphylococcus aureus') AS T1,
565427eaa17c1b7db560f4e9,"Among patients diagnosed with other pulmonary embolism without acute cor pulmonale, what were the top five most common microbiology tests conducted within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other pulmonary embolism without acute cor pulmonale' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.type, COUNT(t3.type) FROM (SELECT t2.type, COUNT(t2.type) FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'other pulmonary embolism without acute cor pulmonale') AS t1 JOIN (SELECT patient.uniquepid, microbiology.type, microbiology.microbiology_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.patient_id) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.microbiology_date AND DATETIME(t2.microbiology_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t3.type) AS t3 SELECT COUNT(t3.type) FROM t3 GROUP BY t3.type ORDER BY COUNT(t3",
ac5c206d44772bba22a9ebfe,What are the top three most frequent drugs prescribed to patients in the same month after the diagnosis of gastro-esophageal reflux disease without esophagitis?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Gastro-esophageal reflux disease without esophagitis') AS t1 JOIN (SELECT patient.id, prescription.drug, prescription.prescription_date FROM prescription JOIN patient ON prescription.patient_id = patient.id) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.prescription_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.prescription_date, 'start of month') GROUP BY t2.drug) AS t3 WHERE t3.c1 <= 3",
6d177c7ee3f8bf320492ec8b,What were the five most frequent microbiology tests that occurred in this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.test_name, COUNT(t.test_name) FROM microbiology_tests t WHERE t.test_date BETWEEN DATETIME(CURRENT_DATE, '-0 year') AND DATETIME(CURRENT_DATE, '-0 year') GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 5",[]
9e339e1a8f7393ed2f0a342e,What are the new single rooms?,,"SELECT * FROM information_schema.tables WHERE table_name = ""new_single_rooms"";",
e8888e24b833fbc7c8316ded,Can you tell me the top three diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT t3.diagnosis, t3.c1, t3.c2, t3.c3 FROM (SELECT t2.diagnosis, t2.c1, t2.c2, t2.c3 FROM (SELECT t1.diagnosis, t1.c1, t1.c2, t1.c3 FROM (SELECT SUM(CASE WHEN patients.dod_date IS NULL THEN 1 WHEN STRFTIME('%j', patients.dod_date) - STRFTIME('%j', t1.chart_date) > 3 * 30 THEN 1 ELSE 0 END) * 100 / COUNT(*) AS c1, t1.diagnosis AS diagnosis FROM (SELECT t1.subject_id, t1.diagnosis, t1.chart_date FROM (SELECT patients.subject_id, diagnoses.diagnosis, diagnoses.chart_date FROM diagnoses JOIN patients ON diagnoses.patient_id = patients.subject_id GROUP BY patients.subject_id, diagnoses.diagnosis HAVING MIN(diagnoses.chart_date) =",
0a36ca6e9f221dc69fc7f8de,Has there been any organism observed in patient 10001217's first csf;spinal fluid microbiology test since 07/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND microbiologyevents.spec_type_desc = 'csf;spinal fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT COUNT(*) > 0 FROM organism_mixture WHERE patient_id = 10001217 AND microbiology_date >= '2000-07-2100' AND sample_type = 'csf;spinal fluid' ORDER BY microbiology_date NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
52505c841a4763efd35adac6,What are the top five common microbiology tests in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.test_name, t.category FROM microbiology_tests t WHERE t.year = 2000 GROUP BY t.test_name ORDER BY COUNT(*) DESC LIMIT 5",[]
58820822f031297565e686b7,Wanna the last time that patient 26799 had a medication that should be taken regularly?,,"SELECT STRFTIME('%Y-%m-%d %H:%M:%S', medication.last_time) FROM medication WHERE medication.patient_id = 26799 AND medication.frequency = 'regular'",
dae5f9c47a5e0608624786d7,"On the current hospital visit, how many days passed since the last anxiety state, unspecified diagnosis of patient 10004733?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anxiety state, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = 'anxiety state, unspecified' AND patient_id = 10004733 AND hospital_visit = 1;",
d4667791b23ee3c61987de79,Can i tell if patient 1205 has need prphyl vc vrl hepat in hisher family?,,"SELECT COUNT(*) > 0 FROM patients WHERE patients.family_id = 1205 AND patients.diagnosis = ""NEED PRPHYL VC VRL HEAT""",
0dac4285b866c55eacef22d7,How much does patient 10018501 weigh difference last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT patient.weight FROM patient WHERE patient.patient_id = 10018501 AND NOT patient.hospital_info.last_dischtime IS NULL ORDER BY patient.hospital_info.admittime DESC LIMIT 1) - (SELECT patient.weight FROM patient WHERE patient.patient_id = 10018501 AND NOT patient.hospital_info.last_dischtime IS NULL ORDER BY patient.hospital_info.admittime DESC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
3ef161ccc95ceeb7a1c4f53a,When did patient 10005348 first get sputum microbial tests in the last hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' ORDER BY microbiologyevents.charttime ASC LIMIT 1,,[]
14f4bb19aad791593fd86e30,Show me the top three most frequent output instances since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT FROM (SELECT output, COUNT(*) FROM brackets WHERE CURRENT_TIMESTAMP - start_time > INTERVAL '1 year' GROUP BY output) AS subquery ORDER BY COUNT(*) DESC LIMIT 3;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
b2d904b2d1f152b67f7b2b51,"Since 07/10/2100, what was patient 10027445's first respiratory rate?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-07-10' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(RespiratoryRate) FROM (SELECT RespiratoryRate FROM RespiratoryData WHERE PatientID = 10027445 AND Date >= '2007-10-2100'),[]
79690c25ac2b2e1a3f74269c,"Was the creatine kinase, mb isoenzyme reading for patient 10004733 last measured on the current hospital visit less than the first value measured on the current hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT (SELECT lab.value FROM lab WHERE lab.patient = 10004733 AND lab.label = 'creatine kinase, mb isoenzyme' ORDER BY lab.date DESC LIMIT 1) < (SELECT lab.value FROM lab WHERE lab.patient = 10004733 AND lab.label = 'creatine kinase, mb isoenzyme' ORDER BY lab.date NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
7a4312f3777e3813772be85d,What was the last time of input of patient 10022041?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) ORDER BY inputevents.starttime DESC LIMIT 1,SELECT MAX(input_time) FROM input WHERE patient_id = 10022041;,[{'starttime': '2187-05-20 15:10:00'}]
4a9c408414e0cb27d0bc9e3b,How much does it cost to get diagnostic of personal history of poliomyelitis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of poliomyelitis' ) ),SELECT SUM(cost) FROM (SELECT cost FROM users WHERE username = '##UserId##') AS T1 JOIN diagnoses ON T1.diagnosis = diagnoses.diagnosis WHERE diagnoses.description = 'Personal history of poliomyelitis',
bd64eba2a9801db69c14dd75,How much did patient 10005817 weigh the first time it was measured in 12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT patient.weight FROM patient WHERE patient.patient_id = 10005817 AND STRFTIME('%y-%m', patient.weight_date) = '2100-12' ORDER BY patient.weight_date NULLS FIRST LIMIT 1",[]
a9c112441a88402a143e7d68,When was the first time patient 10006053's heart rate was greater than 105.0 on the last ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 105.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM patient_heart_rate WHERE patient_id = 10006053 AND NOT icu_last_dischtime IS NULL) WHERE heart_rate > 105.0,[]
6ba230c3cb949791fde3229f,How much nystatin oral suspension has been prescribed to patient 10024043 in total?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND prescriptions.drug = 'nystatin oral suspension',SELECT SUM(prescriptions.dose) FROM prescriptions WHERE prescriptions.patient_id = 10024043 AND prescriptions.drug = 'Nystatin Oral Suspension',[{'SUM(prescriptions.dose_val_rx)': None}]
decffce701731474c7a1532f,What are the single rooms which are now available?,,SELECT * FROM room WHERE room_type = 'single' AND is_available = true;,
45128f30bf831e9b55cca497,How many times did patient 10026255 attend the hospital this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026255 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM visit_table WHERE patient_id = 10026255 AND DATETIME(visit_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
d016293ab625d79f2dc0ca33,When was the last time the SaO2 of patient 10021487 was measured on the last ICU stay at less than 98.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(MEASUREMENT_DATE) FROM (SELECT MEASUREMENT_DATE FROM icu_measurements WHERE icu_measurements.patient_id = 10021487 AND NOT icu_measurements.outcome = 'out' GROUP BY icu_measurements.date_admitted ORDER BY icu_measurements.date_admitted DESC LIMIT 1) WHERE sao2 < 98.0,[]
23a3bff9e2c821e3f091088a,When did patient 10019777 get an input for the last time since 03/04/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-04' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT input_date FROM input_table WHERE patient_id = 10019777 AND input_date >= '2100-03-04' ORDER BY input_date DESC LIMIT 1,[{'starttime': '2187-02-17 20:00:00'}]
55106da0f8f7722ca97968ca,What was the first time patient 10004733 received ph in a lab test in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1","SELECT ph.first_time FROM ph WHERE ph.patient_id = 10004733 AND DATETIME(ph.first_time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', ph.first_time) = '12'",[]
4b334d0f16aebc57870989a3,So how many hours have passed since patient 10021487's first closed fracture of four ribs diagnosis during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of four ribs' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) as hours_since_diagnosis",
9d99fa18449a20ae42392b52,"What was the last dose of glucagon in 09/2100, prescribed to patient 10027445?","SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(dose) FROM prescriptions WHERE prescriptions.patient_id = 10027445 AND prescriptions.drug_name = 'glucagon' AND STRFTIME('%y-%m', prescriptions.date) = '2100-09';",[]
615149dac9c4e11fbde8d9bc,How many patients had a lymphs lab test since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphs' ) AND strftime('%Y',labevents.charttime) >= '2100' )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.has_lymphs_lab = true AND STRFTIME('%y', patient.lymphs_lab_date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
a3d0c04ad119ac98baeec6ac,"Since 04/04/2100, when did patient 10018501 have their last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-04' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT patient 10018501, input 1 FROM brackets WHERE input_date >= '2100-04-04' ORDER BY input_date DESC LIMIT 1",[{'starttime': '2141-08-01 19:44:00'}]
740e35ffd9a5157bb6bf16ad,Count the number of people who were diagnosed with open fracture of shaft of femur.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'open fracture of shaft of femur' ) ),"SELECT COUNT(*) FROM diagnoses WHERE diagnosis = ""Open fracture of shaft of femur""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4d79af33c083f4da6c760216,Was patient 10037861 provided with any medication on the first hospital visit?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM medication_usage WHERE medication_usage.patient_id = 10037861 AND NOT medication_usage.hospital_dischtime IS NULL ORDER BY medication_usage.hospital_admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
d9585c679577af82dd88c509,What is the number of drugs patient 10019172 was prescribed since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10019172 AND DATETIME(medication.date_prescribed) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)': 168}]
0565efc9f6e08966694b0d93,How many times did patient 10001217 go to the hospital?,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10001217,SELECT COUNT(*) FROM hospital_visits WHERE patient_id = 10001217,[{'COUNT( DISTINCT admissions.hadm_id )': 2}]
4e9aac252394c9a79ea2005d,Will any additional blood culture test be done on patient 76275?,,SELECT COUNT(*) FROM Blood_Cultures WHERE Patient_ID = 76275,
04252ccebd8d2d108f1880fc,What are the top three most frequent procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Name, COUNT(t1.Name) FROM procedures AS t1 JOIN (SELECT procedures.Id FROM procedures WHERE procedures.Year >= 2100) AS t2 ON t1.Id = t2.Id GROUP BY t1.Name ORDER BY COUNT(t1.Name) DESC LIMIT 3;",
d4e9772857153946f3bf287d,Can you indicate the daily average dose of replete with fiber (full) that patient 10021487 received since 9 months ago?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'replete with fiber (full)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-9 month') GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT AVG(daily_dose) FROM intake_log WHERE patient_id = 10021487 AND intake_item = 'replete with fiber (full)' AND date >= CURRENT_DATE - INTERVAL '9 month',[]
715cc33a6ffeecdcb8a10831,Tell me the length in days of the first stay for patient 10020187 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT MIN(LENGTH(STAY(1, '2022-06-01', '2022-06-05', 'ICU', '10020187', '{}')) FROM STAY WHERE PATIENT = 10020187 AND IN_ICU = true;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.452662038151175}]"
7b4a60c5a197fac6bff1cdf5,"When did patient 10027445 receive a sodium, urine lab test on the first occasion?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT lab.date FROM lab WHERE lab.patient = 10027445 AND lab.label = 'sodium, urine' ORDER BY lab.date NULLS FIRST LIMIT 1",[]
3df956fea1348d1046fdd09d,When are dr. oneill's rounds and procedures?,,SELECT dr.oneill FROM rounds_and_procedures,
91bfc5a70401d51bfca3e0d1,What was the total 5% dextrose dose that patient 10004235 has been prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = '5% dextrose',SELECT SUM(5) AS '% dextrose' FROM pharmacy WHERE pharmacy.patient_id = 10004235,[{'SUM(prescriptions.dose_val_rx)': None}]
0ef0e1be7cef42de551d0ac7,When was the first time patient 10007818 had been prescribed medication through the pr route on the first hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(date_prescribed) FROM prescriptions WHERE patient_id = 10007818 AND route = 'pr' AND hospital_stay = 1,[]
e07bc2b8ae12376224aac0c9,Tell me the top three most prevalent procedures for patients aged 40s since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,
9304aef38384b969a06b3abe,What was the maximum monthly number of patients who had hemothorax in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MAX(monthly_patients) FROM patients WHERE hemothorax = ""2100""",
0e1d898b2e27b9241962d250,Tell me the count of phlebography of the portal venous system using contrast material procedures that took place since 2100.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'phlebography of the portal venous system using contrast material' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",SELECT COUNT(*) FROM procedures WHERE procedures.contrast_material = 'phlebography of the portal venous system' AND procedures.year >= 2100,
2bdbdd95fe3cb63a5fe57218,Let me know the total quantity of input patient 10012552 received on 04/06/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '04-06'","SELECT SUM(t1.quantity) FROM (SELECT patient_quantity, quantity FROM input_patients WHERE patient_id = 10012552) AS t1 JOIN (SELECT patient_quantity, quantity FROM input_patients WHERE patient_id = 10012552) AS t2 ON t1.patient_quantity = t2.patient_quantity WHERE t1.receive_date = SELECT DATE '2022-04-06'",[{'SUM(inputevents.totalamount)': None}]
a7419fe163e1296529d925bc,What was the name of the organism found in the first bronchoalveolar lavage microbiology test of patient 10007818 in 07/this year?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10007818 AND sample_type = 'bronchoalveolar lavage' AND date = '07-01-2022' ORDER BY date NULLS FIRST LIMIT 1,[]
25a3fc060e58489fa5108651,"In this year, has patient 10018423 visited an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(*) > 0 FROM emergency_room_visits WHERE patient_id = 10018423 AND year = 2016,[{'COUNT(*)>0': 0}]
46a6c77172cbf9196d74a902,What were the top five most common specimen tests conducted?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM (SELECT * FROM results WHERE NOT specimen IS NULL AND specimen <> 'nanoparticle') GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5;","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
b6403378bbfbec78e67126fc,Tell me the four most frequent treatments for patients aged 30s in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.treatment FROM (SELECT treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient_id, treatment FROM procedures WHERE age BETWEEN 30 AND 39) AS t1 JOIN (SELECT patient_id FROM patients WHERE age BETWEEN 30 AND 39) AS t2 ON t1.patient_id = t2.patient_id WHERE STRFTIME('%y', t1.treatment_date) = '2100' GROUP BY treatment) AS t1 WHERE t1.c1 <= 4",
122180d2410c37fb1d467316,Provide the count of ICU visits for patient 10020740 since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT icu_visits) FROM icu_visits WHERE icu_visits.patient_id = 10020740 AND DATETIME(icu_visits.visit_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 5}]
89541b5a85b5b5b3125bf003,Did patient 10016150 undergo the angiocardiography of left heart structures in their first hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'angiocardiography of left heart structures' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),"SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10016150 AND procedures.procedure_name = 'angiocardiography of left heart structures' AND STRFTIME('%j', procedures.procedure_date) = STRFTIME('%j', procedures.patient_info.hospital_admission_date) AND STRFTIME('%j', procedures.patient_info.hospital_admission_date) = STRFTIME('%j', patients.patient_info.hospital_admission_date) WHERE patients.patient_info.hospital_admission_date IS NOT NULL ORDER BY patients.patient_info.hospital_admission_date NULLS FIRST LIMIT 1;",[{'COUNT(*)>0': 0}]
ce7977eba118e89d42bc63b2,What was the diagnosis for patient 10029484 the last time during this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10029484 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') ORDER BY diagnoses.diagnosis_date DESC LIMIT 1",
25df58c9b9009d8a32d96d15,Tell me the number of patients discharged from the hospital last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT date_discharged IS NULL AND date_discharged >= (SELECT MAX(date_admitted) FROM patients) - INTERVAL '1 year',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
98340bd550d51478d6ada232,Could you inform me the total output amount of patient 10012552 on 04/04/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-04'",SELECT SUM(output) FROM total_output WHERE patient = 10012552 AND date = '04/04/2100',[{'SUM(outputevents.value)': None}]
c8b35c10890db1d889786310,Tell the name of the diagnosis that was received by patient 81840 at the other department.,,"SELECT diagnosis.name FROM diagnosis, patient WHERE diagnosis.patient_id = patient.id AND patient.other_department = true AND patient.id = 81840",
5dbb876ab254d8863d9a17ce,What is the daily average input of d5 1/2ns that patient 10022281 is getting during their last ICU stay?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT AVG(input) FROM input WHERE patient = 10022281 AND icu_duration > 0 AND input_type = 'd5 1/2ns' GROUP BY date_input ORDER BY date_input DESC LIMIT 1,[]
6d3a86657cfb5924c8e4dbbb,When did patient 10038933 receive an input for the first time?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) ORDER BY inputevents.starttime ASC LIMIT 1,SELECT MIN(input_date) FROM input_table WHERE patient_id = 10038933,[{'starttime': '2148-09-10 13:30:00'}]
e3e406fe664e626c9595b4ec,Is there a test that patient 65759 had been given?,,SELECT COUNT(*) > 0 FROM diagnosis_table WHERE diagnosis_table.patient_id = 65759,
ede3b2dd4e96f4b8027fd757,Retrieve the top three most frequent output occurrences since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT COUNT(*) FROM outputs WHERE date_diff('year', current_date, outputs.date_last) >= 1 GROUP BY outputs.output ORDER BY COUNT(*) DESC LIMIT 3;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
387697552eec0b37359509db,What was the name of the drug that patient 10004235 was prescribed in the same day after having received a laparoscopic cholecystectomy procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug_name FROM (SELECT patient.id, procedures.date FROM procedures JOIN patient ON procedures.patient_id = patient.id WHERE patient.id = 10004235 AND procedures.procedure_name = 'laparoscopic cholecystectomy') AS t1 JOIN (SELECT patient.id, drugs.drug_name FROM drugs JOIN patient ON drugs.patient_id = patient.id WHERE patient.id = 10004235) AS t2 ON t1.id = t2.id WHERE t1.date = t2.date",
682b7c020d47e07237753b11,"Was ketorolac, simvastatin, or lactated ringers prescribed to patient 10011398 during their first hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'ketorolac', 'simvastatin', 'lactated ringers' )","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10011398 AND prescriptions.drug IN ('ketorolac', 'simvastatin', 'lactated ringers') AND NOT prescriptions.drug_date IS NULL ORDER BY prescriptions.drug_date NULLS FIRST LIMIT 1",[{'COUNT(*)>0': 0}]
d1054cc1b2ffa4b3b7000b34,What was patient 10007058's first tested specimen in 11/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '11' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT MIN(specimen_date) FROM specimens WHERE patient_id = 10007058 AND date_part('month', specimen_date) = 11 AND date_part('year', specimen_date) = 2022",[]
f93cc51e5d7120ee4b957451,What was the total volume of void that patient 10007058 had since 09/10/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-10'",SELECT SUM(volume) FROM intake WHERE patient_id = 10007058 AND type = 'void' AND date >= '2100-09-10',[{'SUM(outputevents.value)': None}]
26904ee0e2e1e4ac50b43168,What was the first time patient 10016742 has had the maximum SaO2 on 08/11/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-11' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT MIN(SaO2) FROM patient WHERE patient.id = 10016742 AND DATETIME(SaO2, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m-%d', SaO2) = '08-11'",[]
921675022a09cbed462a1741,What is the total number of hemodialysis procedures that took place in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",SELECT COUNT(*) FROMhemodialysis WHERE year = 2100;,
23e582ea53646d1236eee37e,"In total, what was the input amount of dextrose 5% that patient 10027602 received on 11/23/this year?","SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '11-23'",SELECT SUM(input_amount) FROM input_table WHERE input_date = '2022-11-23' AND patient_id = 10027602 AND product_name = 'dextrose 5%',[{'SUM(inputevents.totalamount)': None}]
7cefa5cf7a599ae5c96e8eb5,What culture was patient 10007928 last tested since 02/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",,[{'spec_type_desc': 'STOOL'}]
4d5ceeafba15c9090fc8776b,When did patient 10019172 receive a blood culture microbiology test for the last time since 10/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(datetime) FROM microbiology WHERE microbiology.patient_id = 10019172 AND microbiology.test_type = 'blood culture' AND STRFTIME('%y-%m', microbiology.datetime) >= '2100-10'",[]
91233f4f7f64dbd5fbd43579,Present the count of ICU visits for patient 10006053 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',icustays.intime) >= '2100'",SELECT COUNT(ICU_VISITS) FROM (SELECT ICU_VISITS FROM icu_visits WHERE PATIENT_ID = 10006053) WHERE YEAR(ICU_VISITS) >= 2100;,[{'COUNT( DISTINCT icustays.stay_id )': 2}]
db0b8e8e0ddcba04c82bb7f0,What was patient 10010471's last measurement for o2 saturation pulseoxymetry on 12/17/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-17' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT last(o2_saturation_pulseoxymetry) FROM patients WHERE patient_id = 10010471 AND measurement_date = '12/17/2020';,[]
34a5e8b5a91c17bdf4999b17,"Give me the count of inspection of tracheobronchial tree, via natural or artificial opening endoscopic procedures that occurred since 2100.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(DISTINCT t.TracheobronchialTree) FROM tracheobronchial_tree t JOIN procedures p ON t.TracheobronchialTree = p.TracheobronchialTree WHERE p.ProcedureType = 'Inspection of tracheobronchial tree, via natural or artificial opening endoscopic procedures' AND STRFTIME('%y', p.PerformanceDate) >= '2100'",
d5f33799e7f8110fd11cd073,What was the last time that patient 10008454 had a maximum value of lactate dehydrogenase (ld) in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1","SELECT MAX(lactate_dehydrogenase__ld_) FROM lab WHERE lab.patient_id = 10008454 AND STRFTIME('%y-%m', lab.date) = '2022-12'",[]
7fc9012c75133098e145243a,"Retrieve the top four most frequent procedures that patients were given within 2 months after receiving occlusion of right vertebral artery with intraluminal device, percutaneous approach throughout this year.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.procedure FROM (SELECT t2.procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.procedure = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' AND DATETIME(treatment.treatmenttime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, treatment.procedure, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE DATETIME(treatment.treatmenttime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.treatmenttime AND DATETIME(t2.treatmenttime) BETWEEN DATET",
052079a05ce7afbbced7a57a,"Of the patients of age 60 or above since 2100, what were the top three most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT * FROM patients WHERE age >= 60) AS t1 JOIN (SELECT * FROM patients WHERE year >= 2100) AS t2 ON t1.patient_id = t2.patient_id GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 3",
e474a2417040aa88bad3b8f1,How many patients stayed at the emergency department in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department' AND strftime('%Y',transfers.intime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM emergency_department WHERE stay_year = 2100;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
44c07c98fe50b60cd61a2569,What are patient 10021118's changes in free calcium last measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT free_calcium FROM patients WHERE patient_id = 10021118 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1) - (SELECT free_calcium FROM patients WHERE patient_id = 10021118 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
583645b19b83246b4e37528d,What new drugs are prescribed for patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT * FROM prescriptions WHERE prescriptions.patient_id = 10018081 AND DATETIME(prescriptions.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescriptions.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
bc12c47d96a21b5e21142ed7,Show me the top five microbiology tests.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",SELECT * FROM microbiology_tests ORDER BY rank DESC LIMIT 5;,"[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
97d2fe4c7a06a3344798570f,Was patient 10029291 to the er during their last hospital encounter?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 10029291 AND patients.hospital_location = 'emergency room admit' AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime DESC LIMIT 1,[{'COUNT(*)>0': 0}]
3e3f93fb3a2e4577befd898b,Calculate patient 10006053's total output since 86 days ago.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-86 day')",SELECT SUM(output) FROM (,[{'SUM(outputevents.value)': 7045.0}]
5d2e380e135d1c3beebbb4b8,Display the top four most commonly prescribed drugs.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]"
8b6ecc1e8d51fdbbd657d6be,What was the last hospital discharge time for patient 10011398?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10011398 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_dischtime) FROM patient WHERE patient_id = 10011398;,[]
14dc70100f62f8b317f16a1c,I want to know the ward id that patient 65962 can go in and get in?,,SELECT ward_id FROM patient WHERE patient_id = 65962;,
af5718c6edddceb0646a23e6,How many current patients exist?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE current = true;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
08eeb31e70fedda9acf60d5d,When will patient 57023 be able to visit other departments?,,SELECT TIMESTAMP '2022-03-15' FROM patient WHERE patient.id = 57023;,
8fb8495a86fc33185eb96c55,What is the protocol of anticancer drugs.,,SELECT DISTINCT protocol FROM drugs WHERE drug_type = 'anticancer';,
d1786dec0eca017b0b1f5d7b,"Count the number of patients who received unilateral simple mastectomy in the same hospital visit after being diagnosed with personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date, t1.had_surgery FROM (SELECT subject_id, diagnosis_date, had_surgery FROM (SELECT subject_id, diagnosis_date FROM (SELECT * FROM diagnoses WHERE diagnosis = 'personal history of transient ischemic attack (tia)') AS t1 JOIN (SELECT * FROM procedures WHERE procedure = 'cerebral infarction without residual deficits') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of year') = DATETIME(t2.diagnosis_date, 'start of year')) AS t1 JOIN (SELECT * FROM procedures WHERE procedure = 'unilateral simple mastectomy') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATET",
ad2310914d9164e853dba7ed,Tell me the amount of total foley that patient 10007058 had since 11/23/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-23'",SELECT COUNT(DISTINCT foley) FROM foley WHERE patient_id = 10007058 AND date >= '2100-11-23',[{'SUM(outputevents.value)': None}]
ff8f65ff38e91c62de0fab77,What is the maximum total hospital cost involving a drug named aspirin (buffered) since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE product = 'aspirin (buffered)' AND year >= 2100 GROUP BY cost) AS t1,
2195808ddabb497385b40858,Get the count of hospital visits by patient 10017492 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10017492 AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(DISTINCT patient_id) FROM visit_table WHERE patient_id = 10017492 AND year(visit_date) >= 2100,[{'COUNT( DISTINCT admissions.hadm_id )': 2}]
4e9b234a6ce9fa0007c2e212,When was patient 10015860 prescribed with a drug via the im route for the last time on the first hospital stay?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10015860 AND prescriptions.route = 'im',[]
366c5196b25e3189805acc33,How long was temporary tracheostomy taking for patient 78131?,,SELECT length FROM temporary_tracheostomy WHERE patient_id = 78131;,
4fbd8deeeee7c2df137faa1a,What is patient 10039831's maximum asparate aminotransferase (ast) value in their current hospital visit?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ),SELECT MAX(asparate_aminotransferase_ast) FROM patients WHERE patient_id = 10039831 AND hospital_dischtime IS NULL;,[{'MAX(labevents.valuenum)': None}]
1ae02fd40242a1f6626facb2,How many hours has it been since patient 10039831 stayed in the careunit discharge lounge in this hospital encounter for the first time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.staydate)) FROM patient WHERE patient.subjectid = 10039831 AND patient.dischargeunit = 'discharge lounge' AND patient.staydate IS NOT NULL ORDER BY patient.staydate NULLS FIRST LIMIT 1",[]
78c274657cd4e1d8e8b02190,Tell me the five most common diagnoses since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses WHERE DATETIME(diagnoses.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 5",
613a190f2257871bd0c6a395,How much of a difference is there in patient 10029291's weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT weight FROM patients WHERE patient_id = 10029291 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1) - (SELECT weight FROM patients WHERE patient_id = 10029291 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
027be20fe6b2508766d312ac,How many mupirocin cream 2% prescriptions took place?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'mupirocin cream 2%',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Mupirocin Cream 2%',[{'COUNT(*)': 0}]
4bcd1b55582a8d4b902af134,What was the drug prescribed to patient 10018845 for the last time via sc route since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.name, date_prescribed FROM (SELECT patient.id, prescriber.name, date_prescribed FROM prescriber JOIN patient ON prescriber.patient_id = patient.id WHERE patient.id = 10018845 AND prescriber.route = 'sc' AND date_prescribed >= '2000-09-2100') AS t ORDER BY date_prescribed DESC LIMIT 1;",[]
b210336ce9274694af8855f6,What was an insurance plan for patient 10018845 on the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT insurance_plan FROM (SELECT * FROM patient WHERE patient_id = 10018845 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1),[{'insurance': 'Other'}]
2d292b7a053eb9f6d89638af,Retrieve patient 10027602's monthly maximum weight since 1 year ago.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MAX(weight) FROM patients WHERE patient_id = 10027602 AND date > CURRENT_DATE - INTERVAL '1 year' GROUP BY date_trunc('month', date)",[]
d53217eec061327cdf9bf36c,Prazosin - How much does it cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'prazosin' ),"SELECT DISTINCT ""Price in USD"" FROM ""Products"" WHERE ""Product"" = 'Prazosin'",
1c513ac8c299151372834f1a,How many operating rooms are there now?,,SELECT COUNT(*) FROM Operating_Rooms;,
3eebaf8381530fd2b515bfc8,What new meds are prescribed to patient 10039831 today compared to the ones from yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT date_diff('day', MIN(prescriptions.date_prescribed), MAX(prescriptions.date_prescribed)) FROM prescriptions WHERE prescriptions.patient_id = 10039831 AND MIN(prescriptions.date_prescribed) = (SELECT MIN(prescriptions.date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10039831 AND prescriptions.date_prescribed = (SELECT MAX(prescriptions.date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10039831)) AND MAX(prescriptions.date_prescribed) = (SELECT MAX(prescriptions.date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10039831)",[]
39619ec2f079e47413f41d16,"List the top three most frequent specimens that patients were tested in the same hospital encounter after receiving introduction of other therapeutic substance into heart, open approach since 2100.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t1.subject_id, t1.date_of_service FROM (SELECT patient.subject_id, date_of_service FROM patients JOIN patient ON patients.subject_id = patient.subject_id WHERE patient.hospital_dischtime IS NULL) AS t1 JOIN (SELECT patient.subject_id, specimen FROM samples JOIN patient ON samples.subject_id = patient.subject_id WHERE patient.hospital_dischtime IS NULL) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date_of_service < t2.date_of_service AND DATETIME(t1.date_of_service) BETWEEN DATETIME(t2.date_of_service) AND DATETIME(t2.date_of_service, '+1 month') GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 3",
13bf5b0281c0d443bd4ea538,"During the last ICU visit, what was the average value of the systolic blood pressure of patient 10038933?",SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ),SELECT AVG(systolic_blood_pressure) FROM visit_icu WHERE patient_id = 10038933,[{'AVG(chartevents.valuenum)': None}]
9f35654e31c2a74dccf4e709,What was the average value of heart rate for patient 10029291 on 03/02/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-02'",SELECT AVG(heart_rate) FROM patient_heart_rate WHERE patient_id = 10029291 AND measurement_date = '2100-03-02',[{'AVG(chartevents.valuenum)': None}]
7bf454dec8755f5d448775d0,"What is the cost of a surgery called performance of urinary filtration, multiple?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of urinary filtration, multiple' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure = 'Performance of urinary filtration, multiple'",
933c11a9ca710be4b2120713,Has patient 9038 ever experienced a side effect during a blood transfusion?,,SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 9038 AND diagnoses.side_effect = 'side effect during a blood transfusion',
ecbdf8f66488345ecb0ba8bf,What drug was patient 10025463 prescribed for during the same day after undergoing catheter based invasive electrophysiologic testing in 11/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '11' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug FROM (SELECT patient.subject, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.subject WHERE patient.subject = 10025463 AND treatment.type = 'catheter based invasive electrophysiologic testing' AND DATETIME(treatment.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', treatment.date) = '11') AS t2 JOIN (SELECT patient.subject, prescription.drug FROM prescription JOIN patient ON prescription.patient = patient.subject WHERE patient.subject = 10025463 AND DATETIME(prescription.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescription.date) = '11') AS t1 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.",
7a94050770d72ccb6594539a,Can you give me patient 10008454's daily average packed red blood cells input?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT AVG(PackedRedBloodCells) FROM patient WHERE PatientID = 10008454;,[]
9adca592b48d4fd0d62f45d1,"How many patients were given extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT patient.subject, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.subject WHERE procedures.procedure = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic') AS t1 JOIN (SELECT patient.subject, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.subject WHERE procedures.procedure = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic') AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e2c201a20662ad1fab6cc5ef,Has patient 2127 had an appointment in another department?,,SELECT COUNT(*) FROM appointments WHERE appointments.patient_id = 2127 AND appointments.department_id <> (SELECT departments.department_id FROM departments WHERE departments.name = 'Cardiology'),
dbb4226192d4ef37cbf426dd,"Since 07/2100, when did patient 10031757 last get prescribed lactated ringers and metronidazole (flagyl) at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM (SELECT patient_id, date_prescribed FROM prescriptions WHERE patient_id = 10031757 AND prescription_name = 'lactated ringers' AND date_prescribed >= '2007-02-11' UNION ALL SELECT patient_id, date_prescribed FROM prescriptions WHERE patient_id = 10031757 AND prescription_name = 'metronidazole (flagyl)' AND date_prescribed >= '2007-02-11')",[]
0d4e20e0fef8cae36b234d1b,When did patient 10004422's first input on 01/25/2100 occur?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-01-25' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT patient.name, input.input_date FROM patient WHERE patient.patient_id = 10004422 AND STRFTIME('%m/%d/%Y', input.input_date) = '01/25/2100' ORDER BY input.input_date NULLS FIRST LIMIT 1",[]
3afcd24ffddc745b26111a19,Does patient 20000 have any inherited disease?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 20000 AND patients.inherited_disease IS NOT NULL,
cbcb60f4c34e7c1afabdf477,What is the average total cost for a hospital including tests in the rheumatoid factor laboratory?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(t1.c1) FROM (SELECT SUM(s.quantity * p.unit_price) AS c1 FROM sales s JOIN prices p ON s.sale_time = p.ticker_time JOIN tests t ON s.item = t.test_id WHERE t.test_name = 'rheumatoid factor' GROUP BY s.sale_time) AS t1,
de257ec1deb940f9cc31497a,Can you tell me the name of the diagnosis patient 10031404 received last during their last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis.diagnosis_name FROM diagnosis WHERE diagnosis.patient_id = 10031404 AND NOT diagnosis.deleted_at IS NULL ORDER BY diagnosis.diagnosis_date DESC LIMIT 1,
5fd4f4ab7afda4e90c2af26a,What is the average monthly number of patients suffering from personal history of sudden cardiac arrest since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of sudden cardiac arrest' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT AVG(monthly_count) FROM (SELECT COUNT(DISTINCT patient_id) AS monthly_count FROM personal_history WHERE personal_history LIKE '%sudden cardiac arrest%' AND STRFTIME('%y', personal_history_date) >= '2100' GROUP BY STRFTIME('%y-%m', personal_history_date))",
3cfe1a9f322b92f0841576db,What was the first dose of nicardipine iv prescribed to patient 10005817 since 12/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.drug = 'nicardipine iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(nicardipine_iv) FROM patient_prescriptions WHERE patient_id = 10005817 AND date_prescribed >= '12/2100',[]
55298e7d2d87edab46d2e4e0,How many patients received a globulin lab test since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'globulin' ) AND strftime('%Y',labevents.charttime) >= '2100' )",SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.lab_value(globulin) >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
69b33b1e544e77eca6472b64,Give me the four most common microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT microbiology_tests, COUNT(microbiology_tests) FROM brackets GROUP BY microbiology_tests ORDER BY COUNT(microbiology_tests) DESC LIMIT 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]"
0e303986f42987d1f61a3da5,"What drug was prescribed to patient 10021118 within 2 days after the procedure of performance of cardiac output, continuous during this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT t1.subject, t1.date FROM (SELECT patient.subject, procedure.date FROM patient JOIN procedure ON patient.subject = procedure.subject WHERE patient.subject = 10021118) AS t1 JOIN (SELECT patient.subject, prescription.drug FROM patient JOIN prescription ON patient.subject = prescription.subject WHERE patient.subject = 10021118) AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t2.date, 'start of month') = DATETIME(t1.date, 'start of month', '-2 day')",
a3e6f2a97bc4bdaab7616bd2,What percentile is 2.3 on a lactate test among patients of the same age as patient 10015272 during the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.3","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, lab.result, PERCENT_RANK() OVER (ORDER BY lab.result NULLS FIRST) AS c1 FROM patient INNER JOIN lab ON patient.lab_id = lab.lab_id WHERE lab.lab_name = 'lactate' AND patient.age = (SELECT patient.age FROM patient WHERE patient.uniquepid = 10015272 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1) AND patient.hospital_dischtime IS NULL) AS t1 WHERE t1.result = 2.3",
b1baeec40f8e02dc63c8b5e3,"What was the drug that patient 10031404 was prescribed for during the same hospital visit after undergoing drainage of pericardial cavity, percutaneous approach since 02/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-02' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t4.drug FROM (SELECT t3.drug, t3.start_date, t3.stop_date, t3.room FROM (SELECT t2.drug, t2.start_date, t2.stop_date, t2.room FROM (SELECT patient.uniquecarid, treatment.start_date FROM treatment JOIN patient ON treatment.patientid = patient.uniquecarid WHERE patient.uniquecarid = 10031404 AND treatment.treatment = 'drainage of pericardial cavity, percutaneous approach') AS t1 JOIN (SELECT patient.uniquecarid, drug.drug, drug.start_date FROM drug JOIN patient ON drug.patientid = patient.uniquecarid WHERE patient.uniquecarid = 10031404) AS t2 ON t1.uniquecarid = t2.uniquecarid WHERE t1.start_date < t2.start_date AND t1.stop_date > t2.stop_date) AS t3 JOIN (SELECT patient.uniquecarid, drug.drug, drug.start_date FROM drug JOIN",
8146ea91c180f5ff5edacc7d,"When did patient 10026354 have the maximum value of sodium, whole blood last in 10/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(Sodium) FROM (SELECT Sodium FROM Patient WHERE Patient.ID = 10026354) AS T10026354 WHERE T10026354.Sodium = (SELECT MAX(Sodium) FROM (SELECT Sodium FROM Patient WHERE Patient.ID = 10026354) AS T10026354 WHERE T10026354.Sodium = (SELECT MAX(Sodium) FROM (SELECT Sodium FROM Patient WHERE Patient.ID = 10026354) AS T10026354)),[]
ce4f4d6348cd296c4415f38c,When did patient 10000032 receive a mrsa screen microbiology test for the first time since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT screen_date FROM microbiology_data WHERE patient_id = 10000032 AND test_type = 'mrsa screen microbiology' AND screen_date >= '2000-03-2100' ORDER BY screen_date NULLS FIRST LIMIT 1,[]
eb91c0a8a1e1ee146a155b80,"In 05/2100, when did patient 10007795 first get prescribed iso-osmotic dextrose and 5% dextrose at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic dextrose' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT STRFTIME('%y-%m', MIN(patient.age)) FROM patient WHERE patient.id = 10007795 AND MIN(patient.age) IN (SELECT STRFTIME('%y-%m', patient.age) FROM patient WHERE patient.id = 10007795 AND patient.age LIKE '%5%dextrose%')",[]
2aa05532775a51572241041f,Tell me the minimum total cost of a hospital that contains patient room in hospital as the place of occurrence of the external cause?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'patient room in hospital as the place of occurrence of the external cause' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(T1.total_cost) FROM (SELECT SUM(T2.total_cost) AS total_cost FROM patient_room AS T1 JOIN external_causes AS T2 ON T1.place_of_occurrence = T2.place_of_occurrence GROUP BY T1.patient_room_id) AS T3,
be83182a8a89eceb013c4764,What was the name of the organism in the first sputum microbiology test of patient 10009049 on the first hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT organism_name FROM sputum_microbiology WHERE patient_id = 10009049 AND hospital_visit = 1 ORDER BY microbiology_date NULLS FIRST LIMIT 1;,[]
0a91b31731530c53ab09872e,"What is the minimum total cost of the hospital encounters that involve a procedure named destruction of right main bronchus, via natural or artificial opening endoscopic since 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE name = 'destruction of right main bronchus, via natural or artificial opening endoscopic' AND year >= 2100 GROUP BY cost) AS t1",
e6f3a62b65568a7ae075f4d2,List the five most frequent specimens that were tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM brackets_microscopic WHERE year >= 2100 GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5;","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
6d09ba5be77b8bf9cc8b08a8,Tell me the total volume of input for patient 10005817 since 04/03/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03'",SELECT SUM(input_volume) FROM input WHERE patient_id = 10005817 AND input_date >= '2100-04-03',[{'SUM(inputevents.totalamount)': 166435.0}]
4a52128ae4a63ad0dc8d6410,What are the top three diagnoses associated with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT t3.diagnosis, t3.c1, t3.c2 FROM (SELECT t2.diagnosis, t2.c1, t2.c2 FROM (SELECT t1.diagnosis, t1.c1, t1.c2 FROM (SELECT SUM(CASE WHEN t.deaths = 0 THEN 1 ELSE 0 END) AS c1, SUM(CASE WHEN t.deaths = 1 THEN 1 ELSE 0 END) AS c2, t.diagnosis FROM t1 JOIN (SELECT t.subject, t.diagnosis, t.deaths FROM t2 JOIN (SELECT SUM(CASE WHEN t.deaths = 0 THEN 1 ELSE 0 END) AS c1, SUM(CASE WHEN t.deaths = 1 THEN 1 ELSE 0 END) AS c2 FROM t2 JOIN (SELECT t.subject, t.diagnosis, t.deaths FROM t3 JOIN (SELECT SUM(CASE WHEN t.deaths = 0 THEN 1 ELSE 0 END) AS c1, SUM(CASE WHEN t.deaths = 1 THEN",
c91e6629b913e405efe9b9e5,"How many patients received dilation of left common iliac vein with intraluminal device, percutaneous approach treatment within 2 months after having been diagnosed with accidental puncture and laceration of a circulatory system organ or structure during a circulatory system procedure since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental puncture and laceration of a circulatory system organ or structure during a circulatory system procedure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date FROM (SELECT subject_id, date FROM diagnoses WHERE diagnosis = 'ACCIDENTAL PUNCTURE AND LAceration of circulatory system organ or structure') AS t1 JOIN (SELECT subject_id, date FROM procedures WHERE procedures.date >= '2100-01-01' AND procedures.date < '2100-01-02' AND procedures.type = 'dilation of left common iliac vein with intraluminal device, percutaneous approach') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month')",
0dcdf1950d75981036938d0f,The value of hyaline casts of patient 10038992 was last measured on the last hospital visit less than first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT MAX(Hyaline_Casts) FROM '10038992/hospital_data.parquet' WHERE Hospital_Visit_Number = (SELECT COUNT(DISTINCT Hospital_Visit_Number) FROM '10038992/hospital_data.parquet' WHERE Patient_ID = 10038992 AND Measurement_Date = (SELECT MAX(Measurement_Date) FROM '10038992/hospital_data.parquet' WHERE Patient_ID = 10038992 AND Measurement_Type = 'hyaline casts')),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
297288464d61d257567d25a2,What are the new medications prescribed to patient 10018081 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT (SELECT medications FROM prescriptions WHERE patient_id = 10018081 AND date = '2022-01-01') - (SELECT medications FROM prescriptions WHERE patient_id = 10018081 AND date = '2022-01-02'),[]
c3627e6abec2c90a0651a0e7,"Tell me the top three most commonly prescribed medications within the same hospital visit to patients in their 50s who were diagnosed with chronic obstructive pulmonary disease, unspecified since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic obstructive pulmonary disease, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_time, patient.age FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'chronic obstructive pulmonary disease, unspecified' AND STRFTIME('%y', diagnosis.diagnosis_time) >= '2100') AS t1 JOIN (SELECT patient.id, medication.name, medication.medication_time, patient.age FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age >= 50 AND STRFTIME('%y', medication.medication_time) >= '2100') AS t2 ON t1.id = t2.id WHERE t1.diagnosis_time < t2.medication_time AND t1.patient_id = t2.patient_id GROUP BY t2.name) AS t3 WHERE t3.c1 <=",
daf529dca91ee00e8da51d58,What were the three most common tests conducted on specimens throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT t.test_name, COUNT(t.test_name) FROM tests t WHERE t.date_conducted >= '2022-01-01' GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 3",[]
e8f80475c0b36304390859e0,Tell me the number of patients who stayed in coronary care unit (ccu) since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) >= '2100' )",SELECT COUNT(DISTINCT patient_id) FROM coronary_care_unit_ccu WHERE stay_year >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e741a395203aabb321b46310,What was the drug that was prescribed to patient 10016150 for the last time in 05/this year via the po route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.drug FROM prescriber WHERE prescriber.patient_id = 10016150 AND prescriber.route = 'po' AND DATETIME(prescriber.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriber.date) = '05' ORDER BY prescriber.date DESC LIMIT 1",[]
b1ee8ce4305d98f2883b695b,"How many patients were diagnosed in 2100 with intestinal infection due to other organism, not elsewhere classified?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.diagnosisdate BETWEEN '2100-01-01' AND '2100-12-31' AND patient.diagnosis = 'INTESTINAL INFECTION DUE TO OTHER ORGANISM, NOT ELSEWHERE CLASSIFIED'",
05334e2bb5ed306293d184c4,Provide the top four most frequent diagnoses that patients were assigned within 2 months after receiving excision of other bile duct.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, COUNT(t2.diagnosis) FROM (SELECT patient.name, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE treatment.treatment_type = 'Excision of other bile duct') AS t1 JOIN (SELECT patient.name, diagnosis.diagnosis, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.diagnosis) AS t3 ON t1.name = t3.name GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 4",
fee1526403313e5913e5874b,How many other ascites patients since 1 year ago were diagnosed in the same hospital encounter after being diagnosed with posttraumatic stress disorder?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'posttraumatic stress disorder' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ascites' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_location FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'other ascites patients' AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_location FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'posttraumatic stress disorder' AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND t1.admission_location = t2.admission_location",
33c954c2cec837a4ccd734f7,What was the total output that patient 10014354 had since 07/09/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-09'",SELECT SUM(output) FROM output WHERE patient = 10014354 AND output_date >= '2100-07-09',[{'SUM(outputevents.value)': 26195.0}]
c189d34efcb37085fa7b7cb4,What was the number of patients who were prescribed click change <--- to choose a base solution in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'click change <--- to choose a base solution' AND strftime('%Y',prescriptions.starttime) = '2100' )","SELECT COUNT(DISTINCT id) FROM patients WHERE prescriptions = 'Click Change <--- to choose a base solution' AND STRFTIME('%y', date) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
8c1904ba5ce5733337e19e75,Can you report the first heart rate for patient 10018845?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM brackett_heart_rate WHERE patient_id = 10018845;,[]
3e2742de9d17a14d3e82aa41,What are the newly prescribed medicines for patient 10004733 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.name FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND DATETIME(prescriptions.start_date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescriptions.start_date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
b2690f1d201d900a6e245a5a,Tell me what the top three most commonly prescribed drugs are?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]"
5d0429ce6caa78a35b8b997e,Tell me the id of the ward where patient 55281 can be admitted?,,SELECT ward_id FROM patient_wards WHERE patient_id = 55281,
18f859e690e5c53434768ab0,What diagnosis did patient 10031757 receive in 2100 for the first time?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis FROM diagnoses WHERE patient_id = 10031757 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100' ORDER BY diagnoses.diagnosis_date NULLS FIRST LIMIT 1",
5edb9312f6f7f742fcdce8fc,Has patient 10014078 had a lab test done since 03/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10014078 AND STRFTIME('%y-%m', lab_tests.date) >= '2100-03'",[{'COUNT(*)>0': 1}]
1d938ae21a7a7d593616d380,Can you tell me the total volume of chest tube #1 output for patient 10035185 since 04/17/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'chest tube #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-17'","SELECT SUM(chest_tube_#1) FROM (SELECT chest_tube_#1 FROM (SELECT patient_id, date_since FROM (VALUES (10035185, '2000-04-17')) AS t(patient_id, date_since)) AS t(chest_tube_#1)",[{'SUM(outputevents.value)': None}]
be826cd58248f2874aea7651,Tell me the length of stay in days of patient 10016810's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT COUNT(DISTINCT ""length of stay in days"") FROM ""icu"" WHERE ""patient id"" = 10016810 AND NOT ""icu"".""end time"" IS NULL ORDER BY ""icu"".""start time"" NULLS FIRST LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.488912038039416}]"
1a5433aa4aa1b3959ef3e77f,Which are the four most common specimens tested?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]"
4981e0855f969f301153a2e2,What was the number of patients that were given a protein test since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND strftime('%Y',labevents.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT t1.subject, t2.date FROM (SELECT subject, date FROM patients WHERE date >= '2100-01-01') AS t1 JOIN (SELECT patient_id, date FROM lab_results WHERE result_type = 'protein') AS t2 ON t1.subject = t2.patient_id)",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
169bc0cd29c8abe63a931a22,What was the name of the drug that was first prescribed to patient 10020306 through the iv route last month?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT name FROM iv_route WHERE patient = 10020306 AND date = CURRENT_DATE - INTERVAL '1 month' ORDER BY date NULLS FIRST LIMIT 1,[]
6fae636a877faa698dbc3148,"This year, how many patients were provided with lidocaine 5% patch?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine 5% patch' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.patient_type = ' lidocaine 5% patch' AND DATETIME(patient.date_of_entry, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4f2d444fc44c6244f4d959c7,Tell me the top four most commonly prescribed drugs in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE STRFTIME('%y', prescriptions.date) = '2100' GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 4",[]
24273ce507fa41634f03e1bd,How much is the price for acetazolamide?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide' ),SELECT MIN(price) FROM products WHERE product = 'acetazolamide';,
ffe1a02ee978769dd4f4e53d,When did patient 10004733 get their last input on 12/24/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-24' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT patient.last_input FROM patient WHERE patient.patient_id = 10004733 AND STRFTIME('%m/%d/%Y', patient.last_input) = '12/24/2100'",[]
a3dd56dec5262895f50e89b7,How many hours have elapsed since the first time on this hospital stay patient 10021487 received a lab test for basophils?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_test_date)) FROM lab_test WHERE lab_test_type = 'Basophils' AND patient_id = 10021487",[]
3c937ae915d99a3eb8b08241,How many patients were staying in neuro stepdown since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT(DISTINCT j.subject_id) FROM (SELECT j.subject_id, t.transition_time FROM (SELECT j.subject_id, STRFTIME('%y', transition_time) as transition_time FROM job_table WHERE job_type = 'neuro stepdown') AS t JOIN job_table AS j ON t.subject_id = j.subject_id WHERE t.transition_time >= '2100') AS subquery;",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
21a3e839651e25cd7da1dac9,Has patient 10021938 received any surgery since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM surgery WHERE surgery.patient_id = 10021938 AND STRFTIME('%y', surgery.date) >= '2100'",
fd514da0acdf2220eacb5f1f,What was the name of the insurance used for patient 10001217 in their first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT name FROM insurance WHERE insurance_id = (SELECT insurance_id FROM encounter WHERE patient_id = 10001217 AND NOT dismissed = 0 ORDER BY encounter_date NULLS FIRST LIMIT 1);,[{'insurance': 'Other'}]
c1bede41699794dd619feb6b,What's the price of a procedure referred to as other electric countershock of heart?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ),SELECT COUNT(*) FROM procedures WHERE procedures.other_details = 'electric countershock of heart',
040d18e997bb872c3314ccba,Tell me what was patient 10008454's monthly minimum weight since 2 months ago?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-2 month') GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT MIN(weight) FROM patients WHERE patient_id = 10008454 AND date > CURRENT_DATE - INTERVAL '2 month' GROUP BY date,[]
8d73f28463798e2fa6a31b3a,What was the last time patient 10016742 has had the maximum respiratory rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(respiratory_rate) FROM patient WHERE patient.id = 10016742;,[]
c4eba636bd543d4b237a1e3c,What was the dose of pseudoephedrine that in 11/2100 patient 10026354 was first prescribed?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.drug = 'pseudoephedrine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT date_part('year', row(0, 0, 0)) as year, date_part('month', row(0, 0, 0)) as month, prescriber.name as prescriber_name, COUNT(1) as count FROM patients WHERE patients.id = 10026354 AND prescriber.name IN ('John Doe', 'Jane Doe') AND STRFTIME('%y-%m', prescriber.date) = '2100-11' GROUP BY year, month, prescriber.name ORDER BY year NULLS FIRST, month NULLS FIRST, prescriber.name NULLS FIRST",[]
f86dbfb605a8cf22c7785807,What was the total amount of glucagon that they prescribed to patient 10015931 since 05/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'",SELECT SUM(glucagon) FROM prescriptions WHERE patient_id = 10015931 AND date_prescribed >= '05/2100',[{'SUM(prescriptions.dose_val_rx)': None}]
239fa629d1e7317b24ec198e,What is the cost for the drug duloxetine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'duloxetine' ),SELECT AVG(cost) FROM drugs WHERE drug = 'duloxetine';,
fc608735d9ab6fc5bd43a04c,What is the average total cost for the hospital when a triiodothyronine (t3) lab test is involved since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(Total_Cost) FROM hospital WHERE Total_Cost = (SELECT SUM(Cost) FROM lab WHERE Lab_Name = 'Triiodothyronine (T3)' AND Year >= 2100),
a62df61b51406f3e15d17418,Tell me the name of the first specimen test patient 10021938 had received on their last hospital encounter.,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,"SELECT specimen_type FROM (SELECT SUM(CASE WHEN pathogen_present = 'true' THEN 1 ELSE 0 END) AS specimen_type FROM (SELECT pathogen_present FROM (SELECT patient_id, pathogen_present FROM (SELECT patient_id, NULL FROM patient_pathogen WHERE patient_id = 10021938 AND NOT last_hospital_visit IS NULL ORDER BY last_hospital_visit DESC LIMIT 1)) AS t1) AS t2 GROUP BY specimen_type ORDER BY specimen_type NULLS FIRST LIMIT 1",[{'spec_type_desc': 'MRSA SCREEN'}]
b88f292ca552b0ea6d9929d1,"During the last hospital visit, did patient 10037861 receive a right heart cardiac catheterization treatment?",SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM treatment_table WHERE patient_id = 10037861 AND treatment_type = 'right heart cardiac catheterization',[{'COUNT(*)>0': 0}]
03b4e3ee9ffa442c8b1b6f34,"What was the drug that was prescribed to patient 10002495 within the same day after the measurement of cardiac sampling and pressure, right heart, percutaneous approach in 06/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, right heart, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug FROM (SELECT t1.subject_id, t1.date FROM (SELECT 10002495 AS subject_id, '2022-06-01' AS date FROM grades WHERE subject_id = 10002495) AS t1 JOIN (SELECT 10002495 AS subject_id, '2022-06-10' AS date FROM grades WHERE subject_id = 10002495) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day')",
b711a8c66ded68ed4cd6199c,What are the total average expenses for a hospital involving a laboratory test for oxygen since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(Expenses) FROM Hospitals WHERE HospitalID IN (SELECT HospitalID FROM LabTests WHERE TestName = 'Oxygen') AND Year >= 2100,
b4ca4b338d97b7278100eed6,When was the last time when patient 10026354 was prescribed iso-osmotic sodium chloride and 0.9% sodium chloride (mini bag plus) at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND admissions.subject_id = 10026354 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride (mini bag plus)' AND admissions.subject_id = 10026354 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(datetime(prescription_time, 'start date')) FROM prescriptions WHERE patient_id = 10026354 AND prescription_name = '0.9% Sodium Chloride (Mini Bag Plus)' AND iso_osmotic_sodium_chloride = 'Iso-Osmotic Sodium Chloride'",[]
0ba53e15e28cc6c41c12f29b,When and where are the rounds and procedures of dr. canpos?,,SELECT WHERE AND WHEN Dr. Canpos = 'Round 1' AND 'Procedure 2',
a410edd0be9764d12a841458,Has patient 52018 an appointment at the other department?,,SELECT COUNT(*) > 0 FROM appointments WHERE appointments.patient_id = 52018 AND appointments.location = 'other department',
f599a974b9f48dd1b8bee774,"Since 1 year ago, has patient 10020187 been in an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",SELECT COUNT(*) > 0 FROM emergency_room_admissions WHERE patient_id = 10020187 AND admit_date >= (SELECT admit_date FROM patient_admissions WHERE patient_id = 10020187) - 1,[{'COUNT(*)>0': 0}]
bccd2741d2ab3570194f6bc7,What was the name of the medication that patient 10016150 was last prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT medication.name FROM medication WHERE medication.patient_id = 10016150 ORDER BY medication.date DESC LIMIT 1;,[{'drug': 'Aspirin'}]
84e5d95551d30c43dcfd59af,Did patient 10015860 receive a other skin graft to other sites treatment during their last hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other skin graft to other sites' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM treatment WHERE treatment.patient_id = 10015860 AND treatment.treatment_type = 'other skin graft to other sites',[{'COUNT(*)>0': 0}]
d7cb00a4818527abbd869e4f,What is the minimum total hospital cost that involved fluoroscopy of multiple coronary arteries using other contrast procedure since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(total_cost) FROM (SELECT SUM(cost) AS total_cost FROM procedures WHERE procedures.name = 'fluoroscopy of multiple coronary arteries using other contrast' AND STRFTIME('%y', procedures.date) >= '2100' GROUP BY procedures.id)",
0688645b190580e5eaf4bad5,How many operating rooms are available now?,,SELECT COUNT(*) FROM Operating_Rooms WHERE room_status = 'available';,
190982f3687093b621a95f14,"What's the cost to get drainage of pericardial cavity, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure = 'Drainage of pericardial cavity, percutaneous approach';",
f65af6870b5d460f82233782,Could you inform me the total output amount of patient 10022281 since 06/03/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-03'","SELECT SUM(output) FROM (SELECT output FROM ""output.csv"" WHERE patient = ""10022281"" AND output_date >= ""2100-06-03"")",[{'SUM(outputevents.value)': 2332.0}]
3105970deb871dbf0e604cb4,What is the cost of the drug named mirtazapine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'mirtazapine' ),SELECT DISTINCT cost FROM drugs WHERE name = 'mirtazapine';,
2d36357172aa4aae8c662e86,"What are the costs of other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure diagnosis?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) )",SELECT DISTINCT cost FROM procedures WHERE procedure_category = 'Other surgical procedures' AND cost IS NOT NULL AND cost > 0,
fc919be1cf3be39f5788b8c3,Can you tell me when the first lymphocytes test of patient 10007795 was conducted in 04/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1","SELECT STRFTIME('%Y-%m', MIN(lab_date)) FROM lab WHERE lab.patient_id = 10007795 AND lab.test_name = 'lymphocytes'",[]
66c9f492519459a4e0775016,What was the output patient 10007818 had on 07/15/this year on the last occasion?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '07-15' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT SELECT current_setting('output_file') FROM read_parquet('patients/10007818/output.parquet', filename=true) WHERE filename LIKE '%07/%15/%this_year' ORDER BY filename DESC LIMIT 1;",[]
6562f562696c0b8ddfd04a29,"Since 1 year ago, has patient 10001217 been at the emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM patient WHERE patient.emergency_room_visits > 0 AND patient.patient_id = 10001217 AND DATETIME(patient.emergency_room_visits) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 0}]
ae413e6191c531e7f585a405,Has patient 10021312 been provided any medications since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) > 0 FROM medications WHERE medications.patient_id = 10021312 AND STRFTIME('%y', medications.date_provided) >= '2100'",[{'COUNT(*)>0': 1}]
9a53dfd94198f8a68458fa6d,What were the top four most common lab tests done since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date >= (CURRENT_DATE - INTERVAL '1 year')) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
8f5e6c6df7b4307eb679bfd9,Could you list the five most common specimen tests carried out throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen_type, COUNT(specimen_type) FROM microbiology WHERE year = 2014 GROUP BY specimen_type ORDER BY COUNT(specimen_type) DESC LIMIT 5",[]
1e114a0ca464f5bf590ace7d,Do you think patient 24132 is subject to covid-19 testing?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_id = 24132 AND patients.covid_19_testing = 'yes',
e1a987c52eaba2b8697dbc00,What was the first time in 04/this year patient 10012853 was prescribed a medication via the po route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM medication_table WHERE patient_id = 10012853 AND route = 'po' AND date_prescribed >= '2022-04-01',[]
753481148eded16306edf567,What is the ward identification of patient 15968 able to be admitted to?,,SELECT ward FROM patient WHERE patient.admit_date IS NULL AND patient.ward = 15968,
94401d1b08ae71f5ad65ac7b,What was patient 10020944's total volume of output on 03/10/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-10'",SELECT SUM(output) FROM output WHERE patient_id = 10020944 AND output_date = '03/10/2100',[{'SUM(outputevents.value)': None}]
9460f94a4daa58493e8ebbed,What was patient 10020786's first tested culture in 07/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT patient.first_test_culture FROM patient WHERE patient.patient_id = 10020786 AND STRFTIME('%y-%m', patient.first_test_date) = '2100-07'",[]
18d6cbfdf913f50a3617e481,"What is patient 10029291's difference in fibrinogen, functional from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT (SELECT lab.result FROM lab WHERE lab.patient_id = 10029291 AND lab.label = 'Fibrinogen, Functional' ORDER BY lab.date NULLS FIRST LIMIT 1) - (SELECT lab.result FROM lab WHERE lab.patient_id = 10029291 AND lab.label = 'Fibrinogen, Functional' ORDER BY lab.date NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
99fccf1659e27afc7dd17ad2,Tell me the amount of total foley that patient 10010471 had since 03/08/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-08'","SELECT SUM(FOLEY) FROM ""brackets"" WHERE PATIENT_ID = 10010471 AND START_TIME >= '2100-03-08'",[{'SUM(outputevents.value)': None}]
f53ea28051ef658c6e955c6f,What percentile is 32.9 on a hematocrit test among patients of the same age as patient 10029291 on the first hospital stay?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.9",,
2e302933ba1ba62f25b09b46,Calculate the number of prescribed drugs for patient 10022880 since 19 months ago.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-19 month')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10022880 AND DATETIME(prescriptions.date) >= DATETIME(CURRENT_TIME, '-19 month')",[{'COUNT(*)': 63}]
b2a5c5b1233bd06110dd5253,"Since 2100, what was the top four most frequent diagnoses patients were diagnosed with within 2 months after receiving excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.month FROM (SELECT EXTRACT(MONTH FROM procedures.date) AS month FROM procedures WHERE procedures.procedure = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic') AS t1 JOIN (SELECT EXTRACT(MONTH FROM diagnoses.date) AS diagnosis FROM diagnoses WHERE diagnoses.diagnosis = 'top four most frequent diagnoses patients were diagnosed with') AS t2 ON t1.month BETWEEN SELECT EXTRACT(MONTH FROM procedures.date) - 2 AND SELECT EXTRACT(MONTH FROM procedures.date) + 2 GROUP BY t2.diagnosis) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC",
893c2935450c5d908b4a566a,What is the procedure that patient 10007818 received two times?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT _procedure FROM (SELECT _procedure, COUNT(*) AS c1 FROM procedures WHERE _patient = 10007818 GROUP BY _procedure) AS t1 WHERE c1 = 2",
d0b77b1523060bc5563a0484,Tell me the five most common microbiology tests for patients who were previously diagnosed with coronary atherosclerosis of autologous vein bypass graft in the same month in 2100.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.microbiology_test, COUNT(t3.microbiology_test) FROM (SELECT t2.microbiology_test, t1.month FROM (SELECT patient.id, diagnosis.month FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'coronary atherosclerosis of autologous vein bypass graft') AS t1 JOIN (SELECT patient.id, microbiology_test FROM microbiology WHERE year = 2100) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.month = t2.month GROUP BY t2.microbiology_test) AS t3 GROUP BY t3.microbiology_test ORDER BY COUNT(t3.microbiology_test) DESC LIMIT 5",
9def26468b7d6f3093845934,"What is the cost of dislocation of jaw, initial encounter diagnostic?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) )","SELECT DISTINCT cost FROM brackets_diagnoses WHERE diagnosis = ""Dislocation of jaw, initial encounter""",
7d2d2036da24495b7017dd89,"What is the total number of days that have passed since patient 10021487's first potassium, whole blood lab test in their current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT COUNT(*) FROM lab WHERE lab.patient = 10021487 AND lab.lab_name = 'potassium, whole blood'",[]
909967a65d2b569fddd45064,"In 2100, how many medications were prescribed to patient 10004733?","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND STRFTIME('%y', prescriptions.date) = '2100'",[{'COUNT(*)': 0}]
03126bd2f49e133b299a8f4d,How many times was olanzapine prescribed since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine' AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)': 1}]
1108d7271243b64d3250ee9e,Has patient 10000032 gone through any procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10000032 AND STRFTIME('%y', procedures.date) >= '2100'",
a1b5fd9738bdb0ab96eb89a9,What was the medication that patient 10004733 was prescribed for during the same day after receiving enteral infusion of concentrated nutritional substances since 05/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t3.medication FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10004733 AND treatment.type = 'enteral infusion of concentrated nutritional substances' AND STRFTIME('%y-%m', treatment.date) >= '2100-05') AS t1 JOIN (SELECT patient.id, medication.medication, treatment.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.id = 10004733 AND STRFTIME('%y-%m', treatment.date) >= '2100-05') AS t2 ON t1.id = t2.id JOIN (SELECT patient.id, medication.medication, treatment.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.id = 10004733 AND STRFTIME('%y-%m', treatment.date) >= '2100-05') AS t3 ON t2.",
04195370f600639421b6233c,Was there a enteral infusion of concentrated nutritional substances procedure performed on patient 10003046 on the first hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10003046 AND procedures.procedure_name = 'enteral infusion of concentrated nutritional substances' AND NOT procedures.hospital_id IS NULL ORDER BY procedures.hospital_id NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
b0dd61356a38fe4d8c8eda84,What are the newly prescribed drugs for patient 10004733 today compared to those prescribed yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT SELECT * FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND DATETIME(prescriptions.date_prescribed, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescriptions.date_prescribed, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
837a8f55375dcee9e103dbce,Has patient 10021118 been prescribed any prescription drugs throughout this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10021118 AND DATETIME(prescriptions.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
7234f29b92615d05cfbde52f,When did patient 10036156 receive an input for the first time in their first ICU visit?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1,SELECT MIN(time) FROM input WHERE patient_id = 10036156 AND NOT icu_number IS NULL ORDER BY time NULLS FIRST LIMIT 1;,[{'starttime': '2157-07-01 05:00:00'}]
bbd60fbc1489752c6364f8bf,"On their last ICU visit, what was the last arterial blood pressure mean value of patient 10038933?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(arterial_blood_pressure_mean) FROM icu_visits WHERE patient_id = 10038933 AND NOT icu_visits.arterial_blood_pressure_mean IS NULL,[]
f4d15c6e05db8c46f07c865f,Give me the count of patients who were prescribed polyethylene glycol last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'polyethylene glycol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date_prescribed FROM (SELECT subject_id FROM patients WHERE date_of_birth IS NOT NULL) AS t1 JOIN (SELECT date_prescribed FROM prescriptions WHERE polyethylene_glycol IS NOT NULL) AS t2 ON t1.subject_id = t2.subject_id WHERE t2.date_prescribed >= (SELECT MIN(date_prescribed) FROM prescriptions WHERE polyethylene_glycol IS NOT NULL) AND t2.date_prescribed <= (SELECT MAX(date_prescribed) FROM prescriptions WHERE polyethylene_glycol IS NOT NULL) AND DATETIME(t2.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year'))",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
1c5f16182f446c154f204081,"When, , was the first time patient 10031404 was prescribed a medication via the iv route?",SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(date_prescribed) FROM medication_table WHERE patient_id = 10031404 AND route = 'iv',[]
c123e03a1725cd7b860dadff,Tell me what was patient 10021487's daily minimum weight since 18 months ago?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-18 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MIN(weight) FROM patients WHERE patient_id = 10021487 AND date > CURRENT_DATE - INTERVAL '18 month' GROUP BY date,[]
781463ec4654dbff8c5df153,Did patient 10002930 have any prescriptions for medicines in their last hospital visit?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),,[{'COUNT(*)>0': 0}]
f7c14865b950690588b06349,List the top five most frequent events occurring since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT event_type, COUNT(*) FROM events WHERE date_part('year', event_date) >= 2100 GROUP BY event_type ORDER BY COUNT(*) DESC LIMIT 5;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
9dfc1f05e2a00f866e5a96b6,Does patient 31880 have a history of late effect acute polio in his/her family?,,SELECT COUNT(*) > 0 FROM history WHERE history.patient_id = 31880 AND history.description = 'late effect acute polio',
c7a759042b7285ebd4faf3f8,"What were the five most frequently diagnosed microbiology tests for patients who were diagnosed with cardiac arrest due to underlying cardiac condition before in the same hospital visit, in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.Microbiology, COUNT(t3.Microbiology) FROM (SELECT t2.Microbiology, t1.EpisodeNumber, t1.HospitalDischTime, t1.HospitalAdmitTime FROM (SELECT t1.EpisodeNumber, t1.HospitalDischTime, t1.HospitalAdmitTime FROM (SELECT * FROM (SELECT EpisodeNumber, HospitalDischTime, HospitalAdmitTime FROM CardiacArrestData WHERE UnderlyingCardiacCondition = ""Yes"") AS t1 JOIN (SELECT * FROM MicrobiologyData WHERE Microbiology = ""Yes"") AS t2 ON t1.HospitalDischTime = t2.MicrobiologyTime) AS t3 WHERE t3.HospitalAdmitTime = STRFTIME('%Y-%m-%d', '-2100 year') GROUP BY t3.Microbiology) AS t4 ORDER BY COUNT(t4.Microbiology) DESC LIMIT 5",
dc56faa6ef9caadfd8ca6880,What is the number of ICU visits for patient 10025612 in 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND strftime('%Y',icustays.intime) = '2100'",SELECT COUNT(DISTINCT icu_visits) FROM icu_visits WHERE patient_id = 10025612 AND year = 2100;,[{'COUNT( DISTINCT icustays.stay_id )': 0}]
a6fe11704f68e1f821cfc45e,Count the number of people who were diagnosed with postprocedural heart failure following other surgery since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural heart failure following other surgery' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.year FROM (SELECT subject_id, diagnosed FROM diagnoses WHERE diagnosis = 'postprocedural heart failure following other surgery') AS t1 JOIN (SELECT subject_id, procedures.year FROM procedures WHERE procedures.year >= 2100) AS t2 ON t1.subject_id = t2.subject_id)",
82497b82db1a47d9940db063,Can you tell me when the last asparate aminotransferase (ast) test of patient 10015272 was conducted in 06/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime DESC LIMIT 1",SELECT MAX(asparate_aminotransferase__ast_) FROM lab WHERE lab.patient_id = 10015272 AND lab.test_date = '06/this year',[]
61f9f600cf87c85106cb2efd,"Has patient 10007795 got a prescription for acetaminophen, pregabalin, or pantoprazole in 04/last year?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug IN ( 'acetaminophen', 'pregabalin', 'pantoprazole' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10007795 AND prescriptions.drug IN ('acetaminophen', 'pregabalin', 'pantoprazole') AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year') AND STRFTIME('%m', prescriptions.date) = '04'",[{'COUNT(*)>0': 0}]
77238633972ba57331af47e1,What was the total amount of ciprofloxacin 0.3% ophth soln that patient 10026354 has been prescribed since 10/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.drug = 'ciprofloxacin 0.3% ophth soln' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'",SELECT SUM(ciprofloxacin_0.3%_ophth_soln) FROM medication WHERE medication.patient_id = 10026354 AND medication.start_date >= '10/2100',[{'SUM(prescriptions.dose_val_rx)': None}]
11c5ddc438e48b537cf7d477,When did patient 10000032 last get prescribed lactulose and fluticasone propionate 110mcg at the same time in 08/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactulose' AND admissions.subject_id = 10000032 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'fluticasone propionate 110mcg' AND admissions.subject_id = 10000032 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(DATE '2100-08-01') FROM patients WHERE patients.patient_id = 10000032 AND patients.prescriptions = 'lactulose, fluticasone propionate 110mcg'",[]
3fa2f28fcf723a8ae5b496cd,What is patient 10001217's SaO2 change measured at 2100-12-05 21:00:00 compared to the value measured at 2100-12-05 20:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 20:00:00' ),SELECT (SELECT sao2 FROM patients WHERE patient_id = 10001217 AND measurement_time = '2100-12-05 21:00:00') - (SELECT sao2 FROM patients WHERE patient_id = 10001217 AND measurement_time = '2100-12-05 20:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 20:00:00' )"": None}]"
6c4b2c8d659fcb229d747557,Is patient 32168 in the family of a person with react-indwell urin cath?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.family_id IN (SELECT patients.family_id FROM patients WHERE patients.name = 'Jane Doe') AND patients.name = 'Patient 32168',
48a6844f3ba6022354e2d189,What steps should i take before the drsl/dslmb fus post/post procedure?,,SELECT * FROM duckdb_functions WHERE function_name = 'drsl/dslmb fus post/post';,
67a50aa49b80a0cadb830e34,What precautions should i take after a exploratory laparotomy procedure?,,SELECT * FROM procedures WHERE procedure = 'Exploratory laparotomy';,
d939b033b5e6b326580d0570,How many hours have passed since patient 10004733 had the last pt lab test in their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', pt_lab.timestamp)) FROM pt_lab WHERE pt_lab.patient_id = 10004733 AND pt_lab.hospital_id = (SELECT h.hospital_id FROM hospital h WHERE h.hospital_name = 'Stanford Medical Center' AND h.location = 'Stanford, CA') ORDER BY pt_lab.timestamp DESC LIMIT 1;",[]
6ddb92afc3aeb9e8294f6e45,"Tell me the name of the drug patient 10021312 was prescribed in the same hospital encounter after having received a excision of left main bronchus, via natural or artificial opening endoscopic procedure since 04/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT name FROM drugs WHERE patient_id = 10021312 AND date_excision LIKE '%04/%' AND procedures = 'excision of left main bronchus, via natural or artificial opening endoscopic'",
243503fcb552e825a3b62d0c,Is the patient 10018423 a male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10018423,SELECT patients.gender FROM patients WHERE patients.id = 10018423,[{'gender': 'M'}]
54234a211c3fb7360ae4e161,What amount of fish oil (omega 3) has been prescribed to patient 10004457 for the last time during their last hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'fish oil (omega 3)' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT SUM(fish_oil_omega_3) FROM patient WHERE patient.id = 10004457 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1;,[]
84a492082c7e8112ea7f1544,When was the last time that patient 10037861 was given a specific gravity lab test?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(lab_date) FROM lab_data WHERE patient_id = 10037861 AND lab_test = 'specific gravity',[]
0d22269bdd7bfa8481b101b5,What was patient 10005817's total volume of output since 06/04/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-04'","SELECT SUM(output) FROM ""patient10005817"" WHERE output_date >= '2100-06-04'",[{'SUM(outputevents.value)': 41303.0}]
dc8519f946507f8fe299e28d,How many patients left the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",SELECT COUNT(*) FROM patients WHERE HOSPITAL_LEFT = '2100';,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
e973b4ccb6182ec1b934fe53,How much is the maximum total hospital bill when it includes a triiodothyronine (t3) lab test in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(t2.c2) AS c1 FROM (SELECT c2 FROM (SELECT 1 AS c2 FROM t2 WHERE t2.y = 2100) AS t3 JOIN t1 ON t1.y = t2.y) AS t2 JOIN t1 ON t1.y = t2.y) AS t1;,
2fd61472c7569c2469bef07e,Has patient 10005348 received a medication prescription since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM medication_prescriptions WHERE medication_prescriptions.patient_id = 10005348 AND STRFTIME('%y', medication_prescriptions.date) >= '2100'",[{'COUNT(*)>0': 1}]
a39005834defa0da659aa0e9,How many ascorbic acid prescriptions occurred in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Ascorbic Acid' AND STRFTIME('%y', prescriptions.start_date) = '2100';",[{'COUNT(*)': 0}]
74eaa2aea6b2bc5d95b46140,"What was the first time that the SaO2 of patient 10004422 was, on 01/22/this year, less than 96.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 96.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '01-22' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(diagnosis_date) FROM diagnoses WHERE diagnoses.patient_id = 10004422 AND diagnoses.sao2 < 96.0 AND DATETIME(diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m-%d', diagnosis_date) = '01-22'",[]
07c7d0b230f28eb2bba883d4,Has patient 10005909 been provided any medications since 11/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'","SELECT COUNT(*) > 0 FROM medications WHERE medications.patient_id = 10005909 AND STRFTIME('%y-%m', medications.date) >= '2100-11'",[{'COUNT(*)>0': 1}]
383586ac765d783e5374a6c0,What was the name of the drug that during their first hospital visit patient 10016150 was first prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT,[{'drug': 'Nitroglycerin SL'}]
754e29dd9545b861d06c17c4,What is the average hospital cost to include a drug called acetylcysteine (iv) during this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",SELECT AVG(hospitalcost) FROM hospital WHERE prescriptions.drug_name = 'Acetylcysteine (IV)',
1dd7881fb93e0f171b1c67dc,"For the last time on the first hospital stay, what was patient 10018423 diagnosed with?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),"SELECT diagnosis FROM (SELECT patient_id, diagnosis FROM diagnoses WHERE patient_id = 10018423 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1) AS subquery ORDER BY diagnosis DESC LIMIT 1",
75cb3e513ae45223b3f00a57,When was patient 10022017's first discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1","SELECT MIN(dischtime) FROM (SELECT patientid, dischtime FROM patient WHERE patientid = 10022017)",[]
1429055dfad66664c7bf35fe,"When was the first time the SaO2 of patient 10018081 was greater than 92.0, on 12/29/this year?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 92.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(datetime(brackets.session, 'start time')) FROM brackets WHERE brackets.patient = 10018081 AND SAO2 > 92.0 AND datetime(brackets.session, 'start time') = DATETIME(CURRENT_TIME, 'start time', '-0 year') AND DATETIME(brackets.session, 'start time') = DATETIME(CURRENT_TIME, 'start time', '-0 year') AND DATETIME(brackets.session, 'start time') = DATETIME(CURRENT_TIME, 'start time', '-0 year')",[]
1f1579d6f5886ce1d80398a0,"In this year, what was the last diagnosis for patient 10012552?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT MAX(diagnoses.diagnosis_date) FROM diagnoses WHERE diagnoses.patient_id = 10012552 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",
12a5396f55e7c3fd73c0c640,"For patients who undertook drainage of left main bronchus, via natural or artificial opening endoscopic, diagnostic in the same month, what are the top three most frequent specimens tested afterward since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen FROM (SELECT t2.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT patient.subject_id, procedures.date FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.procedure = 'Drainage of left main bronchus, via natural or artificial opening endoscopic' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.subject_id, specimen, date FROM specimen JOIN patient ON specimen.patient_id = patient.subject_id WHERE DATETIME(specimen.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t2.specimen) AS t3 WHERE t3.rank <= 3",
924c0d9895d24fb53c79fb4a,"What is the average expense for dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) )","SELECT AVG(expense) FROM procedures WHERE procedure = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic'",
fd1fe8945ba7f1d84a6e557a,When was the last discharge time of patient 10020944 from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020944 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = 10020944;,[]
cb605fd1d340ab1ad0afe330,What is the drug to avoid during the exc/dest hrt lesion open.,,"SELECT ""drug to avoid"" FROM procedures WHERE ""procedure"" = 'exc/dest hrt lesion open'",
8cdcafd00523784d37d8dad5,Which immuno-cancer drugs have been used for the last five years?,,"SELECT DISTINCT ""drug"" FROM products WHERE ""indication"" = 'immuno-cancer drugs' AND ""manufacturer"" = 'brackets' AND ""year"" >= EXTRACT(YEAR FROM CURRENT_DATE) - 5;",
f99e58fee0562c646b3dc682,Has any prescriptions been given to patient 10022017 during this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10022017 AND DATETIME(prescriptions.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
9b6f8be92fbf3a67eba1ac22,What are the five most frequently prescribed drugs during the same hospital encounter to the patients aged 60 or above after they were diagnosed with street and highway accidents in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'street and highway accidents' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t1.subject_id, t1.diagnosis_date, t1.age FROM (SELECT ST_Read('path/to/your/study.parquet') AS t1 JOIN (SELECT ST_Read('path/to/your/study.parquet') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < '2100-01-01' AND t1.diagnosis_date >= '2100-01-01' AND t1.age >= 60) AS t2 JOIN (SELECT t1.subject_id, t1.drug, t1.drug_date FROM (SELECT ST_Read('path/to/your/study.parquet') AS t1 JOIN (SELECT ST_Read('path/to/your/study.parquet') AS t2 ON t1.subject_id = t2.subject_id WHERE t",
216744fcbadbfb5384e8c226,What are the top four commonly ordered treatments for patients in their 30s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment, t.time FROM (SELECT 'A1' AS treatment, '2001-01-01 00:30:00' AS time FROM patients WHERE patients.age BETWEEN 30 AND 39) AS t GROUP BY t.treatment) AS t1 JOIN (SELECT 'A2' AS treatment, '2001-01-01 00:30:00' AS time FROM patients WHERE patients.age BETWEEN 30 AND 39) AS t2 ON t1.treatment = t2.treatment WHERE t1.time < t2.time GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 4",
07bde541ff2932869ecb4912,How many doses of omeprazole have been prescribed to patient 10023117 on the last hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'omeprazole',SELECT SUM(omeprazole_dose) FROM prescriptions WHERE prescriptions.patient_id = 10023117 AND NOT prescriptions.hospital_dischtime IS NULL ORDER BY prescriptions.hospital_admittime DESC LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
8509828abb4a1380dd44f76c,Did patient 10011398 receive any disease diagnoses during the last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10011398 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year') AND diagnoses.diagnosis_type = 'disease'",
470175d0ccd7f8d9a81e4c14,"Has patient 10038999 undergone the drainage of left pleural cavity, percutaneous approach, diagnostic throughout this year?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM procedures WHERE procedures.patientId = 10038999 AND procedures.procedureName = 'drainage of left pleural cavity, percutaneous approach, diagnostic' AND DATETIME(procedures.procedureDate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
52f3a2c6b4d044c06fd15131,What was the name of the specimen test which patient 10000032 has first received since 04/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT specimen_type FROM visit_log WHERE patient_id = 10000032 AND STRFTIME('%y-%m', visit_date) >= '2100-04' ORDER BY visit_date NULLS FIRST LIMIT 1",[{'spec_type_desc': 'URINE'}]
40ee187ccec9edfec26c08d6,When was patient 10007818 prescribed pantoprazole and vial at the same time for the last time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10007818 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND admissions.subject_id = 10007818 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(pharmacy_id) FROM (SELECT patient_id, prescription_start_date FROM prescriptions WHERE prescription_name = 'pantoprazole' INTERSECT SELECT patient_id, prescription_start_date FROM prescriptions WHERE prescription_name = 'vial')",[]
b594bc62abf53801dd98efe3,Please count the hospital visits made by patient 10012853 in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) = '2100'",SELECT COUNT(Hospital_Visits) FROM Visits WHERE Patient_ID = 10012853 AND Year = 2100;,[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
a86aa0f3bbf78e814aab9af4,What is the foley output for patient 10026354 since 03/01/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-01'",SELECT SUM(foley) FROM output WHERE patient = 10026354 AND date >= '2100-03-01',[{'SUM(outputevents.value)': None}]
6fb7db09905b3e0b6571bb41,When and where are the rounds and procedures of dr. moore?,,SELECT WHEN AND WHERE Dr. Moore Rounds AND Procedures FROM './path/to/dr_moore_brackets.sql';,
54f536c0e9bc497653648fa1,What is the difference between SaO2 last measured on the last ICU visit compared to the first value measured on the last ICU visit for patient 10022041?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT SAO2 FROM ICU WHERE patient = 10022041 AND NOT SAO2 IS NULL ORDER BY SAO2 DESC LIMIT 1) - (SELECT SAO2 FROM ICU WHERE patient = 10022041 AND NOT SAO2 IS NULL ORDER BY SAO2 ASC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
1936469b953a861d9b26f745,What's the maximum total hospital cost that involved alcohol detoxification?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(t1.total_cost) FROM (SELECT SUM(ci.cost) AS total_cost FROM (SELECT c.cost FROM cost_table c WHERE c.name = 'alcohol detoxification') AS ci GROUP BY ci.id) AS t1,
cbcdc4db6f2c0f87986c08eb,"What was the first time that patient 10018501 had a minimum value of calcium, total?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT MIN(calcium, total) FROM patients WHERE patient_id = 10018501",[]
1ece08272edfd635b238cb47,Give me the count of patients who were prescribed nifedipine cr last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
95bf452438092fdf90c9955f,What was the minimum value of patient 10014729's protein in 03/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",SELECT MIN(protein) FROM patient_10014729 WHERE date = '03/2100',[{'MIN(labevents.valuenum)': None}]
1558f54b2c3bec57f2893d4f,What are the three most frequent procedures for patients aged 30s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Name FROM (SELECT procedures.Name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM procedures WHERE procedures.age BETWEEN 30 AND 39 GROUP BY procedures.Name) AS t1 WHERE t1.c1 <= 3",
39a0e7eaffab936c1439a5fa,Is the respiratory rate level of patient 10026406 measured at 2100-01-12 13:00:00 less than measured at 2100-01-12 12:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' ),SELECT (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10026406 AND measurement_time = '2100-01-12 13:00:00') < (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10026406 AND measurement_time = '2100-01-12 12:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' )"": None}]"
0063d54603cf0f791a4f2d03,Has patient 10027445 had a right heart cardiac catheterization procedure in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM cardiac_cath WHERE cardiac_cath.patient_id = 10027445 AND cardiac_cath.cath_type = 'right heart cardiac' AND STRFTIME('%y', cardiac_cath.cath_date) = '2100'",
1ebe06aacc066a61c6d64f52,Has patient 10023117 received any diagnoses since 1 year ago?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10023117 AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')",
72f9d3cf5bb88a5d34be8b2e,How many patients were discharged from the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT(DISTINCT patient_id) FROM brackets WHERE NOT dismissal_date IS NULL AND STRFTIME('%y', dismissal_date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
001bd30793469267511dbbbb,What is the price of a diagnosis for sepsis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis' ) ),SELECT DISTINCT cost FROM diagnoses WHERE name = 'sepsis',
8288ab2fa75b4a191de46940,Tell me the count of the drugs patient 10040025 was prescribed during their first hospital encounter.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) FROM drugs WHERE drugs.patient_id = 10040025 AND NOT drugs.had_any_effect = 0 AND drugs.drug_index = 1,[{'COUNT(*)': 28}]
11bb6b4e96dfc29737cec768,What was the duration of the circumcision procedure for patient 3277?,,SELECT duration FROM procedures WHERE patient = 3277 AND procedure = 'circumcision';,
045bf7ee10229a2cde7504e7,What kind of immunocancer drugs have been out for the last five years?,,SELECT * FROM drugs WHERE date_of_release > (SELECT current_date - INTERVAL '5 years') AND immunocancer = true,
ee344b98a4a7a22b3443b8a1,When was the first time that patient 10014729 has been prescribed ketorolac and sodium bicarbonate at the same time since 16 months ago?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ketorolac' AND admissions.subject_id = 10014729 AND datetime(prescriptions.starttime) >= datetime(current_time,'-16 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10014729 AND datetime(prescriptions.starttime) >= datetime(current_time,'-16 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT MIN(date_prescribed) FROM medication WHERE patient_id = 10014729 AND medication.name = 'ketorolac' AND date_prescribed >= DATEADD(month, -16, CURRENT_DATE) UNION SELECT MIN(date_prescribed) FROM medication WHERE patient_id = 10014729 AND medication.name = 'sodium bicarbonate' AND date_prescribed >= DATEADD(month, -16, CURRENT_DATE)",[]
3da43478d4e899fc1b0f0fe3,How is nystatin oral suspension taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin oral suspension',,[]
f34ae2771a3ae71a42d66a89,What was the first dose of insulin prescribed to patient 10014729 in 03/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND prescriptions.drug = 'insulin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(insulin) FROM prescriptions WHERE patient = 10014729 AND date_prescribed >= DATEADD(month, -3, CURRENT_DATE)",[]
995e071fb1a801ad2552a7c2,What is the outpatient schedule of dr. brunner today?,,"SELECT COUNT(*) FROM patients WHERE patients.outpatient = 'true' AND patients.doctor = 'dr. brunner' AND DATETIME(patients.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day')",
bb2aaeceb6f9b4fb421cf918,Tell me the total foley output of patient 10022880 since 04/03/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-03'",SELECT COUNT(DISTINCT foley) FROM output WHERE patient = 10022880 AND date >= '2100-04-03',[{'SUM(outputevents.value)': None}]
5f697dd690488492bf17ca8e,What were some of the four common specimen tests given since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",SELECT 4 AS _common_specimen_tests FROM brackets;,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]"
2366c7c9140924ccf9f4b123,How many patients last year left the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
a8ed1315b3325cab2ae9dcee,"Can you provide the name of the drug that was prescribed to patient 10022017 within 2 days post bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach procedure in the last hospital visit?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t4.drug_name FROM (SELECT t3.drug_name, t3.start_date, t3.start_date - INTERVAL '2 day' AS previous_start_date",
54714e162bde7b10c34ed1c1,"During the first hospital visit, what was patient 10012853's age?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.age FROM patients WHERE patient.id = 10012853 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1,
c4c116a340d78cd933a79870,Could you tell me the four most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT four FROM (SELECT microbiology, COUNT(microbiology) AS four FROM samples GROUP BY microbiology) AS subquery ORDER BY four DESC LIMIT 1","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]"
4e2be276b6289a600da28a19,"Has patient 10021312 had a inspection of tracheobronchial tree, via natural or artificial opening endoscopic since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM treatment_table WHERE patient_id = 10021312 AND treatment_type = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' AND year_treated >= 2100",
6d4fb4147666cb3f5be2c8be,Tell me the name of the diagnosis that patient 10009035 received last since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT diagnosis.name FROM diagnosis WHERE diagnosis.patient_id = 10009035 AND DATETIME(diagnosis.date) >= DATETIME(CURRENT_TIME, '-1 year') ORDER BY diagnosis.date DESC LIMIT 1",
dbb471287262410819ef2986,What were the last red blood cells lab test results for patient 10021118 since 10/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(lab_result) FROM lab WHERE lab.patient_id = 10021118 AND lab.lab_name = 'red blood cells' AND STRFTIME('%y-%m', lab.lab_date) >= '2100-10'",[]
42450225f8907884075ad901,Provide the top four most common treatments since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT treatment, date_part('year', date) AS year FROM treatment_table WHERE date_part('year', date) >= date_part('year', CURRENT_DATE) - 1) AS t1 GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 4",
b8c5fe61ece23bbbe04cf389,What's the minimum total cost of the hospital visits that involve a procedure called cardiac mapping throughout this year?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.total_cost) FROM (SELECT SUM(diagnosis.cost) AS total_cost FROM diagnosis JOIN procedures ON diagnosis.diagnosis_id = procedures.diagnosis_id WHERE procedures.procedure_name = 'cardiac mapping' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1",
e582763c64c4e8a81b029c81,How much is the drug zolpidem tartrate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'zolpidem tartrate' ),SELECT DISTINCT cost FROM medication WHERE medication.name = 'Zolpidem Tartrate';,
e0d157e7655d68add3bb76d5,"What is the cost of a diagnosis of surgical operation with anastomosis, bypass, or graft, with natural or artificial tissues used as implant causing abnormal patient reaction, or later complication, without mention of misadventure at time of operation?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'surgical operation with anastomosis, bypass, or graft, with natural or artificial tissues used as implant causing abnormal patient reaction, or later complication, without mention of misadventure at time of operation' ) )","SELECT DISTINCT cost FROM (SELECT 1 AS cost FROM diagnoses WHERE diagnosis = 'surgical operation with anastomosis, bypass, or graft, with natural or artificial tissues used as implant causing abnormal patient reaction, or later complication, without mention of misadventure at time of operation') AS T;",
6264718a6161659bf85a5b7c,What is the maximum total cost of the hospital encounters that include a medicine named prasugrel since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prasugrel' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM hospital_encounters WHERE name = 'prasugrel' AND year >= 2100 GROUP BY name) AS t1,
62984005cb4a2bebf693573b,When patient 10029484 first had a mrsa screen microbiology test since 01/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT strftime(min(sample_date), '%y-%m') as first_test_date FROM microbiology WHERE patient_id = 10029484 AND test_type = 'mrsa screen microbiology' AND sample_date >= '2100-01'",[]
d327924a18220cf4ac6ca8ba,"In 2100, which are the four most frequent lab tests given to patients within the same month after they are diagnosed with personal history of alcoholism?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of alcoholism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Personal history of alcoholism' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.name, lab_test, lab_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.patient_id WHERE STRFTIME('%y', lab_date) = '2100') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.lab_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_date, 'start of month') GROUP BY t2.lab_test) AS t3 WHERE t3.c1 <=",
f6401e3fea26ee15aed66ec1,Was the lactate reading for patient 10015860 last measured on the first hospital visit less than the value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab.result FROM lab WHERE lab.patient_id = 10015860 AND NOT lab.result IS NULL ORDER BY lab.date NULLS FIRST LIMIT 1) < (SELECT lab.result FROM lab WHERE lab.patient_id = 10015860 AND NOT lab.result IS NULL ORDER BY lab.date DESC LIMIT 1 OFFSET 1);,"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
f66542e8f77bde61ef62dc26,"Since 07/2100, has patient 10006053 had any input of dextrose 50%?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'",SELECT COUNT(*) > 0 FROM input WHERE input.patient = 10006053 AND input.date >= '2100-07-01' AND input.dextrose = '50%',[{'COUNT(*)>0': 0}]
aa9cf98a6cfcfc591fd1d744,What is the maximum yearly number of patients affected by other specified hypotension?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified hypotension' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT MAX(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis.patient_id) AS c1 FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis_name = ""Other specified hypotension"" GROUP BY STRFTIME('%y', diagnosis.diagnosis_date)) AS t1",
50179ff508b40f8259d4eb6e,What was patient 10021666's last tested culture?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT patient.last_tested_culture FROM patient WHERE patient.patient_id = 10021666;,[{'spec_type_desc': 'URINE'}]
5d8ba988aeacba3a822c6143,Retrieve the top five most frequent diagnoses of patients with age in their 50s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, COUNT(diagnosis) AS c FROM patients WHERE age BETWEEN 50 AND 59 GROUP BY diagnosis) AS t1 ORDER BY c DESC LIMIT 5;",
a2a83e230687e10b793748e7,Was patient 10016150 admitted into the hospital in the previous year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016150 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10016150 AND DATETIME(admissions.admission_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT(*)>0': 0}]
d8caee9d95e20089a90e7c8c,"During this year, has patient 10007928 been at the emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM visit_log WHERE patient_id = 10007928 AND visit_location = 'emergency room admit' AND DATETIME(visit_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
8d848bb37c4790115eb54b25,How many patients were in neuro stepdown in the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, procedures.date FROM admissions JOIN procedures ON admissions.admission_id = procedures.admission_id WHERE procedures.name = 'Neuro Stepdown' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')) AS t1 JOIN (SELECT admissions.subject_id, diagnoses.date FROM admissions JOIN diagnoses ON admissions.admission_id = diagnoses.admission_id WHERE diagnoses.name = 'Neuro Stepdown' AND DATETIME(diagnoses.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
54258b49d9028f2fcc83e6d8,Tell me the total output since 03/07/2100 for patient 10039997.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07'","SELECT COUNT(*) FROM ""output"" WHERE ""patient_id"" = 10039997 AND ""date"" >= '2100-03-07'",[{'SUM(outputevents.value)': 5735.0}]
8140c1e65784238caf1362ad,Calculate the total number of medications that patient 10007818 was prescribed since 1 year ago.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10007818 AND DATETIME(medications.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)': 320}]
90029829a3c76198a7de717b,What was the organism's name found in the first urine test of patient 10031757 in 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM urine_log WHERE patient_id = 10031757 AND sample_date = '10/2100' ORDER BY sample_date NULLS FIRST LIMIT 1,[]
41b9a346811b51fc23501b6f,What was the first drug prescribed to patient 10037861 via the iv route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(drug_name) FROM medication_history WHERE patient_id = 10037861 AND route = 'iv',[]
d668c80dc28d9c4f1a984524,Does patient 73693 have any travel history abroad?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_id = 73693 AND patients.travel_history_abroad IS NOT NULL,
118bc51491df8cdec1b69a69,Could you tell me the name of the drug prescribed to patient 10018081 within 2 days after the enteral infusion of concentrated nutritional substances procedure since 09/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-09' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.id, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.id WHERE patient.id = 10018081 AND procedures.type = 'enteral infusion of concentrated nutritional substances' AND STRFTIME('%y-%m', procedures.date) >= '2100-09') AS t1 JOIN (SELECT patient.id, prescriptions.drug FROM prescriptions JOIN patient ON prescriptions.patient = patient.id WHERE patient.id = 10018081 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-09') AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
76c552ca9be899eab747b7a3,What is the name of the drug that should not be administered during the spinal canal explor nec treatment?,,SELECT name FROM drugs WHERE id = (SELECT drug_id FROM procedures WHERE name = 'spinal canal explor nec');,
a092e1a9ae5251db64ee68be,What's the number of patients who were other nonspecific abnormal finding of lung field diagnosed this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific abnormal finding of lung field' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.abnormalfindingoflungfield = ""OTHER NONSPECIFIC"" AND DATETIME(patient.abnormalfindingoflungfield, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
f2becb6d3806bef1b31ac86a,When was the first input time for patient 10008454 on this month/07?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '07' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10008454 AND input_time BETWEEN '2022-04-07 00:00:00' AND '2022-04-07 23:59:59',[]
d73c8f5b0105e85440aa6baf,What are the maximum yearly number of patients diagnosed with glucocorticoid deficiency since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'glucocorticoid deficiency' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT MAX(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis.patient_id) AS c1 FROM diagnosis WHERE diagnosis.diagnosis = 'glucocorticoid deficiency' AND STRFTIME('%y', diagnosis.date) >= '2100' GROUP BY STRFTIME('%y', diagnosis.date)) AS t1",
f22d564ed9f345b78756fe88,"Since 2100, what are the top five most common microbiology tests that patients were diagnosed with within 2 months after being diagnosed with noncompliance with renal dialysis?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS test_rank FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis_date >= '2100-01-01' AND diagnosis.diagnosis_name = 'Noncompliance with renal dialysis') AS t1 JOIN (SELECT patient.uniquepid, microbiology.test_name, microbiology.test_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.uniquepid WHERE microbiology.test_date >= '2100-01-01') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.test_date AND DATETIME(t2.test_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date,",
49bd4300b2e50aa508c70a40,"For patients who were previously diagnosed with fall resulting in striking against other object, what are the top four most frequent treatments in the same month since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fall resulting in striking against other object' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.treatment FROM (SELECT t3.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Fall resulting in striking against other object' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE DATETIME(treatment.treatment_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.treatment_date",
306cfa6b9fa0c1c51c7dcd49,What new medications were prescribed to patient 10039831 today as compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT date_sub('day', CURRENT_TIMESTAMP, SELECT prescriptions.date_prescribed FROM prescriptions WHERE prescriptions.patient_id = 10039831)",[]
670b3cac2ff679b4a4fb429c,"How many patients underwent extirpation of matter from left common iliac vein, percutaneous approach within 2 months after the diagnosis of operating room of hospital as the place of occurrence of the external cause, in the last year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'operating room of hospital as the place of occurrence of the external cause' AND DATETIME(diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')) AS t1 JOIN (SELECT subject_id, procedure_date FROM procedures WHERE procedure = 'extirpation of matter from left common iliac vein, percutaneous approach' AND DATETIME(procedure_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.procedure_date AND DATETIME(t2.procedure_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month')",
46943daaedc4da5c2540a50c,"On 12/29/this year, what was the minimum value of the respiratory rate for patient 10004733?","SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29'",SELECT MIN(RespiratoryRate) FROM respiratory_rate WHERE RespiratoryRate IS NOT NULL AND PatientID = 10004733,[{'MIN(chartevents.valuenum)': None}]
a8f5c987ca37c40bc1eac5cc,Could you inform me of the minimum vitamin b12 value for patient 10021666?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ),SELECT MIN(Vitamin_B12) FROM patients WHERE Patient_ID = 10021666,[{'MIN(labevents.valuenum)': None}]
f8961f88221514dc6b646933,"Hey jo, tell me what that diagnosis was that patient 20801 got in that other department",,SELECT diagnosis FROM diagnoses WHERE department = 'other' AND patient = 20801,
64a1ee1c1e25b6f646865939,What was the admission type for patient 10021312's first visit to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021312 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT admission_type FROM visit_history WHERE patient_id = 10021312 AND NOT visit_history.dischtime IS NULL ORDER BY visit_history.admittime NULLS FIRST LIMIT 1;,[]
9c318ab198a0c0e5c19cd4b6,Were any procedures carried out on patient 10001217 in their first hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10001217 AND NOT procedures.hospital_id IS NULL ORDER BY procedures.hospital_admission_date NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
6dd0dd2307f507f9c42eea63,What medicine does patient 80555 take after being prescribed by the other medical department of our hospital?,,SELECT t2.name FROM (SELECT * FROM medicine WHERE patient_id = 80555) AS t1 JOIN (SELECT * FROM medicine WHERE patient_id = 80555 AND department = 'other medical') AS t2 ON t1.name = t2.name,
d55a49b733c16c813474898b,Retrieve the top five most common diagnoses for patients with age 50s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT diagnosis FROM (SELECT * FROM patients WHERE age BETWEEN 50 AND 59) AS t1 JOIN (SELECT * FROM diagnoses WHERE date BETWEEN '2022-01-01' AND '2022-12-31') AS t2 ON t1.diagnosis = t2.diagnosis GROUP BY t1.diagnosis) AS t3 ORDER BY COUNT(t3.diagnosis) DESC LIMIT 5",
5c292b2eff5ea33b4c5658b2,What was the total cerebral ventricular #1 volume that patient 10027602 had since 03/08/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cerebral ventricular #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-08'",SELECT SUM(cerebral_ventricular_#1) FROM bar WHERE patient_id = 10027602 AND date >= '2100-03-08',[{'SUM(outputevents.value)': None}]
6b5b9ccd032dd84eb4439664,"When has patient 10019172 been given chloride, whole blood test for the first time since 07/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(date) FROM lab_results WHERE patient_id = 10019172 AND lab_name = 'chloride, whole blood' AND date >= '2000-07-2100'",[]
127ee80e549fe86039373e27,So how many days has passed since patient 10018081's last other ventral hernia without mention of obstruction or gangrene diagnosis in the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ventral hernia without mention of obstruction or gangrene' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = 10018081 AND diagnosis.diagnosis = 'Other ventral hernia without mention of obstruction or gangrene' AND diagnosis.diagnosis_date = (SELECT diagnosis_date FROM diagnosis WHERE patient_id = 10018081 ORDER BY diagnosis_date DESC LIMIT 1)",
f870fc9332fe7c3778488b46,When was the first time patient 10011398 was prescribed drugs via po on their last hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(pharmacy.drug_start_date) FROM pharmacy WHERE pharmacy.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.last_hospital_visit = (SELECT MAX(hospital.hospital_start_date) FROM hospital WHERE hospital.patient_id = 10011398)) AND pharmacy.drug_start_date = (SELECT MIN(pharmacy.drug_start_date) FROM pharmacy WHERE pharmacy.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.last_hospital_visit = (SELECT MAX(hospital.hospital_start_date) FROM hospital WHERE hospital.patient_id = 10011398))) AND pharmacy.drug_route = 'po',[]
be4e133fd657b3c989be8b0b,How many hours has it been since the first stay of patient 10021487 in the careunit trauma sicu (tsicu) on this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.hospital.stay.startdate)) FROM patient WHERE patient.uniquepatientid = 10021487 AND patient.hospital.stay.startdate IS NOT NULL AND patient.hospital.stay.enddate IS NULL",[]
a1a26b44387af2430b609395,Could you calculate the total amount of output from patient 10021487 since 10/22/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-22'",SELECT SUM(output) FROM output WHERE patient = 10021487 AND date >= '2010-22-2100',[{'SUM(outputevents.value)': 71508.0}]
49a64438974f40760d7b4448,What is the diagnosis price for postprocedural hemorrhage of a circulatory system organ or structure following a cardiac catheterization?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural hemorrhage of a circulatory system organ or structure following a cardiac catheterization' ) ),SELECT DISTINCT cost FROM diagnoses WHERE description = 'postprocedural hemorrhage of a circulatory system organ or structure following a cardiac catheterization',
0b0a39c4b7112434084d3daa,Give me the length of stay in days for patient 10022041 during their first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', ICU.LENGTH(days)) as LENGTH_OF_STAY","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.8923842599615455}]"
9f458a33e3737acb61d26a1c,Tell me about the four most common specimens tested since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT specimen, COUNT(specimen) FROM brackets WHERE date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]"
e3050cd2b1f00826b18a4be8,What is the price for ursodiol?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ursodiol' ),SELECT price FROM products WHERE product = 'ursodiol',
41539321bbcb2564370db4b1,When are dr. hurdle's rounds and procedures?,,"SELECT ""date"", ""round"", ""procedure"" FROM ""dr. hurdle's rounds and procedures"" WHERE ""date"" = '1992-09-20'",
ec6cfedc417520a4d86f2365,"Has patient 10025612 been on scopolamine patch, 5% dextrose, or acetaminophen as prescribed since 09/2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND prescriptions.drug IN ( 'scopolamine patch', '5% dextrose', 'acetaminophen' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10025612 AND prescriptions.drug IN ('scopolamine patch', '5% dextrose', 'acetaminophen') AND STRFTIME('%y-%m', prescriptions.date) >= '2100-09'",[{'COUNT(*)>0': 0}]
ff6ea5e1101cdc2781d7466a,Please retrieve the monthly maximum amount of patient 10015931's nacl 0.9% input since 09/07/2100.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07' GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MAX(amount) FROM input_nacl_0.9% WHERE patient_id = 10015931 AND date >= '2000-09-07' GROUP BY date ORDER BY date NULLS FIRST,[]
1c0ad5aee8b258ad464b0c2d,What is the name of a procedure patient 10038081 underwent two or more times since 07/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT d.procedure, COUNT(d.date) FROM (SELECT patient.id, procedures.procedure, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.id WHERE patient.id = 10038081) AS d WHERE d.date >= '07/2100' GROUP BY d.procedure HAVING COUNT(d.date) >= 2",
e9dd16ce54ed38fae39646d8,What was patient 10009035's minimum systolic blood pressure in their first ICU visit?,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ),SELECT MIN(systolic_bp) FROM (SELECT systolic_bp FROM icu WHERE icu.patient_id = 10009035 AND NOT icu.out FROM icu WHERE icu.patient_id = 10009035 ORDER BY icu.admittime NULLS FIRST LIMIT 1),[{'MIN(chartevents.valuenum)': None}]
80466ce112a1c1006d70d876,What were the top four most frequent diagnoses with which patients were diagnosed after receiving excision of other bile duct within 2 months?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.diagnosis, COUNT(t4.diagnosis) FROM (SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, COUNT(t2.diagnosis) FROM (SELECT t1.subject_id, t1.diagnosis, t2.diagnosis, t2.date_excision, t3.date_diagnosis, t4.diagnosis, t4.date_diagnosis FROM (SELECT t1.subject_id, t1.diagnosis, t2.diagnosis, t2.date_excision, t3.date_diagnosis, t4.diagnosis, t4.date_diagnosis FROM (SELECT subject_id, diagnosis FROM diagnoses WHERE diagnosis = 'EXACERBATION OF PARTICULAR SYMPTOM') AS t1 JOIN (SELECT subject_id, diagnosis FROM diagnoses WHERE diagnosis = 'EXACERBATION OF PARTICULAR SYMPTOM') AS t2 ON t1.subject_id = t2.subject_id WHERE",
0ce9c8a93ef40fa209454a71,Find out the number of drugs given to patient 10014729 in 04/this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) FROM medication_usage WHERE patient_id = 10014729 AND date_part('month', date) = 4 AND date_part('year', date) = 2022",[{'COUNT(*)': 0}]
240c55269dbe044f71ee51c5,What is the average yearly number of people diagnosed with rheumatic disorders of both mitral and aortic valves since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis.patient_id) AS c1 FROM diagnosis WHERE diagnosis.diagnosis = 'RHEUMATIC DISORDERS OF BOTH MITRAL AND AORTIC VALVES' AND STRFTIME('%y', diagnosis.date) >= '2100' GROUP BY STRFTIME('%y', diagnosis.date)) AS t1",
56ad123e50882b48474bc758,What are the five commonly ordered medications that patients aged 60 or above were prescribed within the same month after diagnosed with other nonspecific findings on examination of urine?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific findings on examination of urine' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Other nonspecific findings on examination of urine') AS t1 JOIN (SELECT admissions.subject_id, medications.name, medications.prescription_date FROM medications JOIN admissions ON medications.admission_id = admissions.admission_id WHERE admissions.age >= 60) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.prescription_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.prescription_date, 'start of month') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 5",
953ded6c199c40900648aa89,Is patient 10021938's bicarbonate value last measured on the last hospital visit less than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT bicarbonate FROM patients WHERE patient_id = 10021938 AND NOT patient_hospital_info.last_dischtime IS NULL ORDER BY patient_hospital_info.admittime DESC LIMIT 1) < (SELECT bicarbonate FROM patients WHERE patient_id = 10021938 AND NOT patient_hospital_info.last_dischtime IS NULL ORDER BY patient_hospital_info.admittime DESC LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
13bee07976257e0b38f5e9b3,What was the procedure conducted on patient 10020740 two or more times in 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT date(col0) FROM (SELECT col0 FROM (SELECT patient_id, COUNT(DISTINCT visit_date) AS visits FROM visits WHERE patient_id = 10020740 AND visit_date BETWEEN '2000-05-01' AND '2000-05-31' GROUP BY patient_id) AS t WHERE visits >= 2) AS t JOIN (SELECT date(col0) AS col0 FROM (VALUES ('2000-05-01'), ('2000-05-15'), ('2000-05-31')) AS t(col0) ON t.col0 = col0;",
569bfe18989623d3f5c6678a,Count up how many times patient 10006580 was admitted to the ICU since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT ICU_ADMIT_DATE) FROM ICU WHERE ICU_PATIENT_ID IN (SELECT MATIER_PATIENT_ID FROM PATIENT WHERE PATIENT_ID = 10006580) AND DATETIME(ICU_ADMIT_DATE) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}]
fc46ccfbdac692e517e9d7fe,What is the cost for the medicine metformin (glucophage)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'metformin (glucophage)' ),SELECT DISTINCT cost FROM medication WHERE medication.name = 'MetFORMIN (Glucophage)';,
eec30a374f5a614dddb5c128,What are the methods for taking caphosol?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'caphosol',SELECT * FROM duckdb_functions WHERE function_name = 'caphosol';,[]
b5e8c7efd2cc02936f14bf95,When did patient 10039831 since 03/24/2100 for the last time have an input?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-24' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT MAX(date(input_date, '03/24/2100')) FROM input_table WHERE patient_id = 10039831",[{'starttime': '2115-12-30 13:05:00'}]
dd9d9407871fb618bd52f8a9,What was the medicine that was prescribed to patient 10004235 during the same hospital visit after undergoing excision of other bile duct since 04/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t3.medication FROM (SELECT t1.subject_id, t1.date FROM (SELECT 10004235 AS subject_id, '2000-04-2100-01' AS date) AS t1 JOIN (SELECT 10004235 AS subject_id, '2000-04-2100-01' AS date) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date) AS t3 JOIN (SELECT 10004235 AS subject_id, '2000-04-2100-01' AS date) AS t4 ON t3.subject_id = t4.subject_id WHERE t3.date < t4.date",
2561607a3178d1491081ba75,What was the name of the organism found in the last microbiology test conducted on patient 10007795's urine since 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10007795 AND urine = 1 AND date >= '2000-05-2100' ORDER BY date DESC LIMIT 1,[]
40af2c18046760f0127c35fb,What is the maximum total hospital cost for a drug named levetiracetam since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'levetiracetam' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE name = 'levetiracetam' AND year >= 2100 GROUP BY cost) AS t1,
39d219c7d6cf5c42a50daf25,Work out the total amount of input patient 10016742 received since 04/15/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-15'",SELECT SUM(amount) FROM input_patient WHERE patient_id = 10016742 AND input_date >= '2100-04-15',[{'SUM(inputevents.totalamount)': 36640.0}]
1816be0b35b828a815b17b16,How many days has it been since the first acquired absence of intestine (large) (small) diagnosis for patient 10018081 on the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of intestine (large) (small)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT COUNT(DISTINCT diagnosis_date) FROM diagnoses WHERE diagnosis = ""ACQUIRED ABSENCE OF INTESTINE (LARGE) (SMALL)"" AND patient_id = 10018081 AND hospital_connection = ""CURRENT""",
0112d30f1318ad87f07d5ace,What is the count of quetiapine fumarate prescriptions made since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'quetiapine fumarate' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'quetiapine fumarate' AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)': 0}]
0a507e5e6d94656aec03e31d,"During the first ICU visit, when did patient 10025612 have their last input?",SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,"SELECT STRFTIME('%Y-%m-%d %H:%M:%S', MIN(icu_input_time)) as first_icu_input",[{'starttime': '2125-09-30 15:00:00'}]
eacb97f691e333004c824387,"Can you provide the name of the drug that was prescribed to patient 10038999 during the same day post excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure in 06/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT name FROM medication WHERE prescription_date = TO_DATE('06/' || EXTRACT(YEAR FROM CURRENT_DATE) || '-' || EXTRACT(MONTH FROM CURRENT_DATE) || '-' || EXTRACT(DAY FROM CURRENT_DATE), 'dd/mm/yyyy') AND patient_id = 10038999 AND procedure = 'Post excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic'",
e629cd0656dc5fe7580121c9,How many individuals are current patients in their 20s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29,SELECT COUNT(*) FROM patients WHERE age BETWEEN 20 AND 29 AND current_patient = true,
4bb1514c5befb0ece60fdb11,Has there been any organism found in patient 10020740's last sputum microbiology test in 04/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*) > 0 FROM microbiology WHERE microbiology.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.patient_name = '10020740') AND microbiology.sputum_microbiology_date = '2100-04-21' AND NOT microbiology.sputum_microbiology_filename IS NULL,[{'COUNT(*)>0': 0}]
5768d20678cf5c0dad75054a,Give me patient 10027602's total output on 11/26/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '11-26'","SELECT SUM(output) FROM ""output"" WHERE patient = 10027602 AND date = '11/26/2022'",[{'SUM(outputevents.value)': None}]
7f326a0a5a46eb805b8f5a56,Show me the top five most common diagnoses of patients with age 30s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(diagnosis) FROM patients WHERE age BETWEEN 30 AND 39 AND STRFTIME('%y', encounter_date) = '2100' GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 5",
55351822938c1ebf04f6ef79,How many days was patient 10009049's last stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT COUNT(DISTINCT) FROM icu WHERE icu.patient_id = 10009049 AND NOT icu.out_time IS NULL ORDER BY icu.in_time DESC LIMIT 1,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.217499999795109}]"
3dd575660bbbf5e93e445cfb,"During their first hospital visit, what was the insurance of patient 10011398?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.insurance FROM patients WHERE patient.hospital_sequence = 1 AND patient.id = 10011398,[{'insurance': 'Other'}]
e7f9bc2207fce85235ec07aa,Retrieve the top three most frequent procedures that patients were given in the same month after receiving injection or infusion of thrombolytic agent since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection or infusion of thrombolytic agent' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, DATE_TRUNC('month', t2.date) AS month FROM (SELECT patient.name, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.name WHERE treatment.treatment IN ('injection', 'infusion of thrombolytic agent') AND STRFTIME('%y', treatment.date) >= '2100') AS t1 JOIN (SELECT patient.name, treatment.treatment, DATE_TRUNC('month', treatment.date) AS month FROM treatment JOIN patient ON treatment.patient = patient.name WHERE STRFTIME('%y', treatment.date) >= '2100') AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t3.treatment) AS t3 WHERE COUNT(t3.treatment) > 3",
db5bac94ce7826d253dc454e,"What are the top three most common microbiology tests that patients had after the diagnosis of abdominal pain, unspecified site in the same month?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, unspecified site' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis_name = 'abdominal pain, unspecified site') AS t1 JOIN (SELECT patient.uniquepid, microbiology.test_name, microbiology.test_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.test_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.test_date, 'start of month') GROUP BY t2.test_name) AS t3 WHERE t3.rank <= 3",
8174f666b42de86d7c8231a4,Calculate the length of stay in days for the last stay of patient 10005817 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT icu_days FROM icu_stays WHERE icu_stays.patient_id = 10005817 AND NOT icu_stays.out_time IS NULL ORDER BY icu_stays.in_time DESC LIMIT 1;,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 15.972812499850988}]"
43b3a2950b00b6d8b6b27c84,"What was the drug that patient 10015931 was prescribed with within the same hospital visit after the replacement of aortic valve with zooplastic tissue, percutaneous approach since 5 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-5 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.id, treatment.start_time, patient.patient_type FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10015931 AND treatment.treatment_type = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' AND DATETIME(treatment.start_time) >= DATETIME(CURRENT_TIME, '-5 month')) AS t1 JOIN (SELECT patient.id, prescription.drug, prescription.start_time, patient.patient_type FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE patient.id = 10015931 AND DATETIME(prescription.start_time) >= DATETIME(CURRENT_TIME, '-5 month')) AS t2 ON t1.id = t2.id WHERE t1.start_time < t2.start_time AND t1.patient_type = t2.patient_type",
b0c7bdb6be37ebfe3feb04a6,"What are the four frequently ordered medications for patients diagnosed with hemorrhage of rectum and anus previously within 2 months, in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.patientid WHERE diagnosis.diagnosis = 'hemorrhage of rectum and anus' AND DATETIME(diagnosis.diagnosisdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, medication.medication, medication.medicationdate FROM medication JOIN patient ON medication.patientid = patient.patientid WHERE DATETIME(medication.medicationdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.medicationdate AND DATETIME(t2.medicationdate) BETWE",
1d8e1854e955b721c482a91d,What was the last hospital admission type for patient 10005866?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005866 ORDER BY admissions.admittime DESC LIMIT 1,"SELECT ""admission_type"" FROM ""hospital_admissions"" WHERE ""subject_id"" = 10005866 ORDER BY ""admission_date"" DESC LIMIT 1;",[{'admission_type': 'OBSERVATION ADMIT'}]
1990af17fa6d2e02b4b63fe9,When did patient 10009035 have the minimum body temperature for the last time since 295 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-295 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MIN(body_temperature) FROM patient WHERE patient_id = 10009035 AND date_since > (CURRENT_DATE - INTERVAL '295 day'),[]
b3b04512888e6be067ea0094,"What are the total number of assistance with cardiac output using balloon pump, continuous procedures performed since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",SELECT COUNT(DISTINCT a.assist_with_cardiac_output) FROM assistance_with_cardiac_output a JOIN procedures_balloon p ON a.balloon_pump_id = p.balloon_pump_id WHERE p.continuous_procedures = '2100',
accce2ad12559dd458516192,What was the total or urine output of patient 10035185 in the first ICU stay?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),SELECT SUM(output) FROM output WHERE patient_id = 10035185 AND icu_number = 1 AND output_type = 'or urine',[{'SUM(outputevents.value)': None}]
c68906dafb0c5fe36f9c5d48,What's the price of a procedure referred to as endoscopic control of gastric or duodenal bleeding?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) ),"SELECT ""price"" FROM procedures WHERE ""description"" = 'endoscopic control of gastric or duodenal bleeding'",
152ff0308ad4afd9693231f2,What was the last time when patient 10013049 received a bicarbonate lab test in their first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(lab_timestamp) FROM lab_results WHERE lab_name = 'bicarbonate' AND patient_id = 10013049 AND NOT patient_id IS NULL ORDER BY lab_timestamp NULLS FIRST LIMIT 1,[]
c6ff88c99785463abe05ab14,Does an appointment have been had by patient 17462 in other department?,,SELECT COUNT(*) FROM appointments WHERE appointments.patient_id = 17462 AND appointments.department_id <> (SELECT DEPARTMENT_ID FROM patients WHERE patients.name = 'John Doe'),
f5e30b7ed7e2dc03d9e33f9d,What were the top five diagnoses of patients with age 60 or above in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t5.diagnosis FROM (SELECT t4.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT t3.diagnosis FROM (SELECT t2.diagnosis FROM (SELECT 'Alice' AS name, 60 AS age, '2021-01-01' AS date, 'Presbyterian' AS religion)) AS t2 JOIN (SELECT t1.diagnosis, t1.date FROM (SELECT 'Alice' AS name, 60 AS age, '2021-01-01' AS date, 'Presbyterian' AS religion)) AS t1 ON t2.name = t1.name WHERE t2.age >= t1.age AND STRFTIME('%y', t2.date) = '2100' GROUP BY t4.diagnosis) AS t5 WHERE t5.rank <= 5",
0d5c93359124d85b4946ec95,Is patient 739 tested for covid-19?,,SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 739 AND lab_data.field = 'covid-19',
0d3343e3e64231d00abab91e,How was patient 10039997 admitted to the hospital in terms of admission type for the first time?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT admittime FROM admissions WHERE subjectid = 10039997 AND admissions.dischtime IS NULL ORDER BY admittime NULLS FIRST LIMIT 1,[{'admission_type': 'SURGICAL SAME DAY ADMISSION'}]
7fe3a3267061ac2383bb66cb,List the top five most occurring events in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT event FROM events WHERE year = 2100 GROUP BY event ORDER BY COUNT(*) DESC LIMIT 5;,[]
6992e079d5cc2aa7a2bb6cbe,Does patient 5142 have a travel history from overseas?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 5142 AND patients.travel_history = 'overseas',
3ba708e58388ca50083283e8,Retrieve the top five most frequent lab tests that patients had after being diagnosed with calculus of kidney within the same month since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'calculus of kidney' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.name, lab_test, lab_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.patient_id WHERE STRFTIME('%y', lab_date) >= '2100') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.lab_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_date, 'start of month') GROUP BY t2.lab_test) AS t3 ON t3.lab_test = t1.",
dbd23b051c5c2e2ce67a439b,Tell me the five most frequent treatments for patients aged 60 or above.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT * FROM patients WHERE age >= 60) AS t1 JOIN (SELECT * FROM patients WHERE age >= 60) AS t2 ON t1.patient_id = t2.patient_id GROUP BY t1.treatment) AS t3 JOIN (SELECT * FROM patients WHERE age >= 60) AS t4 ON t3.patient_id = t4.patient_id GROUP BY t3.treatment ORDER BY COUNT(t3.treatment) DESC LIMIT 5",
d34f3b955bd78b3126293e64,When did patient 10855 last take a proper medication?,,SELECT MAX(date_proper_medication) FROM medication_table WHERE patient_id = 10855;,
975a9d2f0afd09663ee67165,How is nifedipine typically consumed?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nifedipine',"SELECT DISTINCT prescriber FROM patients WHERE patient = ""NIFEdipine""","[{'route': 'PO'}, {'route': 'ORAL'}]"
dbe29d2282f5b3aed0d011d3,Has patient 10029291 gone to an emergency room since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(*) FROM visit_history WHERE patient_id = 10029291 AND visit_type = 'emergency department' AND STRFTIME('%y', visit_date) >= '2100'",[{'COUNT(*)>0': 0}]
3cb1c84c070748104d4fe00c,"What was the last time, today, that patient 10039831's respiratory rate was less than 21.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(CURRENT_TIMESTAMP) FROM respiratory_rate WHERE patient_id = 10039831 AND respiratory_rate < 21.0,[]
a9632d75ba6d979b5decdf12,Can you name the procedure/treatment that patient 10007795 was given two times in 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT t1.treatment_name FROM (SELECT treatment_name, COUNT(date) AS c1 FROM procedures JOIN patient ON procedures.patient_id = patient.patient_id WHERE patient.patient_id = 10007795 AND STRFTIME('%y-%m', procedures.date) = '2100-05' GROUP BY treatment_name) AS t1 WHERE t1.c1 = 2",
62547959e3baf6a4703c5fbb,How many hours have passed since the first time that patient 10039831 stayed in careunit surgical intensive care unit (sicu) in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'surgical intensive care unit (sicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.admittime)) FROM patient WHERE patient.subjectid = 10039831 AND patient.dischtime IS NULL AND patient.admittime IS NOT NULL",[]
5584a484b396e900b09a1ff9,Has patient 10026406 been to the E.R.?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM patient_table WHERE patient_id = 10026406 AND location = 'emergency room admit',[{'COUNT(*)>0': 0}]
6ce32236a45e40ed7a60af77,Can you tell me when patient 10008454's last microbiology test was since 5 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-5 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology WHERE patient = 10008454 AND type = 'since 5 month(s) ago',[{'charttime': '2110-12-07 03:05:00'}]
3e53f449eb365ab960c6aa59,"For the first time since 08/2100, what specimen test did patient 10007795 get?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_type FROM visit WHERE patient_id = 10007795 AND visit_date = '2000-08-2100',[{'spec_type_desc': 'BLOOD CULTURE'}]
f98f47f9d3ab7a1af147e5ac,How many prescriptions for nifedipine cr were made since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND DATETIME(prescriptions.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)': 0}]
9ee9faec0727283454a64f52,What is the number of (aorto)coronary bypass of four or more coronary arteries procedures carried out?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' ),SELECT COUNT(*) FROM procedures WHERE procedures.procedure = '(Aorto)coronary bypass of four or more coronary arteries',[{'COUNT(*)': 0}]
fa56e6f995ce65468f6bac6a,How many of 0.9% sodium chloride were prescribed to patient 10005817 in total since 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.drug = '0.9% sodium chloride' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10005817 AND medication.drug = '0.9% Sodium Chloride' AND STRFTIME('%y-%m', medication.start_date) >= '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}]
a959a44bac364940384687df,"How many patients received insertion of infusion device into superior vena cava, percutaneous approach treatment in the same hospital encounter after being diagnosed with food in respiratory tract, part unspecified causing asphyxiation, initial encounter in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'food in respiratory tract, part unspecified causing asphyxiation, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into superior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date, t1.had_device FROM (SELECT t1.subject_id, t2.diagnosis_date, t1.had_device FROM (SELECT subject_id, diagnosis_date, had_device FROM (SELECT subject_id, date(diagnosis_date) as diagnosis_date, had_device from (SELECT subject_id, false as had_device FROM (SELECT subject_id, date(diagnosis_date) as diagnosis_date FROM diagnoses WHERE diagnosis = 'food in respiratory tract, part unspecified causing asphyxiation') AS t1 JOIN (SELECT subject_id, date(diagnosis_date) AS diagnosis_date, had_device FROM procedures WHERE procedures = 'insertion of infusion device into superior vena cava, percutaneous approach') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND t1.had_device = t2",
2985a08b2d895846538fee43,Provide the length in days of the first visit for patient 10026406 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT COUNT(DISTINCT ""visit_date"") FROM ""visits"" WHERE ""patient_id"" = 10026406 AND ""icu_id"" = 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.48175925901159644}]"
7299ff6d3a692b4da823bc87,What was the name of the medicine prescribed to patient 10027445 for the first time in 08/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT date_trunc('year', CURRENT_DATE) AS this_year, date_trunc('month', CURRENT_DATE) AS this_month, patient.name, medicine.name FROM patient WHERE patient.id = 10027445 ORDER BY date_trunc('year', CURRENT_DATE) NULLS FIRST, date_trunc('month', CURRENT_DATE) NULLS FIRST, medicine.name NULLS FIRST LIMIT 1;",[]
4f56cb9467f8f3d5205a4396,What was the three most common lab test given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",SELECT lab_test FROM lab_data GROUP BY lab_test ORDER BY COUNT(*) DESC LIMIT 3,"[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
9401e788946c189532687a96,Do you think patient 14203 may have a family history of any diseases?,,"SELECT COUNT(*) > 0 FROM patients WHERE patients.family_history = ""14203""",
b9e7f10e8737b4fd67bc29db,Calculate the number of medicines that patient 10010471 was prescribed since 13 months ago.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month')","SELECT COUNT(*) FROM medicines WHERE medicines.patient_id = 10010471 AND DATETIME(medicines.date_prescribed) >= DATETIME(CURRENT_TIME, '-13 month')",[{'COUNT(*)': 119}]
3cfbe0e30b718f625d69a2c5,When did patient 10013049 get the mcv lab test on the last hospital stay for the last time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,,[]
447267ea557ee396e8eade57,What was the total vitamin d dose that has been prescribed in 05/2100 to patient 10035185?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND prescriptions.drug = 'vitamin d' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'",SELECT SUM(VITAMIN_D) FROM 05_2100 WHERE PATIENT_ID = 10035185,[{'SUM(prescriptions.dose_val_rx)': None}]
f76e82ade10ee685ac166e82,What's the cost of a procedure named other endovascular procedures on other vessels?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'Other endovascular procedures on other vessels',
21b660c0148b20c1b1c2131d,Has patient 10022880 acquired any medication in 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) > 0 FROM acquisition WHERE patient_id = 10022880 AND STRFTIME('%y', acquisition_date) = '2100'",[{'COUNT(*)>0': 0}]
0dbcca2edb8dc4ada9f1ae3a,When did patient 10038081 receive a peritoneal fluid microbiology test first?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT MIN(Microbio_Date) FROM microbiology WHERE Microbio_Type = 'Peritoneal Fluid' AND Patient_ID = 10038081,[]
58dc0f1db2dd25ed12cb221c,"Among patients aged 60 or above since 1 year ago, what are the top five most common diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.diagnosis FROM (SELECT t1.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosisdate >= CURRENT_DATE - INTERVAL '1 year') AS t1 GROUP BY t1.diagnosis) AS d WHERE d.c1 <= 5",
5e6f873f02b4c4a0d2ee764a,What was the first drug prescribed last month to patient 10005909 via the sc route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriber.name, date_sub('month', CURRENT_TIMESTAMP, prescriber.last_drug_date) as months_since_last_drug",[]
9b11adf840122cc37bef0ed4,Tell me about the most common four output events during this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT four FROM outputs WHERE year = 2015 GROUP BY four ORDER BY COUNT(*) DESC LIMIT 1,[]
bc7ad8b3ef9492deca744662,"Since 1 year ago, what was patient 10008287 diagnosed with for the last time?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT diagnosis FROM patients WHERE patient_id = 10008287 AND DATETIME(diagnosis) >= DATETIME(CURRENT_TIME, '-1 year') ORDER BY diagnosis DESC LIMIT 1",
a70c341de1bc993eef26586f,Was magnesium sulfate (bolus) administrated to patient 10007928 in 04/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-04'","SELECT COUNT(*) FROM administrations WHERE admin_date LIKE ""04/%"" AND patient_id = 10007928 AND admin_type = ""Magnesium Sulfate (Bolus)""",[{'COUNT(*)>0': 0}]
02e100aec6d99e6f5934caa5,What are the three most common diagnoses for patients who previously had the excision of dental lesion of jaw procedure within 2 months since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE treatment.procedure = 'excision of dental lesion of jaw' AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE DATETIME(diagnosis.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <=",
1c1615f9c154aca940cea316,When was patient 10038992's last discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10038992 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT patient.discharge_date FROM patient WHERE patient.subject_id = 10038992,[]
6716a47fafd5bf2d15dae0e8,Has patient 10005866 gone through any procedure this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10005866 AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
e630dab0aeb52cb103a0b242,Tell me patient 10023239's maximum value of heart rate since 04/15/2100.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-04-15'",SELECT MAX(heart_rate) FROM patient WHERE patient_id = 10023239 AND start_date >= '2100-04-15',[{'MAX(chartevents.valuenum)': None}]
52fe2640719f3ea2cd5cc5ba,"What was the name of the drug which was prescribed to patient 10007818 within the same day after having received a introduction of nutritional substance into central vein, percutaneous approach procedure in 07/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug_name FROM (SELECT patient.uniquepid, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.uniquepid WHERE patient.uniquepid = 10007818 AND treatment.treatment_type = 'introduction of nutritional substance into central vein, percutaneous approach' AND STRFTIME('%y-%m', treatment.treatment_date) = '2100-07') AS t1 JOIN (SELECT patient.uniquepid, drug_name, treatment.treatment_date FROM drug JOIN patient ON drug.patient_id = patient.uniquepid WHERE patient.uniquepid = 10007818 AND STRFTIME('%y-%m', treatment.treatment_date) = '2100-07') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatment_date < t2.treatment_date AND DATETIME(t1.treatment_date, 'start of day') = DATETIME(t2.treatment_date",
5d2dfd7a5a2882eb9da2724d,"Among patients who were given closed [percutaneous] [needle] biopsy of kidney , what are the top five most common specimens tested afterward within 2 months?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,
814787a2d9c20960f6b872b9,Was patient 10020740 to the E.R. during the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM patient WHERE patient.age >= (SELECT COUNT(*) FROM patient WHERE patient.name = 'John Doe') AND patient.admission_date BETWEEN DATETIME('10020740', 'start of year', '-1 year') AND DATETIME('10020740', 'start of year', '-1 year') + INTERVAL '1 year'",[{'COUNT(*)>0': 0}]
2a505caf854db532714351f3,At what time did the first incident of patient 10006053 having a maximum mean blood pressure occur on last month/16?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '16' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT MAX(mean_blood_pressure) FROM incident_reports WHERE patient_id = 10006053 AND date = ""last month/16""",[]
08afa3fcbebe341dfdf62b15,Can you find the three most frequent drugs that were prescribed during the same month after a gastro-esophageal reflux disease without esophagitis diagnosis was given since 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'Gastro-esophageal reflux disease without esophagitis' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.subject_id, prescription.drug, prescription.prescription_date FROM prescription JOIN patient ON prescription.patient_id = patient.subject_id WHERE STRFTIME('%y', prescription.prescription_date) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.prescription_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.prescription_date, 'start",
41380d1d5d0e6d1c497a8317,"Calculate the number of people who had respiratory ventilation, greater than 96 consecutive hours.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )",SELECT COUNT(*) FROM patients WHERE respiratory_ventilation > 96;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
db0814178ef902c3c2b96f95,How was patient 10018845 admitted to the hospital in terms of admission type for the first time?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018845 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT TERM(AdmissionType) FROM Admissions WHERE Admissions.subject = 10018845 ORDER BY Admissions.admittime NULLS FIRST LIMIT 1;,[]
c243f4fb931374310bdb207c,When did patient 10037928 have the first minimum sodium value in 11/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT MIN(sodium) FROM patient WHERE patient.id = 10037928 AND STRFTIME('%y-%m', patient.date) = '2100-11'",[]
816890403b923f91deda0dda,How many days have elapsed since the last time patient 10018081 got a phosphate lab test during the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', Phosphate_Lab_Result_Date)) FROM Phosphate_Lab_Results WHERE Patient_ID = 10018081 AND Hospital_ID = 1;",[]
c7a42a6138402a2496be2e3d,When was the first time patient 10008454 systolic blood pressure was measured less than 123.0 since 142 days ago.,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 123.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-142 day') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(measurement_time) FROM systolic_blood_pressure WHERE patient_id = 10008454 AND measurement_time >= (CURRENT_TIMESTAMP - INTERVAL '142 day') AND measurement_value < 123.0,[]
cba569373f71ae7e9628bf97,What was the accumulated output for patient 10009628 on 10/02/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-02'",SELECT SUM(output) FROM patient_output WHERE patient_id = 10009628 AND output_date = '10/02/2022',[{'SUM(outputevents.value)': None}]
ef005db9fac61254bdbabbe7,What was the name of the drug that was prescribed last to patient 10011398 in 12/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT name FROM drugs WHERE prescription_date = '12/2016' AND patient_id = 10011398 ORDER BY prescription_date DESC LIMIT 1,[]
54bc89ef44d4c2ee5d31aeec,How many total esophagectomy procedures were conducted?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ),SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'esophagectomy';,[{'COUNT(*)': 0}]
44ff2488f2d3d5682b6994b8,The last time patient 19175 had something to take on a regular basis?,,SELECT MAX(date_last_taken) FROM inventory WHERE patient_id = 19175,
a8030f14c8d26bf536bbb2e7,Has patient 10001217 got a l laboratory test this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM lab WHERE lab.patient_id = 10001217 AND lab.label = 'l' AND DATETIME(lab.result_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
2eabc9e68c01f195e82de460,What is the number of patients who were discharged from the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",SELECT COUNT(DISTINCT id) FROM patients WHERE NOT dismissed AND age >= 1,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
4c7f81e40d7fe7c76ef35275,How many patients since 1 year ago were diagnosed with mitral valve disorders within the same month after the diagnosis of alkalosis?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mitral valve disorders' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'mitral valve disorders' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1, (SELECT patient.subject_id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'alkalosis' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month')",
ad521f49d4f6250463adc2a9,Calculate the number of prescribed drugs for patient 10007795 in 10/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-10'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10007795 AND STRFTIME('%y-%m', prescriptions.date) = '2100-10'",[{'COUNT(*)': 0}]
1f8f753b781c5e7a44238a71,What was the three most common lab test that was given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t.LabTest FROM (SELECT labTest, COUNT(*) AS c FROM labTests GROUP BY labTest) AS t ORDER BY c DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
0a103802ca827b13141a5a60,"For patient 10018081, how many hours have passed since the last diagnosis with long-term (current) use of anticoagulants in their current hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = 10018081 AND diagnosis.diagnosis_date = (SELECT diagnosis_date FROM diagnosis WHERE patient_id = 10018081 AND long_term_use = 'current')",
abf1227f05449e3179b9185d,Was patient 10037861 involved in any medical procedure during the last hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10037861 AND diagnoses.info = 'medical procedure' AND NOT diagnoses.info = 'diagnosis' AND diagnoses.date = (SELECT patient.date FROM patient WHERE patient.patient_id = 10037861 AND NOT patient.dischtime IS NULL ORDER BY patient.date DESC LIMIT 1),[{'COUNT(*)>0': 1}]
1452ce7ea3c5edec118c2e61,Has patient 10021312 gotten any medication this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM medication_usage WHERE medication_usage.patient_id = 10021312 AND DATETIME(medication_usage.date_administered, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
f9db2f1ae379485d2157c06b,Calculate the length of stay in days for the last stay of patient 10001725 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', icu.stay.end_time) - STRFTIME('%j', icu.stay.start_time) AS length_of_stay_days","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.338587962090969}]"
2b1f21750fa632e9b0f7a19f,Did patient 10021938 have a lab test during the previous month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10021938 AND DATETIME(lab_results.lab_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month')",[{'COUNT(*)>0': 0}]
8bfd5025332346ae9908634c,Give me patient 10016810's total output since 06/01/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-01'","SELECT SUM(output) FROM ""output"" WHERE patient = 10016810 AND date >= '2100-06-01'",[{'SUM(outputevents.value)': 5090.0}]
3316ce93c81fea759846ffdb,Get me the top five most frequent events this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT top(5) FROM events WHERE year = 2015;,[]
d557347f082c26133868efb1,Tell me the length in days of the last stay for patient 10016150 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT LENGTH(STAY) FROM icu WHERE PATIENT = 10016150,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.15594907384365797}]"
7346582042d3b9bcee31329c,How many hours has it been since the first time patient 10021487 visited careunit trauma sicu (tsicu) in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.first_visit)) FROM patient WHERE patient.id = 10021487 AND patient.current_location = 'careunit trauma sicu (tsicu)'",[]
45b872b3b1c160f0ef5249c5,What is the total number of patients who stayed in careunit emergency department observation since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT(DISTINCT patient_id) FROM careunit_emergency_department_observation WHERE stay_duration >= ""2100""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f2265be3b7f96b9827e002f2,What was the total output that patient 10020786 had since 07/01/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-01'","SELECT SUM(output) FROM ""output"" WHERE patient = 10020786 AND date >= '2100-07-01';",[{'SUM(outputevents.value)': 925.0}]
4168e2277f26fb151490a2c0,What is the cost of defibrination syndrome diagnostic?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'defibrination syndrome' ) ),SELECT DISTINCT cost FROM brackets_questions WHERE question = 'What is the cost of defibrination syndrome diagnostic',
cc3ae3ee46938d74fbd6ba5e,Number of patients who were diagnosed throughout this year with hepatic encephalopathy.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hepatic encephalopathy' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'hepatic encephalopathy' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'hepatic encephalopathy' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date",
c8c508b6537bf061dae5066a,What was the output that patient 10022880 first had on 04/03/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-03' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT patient.name, patient.age, strftime(patient.admittime, '%d/%m/%Y') FROM patient WHERE patient.admittime IS NOT NULL AND strftime(patient.admittime, '%d/%m/%Y') = '04/03/2100' ORDER BY patient.admittime NULLS FIRST LIMIT 1",[]
1bd83a6f25d3ac9d966ec9e9,What was the total number of input patient 10020944 has received on 03/07/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '03-07'",SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.hasreceived = '03/07/2020' AND patient.uniquepatientid = 10020944,[{'SUM(inputevents.totalamount)': None}]
39b8b45889cc5475dedfa102,Count the ICU visits of patient 10018328 since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')","SELECT COUNT(ICU_VISITS) FROM patient_table WHERE PATIENT_ID = 10018328 AND DATETIME(ICU_VISITS) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}]
a2556a4a997d1f09c6a72589,How much heparin was given to patient 10020740 for the last time in 06/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'heparin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(Heparin_Given) FROM Brackets WHERE Patient_ID = 10020740 AND Date_Heparin_Given >= '2006-01-01' AND Date_Heparin_Given < '2006-07-01',[]
6246ddb668aaa2fe1adb0353,How many hours have passed since last time that patient 10004733 stayed in careunit neurology in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.admittime)) FROM patient WHERE patient.subject = '10004733' AND patient.dischtime IS NULL AND patient.location = 'careunit neurology'",[]
c152c5dd0a1f2626db79696c,What is the ward id that allows patient 55247 to be admitted?,,SELECT wardid FROM admissions WHERE patientid = 55247;,
b9aa9ee30245b8000f1127e3,"How many patients underwent extirpation of matter from left femoral vein, percutaneous approach in this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t.subject_id) FROM (SELECT t.subject_id, t.extended_procedure_date FROM (SELECT t.subject_id, DATE(t.extended_procedure_date) AS extended_procedure_date FROM (SELECT t.subject_id FROM ""t1"" AS t WHERE t.left_femoral_vein IS NOT NULL) AS t GROUP BY t.subject_id HAVING DISTINCT YEAR(t.extended_procedure_date) = 2022) AS t;",
9a8d0a7f72b2f306a779ac82,Has patient 10010471 been checked into the hospital since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10010471 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM checkins WHERE patient_id = 10010471 AND DATETIME(checkin_time) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 1}]
8ca8f566936f59b5c916eadf,"In patients who had the resection of vessel with replacement, thoracic vessels since 1 year ago, what were the three most common diagnoses that followed in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'resection of vessel with replacement, thoracic vessels' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, resection.month FROM resection JOIN patient ON resection.patientid = patient.uniquepid WHERE resection.procedure = 'resection of vessel with replacement, thoracic vessels' AND DATETIME(resection.month) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.month FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE DATETIME(diagnosis.month) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.month = t2.month GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 3",
1ca13ce347fd46ac69499979,What was diagnosed for patient 10037928 the first time in their first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10037928 AND diagnoses.hospital_sequence = 1 ORDER BY diagnoses.diagnosis_date NULLS FIRST LIMIT 1,
5442daaf8455ec924ced4a84,Will patient 99082 be given any additional stool (received in transport system) test?,,SELECT COUNT(*) > 0 FROM transport_system WHERE transport_system.patient_id = 99082 AND transport_system.stool_type = 'additional',
163f4af47f19becb80903c30,How many medications were assigned to patient 10035185 since 8 months ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month')","SELECT COUNT(*) FROM medication_assignment WHERE patient_id = 10035185 AND date_assigned >= DATEADD(month, -8, CURRENT_DATE)",[{'COUNT(*)': 104}]
28b46c82ec1854678938782d,Please tell me the sex of patient 10014078.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10014078,SELECT MIN(SEX) FROM patients WHERE PATIENT_ID = 10014078,[{'gender': 'F'}]
87cc300179a5fe28e3498b5e,Did patient 10004235 experience any procedure in the last year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10004235 AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
7c03fe01f161036f720f6d7e,Has there been any organism detected in the first microbiological examination of patient 10019385's urine on their last hospital encounter?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM microbiology WHERE microbiology.patient_id = (SELECT patient.id FROM patient WHERE patient.name = '10019385' AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1) AND microbiology.specimen_type = 'urine' AND NOT microbiology.result IS NULL ORDER BY microbiology.examination_date NULLS FIRST LIMIT 1;,[{'COUNT(*)>0': 0}]
f8421512590cea257bf8a931,"Retrieve the top three most frequent medications that patients were prescribed in the same month after being diagnosed with hyperlipidemia, unspecified since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'HYPERLIPIDEMIA, UNSPECIFIED' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, medication.medication, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.patient_id WHERE STRFTIME('%y', medication.medication_date) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_",
6a1bd90b69ca958eeb14cef8,Has patient 10007795 gotten any medication since 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*) > 0 FROM medication_usage WHERE medication_usage.patient_id = 10007795 AND STRFTIME('%y-%m', medication_usage.date) >= '2100-03'",[{'COUNT(*)>0': 1}]
58dca5f1f34e6a0994b147eb,When was the last time the heart rate of patient 10005909 was measured to be less than 106.0 since 04/04/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 106.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-04-04' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM vital_signs WHERE patient_id = 10005909 AND measurement_time >= '2000-04-04' AND heart_rate < 106.0,[]
1d9b591db242abe298d896a5,"Among patients diagnosed with diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled since 1 year ago, what are the top five medications prescribed within 2 months to patients in their 40s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t1.name FROM (SELECT patients.id FROM patients WHERE patients.age BETWEEN 40 AND 49) AS t1 JOIN (SELECT patients.id FROM patients WHERE patients.diabetes = 'ii' OR patients.diabetes = 'unspecified') AS t2 ON t1.id = t2.id WHERE t1.age >= (SELECT CURRENT_DATE - INTERVAL '1 year') AND t2.age <= (SELECT CURRENT_DATE - INTERVAL '1 year') AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month')",
9d3fa7a1702389bcc1a4904b,When did the first time patient 10016742 had the maximum value of respiratory rate during their first ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT ""first ICU stay"" FROM ""patient 10016742"" WHERE ""respiratory rate (maximum)"" = (SELECT MAX(""respiratory rate (maximum)"") FROM ""patient 10016742"" WHERE ""unit"" = 'ICU 1');",[]
ee04b4b7af645ba90c2bd384,What's the reimbursement standard for pharmaceuticals?,,"SELECT STANDARD FROM (SELECT 'REI' AS STANDARD, 'Pharmaceuticals' AS INDUSTRY, '10000' AS MAX_REIMBURSEMENT FROM Suggestion WHERE INDUSTRY = 'Pharmaceuticals') AS T;",
cdeaa55f2c3e7ba95eec9c4a,When did patient 10021487 have the minimum value of creatinine first in the current hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",SELECT MIN(Creatinine) FROM bracket_table WHERE PatientID = 10021487 AND EncounterID = 1,[]
7f6a053c4c7996cce251e27b,Tell me the average overall hospital cost that includes potassium chl 20 meq / 1000 ml d5lr since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(OVERALL_HOSPITAL_COST) FROM brackets WHERE MIN(OVERALL_HOSPITAL_COST) = 0 AND MAX(OVERALL_HOSPITAL_COST) = 1000 AND POTASSIUM_CHL 20 MIN(OVERALL_HOSPITAL_COST) = 0 AND POTASSIUM_CHL 20 MAX(OVERALL_HOSPITAL_COST) = 1000 AND STUDY_ID IN (SELECT STUDY_ID FROM brackets WHERE MIN(OVERALL_HOSPITAL_COST) = 0 AND MAX(OVERALL_HOSPITAL_COST) = 1000) AND TIMESTAMP = '2100-01-01 00:00:00',
9d8591acb0d3258f159e45cc,"What is the average yearly number of patients affected by diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled since 2100?","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis.patient_id) AS c1 FROM diagnosis WHERE diagnosis.diagnosis = 'DIABETES MELLITUS WITHOUT MENTION OF COMPLICATION, TYPE II OR NOT SPECIFIED TYPE, NOT STATED AS UNCONTROLLED' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100' GROUP BY diagnosis.patient_id) AS t1",
f6ad015f8e12733510bfd83d,"When, in 12/this year, was the last time patient 10021487 was prescribed a medication via the tp route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'tp' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM medication_table WHERE patient_id = 10021487 AND route = 'tp' AND date_part('year', date_prescribed) = date_part('year', CURRENT_DATE) AND date_part('month', date_prescribed) = date_part('month', CURRENT_DATE)",[]
07c1c8b47f2651220e2fa40f,How many patients stayed on med/surg?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' ),SELECT COUNT(DISTINCT patient_id) FROM patients WHERE stay_location = 'MED/SURG';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
0e79ae45b54260645fa447df,Has patient 5828 had any additional catheter tip-iv test performed on him?,,SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 5828 AND procedures.procedure_name = 'additional catheter tip-iv test',
776aa437e8c7772107f91170,Did patient 10021312 have any prescriptions for medicines on their last hospital encounter?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10021312 AND NOT prescriptions.dischtime IS NULL ORDER BY prescriptions.admittime DESC LIMIT 1;,[{'COUNT(*)>0': 1}]
be2ea8ec1974fc0574f2921f,"Has patient 10021487 had a total nucleated cells, pleural test done in 10/last year?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'","SELECT COUNT(*) FROM nucleated_cells, patients WHERE patients.patient_id = nucleated_cells.patient_id AND nucleated_cells.test_name = 'total nucleated cells, pleural' AND patients.patient_id = 10021487 AND DATETIME(nucleated_cells.test_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year') AND STRFTIME('%m', nucleated_cells.test_date) = '10'",[{'COUNT(*)>0': 0}]
8767ec4e6f5bb384a55e1f3a,"Since 2100, what are the top five most frequent procedures that patients received within 2 months after being diagnosed with pseudomonas infection in conditions classified elsewhere and of unspecified site?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pseudomonas infection in conditions classified elsewhere and of unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.pseudomonas FROM (SELECT t2.pseudomonas, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'Pseudomonas infection in conditions classified elsewhere and of unspecified site' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.uniquepid WHERE STRFTIME('%y', treatment.treatment_date) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t2.treatment_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagn",
1d7daad1762a274e42d1274a,"What's the cost for drainage of left pleural cavity, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) )","SELECT COUNT(DISTINCT cost) FROM procedures WHERE drainage = 'left pleural cavity, percutaneous approach';",
4dbad1cc3c3af06c5664a2ad,"During the last year, was patient 10014354 in an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(*) FROM emergency_room_admissions WHERE patient_id = 10014354 AND year(admission_date) = 2015,[{'COUNT(*)>0': 0}]
6e39fda592a8e6af9e50df9b,"Since 10/2100, lactated ringers, cisatracurium besylate, or glucose gel has been prescribed for patient 10018081.","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.drug IN ( 'lactated ringers', 'cisatracurium besylate', 'glucose gel' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10018081 AND medication.date >= '2021-10-2100' AND medication.product IN ('lactated ringers', 'cisatracurium besylate', 'glucose gel')",[{'COUNT(*)>0': 0}]
c1cbfb46dafe04deb682724d,Can you tell me the first recorded weight for patient 10015272?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(weight) FROM patients WHERE patient_id = 10015272,[]
4cc7f474aee41be6f9a8dc37,What is the code in icd-11 for klebsiella pneumoniae in icd-10?,,SELECT icd_11 FROM icd_mappings WHERE icd_10 = 'klebsiella pneumoniae',
ecdd6175747da4a32daa8f99,What was the name of the medication which patient 10021487 was prescribed during the same day after receiving enteral infusion of concentrated nutritional substances since 06/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.name FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10021487 AND treatment.type = 'enteral infusion of concentrated nutritional substances' AND STRFTIME('%y-%m', treatment.date) >= '2100-06') AS t1 JOIN (SELECT patient.id, medication.name FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.id = 10021487 AND STRFTIME('%y-%m', medication.date) >= '2100-06') AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day')",
43ac9cba569c151427df4304,What did patient 10021666 have last as the output since 03/28/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-28' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT strftime(output.timestamp, '%m/%d/%Y') as formatted_date",[{'label': 'Foley'}]
f1d835a5bb021603f18ae280,Do you know patient 9566 went to another country?,,SELECT patient_9566 FROM patients WHERE patient_9566 = 'another country',
51ad9f66e93f33042ccc4669,When did patient 10039831 get their first input since 11/24/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-24' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT MIN(input_date) FROM input_table WHERE input_table.patient_id = 10039831 AND STRFTIME('%y-%m-%d', input_date) >= '2100-11-24'",[{'starttime': '2115-12-28 20:38:00'}]
f2fb4d6b40dabed3a0ffdc3e,Show me patient 10010471's daily maximum weight since 2100.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10010471 AND year > 2100 GROUP BY date;,[]
53cdff279789d1183c4e5a86,What about the single rooms out there now?,,SELECT * FROM inventory WHERE room_type = 'single';,
555c677326428762a09481c7,Has patient 10021312 been provided any medications?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ),SELECT COUNT(*) > 0 FROM medication_usage WHERE patient_id = 10021312;,[{'COUNT(*)>0': 1}]
9d2d12172b2bedc5632b132e,Has patient 10038933 been on any boost glucose control (full) since 02/04/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'boost glucose control (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-04'","SELECT COUNT(*) > 0 FROM boost_glucose_control(full) WHERE boost_glucose_control(full).patient_id = 10038933 AND STRFTIME('%y-%m-%d', boost_glucose_control(full).date) >= '2100-02-04'",[{'COUNT(*)>0': 0}]
5ae7505a2520a19129c81edd,What is the body weight change of patient 10020740 last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT patient.body_weight FROM patient WHERE patient.patient_id = 10020740 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1) - (SELECT patient.body_weight FROM patient WHERE patient.patient_id = 10020740 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
50d49912da164775f9dc831f,Give me patient 10021487's total peptamen bariatric (full) input.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'peptamen bariatric (full)' AND d_items.linksto = 'inputevents' ),SELECT SUM(PeptamenBariatricFull) FROM patients WHERE PatientId = 10021487,[{'SUM(inputevents.totalamount)': None}]
cb1a4e3e68a3305cbed774f1,What was the name of the drug that was prescribed first to patient 10022017 since 04/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriber.drug_name FROM prescriber WHERE prescriber.patient_id = 10022017 AND STRFTIME('%y-%m', prescriber.date) >= '2100-04' ORDER BY prescriber.date NULLS FIRST LIMIT 1",[{'drug': 'Sodium Chloride 0.9%  Flush'}]
c8b3ff2eeceef81045187d16,What were the name of the treatment received by patient 10038081 two or more times in their last hospital encounter?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t4.treatment_name FROM (SELECT t3.treatment_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10038081 AND NOT treatment.date IS NULL AND treatment.date = (SELECT MAX(date) FROM treatment WHERE patient_id = 10038081 AND NOT date IS NULL)) AS t3 GROUP BY t3.treatment_name) AS t4 WHERE t4.c1 <= 2",
ee69065549df2afefab7aae1,What is patient 10018328's gender?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10018328,SELECT patients.gender FROM patients WHERE patients.id = 10018328,[{'gender': 'F'}]
def6d375a2be3ced2d907c6d,What are the various ways to consume 5% dextrose (excel bag)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = '5% dextrose (excel bag)',"SELECT * FROM (SELECT 5 AS percent, 'dextrose (excel bag)' AS product, 'consumer' AS category FROM grades WHERE course = 'dextrose (excel bag)') AS T;",[]
919fd2fec23929480d56959a,How much is the difference of urea nitrogen of patient 10021118 second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT urea_nitrogen FROM patients WHERE patient_id = 10021118 AND NOT patient_hospital_info.hospital_name IS NULL ORDER BY patient_hospital_info.hospital_admission_date NULLS FIRST LIMIT 1) - (SELECT urea_nitrogen FROM patients WHERE patient_id = 10021118 AND NOT patient_hospital_info.hospital_name IS NULL ORDER BY patient_hospital_info.hospital_admission_date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
d6b7b3ab6732956bc3e0fc24,How many hours have passed since patient 10021487 got his first diagnosis of acidosis on this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acidosis' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = 'acidosis' AND patient_id = 10021487 AND hospital_dischtime IS NULL;",
b88e4ef160b32df83a1e6e63,How many drugs were given to patient 10004720 since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM drugs WHERE drugs.patient_id = 10004720 AND DATETIME(drugs.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)': 82}]
0f03144b28c1a640986c7ffc,When was the last test of patient 10008454's microbiology urine since 09/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology_urine WHERE patient_id = 10008454 AND date BETWEEN '2009-01-21' AND '2009-12-31',[]
029b91056c419bf0d15c3c15,What precautions should you follow after the nonop cardiac/vasc exam procedure?,,SELECT * FROM procedures WHERE procedure_name = 'nonop cardiac/vasc exam';,
1153946181f7d7b47dbdc917,When did patient 10007818 receive the tobramycin test for the last time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(date_administered) FROM lab_results WHERE lab_results.patient_id = 10007818 AND lab_results.lab_name = 'tobramycin',[]
ae481d3d9b25f812bf25bdfd,"What are the four commonly given procedures for patients that also received other incision of brain previously within the same hospital visit, since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, procedures.date FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE procedures.name = 'other incision of brain' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT admissions.subject_id, procedures.date FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE procedures.name = 'four commonly given procedures for patients' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date AND DATETIME(t1.date) >= DATETIME(t2.date) GROUP BY t1.subject_id",
f80d944a40468e69f130d0ca,How much does personal history of other diseases of digestive system cost to get diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other diseases of digestive system' ) ),"SELECT id, name, cost FROM diagnosis WHERE name = 'personal history of other diseases of digestive system'",
447ce94b8c1311a33e0848fc,What new meds are prescribed to patient 10004733 today compared to the ones from yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM medication_usage WHERE patient_id = 10004733 AND date = CURRENT_DATE - INTERVAL '1 day',[]
f04c7d3113bb51fa52b5acf5,"What is patient 10002495's difference in cholesterol, total from the last value measured on the last hospital visit compared to the first value measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT (SELECT lab_value FROM lab_measurements WHERE lab_measurements.patient_id = 10002495 AND lab_measurements.lab_name = 'cholesterol, total' ORDER BY lab_measurements.measurement_date DESC LIMIT 1) - (SELECT lab_value FROM lab_measurements WHERE lab_measurements.patient_id = 10002495 AND lab_measurements.lab_name = 'cholesterol, total' ORDER BY lab_measurements.measurement_date NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
7a05f054a0d752aa65a229c4,When did patient 10039997 last receive an input since 08/11/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(date_input) FROM input WHERE patient_id = 10039997 AND date_input >= '2100-08-11',[{'starttime': '2134-09-08 17:50:00'}]
88d1d764d3e45a0ff254d45a,"Among patients diagnosed with other diseases of lung, not elsewhere classified, what are the top three most common lab tests conducted within the same hospital visit in this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of lung, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.name, diagnosis.diagnosis_date, patient.patient_id FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis LIKE '%other diseases of lung, not elsewhere classified%' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.name, lab_test, lab_test_date, patient.patient_id FROM lab_test JOIN patient ON lab_test.patient_id = patient.patient_id WHERE DATETIME(lab_test_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.lab_test_date AND t1.pat",
6f1219fa346b449ef48710c1,Tell me the total volume of input for patient 10014354 since 10/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-12'",SELECT SUM(input_volume) FROM intake WHERE patient_id = 10014354 AND intake_date >= '2010-12-2100',[{'SUM(inputevents.totalamount)': 29320.0}]
ac0778f01b4dfce5b48de369,List the top five most frequently prescribed medications since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.name FROM (SELECT prescriptions.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE DATETIME(prescriptions.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY prescriptions.name) AS t1 WHERE t1.c1 <= 5;","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
d8df22b2ce5cbb8d4e6d6f4d,How much is the drug named bag?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'bag' ),SELECT SUM(price) FROM drugs WHERE name = 'Bag';,
ad2612489dcd53ed00312d17,"How many days have elapsed since the last time patient 10021487 was diagnosed with injury to liver without mention of open wound into cavity laceration, unspecified in their current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity laceration, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE patient_id = 10021487 AND diagnosis_date = diagnosis_date",
e449057b794c66a951ffc20d,Can you tell me the total amount of metoprolol succinate xl that patient 10020944 has been prescribed in 03/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03'",SELECT COUNT(DISTINCT prescription_id) FROM prescriptions WHERE prescriber_id IN (SELECT prescriber_id FROM prescriptions WHERE patient_id = 10020944) AND prescription_name = 'metoprolol succinate xl' AND prescription_date BETWEEN '2000-03-21' AND '2000-03-21',[{'SUM(prescriptions.dose_val_rx)': None}]
4293159f67c757b21ef6659a,Count the number of patients who had their other cell tested in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other cell' ) AND strftime('%Y',labevents.charttime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM cells WHERE other_cell_type = '2100',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
71e8c2b5076850658d8e63ed,"Among patients who were given destruction of right lower lung lobe, via natural or artificial opening endoscopic in 2100, what are the top four most common specimens tested afterward during the same hospital visit?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t3.specimen_type, COUNT(t3.specimen_type) FROM (SELECT t2.specimen_type, COUNT(t2.specimen_type) FROM (SELECT patient.uniquepid, treatment.treatmentdate, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' AND STRFTIME('%y', treatment.treatmentdate) = '2100') AS t1 JOIN (SELECT patient.uniquepid, specimen_type, COUNT(specimen_type) FROM patient JOIN specimen ON patient.uniquepid = specimen.uniquepid WHERE STRFTIME('%y', specimen.specimendate) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.specimendate AND t1.patientname = t2.patientname GROUP BY t2.specimen_type) AS t3 WHERE t3.count > 4 GROUP BY t3.",
820528745b6eb9d481abf58f,Can you tell me the top four most common treatments for patients in their 30s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment, t2.age FROM treatment AS t1 JOIN patient AS t2 ON t1.patient = t2.patient WHERE t2.age BETWEEN 30 AND 39) AS t3 GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 4",
8bbc16e7b33ddf49226c0c8e,How much sodium bicarbonate was prescribed the last time since 11/2100 to patient 10006053?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND prescriptions.drug = 'sodium bicarbonate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(sodium_bicarbonate) FROM prescriptions WHERE prescriptions.patient_id = 10006053 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-11';",[]
bbfcc311f9650f6a3a91f0b6,What is the average monthly number of patients diagnosed with bariatric surgery status?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bariatric surgery status' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT AVG(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis_date) AS c1 FROM diagnoses WHERE diagnosis_category = ""Bariatric surgery status"" GROUP BY diagnosis_date) AS t1",
c868b0184dd86f732c24d8f6,What immuno-cancer drugs are in use over the last five years?,,"SELECT DISTINCT ""drug"" FROM ""immuno_cancer_drugs"" WHERE ""year"" >= (SELECT MIN(""year"") FROM ""immuno_cancer_drugs"" - 5)",
062575cdb38e709723edbb54,What was the drug that patient 10018081 was prescribed for the last time using a po/ng route since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(drug_date) FROM (SELECT patient_id, drug_date FROM prescriptions WHERE route = 'po/ng' AND patient_id = 10018081)",[]
f6ff7f1d41f19c951d2854e9,Get me the top five most frequent procedures that patients received within 2 months after receiving closed [endoscopic] biopsy of bronchus since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, t1.month FROM (SELECT DATEADD(month, DATE_DIFF('month', 0, CLOSED_ENDSCOPIC_BIOPIY(t)), 0) AS month FROM CLOSED_ENDSCOPIC_BIOPIY(t) WHERE t.closed_endscopic_biopsy = 1) AS t1 JOIN (SELECT DATEADD(month, DATE_DIFF('month', 0, CLOSED_ENDSCOPIC_BIOPIY(t)), 0) AS month FROM CLOSED_ENDSCOPIC_BIOPIY(t) WHERE t.closed_endscopic_biopsy = 1) AS t2 ON t1.month BETWEEN DATEADD(month, DATE_DIFF('month', 0, t2.month) - 2, 0) AND DATEADD(month, DATE_DIFF('month', 0, t2.month) + 2, 0) GROUP BY t3.pro",
6c01e0679abf5f4770e5efe4,What are the five most frequently ordered laboratory tests this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date_part('year', current_date) = date_part('year', t.date)) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5",[]
d936f940a2ec69a598302c7c,What is the difference between mean blood pressure on patient 10002495 last measured on the last ICU visit compared to the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT mean_blood_pressure FROM information_schema.columns WHERE table_name = 'patient_10002495' AND column_name = 'mean_blood_pressure' ORDER BY icu_visit_date DESC LIMIT 1) - (SELECT mean_blood_pressure FROM information_schema.columns WHERE table_name = 'patient_10002495' AND column_name = 'mean_blood_pressure' ORDER BY icu_visit_date DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
a112ad7cd8202090ededa192,What was the first o2 saturation pulseoxymetry value that patient 10004733 had on this month/23?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '23' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(O2_SATURATION_PULSEOXYMETRY) FROM pulse_oxymetry WHERE PATIENT_ID = 10004733 AND MONTH = 9 AND DAY = 23,[]
3c11cf08e04cd8e55787eb1f,What was the last time patient 10009035 had a mrsa screen microbiology test in 05/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '05' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(date) FROM microbiology WHERE patient_id = 10009035 AND test_name = 'mrsa screen microbiology' AND date_part('month', date) = 5 AND date_part('year', date) = 2022",[]
5c86eada276c78a8735e0dfb,What are the new drugs prescribed to patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT * FROM drugs WHERE patient_id = 10039831 AND date_sub('day', CURRENT_DATE, yesterday()) = 0",[]
110b301bfc80d9c150556b92,What was measured as patient 10007795's weight during the last check in 05/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '05' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT SUM(patient.weight) FROM patient WHERE patient.patient_id = 10007795 AND NOT patient.weight IS NULL AND DATETIME(patient.weight_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', patient.weight_date) = '05'",[]
8c6f20f6c2e2c7185fddb381,What is the average total hospital expense that includes malignant neoplasm of rectosigmoid junction since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of rectosigmoid junction' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(t1.c1) FROM (SELECT SUM(expenses.total) AS c1 FROM expenses WHERE expenses.type = 'malignant neoplasm of rectosigmoid junction' AND STRFTIME('%y', expenses.date) >= '2100' GROUP BY expenses.id) AS t1",
fa8402cd41bf604fac740f8c,Has patient 10026354 had nacl 0.9% given since 03/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03'",SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 10026354 AND patients.date_of_last_contact > '03/2100' AND products.product_name = 'nacl 0.9%',[{'COUNT(*)>0': 0}]
650faa5ad60fd0f4f2dee70a,What is the procedure on anticancer drugs?,,SELECT * FROMdrugs WHERE drug_category = 'anticancer';,
9ab9f7bcf85120221b47db91,Get me the top four most frequent diagnoses for patients of age 40s since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) as rank",
f7afdc32d94d128115a2b257,"Has patient 10002428 been ordered 0.45% sodium chloride, lisinopril, or heparin since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND prescriptions.drug IN ( 'lisinopril', '0.45% sodium chloride', 'heparin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'",SELECT COUNT(*) > 0 FROM orders WHERE patient_id = 10002428 AND order_date >= 2100 AND order_type = '0.45% sodium chloride',[{'COUNT(*)>0': 0}]
03f81bdff77fe530b0d0fe7d,Can you indicate the daily maximum dose of solution that patient 10031757 received during their first ICU stay?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT MAX(daily_dose) FROM icu_dose WHERE icu_dose.patient_id = 10031757 AND NOT icu_dose.outdated GROUP BY icu_dose.date ORDER BY icu_dose.date NULLS FIRST LIMIT 1;,[]
ce6918d801a0e9dc37e563ce,What were the top four most frequently prescribed medicines this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.name FROM (SELECT prescriptions.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY prescriptions.name) AS t1 WHERE t1.c1 <= 4;",[]
f613480747542c410142b4ea,When was the last input time since 07/11/2100 for patient 10021487?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-11' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10021487 AND input_time >= '2100-07-11';,[{'starttime': '2117-03-09 14:20:00'}]
c1f369fb99bd717e87c34253,"On their first hospital encounter, was patient 10009049 given any diagnosis?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10009049 AND diagnoses.date = (SELECT MIN(date) FROM encounters WHERE encounters.patient_id = 10009049 AND encounters.hospital_location = 'initial hospital'),[{'COUNT(*)>0': 1}]
07c43928bf97ed8bc8540e78,Tell me the name of the output patient 10025612 had for the last time?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),SELECT name FROM outputs WHERE patient_id = 10025612 ORDER BY time DESC LIMIT 1,[{'label': 'Foley'}]
0c1c6ad6a0a679043de5adc2,How long ago did patient 52647 receive a medication that should be taken regularly?,,SELECT 32 FROM patients WHERE patient_id = 52647,
af3705067de009f76d7a8031,What was the number of patients who were prescribed iso-osmotic dextrose in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic dextrose' AND strftime('%Y',prescriptions.starttime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, prescriber FROM prescriptions WHERE prescriber = 'iso-osmotic dextrose' AND STRFTIME('%y', prescriptions.date) = '2100') AS t1 JOIN (SELECT subject_id FROM patients WHERE patients.age < 30) AS t2 ON t1.subject_id = t2.subject_id",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
1d930d1bc64cf3b52d4cfe25,Tell me the total output on 11/28/this year for patient 10027602.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '11-28'","SELECT COUNT(DISTINCT ""output"") FROM ""output"" WHERE ""patient"" = 10027602 AND ""date"" = '2022-11-28'",[{'SUM(outputevents.value)': None}]
63e5457b5b019e78c8dbf939,What were the top three most common microbiology tests for patients who were previously diagnosed with neoplasm of unspecified nature of endocrine glands and other parts of nervous system within the same hospital visit since 1 year ago?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'neoplasm of unspecified nature of endocrine glands and other parts of nervous system' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnosis.date_of_diagnosis, patient.hadron_value FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis_name = 'NEOPLASM OF UNKNOWN NATURE' AND DATETIME(diagnosis.date_of_diagnosis) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.subject_id, microbiology.test_name, microbiology.date_of_test, patient.hadron_value FROM microbiology JOIN patient ON microbiology.patient_id = patient.subject_id WHERE DATETIME(microbiology.date_of_test) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date_of_diagnosis < t2.",
86f9f9f4d49dd3a3f7c9fedf,What was the new drug for patient 10039831 today compared to the one prescribed yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT (SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patientId = 10039831 AND DATETIME(prescriptions.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day')) - (SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patientId = 10039831 AND DATETIME(prescriptions.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-1 day'))",[]
11a79e0284c0d972831a98a0,When was the last input time since 10/09/2100 for patient 10021938?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-09' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10021938 AND input_time >= '2100-10-09',[{'starttime': '2181-10-26 20:38:00'}]
cd1253c3a3d160eab14d31d4,How much is the difference of glucose of patient 10021938 last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT glucose FROM patients WHERE patient_id = 10021938 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime DESC LIMIT 1) - (SELECT glucose FROM patients WHERE patient_id = 10021938 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime DESC LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
7e56a0516c482d121cd99bc1,Has there been any organism observed in patient 10021118's last staph aureus swab microbiology test since 1 year ago?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT COUNT(*) > 0 FROM Organism WHERE Organism.patient_id = 10021118 AND Organism.strain = 'staph aureus' AND DATETIME(Organism.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 0}]
5f192a749e3dc5e91eff2fd7,The value of mch of patient 10004733 was last measured on the current hospital visit greater than second to last measured on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT mch FROM patients WHERE patients.hospital_subject_id = 10004733 ORDER BY mch DESC LIMIT 1) > (SELECT mch FROM patients WHERE patients.hospital_subject_id = 10004733 ORDER BY mch DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
16690ffc32c0b935ca799d7f,What are the five most frequently performed treatments for patients in their 60 or above in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT treatment FROM (SELECT * FROM patients WHERE age >= 60) AS t1 JOIN (SELECT * FROM procedures WHERE year = 2100) AS t2 ON t1.treatment = t2.treatment) GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 5",
5812f2aa2ec32908144ea996,What is the name of the procedures that were given to patient 10005909 two or more times?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",SELECT T1.name FROM duckdb_functions AS T1 JOIN procedures AS T2 ON T1.function_name = T2.name WHERE T1.database_oid = (SELECT oid FROM main.patients WHERE patient_id = 10005909) GROUP BY T1.name HAVING COUNT(*) >= 2;,
abe78de7464f93993da9c600,How many hours elapsed since the first time patient 10039831 received a phosphate lab test on this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', phosphate_lab_time)) FROM lab_results WHERE patient_id = 10039831 AND lab_result = 'phosphate' AND phosphate_lab_time IS NOT NULL;",[]
132963e711d7f2dfe87f94dc,What was the last hospital admission type for patient 10021666 during?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021666 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1","SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021666 AND DATETIME(admissions.admission_date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-5 day') ORDER BY admissions.admission_date DESC LIMIT 1",[]
c9b9077631942180f3a3b0ed,What is the precautionary measure following the head & neck endarter nec procedure?,,"SELECT precautionary_measure FROM procedures WHERE procedures.head_neck_endarter = ""Nec""",
6b368507937b705eba056861,"What are the five most frequently given lab tests for patients that were diagnosed with family history of malignant neoplasm of breast previously during the same hospital visit, in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of breast' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab FROM (SELECT t2.lab, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date, patient.patient_info->>'institution' AS institution FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'FAMILY HISTORY OF MALIGNANT NEOPLASM OF BREAST' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.uniquepid, lab, lab_date, patient.patient_info->>'institution' AS institution FROM lab JOIN patient ON lab.patient_id = patient.uniquepid WHERE STRFTIME('%y', lab.lab_date) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.lab_date AND t1.institution = t2.institution GROUP BY t2.lab) AS t3",
1e2f66da2eb65a0b588daf76,How many patients were given a basophils lab test during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.lab_basophils IS NOT NULL AND DATETIME(patient.lab_basophils, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
695030002227c1585f70824e,"Among patients diagnosed with accidental fall on or from other stairs or steps since 2100, what are the top three medications prescribed within the same month to patients in their 30s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall on or from other stairs or steps' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id FROM patient WHERE patient.age BETWEEN 30 AND 39) AS t1 JOIN (SELECT patient.id, medication.name FROM medication JOIN patient ON medication.patient_id = patient.id WHERE medication.date >= '2100-01-01') AS t2 ON t1.id = t2.patient_id GROUP BY t2.name) AS t3 WHERE t3.c1 <= 3",
467265322cf858e76174f260,"What are the total maximum expenses for a hospital involving a laboratory test for thyroxine (t4), free?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4), free' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(Expenses.Thyroxine (T4), Free) FROM Expenses WHERE Expenses.Hospital = 'University of North Carolina at Chapel Hill';",
2c1f374a404a551c3391df72,How many patients had angiocardiography of left heart structures done throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'angiocardiography of left heart structures' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.angiocardiography_left_heart = 1,
4a31a2d75cf6e073cdeef706,What was the name of the drug that was first prescribed for patient 10001725 since 04/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT name FROM drugs WHERE prescription_date >= '2000-04-2100' AND patient_id = 10001725 ORDER BY prescription_date NULLS FIRST LIMIT 1,[{'drug': 'Ondansetron'}]
00979fbe4ba004cc20246b9a,Patient 15209 is subject to covid-19 testing,,SELECT COUNT(*) FROM patients WHERE patients.subject_to_covid_19_testing = 15209,
fabcb3ee15b98badd66dcd76,How much was the difference in body temperature of patient 10005817 from the second-to-last value measured to the last value measured during the final ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT vital_signs.body_temperature FROM vital_signs WHERE vital_signs.patient_id = 10005817 AND NOT vital_signs.timestamp IS NULL ORDER BY vital_signs.timestamp DESC LIMIT 1) - (SELECT vital_signs.body_temperature FROM vital_signs WHERE vital_signs.patient_id = 10005817 AND NOT vital_signs.timestamp IS NULL ORDER BY vital_signs.timestamp DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
dfa9c58ea0197508d2682000,Was any prescription drug given to patient 10004235 in 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03'","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10004235 AND STRFTIME('%y-%m', prescriptions.date) = '2100-03'",[{'COUNT(*)>0': 0}]
2c36fe674f06fe07c1c1b71d,Is the value of anion gap of patient 10015272 last measured on the last hospital visit less than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT anion_gap FROM patient_10015272 WHERE patient_id = 10015272 AND NOT patient_10015272.hospital_info IS NULL ORDER BY patient_10015272.hospital_info->'admit_date' DESC LIMIT 1) < (SELECT anion_gap FROM patient_10015272 WHERE patient_id = 10015272 AND NOT patient_10015272.hospital_info IS NULL ORDER BY patient_10015272.hospital_info->'admit_date' NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
d72835768250c3efcfb0ef0f,Let me know the total quantity of input patient 10027602 received on last month/24.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '24'","SELECT SUM(t2.quantity) FROM (SELECT t1.quantity, t1.id FROM (SELECT patient_id, quantity FROM input_patient WHERE patient_id = 10027602) AS t1 JOIN output_patient ON t1.id = output_patient.input_patient_id) AS t2 JOIN (SELECT patient_id, quantity FROM input_patient WHERE patient_id = 10027602) AS t3 ON t2.patient_id = t3.patient_id WHERE t2.quantity = t3.quantity AND DATETIME(t2.input_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month') AND STRFTIME('%d', t2.input_date) = '24'",[{'SUM(inputevents.totalamount)': None}]
7b1b135317d758d40c445a0d,"Last time, what drug was prescribed for patient 10023117 on the last hospital stay?",SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10023117 AND NOT prescriptions.hospital_stay_id IS NULL ORDER BY prescriptions.hospital_stay_id DESC LIMIT 1;,[{'drug': 'HYDROmorphone (Dilaudid)'}]
68ed3b6273aa80637c7691c7,"In this year, what were the top four most commonly tested specimens?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT t.specimen, COUNT(t.specimen) FROM (SELECT specimen FROM (WHERE year = 2014) GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 4) t GROUP BY t.specimen;",[]
44142bfb9b0cf7c3ae3ebb6a,"Since 1 year ago, how many medications were prescribed to patient 10025612?","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10025612 AND DATETIME(prescriptions.date_prescribed) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)': 86}]
3c3c48b480fadfdd63afc64a,What is the name of the procedures that were given to patient 10016742 two times since 07/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT d.name FROM (SELECT name, COUNT(date) AS c FROM procedures WHERE patient = 10016742 AND date >= '2100-07-21' GROUP BY name) AS d WHERE c = 2",
4391a17af3d3dc9b48eb23de,Retrieve the top three most frequent procedures that were delivered to patients within 2 months after they received fluoroscopy of multiple coronary arteries using low osmolar contrast in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.item, COUNT(t3.item) FROM (SELECT t2.item, COUNT(t2.item) FROM (SELECT patient.uniquepid, treatment.treatdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatdate BETWEEN '2100-01-01' AND '2100-12-31' AND treatment.item = 'Fluoroscopy of multiple coronary arteries using low osmolar contrast') AS t1 JOIN (SELECT patient.uniquepid, treatment.item, treatment.treatdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatdate BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatdate < t2.treatdate AND DATETIME(t2.treatdate) BETWEEN DATETIME(t1.treatdate) AND DATETIME(t1.treatdate, '+",
6fab218a9bcfb128b745f81b,Tell me what the top four most common diagnoses of patients with an age of 20s?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",SELECT diagnosis FROM patients WHERE age BETWEEN 20 AND 29 GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 4,
d8493e7bf9c18bcd8edb3a40,What was the drug that patient 10019777 was prescribed for the first time using a neb route during their last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'neb' ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT neb.drug FROM (SELECT patient.id, patient.last_hospital_visit FROM patient WHERE patient.id = 10019777 AND NOT patient.last_hospital_visit IS NULL ORDER BY patient.last_hospital_visit DESC LIMIT 1) AS patient INNER JOIN (SELECT prescriber.patient_id, prescriber.drug FROM prescriber WHERE prescriber.route = 'neb') AS neb ON patient.id = neb.patient_id;",[]
290e46c4e70581545b39621a,What was the name of the outputs that patient 10029484 last had?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),SELECT output_name FROM duckdb_outputs WHERE last_modified_by_patient_id = 10029484 ORDER BY last_modified_by_patient_id DESC LIMIT 1;,[{'label': 'Void'}]
be52dc50e6aaa98ddf135fe9,What is the reimbursement model for drug?,,"SELECT ""Reimbursement Model"" FROM ""Drug"" WHERE ""Drug"" = 'Aspirin';",
0d012e621517a4059d3caf10,Could you inform me the total output amount of patient 10021938 since 86 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-86 day')",SELECT COUNT(*) FROM output WHERE patient_id = 10021938 AND date >= CURRENT_DATE - INTERVAL 86 DAY,[{'SUM(outputevents.value)': 690.0}]
4587dd491b8793e1feba1da6,When was the last time patient 10018081 SaO2 was measured less than 99.0 yesterday.,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 99.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT strftime(patient_10018081.sao2, '%Y-%m-%d %H:%M:%S') FROM patient_10018081 WHERE patient_10018081.sao2 < 99.0 AND DATETIME(patient_10018081.sao2, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
f8c155d806d238a7b40fccc9,"For patient 10017492, what was the first polys reading during their last hospital visit?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT MIN(Polys) FROM read_parquet('polys.parquet', hive_partitioning=1) WHERE Patient_ID = 10017492 AND NOT Hospital_Dischtime IS NULL ORDER BY Hospital_Admittime DESC LIMIT 1;",[]
d2edfd01c7ab2bfa13268728,How many days have elapsed since patient 10004733 has first received a eosinophils lab test during this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result_date)) FROM lab_results WHERE lab_result_type = 'eosinophils' AND patient_id = 10004733 AND hospital_location = 'TRANSFER FROM HOSP/EXTRAM'",[]
99da27a442847a01bbdb593a,What is the count of famotidine prescriptions made?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'famotidine',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Famotidine';,[{'COUNT(*)': 7}]
04c15bde72e4c64e49a380e7,How much is the total minimum cost for a hospital that includes a amylase lab test?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(COSTS.cost) FROM (SELECT lab.cost FROM lab WHERE lab.lab_name = 'amylase') AS COSTS JOIN (SELECT hosp.hospital_id FROM hosp WHERE hosp.hospital_name = 'total') AS HOSP ON COSTS.hospital_id = HOSP.hospital_id,
25c3e1d8afe894678fc6be2a,When was the last time last month that patient 10019172 was prescribed with syringe and 0.9% sodium chloride at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'syringe' AND admissions.subject_id = 10019172 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10019172 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM (SELECT date_prescribed FROM prescriptions WHERE prescriptions.patient_id = 10019172 AND prescriptions.drug_name = 'syringe' AND DATETIME(date_prescribed, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month')) AS subquery WHERE subquery.drug_name = '0.9% sodium chloride';",[]
c0b58eb14940edd013085528,What was the organism detected during the first bronchial washings microbiology test of patient 10021312 since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism FROM microbiology WHERE patient_id = 10021312 AND sample_type = 'bronchial washings' AND date(date_of_testing) >= '2000-08-21' ORDER BY date_of_testing NULLS FIRST LIMIT 1,[]
d526b1d43696d492cab8fec9,How many current patients are there in the 30s age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT(*) FROM patients WHERE age BETWEEN 30 AND 39 AND current_patient = 1,
4086b5f6f40bd2dfb3952f6d,What was patient 10021666's minimum SaO2 in their first ICU stay?,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ),SELECT MIN(SaO2) FROM (SELECT SaO2 FROM icu_summary WHERE icu_summary.patient_id = 10021666 AND NOT icu_summary.out_time IS NULL ORDER BY icu_summary.in_time NULLS FIRST LIMIT 1),[{'MIN(chartevents.valuenum)': None}]
a2c0369e9e1db224ff7cb590,What was the drug patient 10022281 was prescribed for the last time using the sc route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM patient WHERE patient_id = 10022281 AND route = 'sc';,[]
f93686c3008e71187f331de5,What were the four most frequent lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date > (CURRENT_DATE - INTERVAL '1 year')) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
84f5dabf19eb4e0fd354fbef,What was the first respiratory rate in patient 10027445's body on 08/12/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-12' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(RespiratoryRate) FROM RespiratoryData WHERE RespiratoryData.PatientID = 10027445 AND RespiratoryData.Date BETWEEN '2022-08-12' AND '2022-08-12',[]
af48025f4da1ed8f5c1616e3,How many hours has it been since the first stay of patient 10004733 in the careunit medicine during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', StayDate)) FROM Stays WHERE StayID = (SELECT StayID FROM Stays WHERE PatientID = 10004733 AND DischTime IS NULL);",[]
e7b550eaa8e671a43a12d80f,Has there been any dextrose 5% given to patient 10004720 since 07/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'",SELECT COUNT(*) > 0 FROM input WHERE patient = 10004720 AND product = 'dextrose 5%' AND date >= '2007-02-11',[{'COUNT(*)>0': 0}]
631830633e3ef0505c85ca98,Calculate the total number of medications that patient 10004457 was prescribed throughout this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10004457 AND DATETIME(medications.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)': 0}]
3ab5f4f4e306a69472e20429,Has patient 23224 an appointment in another hospital department?,,SELECT COUNT(*) > 0 FROM Appointment WHERE Appointment.patient_id = 23224 AND Appointment.location <> 'TRSF WITHIN THIS HOSP',
434dfa0e21a4e11280d53e6e,What was patient 10005909's daily average value of body weight in 2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT AVG(body_weight) FROM patient_weight WHERE patient_id = 10005909 AND measurement_date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY measurement_date,[]
40aa706064637ead2ae39af7,How many patients were diagnosed with atherosclerotic heart disease of native coronary artery with unspecified angina pectoris within 2 months after first being diagnosed with atherosclerotic heart disease of native coronary artery with unstable angina pectoris since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unspecified angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis FROM diagnoses WHERE diagnosis = 'ATHEROSCLEROTIC HEART DISEASE OF NATIVE CORONARY ARTERY WITH UNSTABLE ANGINA PECTORIS' AND year >= 2100) AS t1 JOIN (SELECT subject_id, diagnosis FROM diagnoses WHERE diagnosis = 'ATHEROSCLEROTIC HEART DISEASE OF NATIVE CORONARY ARTERY WITH UNSPECIFIED ANGINA PECTORIS' AND year >= 2100) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis = t2.diagnosis AND DATETIME(t2.diagnosis) BETWEEN DATETIME(t1.diagnosis) AND DATETIME(t1.diagnosis, '+2 month')",
29183d163063354c6c818147,Is there any medication that patient 10021487 has received since 12/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10021487 AND STRFTIME('%y-%m', medication.date) >= '2100-12'",[{'COUNT(*)>0': 1}]
4fd5da8b9c864e5a3800f681,"What were the five most commonly performed lab tests for patients who were previously diagnosed with other diseases of bronchus, not elsewhere classified in the same hospital encounter, since 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.TagName, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS Rank FROM (SELECT t2.TagName, t1.SubjectId, t1.ChartDate FROM (SELECT SubjectId, ChartDate FROM (SELECT STATUS AS SubjectId, ChartDate FROM (SELECT STATUS AS SubjectId, ChartDate FROM patients WHERE NOT ChartDate IS NULL AND STATUS = 'previously diagnosed with other diseases of bronchus, not elsewhere classified') AS t1 JOIN (SELECT TagName, COUNT(*) AS c FROM (SELECT TagName FROM (SELECT * FROM (SELECT STATUS AS TagName FROM labtests WHERE ChartDate BETWEEN '2100-01-01' AND '2100-12-31') AS t2 GROUP BY TagName) AS t3 ON t1.TagName = t3.TagName WHERE t1.ChartDate < t2.ChartDate AND t1.SubjectId = t2.SubjectId) AS t4 GROUP BY t3.TagName) AS t5 WHERE t5.Rank <= 5",
a1a5f421d9b782f7e987091a,When and where are the rounds and procedures of dr. conerly?,,"SELECT procedure, round FROM dr_conerly WHERE round IS NOT NULL;",
02964db902a561eae10282a2,"Did patient 10017492 have total protein, csf tests in 03/2100?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'","SELECT COUNT(*) FROM lab_data WHERE lab_data.patient_id = 10017492 AND lab_data.test_name = 'total protein, csf' AND STRFTIME('%y-%m', lab_data.date) = '2100-03'",[{'COUNT(*)>0': 0}]
3a60895a1bcc132fc939a54a,What is the name of the medication which should not be administered during the contrast arteriogram-leg treatment?,,SELECT name FROM medication WHERE NOT name IN (SELECT name FROM medication WHERE type = 'contrast arteriogram-leg');,
37805d9674cc2e4525168916,"Among patients in their 60 or above this year, what were the top four most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.onset >= '2010-01-01' AND patient.age >= 60) AS t1 WHERE t1.c1 <= 4",
61a27855d733cbb01f805863,What was the procedure conducted on patient 10000032 two or more times?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT ""procedure"" FROM ""procedures"" WHERE ""patient"" = '10000032' GROUP BY ""procedure"" HAVING COUNT(*) >= 2",
571c7531441ce4b75b1fe333,What was the first drug prescribed to patient 10009628 in 10/this year via the ng route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND prescriptions.route = 'ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT ng FROM prescriptions WHERE prescriptions.patient_id = 10009628 AND prescriptions.route = 'ng' AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '10' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[]
5e75262ac3a25d12e75712dc,So how many days has passed since patient 10004733's first pneumonitis due to inhalation of food or vomitus diagnosis on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pneumonitis due to inhalation of food or vomitus' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",SELECT COUNT(DISTINCT TIMESTAMP '2022-01-01 00:00:00') FROM diagnoses WHERE diagnoses.patient_id = 10004733 AND diagnoses.diagnosis_name = 'pneumonitis due to inhalation of food or vomitus',
9de280a78a2a5c2a9872c3b4,What was the name of the organism that was found in the first microbiology test on patient 10037861's urine since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10037861 AND urine = 1 AND date >= '2000-08-2100' ORDER BY date NULLS FIRST LIMIT 1,[]
d3693b3ee981749f8a199c7b,"For the last time since 07/2100, what specimen test did patient 10007818 get?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_test FROM history WHERE patient_id = 10007818 AND last_date >= '2007-02-10',[{'spec_type_desc': 'BLOOD CULTURE'}]
460140392f817cccb9e244d4,Retrieve the top five most frequent lab tests that patients had after being diagnosed with noncompliance with renal dialysis in the same hospital visit since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3. lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.name, diagnosis.diagnosis_date, patient.patient_id FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Noncompliance with renal dialysis' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.name, lab_test, lab_test_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.patient_id WHERE STRFTIME('%y', lab_test_date) >= '2100') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.lab_test_date AND t1.patient_id = t2.patient_id GROUP BY t2.lab_test) AS t3 GROUP BY t3.lab_test ORDER BY COUNT(t3",
3f37877d41058e4ed337aadb,What was the organism found in the first microbiology test done on the patient 10021312's bronchial washings since 03/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism FROM microbiology WHERE patient_id = 10021312 AND sample_type = 'bronchial washings' AND date >= '2000-03-21' ORDER BY date NULLS FIRST LIMIT 1,[]
024f3a6b35669ffe35709f85,I would like to know the top three diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT t3.diagnosis, t3.c1, t3.c2, t3.c3 FROM (SELECT t2.diagnosis, t2.c1, t2.c2, t2.c3 FROM (SELECT t1.diagnosis, t1.c1, t1.c2 FROM (SELECT 'diabetes with keto acid' AS diagnosis, 0.4 AS c1, 0.35 AS c2) AS t1 GROUP BY t1.diagnosis) AS t2 JOIN (SELECT 'diabetes with keto acid' AS diagnosis, 0.4 AS c1, 0.35 AS c2) AS t3 ON t2.diagnosis = t3.diagnosis WHERE t2.c1 > t3.c1 GROUP BY t3.diagnosis ORDER BY t3.c1 DESC LIMIT 3",
45b7526b9941e4579af43e6c,Could you retrieve the top five most common outputs in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT 2000 FROM (SELECT COUNT(1) AS c FROM (SELECT DISTINCT YEAR(date) AS y FROM players JOIN results ON players.player_id = results.player_id WHERE YEAR(date) = 2100) AS top_five_years GROUP BY 2000 ORDER BY c DESC LIMIT 1) AS top_five_2000s;,[]
4ae26018d8ea48c61224e513,"How many patients underwent spinal tap during the same hospital encounter after the diagnosis of unspecified essential hypertension, last year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date, t1.had_contact_with_patient FROM (SELECT subject_id, diagnosis_date, NULL AS had_contact_with_patient FROM (SELECT subject_id, NULL AS diagnosis_date, NULL AS had_contact_with_patient FROM (SELECT * FROM diagnosis_table WHERE diagnosis = 'unspecified essential hypertension')) AS t1 JOIN (SELECT * FROM treatment_table WHERE treatment = 'spinal tap') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date = t2.diagnosis_date) AS t1 GROUP BY t1.subject_id HAVING MIN(t1.diagnosis_date) = t1.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
de871565192e846d9c7ca39a,Did patient 10022017 have a pt test done in 10/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10'","SELECT COUNT(*) FROM lab_results WHERE lab_results.patient_id = 10022017 AND lab_results.test_name = 'pt' AND STRFTIME('%y-%m', lab_results.result_date) = '2100-10'",[{'COUNT(*)>0': 0}]
bb4344288238a4637074b5b3,Count how many patients were discharged from hospital throughout this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT patients.dischtime IS NULL AND DATETIME(patients.dischtime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
333df3a7ec5a12c84b0e951e,What was the total of zolpidem tartrate patient 10021487 had been prescribed in 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'zolpidem tartrate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'",SELECT COUNT(*) FROM patients WHERE patients.id = 10021487 AND patients.date_of_prescription = '12/2100' AND prescriptions.drug = 'Zolpidem Tartrate',[{'SUM(prescriptions.dose_val_rx)': None}]
5abb89ffecbb35ddc1f5b163,How much does vancomycin oral liquid cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin oral liquid' ),"SELECT ""cost"" FROM ""items"" WHERE ""item"" = 'vancomycin oral liquid'",
d1296c6e0fcaaa1292187c95,When was the last microbiological test of patient 10022281 since 06/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiological_tests WHERE patient_id = 10022281 AND date >= '2000-06-2100',[{'charttime': '2125-06-17 05:30:00'}]
a8ce51c1370a7fb07b65da1c,What's the protocol for anticancer drugs?,,SELECT DISTINCT protocol FROM drugs WHERE indication = 'anticancer';,
14a36d4ffabe710c621140cf,When was the last input of patient 10004733 during the last ICU visit?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,SELECT MAX(input_time) FROM input_table WHERE patient_id = 10004733 AND NOT icu_visit IS NULL;,[{'starttime': '2174-12-12 18:00:00'}]
c1b9f618d57148f9613d4e17,Which procedure was performed on patient 10027602 two or more times since 11/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-11' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",SELECT procedure FROM procedures WHERE patient = 10027602 AND date >= '11/2100' GROUP BY procedure HAVING COUNT(*) >= 2,
1aa406c499de99518294077e,Tell me the minimum total hospital cost that involves endoscopic control of gastric or duodenal bleeding?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(T1.c) FROM (SELECT SUM(T2.h) AS c FROM gastric_or_duodenal_bleeding T2 JOIN endoscopic_control_of_gastric_or_duodenal_bleeding T1 ON T1.gastric_or_duodenal_bleeding_id = T2.gastric_or_duodenal_bleeding_id GROUP BY T1.gastric_or_duodenal_bleeding_id) AS T1,
abb065f7fb28acb0c3c8fb68,Tell me the top four most common diagnoses for patients aged 20s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.diagnosis, COUNT(t4.diagnosis) FROM (SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, COUNT(t2.diagnosis) FROM (SELECT t1.id, t1.diagnosis FROM t1 JOIN t2 ON t1.id = t2.patient_id WHERE t1.age BETWEEN 20 AND 29) AS t2 GROUP BY t2.diagnosis) AS t3 GROUP BY t3.diagnosis) AS t4 WHERE t4.count > (SELECT MIN(count) FROM (SELECT diagnosis, COUNT(diagnosis) AS count FROM t1 JOIN t2 ON t1.id = t2.patient_id WHERE t1.age BETWEEN 20 AND 29) AS t2 GROUP BY diagnosis) GROUP BY t4.diagnosis ORDER BY COUNT(t4.diagnosis) DESC LIMIT 4",
dcefbced3548a05ff203d8a9,Count the number of hospital visits that patient 10027602 had in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10027602 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(VisitDate) FROM Visits WHERE PatientID = 10027602 AND STRFTIME('%y', VisitDate) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
f6001dcc7f0b69fb01da77ee,Calculate how many drugs patient 10007058 was prescribed since 09/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'","SELECT COUNT(*) FROMdrugs WHERE drugs.patient_id = 10007058 AND STRFTIME('%y-%m', drugs.date) >= '2100-09'",[{'COUNT(*)': 43}]
47b903aa15da43a35db353c7,"After getting diagnosed with acute on chronic diastolic heart failure, how many patients were found to have postinflammatory pulmonary fibrosis within 2 months in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'Acute on chronic diastolic heart failure' AND STRFTIME('%y', diagnosis.date) = '2100') AS t1, (SELECT patient.subject_id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'Postinflammatory pulmonary fibrosis' AND STRFTIME('%y', diagnosis.date) = '2100') AS t2 WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month')",
bb02020436904947b9602d44,Tell me the percentile of the red blood cells value of 3.03 among patients of the same age as patient 10010471 in the first hospital encounter.,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 3.03","SELECT t1.c1 FROM (SELECT lab.result, PERCENT_RANK() OVER (ORDER BY lab.result NULLS FIRST) AS c1 FROM lab WHERE lab.name = 'red blood cells' AND lab.patient_id = (SELECT patient.id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE id = 10010471 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1))) AS t1 WHERE t1.result = 3.03",
97b55cd17bce748e8c767456,I want to know the total volume of input patient 10001725 has received since 04/05/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-05'",SELECT SUM(volume) FROM intake WHERE patient = 10001725 AND date >= '2100-04-05',[{'SUM(inputevents.totalamount)': 4450.0}]
395c9fa32c41aa7400cb5a87,"Count the number of people who received insertion of infusion device into right atrium, percutaneous approach in the same month after having been diagnosed with unspecified atrial flutter in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial flutter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into right atrium, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_month FROM (SELECT subject_id, diagnosed_month FROM diagnoses WHERE diagnosis = 'unspecified atrial flutter') AS t1 JOIN (SELECT subject_id, date_inserted_month FROM insertions WHERE insertion_method = 'percutaneous approach') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_month = t2.date_inserted_month) AS t3 JOIN (SELECT subject_id, date_inserted_month FROM insertions WHERE insertion_method = 'right atrium, percutaneous approach') AS t4 ON t3.subject_id = t4.subject_id WHERE t3.diagnosed_month = t4.date_inserted_month",
b2c10ed422acd1b5e903bf20,Show me patient 10020740's yearly maximum weight since 28 months ago.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') GROUP BY strftime('%Y',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10020740 AND date >= CURRENT_DATE - INTERVAL '28 month' GROUP BY date,[]
d6c2a396d94d370d6f2348f2,How many patients were present in the vascular since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) >= '2100' )",SELECT COUNT(DISTINCT patient_id) FROM vascular WHERE year >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c8434cc6732c978c99684d40,"On their first hospital visit, did patient 10020944 receive a venous catheterization, not elsewhere classified treatment?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",SELECT COUNT(*) FROM treatment WHERE treatment.patient_id = 10020944 AND treatment.treatment_type = 'VENOUS CATH NOT ELSEWHERE',[{'COUNT(*)>0': 0}]
0a52d95713114e75cad62068,How many patients had a diagnosis of edema of male genital organs?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) ),"SELECT COUNT(DISTINCT patient_id) FROM diagnoses WHERE diagnosis = ""EDEMA OF MALE GENITAL ORGANS""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
b0e8ceb89dac04c7f918d0aa,What was the condition patient 10038999 was diagnosed with last time in the first hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis_condition FROM diagnoses WHERE patient_id = 10038999 AND NOT hospital_dischtime IS NULL ORDER BY diagnosis_date NULLS FIRST LIMIT 1,
b9f6116b0b39e50a2fa629e1,Is the value of anion gap last measured on the first hospital visit of patient 10005348 greater than its value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT anion_gap FROM visit_1 WHERE patient_id = 10005348 ORDER BY measurement_time NULLS FIRST LIMIT 1) > (SELECT anion_gap FROM visit_1 WHERE patient_id = 10005348 ORDER BY measurement_time DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
07d28012648c5a33f74fb154,What were the three most common tests conducted on specimens since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT test_type, COUNT(*) FROM specimens WHERE year > 2100 GROUP BY test_type ORDER BY COUNT(*) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
45055dee9d62c2fec5046a84,What medication was prescribed to patient 10021312 last time during the last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT medication FROM prescriptions WHERE patient_id = 10021312 AND NOT hospital_id IS NULL ORDER BY date DESC LIMIT 1;,[{'drug': 'Metoprolol Tartrate'}]
0901f19617fd97688d40bbbd,When was the last time that on the last hospital stay patient 10021312 was prescribed a medication via po?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM medications WHERE medications.patient_id = 10021312 AND medications.date_prescribed IS NOT NULL AND medications.drug_po = 'PO',[]
efd275d1b7116eb72bf67aaa,Calculate the number of closed [endoscopic] biopsy of bronchus procedures performed in 2100.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,
9247b77bedc088fb1beb2f9c,What was the name of the organism discovered in the first sputum test of patient 10029291 in 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM sputum_test WHERE patient_id = 10029291 AND sample_date = '2002-2100-02' ORDER BY sample_date NULLS FIRST LIMIT 1,[]
95b867d0cf6c28bfdd679151,How many hours has it been since the first other staphylococcus pneumonia diagnosis for patient 10004733 in their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other staphylococcus pneumonia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = 'other staphylococcus pneumonia' AND patient_id = 10004733 AND hospital_oid = (SELECT oid FROM hospital WHERE name = 'Staphylococcus Hospital') ORDER BY diagnosis_date DESC LIMIT 1;",
c66698669f239c7f44238998,What are the five most common laboratory tests undertaken by patients during the same hospital visit following a diagnosis of other cirrhosis of liver?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_location FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Other cirrhosis of liver') AS t1 JOIN (SELECT admissions.subject_id, lab_test, lab_date FROM lab_results JOIN admissions ON lab_results.admission_id = admissions.admission_id) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.lab_date AND t1.admission_location = t2.admission_location GROUP BY t2.lab_test) AS t3 WHERE t3.c1 <= 5",
2cffa622f6560d843482b50d,How much is the cost of the acute and subacute hepatic failure without coma diagnosing?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute hepatic failure without coma' ) ),SELECT SUM(cost) FROM diagnoses WHERE diagnosis = 'acute and subacute hepatic failure without coma',
a3a2597423bb12f178e4e5b7,Can you show me the drug that patient 10020740 was last prescribed in 04/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT drug FROM prescriptions WHERE patient_id = 10020740 AND date_part('month', prescriptions.date) = 4 AND date_part('year', prescriptions.date) = 2020 ORDER BY prescriptions.date DESC LIMIT 1",[]
23ef89f430d2312cd46e8a1d,Could you list the daily average lr input of patient 10013049?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(lr_input) FROM read_csv_auto('patients/10013049/daily_lr_input.csv', dateformat='%m/%d/%Y') WHERE patient_id = 10013049;",[]
870ff7dd4c46ed086c2c0376,Calculate patient 10007928's length of stay in days for the first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.859664352145046}]"
6e3ef13b7c663dcb6c9945ec,When was the last time that patient 10266 had a medication that should be taken regularly?,,SELECT MAX(date_last_medication) FROM medication_usage WHERE patient_id = 10266 AND frequency = 'regular';,
592209b6b448207dfea92c06,When did patient 10027602 get input since 07/25/2100 for the last time?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-25' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(date_input) FROM input WHERE patient_id = 10027602 AND date_input >= '2100-07-25',[{'starttime': '2201-12-13 16:51:00'}]
e6251eca229881bceb8a97c7,I would like to know what dr. garcia's on today's outpatient schedule.,,SELECT * FROM dr_garcia_outpatient_schedule WHERE dr_garcia_outpatient_schedule.date = CURRENT_DATE;,
690bde321b749a8d1310a710,What is the number of patients who had a macrophages test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophages' ) AND strftime('%Y',labevents.charttime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM lab_data WHERE lab_name = 'Macrophages' AND year = 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
11f0c0917f60ce2086cc646c,How many patients with noncompliance with renal dialysis were diagnosed within 2 months after previously being diagnosed with personal history of tobacco use?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Noncompliance with renal dialysis') AS t1 JOIN (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Personal history of tobacco use') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month')",
e9f0066c2e5b7c4c2d7fe515,How many patients had a diagnosis of methicillin susceptible pneumonia due to staphylococcus aureus during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT admissions.subject, diagnoses.date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Methicillin Susceptible Pneumonia due to Staphylococcus Aureus"" AND DATETIME(diagnoses.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject, diagnoses.date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Methicillin Resistant Pneumonia due to Staphylococcus Aureus"" AND DATETIME(diagnoses.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.subject = t2.subject WHERE t1.date = t2.date",
8e4ed37b59452ca69b3481b2,Which method of disinfection is in the quarantine room?,,SELECT * FROM sanitation WHERE location = 'quarantine room';,
4464d8ca9583f59be4160810,What were the top five frequent laboratory tests that patients had after they were diagnosed with intermediate coronary syndrome during the same hospital visit in this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intermediate coronary syndrome' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'intermediate coronary syndrome' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, lab_test, lab_date FROM lab_data JOIN admissions ON lab_data.admission_id = admissions.admission_id WHERE DATETIME(lab_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.lab_date AND t1.admission",
2fb580e18c83d31b38426b65,Tell me the count of the drugs patient 10026354 was prescribed since 2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10026354 AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)': 60}]
92a24aa83e1c66451f13de62,When did patient 10031757 last get swab's microbiology test during their last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'swab' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(date) FROM swab_microbiology WHERE patient_id = 10031757 AND location = 'last hospital encounter',[]
9f640a77c4f06183632d1120,"What was the name of the drug prescribed for patient 10002495 in the same hospital visit after having received a dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach procedure since 22 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-22 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-22 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug_name FROM (SELECT t1.subject_id, t1.date FROM (SELECT patient.subject_id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach') AS t1 GROUP BY t1.subject_id HAVING MIN(t1.date) = t1.date AND DATETIME(t1.date) >= DATETIME(CURRENT_TIME, '-22 month')) AS t2 JOIN (SELECT patient.subject_id, medication.drug_name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.patient_id WHERE DATETIME(medication.date) >= DATETIME(CURRENT_TIME, '-22 month')) AS t3 ON t2.subject_id = t3.subject_id WHERE t2.date < t3.date AND DATETIME(t2.date) >= DATETIME(t",
db2dac9cf4438079183f8b61,"On their last hospital encounter, how old was patient 10038081?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT MAX(age) FROM (SELECT patient_id, age FROM patients WHERE patient_id = 10038081 AND NOT age IS NULL)",
3274494f44c1ffdda4c98220,What was the daily maximum input of piggyback for patient 10021666 in the first ICU stay?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT MAX(input) FROM icu WHERE patient = 10021666 AND icu_index = 1 AND input_type = 'piggyback' AND time_frame = 'daily';,[]
1aaa39bc1ab0805e5a3b83be,"What percentile is the fibrinogen, functional value of 86.0 in the same age group as patient 10013049 during the first hospital encounter?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 86.0","SELECT t1.c1 FROM (SELECT patient.age, percent_rank() OVER (PARTITION BY patient.age ORDER BY patient.fibrinogen DESC) AS c1 FROM patient WHERE patient.patient_id = 10013049 AND NOT patient.dischtime IS NULL ORDER BY patient.age NULLS FIRST LIMIT 1) AS t1 WHERE t1.age = 86.0",
66c02202fa82b6035ee4845c,"Since the last diagnosis of patient 10004733 with unspecified sinusitis (chronic) during this hospital visit, how many hours have passed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.hospital_dischtime IS NULL) AND diagnosis.diagnosis = 'unspecified sinusitis (chronic)' ORDER BY diagnosis.diagnosis_date DESC LIMIT 1",
fc39ef8cc2866f09ef373bdd,Could you unfold the three most frequent outputs since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT UNNEST(ARRAY_AGG(output, 1000000000)) AS output","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
cc3323ca987760bede847423,What was the first time patient 10038081 had a blood (toxo) microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (toxo)' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(blood_toxo_microbiology_date) FROM microbiology WHERE patient_id = 10038081 AND blood_toxo_microbiology_date >= '2000-03-2100',[]
f3fb1b7298f0046e0b6c55ba,Has there been a hospital admission for patient 10016810 since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016810 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM hospital_admissions WHERE patient_id = 10016810 AND DATETIME(admission_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 1}]
055f3e16faecc90b5ba954f2,What new medications were prescribed to patient 10018081 today as compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.name FROM prescriptions WHERE prescriptions.patient_id = 10018081 AND DATETIME(prescriptions.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescriptions.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
bf3cde9944a2d256d7dea6dd,Tell me the sum of the input volume for patient 10020786 since 07/01/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-01'",SELECT SUM(input_volume) FROM input_table WHERE patient_id = 10020786 AND input_date >= '2100-07-01';,[{'SUM(inputevents.totalamount)': 7140.0}]
f14cb951f41a1c19af6d82c9,"What is the average total cost for a hospital including tests in the amylase, ascites laboratory this year?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.total_cost) FROM (SELECT SUM(T2.amount) AS total_cost FROM ""tests"" AS T1 JOIN ""results"" AS T2 ON T1.result_id = T2.result_id WHERE T1.test_name = 'amylase, ascites' AND T2.date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY T2.date) AS T1",
3591d10cf8e7b2175165ea6c,"When did patient 10006053 have the bilirubin, direct lab test for the first time during the last hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, direct' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1",,[]
ae00fe5dbb359a903185aab9,Can you tell me if patient 10031757 is male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10031757,SELECT SELECT MIN(birthdate) FROM patients WHERE patients.patient_id = 10031757,[{'gender': 'F'}]
94693223b09516e219df459b,What was the minimum daily number of patients who had intestinal infection due to clostridium difficile in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to clostridium difficile' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",SELECT MIN(daily_patients) FROM intestinal_infection WHERE infective_year = 2100 AND microorganism = 'clostridium difficile',
cb9ef2da0330655eb9c04acb,When did patient 10026354 receive the first prescription of ciprofloxacin 0.3% ophth soln and dexamethasone ophthalmic susp 0.1% at the same time in 10/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ciprofloxacin 0.3% ophth soln' AND admissions.subject_id = 10026354 AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'dexamethasone ophthalmic susp 0.1%' AND admissions.subject_id = 10026354 AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT t1.date FROM (SELECT patient.date, prescription.start_time FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE prescription.drug = 'ciprofloxacin 0.3% ophth soln' AND patient.patient_id = 10026354) AS t1 JOIN (SELECT patient.date, prescription.start_time FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE prescription.drug = 'dexamethasone ophthalmic susp 0.1%' AND patient.patient_id = 10026354) AS t2 ON t1.date = t2.date WHERE DATETIME(t1.start_time) = DATETIME(t2.start_time) ORDER BY t1.start_time NULLS FIRST LIMIT 1",[]
a291e9eb06fbda894cbb7a33,"In 10/this year, what was the maximum mcv value for patient 10018845?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'","SELECT MAX(MCV) FROM read_parquet('10/*/10018845/*.parquet', hive_partitioning=1);",[{'MAX(labevents.valuenum)': None}]
c7f69643d20645a5bd715035,What kind of diagnosis did patient 10031757 receive first on their first hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis_type FROM diagnoses WHERE patient_id = 10031757 AND NOT patient_id IS NULL ORDER BY encounter_date NULLS FIRST LIMIT 1;,
dbb22b767c34f1cecea22ea4,"What are the four most commonly prescribed medications for patients who were diagnosed with facial weakness previously within 2 months, in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.id WHERE diagnosis.name = 'facial weakness' AND STRFTIME('%y', diagnosis.date) = '2100') AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient = patient.id WHERE STRFTIME('%y', medication.date) = '2100') AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 4",
0653e85d090882590ea6b4ce,Can you tell me about patient 10022880's age on the last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patient WHERE patient.id = 10022880 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1,
baba1d99e845eb5d22b1c46a,Tell me the sum of the input volume for patient 10013049 since 05/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-12'",SELECT SUM(input_volume) FROM intake WHERE patient_id = 10013049 AND date >= '2100-05-12',[{'SUM(inputevents.totalamount)': 10945.0}]
0a0992495803104da30af972,What was the organism's name of the first urine microbiology test done on patient 10016150 since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10016150 AND microbiology_type = 'urine' AND date_collected >= '2000-02-21' ORDER BY date_collected NULLS FIRST LIMIT 1,[]
e626a72073cf3197a0efbd87,Tell me patient 10011398's average value of systolic blood pressure on this month/27.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '27'","SELECT AVG(systolic_blood_pressure) FROM patient WHERE patient_id = 10011398 AND date_part('month', CURRENT_TIMESTAMP) = date_part('month', CURRENT_TIMESTAMP) AND date_part('day', CURRENT_TIMESTAMP) = date_part('day', CURRENT_TIMESTAMP)",[{'AVG(chartevents.valuenum)': None}]
618f91256c79080bd2fc27d0,Tell me the top three most prevalent procedures for patients aged 60 or above.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Name FROM (SELECT procedures.Name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM procedures INNER JOIN patients ON procedures.patient_id = patients.id WHERE patients.age >= 60 GROUP BY procedures.Name) AS t1 WHERE t1.c1 <= 3",
0b0c7f34ee233cef21378070,What was the name of the procedure that was given two times to patient 10027602 during the last month?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT d.procedure_name FROM (SELECT t.procedure_name, COUNT(t.date) AS call_count FROM (SELECT patient_id, procedure_name, date FROM procedures WHERE patient_id = 10027602) AS t GROUP BY t.procedure_name) AS d WHERE d.call_count > 2 AND DATETIME(d.date, 'start of month') = DATETIME(CURRENT_DATE, 'start of month', '-1 month')",
7fa7ba261095aaef6e6a3b4f,What is the maximum total hospital expense that includes sepsis due to escherichia coli [e. coli] in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis due to escherichia coli [e. coli]' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,
eb9fcf1a569a58fe71b1b257,When was the last time patient 10040025 was discharged from hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10040025 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = '10040025';,[]
f2298b0bf7b7aa99bc543176,Tell me the method of disinfection in a quarantine?,,SELECT method FROM sanitization WHERE type = 'disinfection' AND quarantine = 'quarantine';,
27f16675ba7f39ec5b46e3bf,What was the first medication that patient 10016150 was prescribed in 05/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT medication FROM prescriptions WHERE patient_id = 10016150 AND date_prescribed = '05/2022' ORDER BY date_prescribed NULLS FIRST LIMIT 1,[]
ff61f56376566ef1959962de,How was patient 10015931 admitted in terms of admission type for the last time?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10015931 ORDER BY admissions.admittime DESC LIMIT 1,SELECT AdmissionType FROM Admissions WHERE PatientID = 10015931 ORDER BY AdmissionDate DESC LIMIT 1;,[{'admission_type': 'URGENT'}]
65b2855ba05f13d02f85adcd,What was the organism's name found in the last urine test of patient 10007928 in 04/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM urine_test WHERE patient_id = 10007928 AND sample_date = '2100-04-21' ORDER BY sample_date DESC LIMIT 1,[]
d091004cb9fc04cd233d1142,Does patient 25951 have a documented record of legal blindness-usa def in his / her family?,,"SELECT COUNT(*) > 0 FROM patients WHERE patients.family_id = 25951 AND patients.diagnosis = ""LEGAL BLINDNESS-USA DEF""",
9879a8df02f5078e4cc9405e,What was the name of the diagnosis that patient 10038992 received for the first time during the first hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis.diagnosis_name FROM diagnosis WHERE diagnosis.patient_id = 10038992 AND NOT diagnosis.diagnosis_name IS NULL ORDER BY diagnosis.diagnosis_date NULLS FIRST LIMIT 1,
dc47e1e9c572da5b543bcf0e,"What are the five commonly taken specimens for patients that received excision of right internal mammary artery, percutaneous endoscopic approach previously within 2 months since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.date FROM (SELECT p.tissue, p.date FROM patients p WHERE p.tissue = 'right internal mammary artery, percutaneous endoscopic approach') AS t1 JOIN (SELECT specimen, date FROM excision_results WHERE date >= '2100-01-01') AS t2 ON t1.specimen = t2.specimen WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.specimen) AS t3 JOIN (SELECT specimen, COUNT(specimen) AS c FROM excision_results GROUP BY specimen) AS t4 ON t3.specimen = t4.specimen WHERE t4.c > 5",
e65b59a5ae495773129a972f,Calculate the number of patients who were in the neuro stepdown careunit in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT admissions.subject, careunits.careunit FROM admissions JOIN careunits ON admissions.careunit = careunits.careunit_id WHERE careunits.careunit = 'Neuro Stepdown' AND DATETIME(careunits.entry_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject, diagnoses.diagnosis_date FROM admissions JOIN diagnoses ON admissions.diagnosis_id = diagnoses.diagnosis_id WHERE diagnoses.diagnosis = 'NEURO STEPDOWN' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.subject = t2.subject WHERE t1.careunit = t2.careunit",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e7d455d2f4e0704722248c62,"Since 08/11/2100, when was the last input time for patient 10039997?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10039997 AND input_time >= '2008-11-21 00:00:00',[{'starttime': '2134-09-08 17:50:00'}]
ba92f2f766b9d7fdf7e30e5d,Which procedure was performed on patient 10016742 two or more times since 21 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT procedure, COUNT(procedure) FROM procedures WHERE patient = 10016742 AND date >= DATEADD(month, -21, CURRENT_DATE) GROUP BY procedure HAVING COUNT(procedure) >= 2",
05424dfd1bc74bf21ddc5688,What were the top five diagnoses most frequently diagnosed in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, COUNT(diagnosis) AS c FROM diagnoses GROUP BY diagnosis) AS t1 JOIN (SELECT diagnosis, COUNT(diagnosis) AS c FROM diagnoses GROUP BY diagnosis) AS t2 ON t1.diagnosis = t2.diagnosis ORDER BY c DESC LIMIT 5;",
99ae2a1c4797235aeeccbd8a,What is the number of patients who were prescribed bupivacaine 0.1% since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupivacaine 0.1%' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.identifier) FROM patient WHERE patient.prescriptions.bupivacaine_0.1% >= '2100',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4f7a1d19e6fadf0e7b619491,Has patient 10014354 visited an emergency room since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",SELECT COUNT(*) > 0 FROM visit_log WHERE patient_id = 10014354 AND emergency_room = 1 AND visit_date >= (CURRENT_DATE - INTERVAL '1 year'),[{'COUNT(*)>0': 0}]
7da9c0a5790b317cead06455,What was the drug that patient 10011398 was prescribed for the last time using a oral route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(drug_date) FROM prescriptions WHERE prescriptions.patient_id = 10011398 AND prescriptions.route = 'ORAL',[]
119d4b9159d345fd67da01be,Has there been any organism found in patient 10021118's last staph aureus swab microbiology test since 08/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*) > 0 FROM microbiology WHERE microbiology.patient_id = 10021118 AND microbiology.staph_aureus_swab = '08/2100',[{'COUNT(*)>0': 0}]
0468ce0daa5a2cba57e45350,What is the number of patients who were prescribed ramipril since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ramipril' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patienttype = 'prescribed' AND patient.startdate >= '2100-01-01' AND patient.startdate < '2100-01-01' AND patient.prescription = 'ramipril',[{'COUNT( DISTINCT admissions.subject_id )': 4}]
b7f15ad17e5a4047c43d42e6,When did patient 10018081 last receive a lab test for sodium since 10/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(Lab.Date) FROM Lab WHERE Lab.PatientId = 10018081 AND Lab.Result = 'Sodium' AND STRFTIME('%y-%m', Lab.Date) >= '2100-10'",[]
a087cf65a777e7f24185f1a9,Is the patient 10009049 a male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10009049,SELECT patients.gender FROM patients WHERE patients.id = 10009049,[{'gender': 'M'}]
4830ab94fb0c437406b08947,"Since 02/2100, when was patient 10021312's first microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM microbiology WHERE patient_id = 10021312 AND date >= '2002-2100-01',[{'charttime': '2113-08-16 16:22:00'}]
371d12824fa1ffd7ef5e90e7,What is the dose of the prescribed opioid for patient 99647??,,SELECT SUM(opioid_dose) FROM prescriptions WHERE prescriptions.patient_id = 99647,
97516d1ecb3c025c618fb0ef,Please count the hospital visits made by patient 10002930 in this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10002930 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(Hospital.Visit) FROM Hospital WHERE Hospital.Patient = 10002930 AND DATETIME(Hospital.Visit, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
942603b5dceccf0a7d2a31df,What is the number of patients who were discharged from the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,"SELECT COUNT(DISTINCT patient_id) FROM discharge_summary WHERE discharge_reason = 'DISC-TRAN CANCER/CHLDRN H""';",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
320d0d42e2bc3e896297a919,What is the white blood cells percentile of 11.6 among patients of the same age as patient 10004720 during their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.6","SELECT MAX(t1.c1) FROM (SELECT c1, c2 FROM patient 10004720 WHERE c2 = 11.6 AND patient.age = (SELECT patient.age FROM patient 10004720 WHERE patient.name = ' patient 10004720')) AS t1",
888e5315d7db699f3ac78093,What is the minimum total hospital cost that includes a drug named ciprofloxacin hcl?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin hcl' ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(t1.c1) FROM (SELECT SUM(ciprofloxacin_hcl) AS c1 FROM ciprofloxacin_hcl GROUP BY ciprofloxacin_hcl) AS t1,
a0e105397fe459f9ad540eef,What was the senna dose that patient 10021666 was last prescribed in 03/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'senna' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(brackets.senna) FROM brackets WHERE brackets.patient = 10021666 AND STRFTIME('%y-%m', brackets.date) = '2100-03'",[]
8c389720f8914eabd76867e2,What are the five most common prescriptions in 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.prescriptions FROM (SELECT prescriptions, COUNT(prescriptions) AS c FROM (SELECT patient.prescriptions FROM patient WHERE STRFTIME('%y', patient.date) = '2100') GROUP BY prescriptions) AS t1 ORDER BY c DESC LIMIT 5",[]
a975cd9e522a7abecfd9d1ff,What was patient 10001725's daily maximum weight this year?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10001725 AND date BETWEEN '2001-01-01' AND '2001-12-31' GROUP BY date;,[]
065b726dbf86eb804accd168,"For the last time since 02/2100, what was the drug that patient 10014078 was prescribed via iv drip route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.drug FROM prescriber WHERE prescriber.patient_id = 10014078 AND prescriber.route = 'iv drip' AND STRFTIME('%y-%m', prescriber.date) >= '2100-02' ORDER BY prescriber.date DESC LIMIT 1",[]
bb93faad71aaa3ed0164496c,What is the minimum total expenditure of a hospital that involves the medication potassium chl 20 meq / 1000 ml d5 1/2 ns?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5 1/2 ns' ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(expenditure) FROM (SELECT SUM(cost) AS expenditure FROM medication WHERE medication = 'potassium chl 20 meq / 1000 ml d5 1/2 ns' GROUP BY patient_id),
90c223d20a0599528657b6d3,What organism was found in patient 10001725's last urine test during their first hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism FROM urine_specimen WHERE patient_id = 10001725 AND NOT organism IS NULL ORDER BY organism DESC LIMIT 1;,[]
6fb281ee6d2d6ec101b35dc4,Show me the top three most frequent drugs that patients were prescribed within the same hospital visit after being diagnosed with hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) throughout this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (LUTS)' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, prescriptions.drug, prescriptions.prescription_date FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE DATETIME(prescriptions.prescription_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1",
5e120295af4004e7fa588d2f,What total amount of sarna lotion was prescribed to patient 10018501 during the first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'sarna lotion',SELECT SUM(drug_prescriptions.quantity) FROM drug_prescriptions WHERE drug_prescriptions.patient_id = 10018501 AND drug_prescriptions.drug_name = 'sarna lotion',[{'SUM(prescriptions.dose_val_rx)': None}]
e855fab09bf918229922f967,What was the drug that patient 10015860 was prescribed for during the same day after the procedure of other fasciectomy?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other fasciectomy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug FROM (SELECT patient.subject, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.subject WHERE patient.subject = 10015860 AND treatment.procedure = 'other fasciectomy') AS t1 JOIN (SELECT patient.subject, drug.name FROM drug JOIN patient ON drug.patient = patient.subject WHERE patient.subject = 10015860) AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day')",
2ba257c83dfd7776e8506244,"Throughout this year, what are the top five most common lab tests ordered for patients in the same hospital encounter after dysphagia, oropharyngeal phase?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, oropharyngeal phase' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS ""top_five"" FROM (SELECT t2.subject, t2.stay_from, t2.stay_to FROM (SELECT admissions.subject, diagnoses.stay_from, diagnoses.stay_to FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Dysphagia, oropharyngeal phase') AS t1 JOIN (SELECT admissions.subject, lab_test, stay_from, stay_to FROM lab_tests JOIN admissions ON lab_tests.admission_id = admissions.admission_id) AS t2 ON t1.subject = t2.subject WHERE t1.stay_from < t2.stay_from AND t1.stay_to > t2.stay_to) AS t3 GROUP BY t3.lab_test ORDER BY COUNT(*) DESC LIMIT 5",
bbe2b568ffdaf7c89fb508ab,How long did proximal gastrectomy take for patient 366?,,SELECT procedures.time FROM procedures WHERE procedures.patient = 366 AND procedures.procedure = 'proximal gastrectomy',
52b4c6302fbd18b90e270e93,How many patients were given single internal mammary-coronary artery bypass since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.mamcorartype = '1 int mam-cor art bypass' AND STRFTIME('%y', patient.mamcorartype) >= '2100'",
16efb111485f01232222a8c4,What was the duration of the packed cell transfusion procedure for patient 9566?,,SELECT SUM(duration) FROM procedures WHERE patient = 9566 AND procedure = 'Packed cell transfusion',
b6d9cd67e22e2ef748217cd1,"In patients who had the extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic since 2100, what were the four most common diagnoses that followed during the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' AND STRFTIME('%y', diagnosis.diagnosisdate) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE STRFTIME('%y', diagnosis.diagnosisdate) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.diagnosisdate AND DATETIME(t1.diagnosisdate, 'start of month') = DATETIME(t2.diagnosisdate, 'start of month",
12f5143349944b924783990d,Has there been a hospital admission for patient 10020740 since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020740 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM hospital_admissions WHERE admissions.subject_id = 10020740 AND DATETIME(admissions.admission_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 1}]
a978c41bf772b0328ae1c73e,Please tell me the exact prescriptions patient 4269 received from the other department.,,"SELECT prescriptions FROM (SELECT patient_id, prescriptions FROM other_department WHERE patient_id = 4269) AS subquery;",
e330c2e4df1717b019f638e1,"Tell me the average total hospital cost that includes personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits.","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.hospital_cost) FROM (SELECT SUM(hospital_cost) AS hospital_cost FROM (SELECT 1 AS diagnosis_1, 1 AS diagnosis_2, 1 AS diagnosis_3, 1 AS diagnosis_4, 1 AS diagnosis_5, 1 AS diagnosis_6, 1 AS diagnosis_7, 1 AS diagnosis_8, 1 AS diagnosis_9, 1 AS diagnosis_10, 1 AS diagnosis_11, 1 AS diagnosis_12 FROM (SELECT 1 AS tia_diagnosis, 1 AS cerebral_infarction_without_residual_deficits FROM (SELECT 1 AS personal_history_of_transient_ischemic_attack, 1 AS current_diagnosis FROM (VALUES (1), (1), (1), (1), (1), (1), (1), (1), (1), (1), (1), (1), (1), (1), (1), (1), (1), (1)) AS t(diagnosis_",
5238005ffc47bc3719f52f2a,"Calculate the number of patients who underwent a laboratory test for urea nitrogen, urine since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.labresult.urea_nitrogen, urine > DATEADD(year, -1, CURRENT_DATE)",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e7aa4b2720464fe5f689b5f0,When was the first hospital discharge time for patient 10035185?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10035185 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(hospital_dischtime) FROM hospital WHERE patient_id = 10035185,[{'dischtime': '2120-05-17 16:00:00'}]
982fb7efe92d6f33dcdb9848,What are the top five diagnoses associated with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t5.diagnosis, t5.months FROM (SELECT t4.diagnosis, t4.months FROM (SELECT t3.diagnosis, t3.months FROM (SELECT ""6-month"", ""12-month"", ""24-month"", ""36-month"", ""52-month"", ""68-month"", ""84-month"", ""100-month"", ""115-month"", ""130-month"", ""145-month"", ""160-month"", ""175-month"", ""200-month"", ""215-month"", ""230-month"", ""245-month"", NULL AS ""6-month"", NULL AS ""12-month"", NULL AS ""24-month"", NULL AS ""36-month"", NULL AS ""52-month"", NULL AS ""68-month"", NULL AS ""84-month"", NULL AS ""100-month"", NULL AS ""115-month"", NULL AS ""130-month"", NULL AS ""145-month"", NULL AS ""160-month",
3aab4c6e3c824c26d1f50ebe,What was the name of the output which patient 10029484 had for the last time since 04/06/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-06' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT OUTPUT_NAME FROM OUTPUT WHERE PATIENT_ID = 10029484 AND STRFTIME('%y-%m-%d', CURRENT_TIMESTAMP) >= '2100-04-06' ORDER BY CURRENT_TIMESTAMP DESC LIMIT 1",[{'label': 'Void'}]
f888fddd502f84dfdc3b3bcb,How many days has it been since the first time patient 10018081 stayed in their current hospital visit in the careunit trauma sicu (tsicu)?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1",SELECT COUNT(DISTINCT DATE) FROM patient WHERE patient.stay_length > 0 AND patient.subject_id = 10018081 AND patient.location = 'careunit trauma sicu (tsicu)',[]
5b78e15830003c4050414093,Was patient 10006053 diagnosed with anything during their first hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10006053 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
6a55f374b69cde6051e87af6,Was the hematocrit value of patient 10036156 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT hematocrit FROM measurements WHERE patient_id = 10036156 AND NOT visit_number IS NULL ORDER BY measurement_time DESC LIMIT 1) < (SELECT hematocrit FROM measurements WHERE patient_id = 10036156 AND NOT visit_number IS NULL ORDER BY measurement_time DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
36f1d4c5bd1c63cf74545e1f,What is the code in icd-11 for renal & ureteral dis nos in icd-10?,,SELECT icd_11 FROM icd_10 WHERE icd_10 = 'renal & ureteral dis NOS';,
8304664f47f63bb4e4aedbc5,Count the current patients who are in the 40s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT(DISTINCT j.subject) FROM job j WHERE j.status = 'current' AND j.subject.age BETWEEN 40 AND 49,
425e31a5bea537ada730003e,What was the last time patient 10005817 was prescribed medications via the ng route throughout this month?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.route = 'ng' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10005817 AND prescription_route = 'ng' AND date_prescribed >= DATEADD(month, -0, CURRENT_DATE)",[]
6d770f5dad11c867295ac4f0,How many hours has elapsed since the last time during their current hospital encounter patient 10018081 had received a specific gravity lab test?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_test_date)) as hours_since_last_lab_test",[]
1afcc723ae25dcbcaee4919e,When did patient 10018081 first get mrsa screen microbial tests in 12/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT patient.name, screening_date FROM patient WHERE patient.id = 10018081 AND screening_date BETWEEN DATEADD(month, -12, GETDATE()) AND DATEADD(month, -12, DATEADD(year, -0, GETDATE())) AND test_name = 'mrsa screen microbial' ORDER BY screening_date NULLS FIRST LIMIT 1",[]
0bf13d65d6a6c37aaf9ffd42,How many patients were administered divalproex (delayed release) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'divalproex (delayed release)' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patienttype = 'DIVALPROEX (DELAYED RELEASE)' AND STRFTIME('%y', patient.lastcontactdate) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
52ab9f0636d7c7efa44fbe81,"Since 2100, what were the top three most common specimens tested on patients during the same month after the diagnosis of polyneuropathy, unspecified?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, DATE_TRUNC('month', t2.diagnosis_date) AS diagnosis_month FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Polyneuropathy, unspecified') AS t1 JOIN (SELECT patient.name, specimen, diagnosis_date FROM specimen JOIN patient ON specimen.patient_id = patient.patient_id WHERE DATE_TRUNC('month', diagnosis_date) >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month') AS t2 ON t1.name = t2.name WHERE diagnosis_month = t2.diagnosis_month) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 3",
99a500fd67403f12fc30f8b6,What were the top five most frequent diagnoses that followed within 2 months for those patients who received diagnostic ultrasound of digestive system?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'diagnostic ultrasound of digestive system') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosistime FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.diagnosistime AND DATETIME(t2.diagnosistime) BETWEEN DATETIME(t1.treatmenttime) AND DATETIME(t1.treatmenttime, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 5",
a566581cd7454020e0914ed3,I would love to know the name of the diagnosis that patient 25763 received in the other department.,,SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 25763 AND diagnoses.location = 'other department',
538445bd77fd441ff8085f91,What was the first time during their last ICU stay patient 10022281 had a maximum systolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",SELECT MAX(systolic_blood_pressure) FROM (SELECT blood_pressure FROM icu WHERE icu.patient_id = 10022281 AND NOT icu.outgoing_date IS NULL ORDER BY icu.incoming_date DESC LIMIT 1) WHERE systolic_blood_pressure IS NOT NULL;,[]
a2cad7bd6649d8cc2f3b637d,"On the first hospital stay, did patient 10020187 visit an emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM visit WHERE visit.patient_id = 10020187 AND visit.location = 'emergency room admit' AND NOT visit.dischtime IS NULL ORDER BY visit.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
8fe4b6848aa995f8ab0554ae,"On the first hospital stay, did patient 10005817 undergo a single internal mammary-coronary artery bypass procedure?",SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) FROM treatment WHERE patient_id = 10005817 AND treatment_type = '1 int mam-cor art bypass',[{'COUNT(*)>0': 0}]
1153c548a9a77ae4687c8846,Can you provide the total number of outputs patient 10018845 had since 03/10/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-10'",SELECT COUNT(*) FROM outputs WHERE patient_id = 10018845 AND date >= '2100-03-10',[{'SUM(outputevents.value)': 2442.0}]
701c361638b72b18b59910b7,"Retrieve the top five most frequent procedures that patients were given during the same hospital encounter after receiving inspection of tracheobronchial tree, via natural or artificial opening endoscopic in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.Name FROM (SELECT t2.Name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.Name, treatment.treatment_time, patient.patient_id FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE treatment.treatment_time = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic') AS t1 JOIN (SELECT patient.Name, treatment.treatment_time, patient.patient_id FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE treatment.treatment_time = '2100') AS t2 ON t1.Name = t2.Name WHERE t1.treatment_time < t2.treatment_time AND t1.patient_id = t2.patient_id GROUP BY t2.Name) AS t3 WHERE t3.c1 <= 5",
11334e5323118eea80ce40d5,What were the top three most common procedures in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Name, COUNT(t1.Name) FROM (SELECT procedures.Name FROM procedures WHERE STRFTIME('%y', procedures.Date) = '2100') AS t1 JOIN transactions ON t1.Code = transactions.Procedure GROUP BY t1.Name ORDER BY COUNT(t1.Name) DESC LIMIT 3;",
30e8031670f0d3838d940ec4,What was the last time when patient 10006580 received a creatinine lab test since 03/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(lab_creatinine.timestamp) FROM lab_creatinine WHERE lab_creatinine.patient_id = 10006580 AND STRFTIME('%y-%m', lab_creatinine.timestamp) >= '2100-03'",[]
00249e27093cdde779012293,"Has docusate sodium (liquid), glucose gel, or heparin been prescribed since 2100 to patient 10036156?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug IN ( 'docusate sodium (liquid)', 'glucose gel', 'heparin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10036156 AND prescriptions.drug IN ('docusate sodium (liquid)', 'glucose gel', 'heparin') AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)>0': 0}]
5519ee451e8ab94af344b52d,What was the cost of the drug syringe (iso-osmotic dextrose)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'syringe (iso-osmotic dextrose)' ),SELECT DISTINCT cost FROM drugs WHERE drug = 'syringe (iso-osmotic dextrose)',
a3fbabc4125bd38ac2aed4db,Has patient 10039831 been given any drugs since 08/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'",SELECT COUNT(*) > 0 FROM medication_usage WHERE patient_id = 10039831 AND date_administered >= '2000-08-21',[{'COUNT(*)>0': 1}]
4a5bb0f951af309dfe062485,When was the last time patient 10021487 had input on this month/11?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '11' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_date) FROM input_table WHERE patient_id = 10021487 AND input_date >= '2022-04-01' AND input_date < '2022-05-01',[]
58be20bc10780428cb236a2e,What are the precautions to take after the opn/oth rep mtrl vlv-tis procedure?,,SELECT precautions FROM procedures WHERE procedure = 'OPN/OTH REP MATERIALIZATION VLV-TIS';,
171a187b546228165ca60f92,"The first time , when was patient 10004720 prescribed insulin and artificial tear ointment at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10004720 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'artificial tear ointment' AND admissions.subject_id = 10004720 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT t1.timestamp FROM (SELECT patient.date_prescribed, patient.patient_id FROM patient WHERE patient.patient_id = 10004720 AND patient.date_prescribed IS NOT NULL) AS t1 JOIN (SELECT patient.date_prescribed, patient.patient_id FROM patient WHERE patient.patient_id = 10004720 AND patient.date_prescribed IS NOT NULL) AS t2 ON t1.patient_id = t2.patient_id WHERE DATETIME(t1.timestamp) = DATETIME(t2.timestamp) ORDER BY t1.timestamp NULLS FIRST LIMIT 1",[]
ef47010e396a58191a716c15,Show me the top three most commonly prescribed drugs since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.drug, COUNT(t1.drug) FROM (SELECT prescriber.drug FROM prescriber WHERE DATETIME(prescriber.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT prescriber.drug FROM prescriber WHERE DATETIME(prescriber.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.drug = t2.drug GROUP BY t1.drug ORDER BY COUNT(t1.drug) DESC LIMIT 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]"
a61a197e35f3b625c9540a0a,"In 2100, what are the top four most common specimens tested for patients previously diagnosed with obstructive chronic bronchitis with (acute) exacerbation within 2 months?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'obstructive chronic bronchitis with (acute) exacerbation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, DATE_DIFF('CREATIONDATE', t2.diagnosisdate, month) AS days FROM (SELECT t1.subjectid, t1.diagnosisdate, t2.specimen FROM (SELECT patient.subjectid, diagnosis.diagnosisdate, patient.specimen FROM diagnosis JOIN patient ON diagnosis.patientid = patient.subjectid WHERE diagnosis.diagnosis = 'obstructive chronic bronchitis with (acute) exacerbation') AS t1 JOIN (SELECT patient.subjectid, diagnosis.diagnosisdate, patient.specimen FROM diagnosis JOIN patient ON diagnosis.patientid = patient.subjectid WHERE diagnosis.diagnosis = 'obstructive chronic bronchitis with (acute) exacerbation') AS t2 ON t1.subjectid = t2.subjectid WHERE t1.diagnosisdate < t2.diagnosisdate AND DATE_DIFF('CREATIONDATE', t1.diagnosisdate, month) BETWEEN 2 AND",
6a8ea90422439952b0b95d0a,How many medications were prescribed since 27 months ago to patient 10027445?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-27 month')","SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10027445 AND date_prescribed >= DATEADD(month, -27, CURRENT_DATE);",[{'COUNT(*)': 230}]
0293a5acee37151a49ceaa8a,Has any dextrose 50% been given to patient 10016742 since 20 months ago?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-20 month')",SELECT COUNT(*) > 0 FROM inventory WHERE item = 'dextrose 50%' AND patient = 10016742 AND date >= CURRENT_DATE - INTERVAL '20 month',[{'COUNT(*)>0': 0}]
b60fe48723590c9d8172f6c7,Tell me the time when patient 10020187's mean blood pressure was less than 91.0 for the first time on 02/03/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 91.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-03' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT TIME FROM patient_10020187 WHERE mean_blood_pressure < 91.0 AND DATETIME(12, '02/03/2022') = 1",[]
93e00f471a0dcb56dfb1ea6e,Tell me the yearly maximum amount of patient 10014354's nacl 0.9% input.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",SELECT MAX(amount) FROM inputs WHERE patient_id = 10014354 AND input_type = 'nacl 0.9%' GROUP BY year;,[]
d4ffd536638a0b500dea5e1d,What was the name of the drug patient 10017492 was prescribed within the same hospital visit after having received a spinal tap procedure in 03/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.name FROM (SELECT patient.name, treatment.date, patient.patient_id FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE patient.patient_id = 10017492 AND treatment.type = 'spinal tap') AS t1 JOIN (SELECT patient.name, drug.name, drug.date, patient.patient_id FROM drug JOIN patient ON drug.patient_id = patient.patient_id WHERE patient.patient_id = 10017492) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month')",
5c3f52d548353aad5447d804,"On this month/04, what was the last heart rate reading for patient 10004720?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '04' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM patient_heart_rate WHERE patient_id = 10004720 AND measurement_date = CURRENT_DATE - INTERVAL '04 month',[]
05d218c03d4f3db81a54165a,Could you tell me how many patients stayed in the medical/surgical intensive care unit (micu/sicu) careunit since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient_id) FROM intensive_care_unit WHERE unit_type = 'medical/surgical intensive care unit (micu/sicu)' AND DATETIME(unit_admission_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
5a4d87a7bd80bc03275287c6,"Tell me the top four most frequent procedures that patients were given within 2 months after receiving excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic since 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.technique, COUNT(t3.technique) FROM (SELECT t2.technique, COUNT(t2.technique) FROM (SELECT patient.uniquepatid, treatment.treatdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepatid WHERE treatment.treatment = 'Excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' AND STRFTIME('%y', treatment.treatdate) >= '2100') AS t1 JOIN (SELECT patient.uniquepatid, treatment.technique, treatment.treatdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepatid WHERE STRFTIME('%y', treatment.treatdate) >= '2100') AS t2 ON t1.uniquepatid = t2.uniquepatid WHERE t1.treatdate < t2.treatdate AND DATETIME(t2.treatdate) BETWEEN DATETIME(t1.treatdate) AND DATETIME(t1.treatdate, '+2 month') GROUP BY t2",
1089bbe66e821577636739ae,"In the last hospital encounter was readi-cat 2 (barium sulfate 2% suspension), glipizide xl, or sodium chloride 0.9% prescribed for patient 10029484?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'readi-cat 2 (barium sulfate 2% suspension)', 'glipizide xl', 'sodium chloride 0.9%' )","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10029484 AND medication.drug IN ('readi-cat 2 (barium sulfate 2% suspension)', 'glipizide xl', 'sodium chloride 0.9%') AND NOT medication.drug LIKE '%eye%' AND medication.hospital_sequence_number = (SELECT MAX(hospital_sequence_number) FROM medication WHERE medication.patient_id = 10029484 AND NOT medication.drug LIKE '%eye%')",[{'COUNT(*)>0': 0}]
3280dd533a7cef123247bde5,When did the last hospital discharge of patient 10004720 occur?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_discharge_date) FROM patient WHERE patient.subject_id = 10004720,[{'dischtime': '2186-11-17 18:30:00'}]
1286e054ab8b363bfd212296,How many days have elapsed since the last time patient 10021487 was diagnosed with other iatrogenic hypotension during this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosed_date)) FROM diagnoses WHERE diagnoses.patient_id = 10021487 AND diagnoses.diagnosis = 'other iatrogenic hypotension' AND diagnoses.dischtime IS NULL;",
292e05db320f21dac9efa68e,When was the first time that patient 10038081 since 136 days ago had a respiratory rate that was less than 14.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 14.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-136 day') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(RespiratoryRate) FROM (,[]
4e62b0e57830a46896da0604,Reveal the four most frequently prescribed medications since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.name FROM (SELECT medication.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM medication WHERE DATETIME(medication.last_prescribed) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY medication.name) AS t1 WHERE t1.c1 <= 4;","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]"
067417d484687c9d57f7dfcd,What is the procedure that patient 10029291 received two times in 03/this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT COUNT(DISTINCT t1.date) FROM (SELECT patient.date FROM patient WHERE patient.patient_id = 10029291) AS t1 JOIN (SELECT patient.date FROM patient WHERE patient.patient_id = 10029291) AS t2 ON t1.date = t2.date WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of year') = DATETIME(t2.date, 'start of year') AND STRFTIME('%m', t1.date) = '03'",
03cdbce2386e1c8684bf2a13,What were the four most frequent lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.lab_test, COUNT(t.lab_test) FROM lab_tests t WHERE t.year >= 2100 GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
b7d1939430a21c6f12cd36da,How many ampicillin-sulbactam prescriptions occurred in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ampicillin-sulbactam' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Ampicillin-Sulbactam' AND STRFTIME('%y', prescriptions.date) = '2100';",[{'COUNT(*)': 0}]
5c5d5137fe45b2eb60a11cc5,What were the top four most common diagnoses that followed within 2 months for those who received enteral infusion of concentrated nutritional substances in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT diagnosis, COUNT FROM (SELECT patient.identifier, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.identifier WHERE treatment.treatment_type = 'enteral infusion of concentrated nutritional substances' AND STRFTIME('%y', treatment.date) = '2100') AS t1 JOIN (SELECT patient.identifier, diagnosis, DATEADD(month, DATE_DIFF('month', 0, DATE), 0) AS date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.identifier WHERE STRFTIME('%y', diagnosis.date) = '2100') AS t2 ON t1.patient.identifier = t2.patient.identifier WHERE t1.date < t2.date AND DATE_DIFF('month', t1.date, t2.date) BETWEEN 2 AND 2 GROUP BY diagnosis ORDER BY COUNT DESC LIMIT 4",
0eb69f6e47ab63c055e2df90,Was patient 10038081 treated with percutaneous abdominal drainage on the first hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10038081 AND diagnoses.treatment_type = 'percutaneous abdominal drainage' AND NOT diagnoses.date IS NULL ORDER BY diagnoses.date NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
742320113523a87f95b0f270,Can you tell me the name of the last output of patient 10018845 since 10/02/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-02' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT name FROM outputs WHERE patient = 10018845 AND output_date >= '2100-10-02' ORDER BY output_date DESC LIMIT 1,[{'label': 'Foley'}]
ef58c8f426926b9b7c5610fc,"List the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving respiratory ventilation, greater than 96 consecutive hours.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.name WHERE treatment.treatment = 'Respiratory ventilation, greater than 96 consecutive hours') AS t1 JOIN (SELECT patient.name, diagnosis.diagnosis, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.name) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 3",
339bd7b7cb9460146cc1f5a0,What is the percentile ranking of a glucose test value of 176.0 for patients of the same age as patient 10038992 on the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 176.0","SELECT MIN(Ranking) FROM (SELECT 10038992 AS Patient, 176.0 AS Glucose FROM patients WHERE patients.age = (SELECT patients.age FROM patients WHERE patients.name = 'patient10038992' AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime DESC LIMIT 1)) AS subquery;",
3d262da4f3ade06a2f6f3db1,"What is the maximum total cost of hospitalization that includes the glucose, ascites laboratory test since 1 year ago?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.total_cost) FROM (SELECT SUM(cost) AS total_cost FROM cost_table WHERE cost_table.glucose = '1' AND cost_table.ascites = '1' AND DATETIME(cost_table.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY cost_table.glucose, cost_table.ascites) AS t1",
ddf32de215f19f42c2a8ddf6,Calculate patient 10007928's total amount of foley output on 04/14/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-14'",SELECT SUM(foley) FROM output WHERE patient = 10007928 AND date = '2100-04-14',[{'SUM(outputevents.value)': None}]
7de6019246eb50aa7a443936,What was the amount of fluticasone-salmeterol diskus (100/50) prescribed to patient 10021666 in total in 03/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'fluticasone-salmeterol diskus (100/50)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'",SELECT SUM(fluticasone-salmeterol diskus (100/50)) FROM patients WHERE patient_id = 10021666 AND date_prescribed BETWEEN '2003-01-01' AND '2003-12-31',[{'SUM(prescriptions.dose_val_rx)': None}]
7acfb197a239ef58e7f08525,When patient 9619 is scheduled for the earliest hospital visit?,,SELECT MIN(hospital_visits) FROM patients WHERE patient_id = 9619,
df0baa783ad628147be24b1a,"When, during their last ICU stay, was patient 10002495's respiratory rate measured greater than 21.0 for the first time?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 21.0 ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT STRFTIME('%Y-%m-%d %H:%M:%S', ICU_MEASUREMENT.MEASUREMENT_TIME) FROM ICU_MEASUREMENT WHERE ICU_MEASUREMENT.PATIENT_ID = 10002495 AND ICU_MEASUREMENT.MEASUREMENT_TYPE = 'respiratory rate' AND CAST(ICU_MEASUREMENT.MEASUREMENT_VALUE AS DOUBLE) > 21.0 ORDER BY ICU_MEASUREMENT.MEASUREMENT_TIME NULLS FIRST LIMIT 1;",[]
fa4ebfb881b70db087e81779,Has patient 10008454 got a lymphocytes laboratory test in 12/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'","SELECT COUNT(*) > 0 FROM lab WHERE lab.patient_id = 10008454 AND lab.lab_name = 'lymphocytes' AND STRFTIME('%y-%m', lab.sample_date) = '2100-12'",[{'COUNT(*)>0': 0}]
72be988adaa416d79f2d4060,What was patient 10009628's heart rate for the first time during their last ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT STRFTIME('%m-%d %H:%M:%S', patient.heart_rate) AS heart_rate_first_time",[]
ae87fc8fc5ccf8578f0ec36c,"What is the cost of introduction of nutritional substance into upper gi, via natural or artificial opening?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) )","SELECT DISTINCT cost FROM inventory WHERE item = 'Introduction of nutritional substance into upper gi, via natural or artificial opening'",
5661fb129ea343e46075bab5,Tell me the type of blood of patient 31854?,,SELECT MIN(BloodType) FROM patients WHERE PatientID = 31854,
38e2f42ebf3b484fd618abc2,Does patient 54386 have any overseas experience?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 54386 AND patients.overseas_experience = 'Yes',
21516330871ebef6b95137ea,Show me the top three most frequent events that took place in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT Event, COUNT(Event) FROM events WHERE Year = 2100 GROUP BY Event ORDER BY COUNT(Event) DESC LIMIT 3;",[]
462cd9e5980b86409d6557d8,What was the name of the medication that patient 10024043 was first prescribed in 04/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT medication.name FROM medication WHERE medication.patient_id = 10024043 AND STRFTIME('%y-%m', medication.date) = '2100-04' ORDER BY medication.date NULLS FIRST LIMIT 1",[]
ee04db0976616af28ba6a8a5,Can I know the total output amount for patient 10014078 since 172 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-172 day')",SELECT SUM(output_amount) FROM output_table WHERE patient_id = 10014078 AND output_date >= CURRENT_DATE - INTERVAL '172' DAY,[{'SUM(outputevents.value)': 9445.0}]
4b2e4f08510d69ad89b581ce,What percentile is the alkaline phosphatase value of 129.0 in the same age group as patient 10003046 during the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 129.0","SELECT STRFTIME('%y-%m-%d', patient.hospital_age(patient.age, patient.hospital_age(10003046, 'last encounter')) as enc_age,",
d165a95f794e3d301e6f6179,Give me the top three most commonly prescribed medications within 2 months to patients aged 60 or above after they were diagnosed with hypoxemia since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypoxemia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.id WHERE diagnosis.diagnosis = 'hypoxemia' AND STRFTIME('%y', diagnosis.date) >= '2100') AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient = patient.id WHERE patient.age >= 60 AND STRFTIME('%y', medication.date) >= '2100') AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 3",
515fbb81432c9872301c377a,Which drug was the last one prescribed for patient 10007818 in 07/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10007818 AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '07' ORDER BY prescriptions.date DESC LIMIT 1;",[]
b77757e9df39efd72596255e,What are the average monthly number of patients diagnosed with malignant neoplasm of unspecified part of unspecified bronchus or lung in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT AVG(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis_date) AS c1 FROM diagnoses WHERE diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND malignant_neoplasm = 'unspecified part of unspecified bronchus or lung' GROUP BY EXTRACT(MONTH FROM diagnosis_date)) AS t1,
40e1b2eb72eb67d84b772be6,What was the total guaifenesin-dextromethorphan dose that has been prescribed in 08/this year to patient 10021312?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'guaifenesin-dextromethorphan' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08'","SELECT SUM(guaifenesin_dextromethorphan) FROM pharmacy WHERE pharmacy.patient_id = 10021312 AND DATETIME(pharmacy.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND DATETIME(pharmacy.date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month');",[{'SUM(prescriptions.dose_val_rx)': None}]
486691bb6da24ab4f1918724,Tell me the first output of patient 10015860 since 06/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT 1 AS st_output FROM patients WHERE patient_id = 10015860 AND st_date >= '2100-06-05',[{'label': 'Void'}]
c04f16fa062bc81f8c917962,When did patient 10010471 first take the microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,"SELECT patient.name, microbiology.date FROM patient JOIN microbiology ON patient.patient_id = microbiology.patient_id WHERE patient.patient_id = 10010471 ORDER BY microbiology.date NULLS FIRST LIMIT 1",[{'charttime': '2155-12-03 19:58:00'}]
7b14cdcd4cf8cd3ffdc02db7,Can you tell me how much fentanyl patch costs?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl patch' ),SELECT DISTINCT cost FROM products WHERE name = 'fentanyl patch',
129e758237d6a21a110b1f7c,What is the ward id that patient 3929 can be admitted?,,SELECT ward_id FROM patient WHERE patient_id = 3929;,
d44b7e9b8f15bdcd053d65f3,"Since 2100, how often was excision of left saphenous vein, percutaneous endoscopic approach done?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.name = 'excision of left saphenous vein, percutaneous endoscopic approach' AND STRFTIME('%y', procedures.date) >= '2100'",
722cbb6c7cc7ed4d2c24e87d,"What were the top three most frequent specimens ordered for patients after being diagnosed with renal sclerosis, unspecified in the same hospital encounter since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'renal sclerosis, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t2.specimen, t2.diagnosis_date, t1.patient_id FROM (SELECT patient_id, diagnosis_date FROM renal_sclerosis WHERE diagnosis_date IS NOT NULL) AS t1 JOIN (SELECT patient_id, specimen, diagnosis_date FROM patients WHERE diagnosis_date IS NOT NULL) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date) >= DATETIME('2100-01-01', '-0 year') GROUP BY t2.specimen) AS t3 WHERE t3.diagnosis_date >= DATETIME('2100-01-01', '-0 year') GROUP BY t3.specimen ORDER BY c1 NULLS FIRST LIMIT 3",
db2e74ae7eb32d3ddbdbe8b2,How much does patient 10005817 weigh based on the last measurement since 07/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT COUNT(DISTINCT patient.weight) FROM patient WHERE patient.patient_id = 10005817 AND STRFTIME('%y-%m', patient.weight_date) >= '2100-07'",[]
e1c93dd5e81567e826a17f47,"Since 2100, what are the top five most common microbiology tests that patients were diagnosed with after the diagnosis of noncompliance with renal dialysis in the same hospital encounter?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_location FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Noncompliance with renal dialysis' AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100') AS t1 JOIN (SELECT admissions.subject_id, microbiology.test_name, microbiology.diagnosis_date, admissions.admission_location FROM microbiology JOIN admissions ON microbiology.admission_id = admissions.admission_id WHERE STRFTIME('%y', microbiology.diagnosis_date) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND t1.admission",
edcb877560f680ecc90bffc6,Can you tell me the last recorded weight for patient 10007928 since 19 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT last_recorded_weight FROM patients WHERE patient_id = 10007928 AND DATETIME(weight_date) >= DATETIME(CURRENT_TIME, '-19 month')",[]
232cc5cdd5e1b965d61da342,What is the total number of patients who were discharged from the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissed_date IS NULL AND DATETIME(dismissed_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
6699dac0cf704c408038528e,"Has patient 10019777 received a venous catheterization, not elsewhere classified treatment since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM treatment WHERE treatment.patient = 10019777 AND treatment.treatment = 'venous catheterization, not elsewhere classified' AND STRFTIME('%y', treatment.treatment_date) >= '2100'",
1aa433cdad6f6e1610a4c24f,Tell me the top five most frequent lab tests that patients were given in the same hospital visit after being diagnosed with personal history of pulmonary embolism.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of pulmonary embolism' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3. lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.name, diagnosis.diagnosis_date, patient.age FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Personal history of pulmonary embolism') AS t1 JOIN (SELECT patient.name, lab_test, lab_test_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.patient_id) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.lab_test_date AND DATETIME(t1.diagnosis_date, 'start of day') = DATETIME(t2.lab_test_date, 'start of day') GROUP BY t2.lab_test) AS t3 JOIN (SELECT patient.name, lab_test, lab_test_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.patient_id",
5c0ef35bdd581b7068ef254e,"What was the last time in 11/2100 patient 10006053 had the minimum potassium, whole blood value?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MIN(potassium) FROM read_potassium('11/2100 patient 10006053') WHERE potassium IS NOT NULL;,[]
6c0364360a42833597617b98,What was the name of the organism found in patient 10027602's first sputum microbiology test since 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10027602 AND sputum_microbiology_date > '2000-05-2100' ORDER BY sputum_microbiology_date NULLS FIRST LIMIT 1,[]
366c5a5077a210313a50c552,Get me the top four most frequent drugs that patients were prescribed within 2 months after being diagnosed with esophageal reflux since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t4.drug FROM (SELECT t3.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'Esophageal reflux' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, prescription.drug, prescription.prescription_date FROM prescription JOIN patient ON prescription.patient_id = patient.uniquepid WHERE STRFTIME('%y', prescription.prescription_date) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.prescription_date AND DATETIME(t2.prescription_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month')",
cd05e6424347ce699cf7b7cd,Quantify the number of patients who were tested since 1 year ago for absolute lymphocyte count.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute lymphocyte count' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.has_data AND DATETIME(patient.data_date) >= DATETIME(CURRENT_DATE, '-1 year') AND patient.data_name = 'absolute lymphocyte count'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
45e27a5adb524da103b1963d,When was the first time that patient 10027602 had the maximum red blood cells value in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT MAX(Red Blood Cells) FROM patient WHERE Patient.ID = 10027602 AND DATETIME(Red Blood Cells, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND DATETIME(Red Blood Cells, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month') GROUP BY STRFTIME('%y-%m', Red Blood Cells, 'start of year') STRFTIME('%y-%m', Red Blood Cells, 'start of month') ORDER BY Red Blood Cells DESC LIMIT 1",[]
070f868f0ab84f4ec3f3982b,Does patient 69895 have a genetic test that they got?,,SELECT EXISTS (SELECT * FROM genetic_test WHERE genetic_test.patient_id = 69895);,
2ce2c777d5cf2c8bf9c60de2,How many insertion of drug-eluting coronary artery stent(s) treatments were executed since 1 year ago?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.treatment = 'Insertion of drug-eluting coronary artery stent(s)' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year');",
5da552e4bce7844817e8e4ec,When was patient 10026406's last discharge from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10026406 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT patient.dischtime FROM patient WHERE patient.subject = '10026406';,[{'dischtime': '2133-03-04 17:05:00'}]
bc8f51d9cc16b51ab2a55aaa,Count the number of patients who had their uric acid tested.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'uric acid' ) ),SELECT COUNT(DISTINCT patient_id) FROM results WHERE lab_name = 'uric acid',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
6408991bd45a8b1bed727d8d,What is the daily minimum input of or packed rbc intake that patient 10005817 is getting since 11/2100?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or packed rbc intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT MIN(input_intake) FROM intake WHERE intake_category = 'or packed rbc' AND patient_id = 10005817 AND date_input >= '11/2100' GROUP BY date_input,[]
75dcf661ef83b60c79a0aa34,Is the respiratory rate reading for patient 10026406 last measured on the first ICU visit less than the value second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT respiratory_rate FROM (SELECT * FROM icu WHERE icu.patient_id = 10026406 ORDER BY icu.admittime NULLS FIRST LIMIT 1) AS first_icu WHERE respiratory_rate IS NOT NULL ORDER BY respiratory_rate DESC LIMIT 1) < (SELECT respiratory_rate FROM (SELECT * FROM icu WHERE icu.patient_id = 10026406 ORDER BY icu.admittime NULLS FIRST LIMIT 1) AS first_icu WHERE respiratory_rate IS NOT NULL ORDER BY respiratory_rate DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
f4d88d6b65c3f2fef3bf62c5,"How many times, in the previous year, was a coronary arteriography using two catheters procedure ordered?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'Coronary arteriography using two catheters' AND DATETIME(procedures.order_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",
aeeff9dc3dd3312a35c0af6c,Did patient 10015860 have a lab test last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10015860 AND DATETIME(lab_results.result_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT(*)>0': 0}]
23a4576cc256bed45465d6f4,What is the code that corresponds in icd-10 to icd-11 for delirium d/t other cond?,,SELECT icd_10 FROM icd_11 WHERE icd_11 = 'DELIRIUM D/T OTHER COND';,
1ba68173e9103374da571bcf,What was patient 10018423's insurance name on their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance_name FROM patient WHERE patient.patient_id = 10018423 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1,[{'insurance': 'Other'}]
2fe3354da7c1d59bea4dda70,How much is the cost for the drug sodium chloride 3% inhalation soln?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium chloride 3% inhalation soln' ),SELECT DISTINCT cost FROM drugs WHERE drug_name = 'Sodium Chloride 3% Inhalation Soln';,
157b31fa4605dab06049c427,Have any diagnoses been made for patient 10038081 on the last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10038081 AND diagnoses.hospital_visit_number = (SELECT COUNT(DISTINCT diagnoses.hospital_visit_number) FROM diagnoses WHERE diagnoses.patient_id = 10038081 ORDER BY diagnoses.hospital_visit_number DESC LIMIT 1),[{'COUNT(*)>0': 1}]
3ca5f7f58238739a39418242,What was the last time patient 10012552 has had the minimum mean blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MAX(mean_blood_pressure) FROM patient WHERE patient_id = 10012552,[]
52d67bef474996c117256e92,What is the percentile of the mchc value of 34.3 among patients of the same age as patient 10017492 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.3",SELECT percent_rank() OVER (ORDER BY mchc NULLS FIRST) FROM patients WHERE age = (SELECT age FROM patients WHERE patient_id = 10017492 AND NOT last_hospital_dischtime IS NULL ORDER BY age DESC LIMIT 1) AND mchc = 34.3,
b8f6fd0f9b950b22019dc5f9,How many hours have elapsed since patient 10021487's first stay in the careunit trauma sicu (tsicu) during their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.first_stay_date)) FROM patient WHERE patient.subject_id = 10021487 AND patient.dischtime IS NULL AND patient.first_stay_date IS NOT NULL AND patient.location = 'careunit trauma sicu (tsicu)'",[]
0186746594c1cf90e38d4ffd,Has patient 10006053 had a lab test for basophils since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',labevents.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10006053 AND lab_data.lab_name = 'basophils' AND STRFTIME('%y', lab_data.date) >= '2100'",[{'COUNT(*)>0': 0}]
224fe50640fe06e9fd64e1cd,Tell me the name of the last specimen test patient 10014354 had received since 10/2100.,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT name FROM patients WHERE patient_id = 10014354 AND date_last_specimen_test >= '10/2100',[{'spec_type_desc': 'BLOOD CULTURE'}]
30444a0364fc39ff849021b5,Calculate the number of ICU visits for patient 10004720 in the last hospital encounter.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT SUM(ICU_visits) FROM (SELECT ICU_visits FROM visit_table WHERE patient_id = 10004720 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime DESC LIMIT 1),[{'COUNT( DISTINCT icustays.stay_id )': 1}]
1f6fb1acb94a920e308918de,Can you point to a genetic test that patient 28447 received?,,SELECT genetic_test FROM genetic_tests WHERE patient_id = 28447,
96550da61d7335c3ccc3d5d0,What is the cost for a drug named lidocaine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine' ),SELECT COUNT(DISTINCT cost) FROM drugs WHERE drug_name = 'lidocaine',
e530d92c14e1178895ca7c89,When was the last time that patient 10020740 has been prescribed lidocaine 1% and heparin flush (10 units/ml) at the same time in 04/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 1%' AND admissions.subject_id = 10020740 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (10 units/ml)' AND admissions.subject_id = 10020740 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(DATE '2002-04-01') FROM patient WHERE patient.patient_id = 10020740 AND patient.prescriptions.drug_name = 'Lidocaine 1%' AND patient.prescriptions.start_date = DATE '2002-04-01' AND patient.prescriptions.drug_name = 'Heparin Flush (10 units/ml)',[]
d4cc44e155d21e53108993c3,Has patient 10027602 received any insertion or replacement of external ventricular drain [evd] treatment?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ),,[{'COUNT(*)>0': 0}]
55f8f1cd25a1f682cc88512b,What is the price for the drug cyanocobalamin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' ),,
c9fe1f1b8ec77f4a772615c7,"What was the last time, on the last ICU stay, that patient 10025612's heart rate was greater than 75.0?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 75.0 ORDER BY chartevents.charttime DESC LIMIT 1,"SELECT STRFTIME('%Y-%m-%d %H:%M:%S', patient.heart_rate) AS heart_rate_time",[]
ea10182ca02a264d05d0a0c6,Tell me the total 0.9% sodium chloride dose that patient 10001217 has been prescribed during their first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = '0.9% sodium chloride',SELECT COUNT(0.9) % sodium chloride FROM patients WHERE patient_id = 10001217 AND NOT patients.first_hospital_visit IS NULL,[{'SUM(prescriptions.dose_val_rx)': None}]
76de61af821cbfa636cc92fe,Calculate the total quantity of output of patient 10018081 since 12/12/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-12'","SELECT SUM(output.quantity) FROM output WHERE output.patient_id = 10018081 AND STRFTIME('%y-%m-%d', output.since) >= '2100-12-12'",[{'SUM(outputevents.value)': 66945.0}]
bae75ab280f0f80ba298c0cb,Patient 10037928's age on their last hospital encounter was what?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT SUM(brackets.age) FROM patients WHERE patients.patient_id = 10037928 AND NOT patients.dischtime IS NULL ORDER BY patients.admittime DESC LIMIT 1,
9906ee00ac2183b7e809821c,List the top four most frequently prescribed medications since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.name FROM (SELECT prescriber.name, COUNT(prescriber.name) AS cnt FROM prescriber INNER JOIN medicine ON prescriber.medicine = medicine.name WHERE STRFTIME('%y', medicine.first_seen) >= '2100' GROUP BY prescriber.name) AS t1 WHERE t1.cnt >= (SELECT MIN(cnt) FROM (SELECT prescriber.name, COUNT(prescriber.name) AS cnt FROM prescriber INNER JOIN medicine ON prescriber.medicine = medicine.name WHERE STRFTIME('%y', medicine.first_seen) >= '2100' GROUP BY prescriber.name) AS t2) ORDER BY cnt DESC LIMIT 4;","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]"
7f24de340048d1b87aca545d,What is the total number of hospitalized patients now?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE hospitalized = true;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
34586824e9cd0af359187e34,When are dr. williams's rounds and procedures?,,"SELECT dr.williams.rounds, dr.williams.procedures FROM dual;",
0cd28c037e9d62e1fe5d608a,List the top five most common diagnoses in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT diagnosis FROM diagnoses WHERE year = 2100 GROUP BY diagnosis) AS t1 JOIN (SELECT diagnosis FROM diagnoses WHERE year = 2100 GROUP BY diagnosis) AS t2 ON t1.diagnosis = t2.diagnosis ORDER BY COUNT(t1.diagnosis) DESC LIMIT 5;",
f335eed9cf01ee1b0747a75a,Tell me what the top five most common diagnoses of patients with an age of 30s since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, COUNT(diagnosis) AS c FROM postgres_scan('', 'public', 'patients') WHERE age BETWEEN 30 AND 39 AND date_diff('year', current_date, age_date) >= 1 GROUP BY diagnosis) AS t1 ORDER BY c DESC LIMIT 5",
1ada788cf4c8e059533b5f04,"Since 2100, how many patients had been diagnosed with alcohol dependence, in remission?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.type = 'alcohol dependence' AND STRFTIME('%y', diagnosis.date) >= '2100') AS t1 JOIN (SELECT patient.subject_id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.type = 'alcohol dependence' AND STRFTIME('%y', diagnosis.date) >= '2100' AND diagnosis.status = 'in remission') AS t2 ON t1.subject_id = t2.subject_id",
94565cd9b8a667a9b65034a4,I am curious what the protocols for the drugs that work to treat cancer.,,SELECT DISTINCT protocol FROM drugs WHERE indication = 'treat cancer';,
e99894fa240f028ed3221457,How many patients were diagnosed in 2100 with pericardial effusion (noninflammatory)?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pericardial effusion (noninflammatory)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.diagnosis = '2100 pericardial effusion (noninflammatory)',
6af5326ec076b32f85b4e657,How much is the cost of the encounter for palliative care diagnosing?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) ),SELECT DISTINCT cost FROM diagnosis WHERE diagnosis_name = 'palliative care';,
b8fc22b947af56744b197ad0,Has patient 10022041 been admitted into the hospital throughout this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM patient WHERE patient.subject_id = 10022041 AND DATETIME(patient.admittime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
037d3be256bd398ee1db08ce,What's the cost of a drug known as clonazepam?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clonazepam' ),SELECT DISTINCT cost FROM drugs WHERE drug_name = 'Clonazepam';,
fd5726998d426a2fdca616fc,"Fetch the top three most frequent procedures that were administered to patients within 2 months after they had ileostomy, not otherwise specified.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.procedure FROM (SELECT t2.procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.subject) AS t1 JOIN (SELECT patient.subject, procedure.procedure, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.subject) AS t2 ON t1.subject = t2.subject WHERE t1.treatment_date < t2.treatment_date AND DATETIME(t2.treatment_date) BETWEEN DATETIME(t1.treatment_date) AND DATETIME(t1.treatment_date, '+2 month') GROUP BY t2.procedure) AS t3 WHERE t3.c1 <= 3",
13540fd048d7adb5f077165f,"Do you know the maximum total protein, ascites value of patient 10006053?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, ascites' )",SELECT MAX(tot_protein_ascites) FROM patients WHERE patient_id = 10006053;,[{'MAX(labevents.valuenum)': None}]
42fb2b34ffcff69466b09384,What was the admission type during patient 10007795's last entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10007795 ORDER BY admissions.admittime DESC LIMIT 1;,[]
987c9d2214cdf8dd1eff384d,How much ciprofloxacin iv had been prescribed to patient 10018081 in total since 11/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.drug = 'ciprofloxacin iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'",SELECT COUNT(*) FROM patients WHERE patients.id = 10018081 AND patients.ciprofloxacin_iv >= '11/2100',[{'SUM(prescriptions.dose_val_rx)': None}]
af2418efda8240fde827a469,What are the top five most common specimens being tested for patients who were diagnosed with unspecified viral hepatitis c with hepatic coma in the same month since 2100?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c with hepatic coma' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) as rank FROM (SELECT patient.specimen, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'unspecified viral hepatitis c with hepatic coma' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t GROUP BY t.specimen ORDER BY rank NULLS FIRST LIMIT 5",
dd2f29754291be893cdcffa8,How many hours have passed since patient 10004733's last specific gravity laboratory test on their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.last_specific_gravity_test)) FROM patient WHERE patient.id = 10004733 AND patient.hospital_dischtime IS NULL;",[]
81b76631822bb19d0aaa0811,Has patient 10000032 undergone the percutaneous abdominal drainage procedure in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10000032 AND procedures.procedure_name = 'percutaneous abdominal drainage' AND STRFTIME('%y', procedures.procedure_date) = '2100'",
0179af361778345171c9542a,Is the creatinine value last measured on the first hospital visit in patient 10018501 less than the value from the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT creatinine FROM patients WHERE patient_id = 10018501 AND NOT patient_hospital_info.hospital_dischtime IS NULL ORDER BY patient_hospital_info.hospital_admittime NULLS FIRST LIMIT 1) < (SELECT creatinine FROM patients WHERE patient_id = 10018501 AND NOT patient_hospital_info.hospital_dischtime IS NULL ORDER BY patient_hospital_info.hospital_admittime DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
ca6018236b179b413a64059e,What was the last time patient 10020187 input time on 02/04/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-04' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10020187 AND input_time BETWEEN '2100-02-04 00:00:00' AND '2100-02-04 23:59:59';,[]
86c494ae04729b5345b49a12,"For patients diagnosed with epilepsy, unspecified, without mention of intractable epilepsy since 1 year ago, what are the top three most recurrent treatments during the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, without mention of intractable epilepsy' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'EPILEPSY, UNSPECIFIED, WITHOUT MENTION OF INTRACTABLE EPILEPSY' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.id, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE DATETIME(treatment.treatment_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t1.diagnosis_date, 'start of month') =",
14540374a9d0b9528a6d94fe,How many doses of rifaximin have been prescribed to patient 10038081 since 09/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'rifaximin' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10038081 AND prescriptions.drug = 'rifaximin' AND STRFTIME('%y-%m', prescriptions.date) >= '2100-09'",[{'SUM(prescriptions.dose_val_rx)': None}]
3a6c107da55dce7df0c5c04c,Has there been any organism detected during the first stool microbiology test of patient 10020944 on the first hospital encounter?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM stool_microbiology WHERE stool_microbiology.patient_id = 10020944 AND NOT stool_microbiology.result_date IS NULL ORDER BY stool_microbiology.result_date NULLS FIRST LIMIT 1;,[{'COUNT(*)>0': 0}]
dc2a2b0ab8c3da8e52bdaa44,What's the maximum total cost of the hospital visits that involve a procedure called closed [percutaneous] [needle] biopsy of kidney?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) ) GROUP BY cost.hadm_id ) AS T1,,
137099cf125111be9c3e94c3,Is there a method for disinfecting the quarantine room?,,SELECT * FROM methods WHERE method_name = 'disinfecting the quarantine room';,
8f621fd97d1842a4a61410fa,Calculate the number of ICU visits for patient 10016742 during the last hospital visit.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT SUM(ICU_visits) FROM visit_data WHERE patient_id = 10016742 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime DESC LIMIT 1;,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
ca2d821af5309a1a9e06bffa,How many patients were discharged from hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT(DISTINCT patient_id) FROM procedures WHERE procedures.discharge_reason = 'Discharged';,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
3721cd5bc8e32a4de1812101,Tell me the minimum total hospital cost that involves a procedure called unilateral simple mastectomy?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) ) GROUP BY cost.hadm_id ) AS T1,"SELECT MIN(T1.total_hospital_cost) FROM (SELECT SUM(T2.hospital_cost) AS total_hospital_cost FROM (SELECT T3.hospital_cost FROM (SELECT 3 AS hospital_cost FROM procedures WHERE procedure_name = 'unilateral simple mastectomy') AS T3 GROUP BY T3.hospital_cost) AS T2 JOIN (SELECT T4.patient_id, T4.total_hospital_cost FROM (SELECT 5 AS hospital_cost FROM diagnoses WHERE diagnosis_name = 'hypothyroidism') AS T4 GROUP BY T4.patient_id) AS T1 ON T1.patient_id = T2.patient_id",
7c769198cdf2ef06b5f1dab3,Has patient 10038081 had a lab test for glucose?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ),"SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10038081 AND lab_tests.lab_name = ""Glucose""",[{'COUNT(*)>0': 0}]
acef00fb099d89d41958c435,Does patient 49176 have experience travelling abroad?,,"SELECT COUNT(*) > 0 FROM patients WHERE patients.experience_travelling_abroad = ""YES"" AND patients.uniquepatientid = 49176",
ee03c89cedfa0f30f24da326,What is the prescribed opioid dose for patient 739?,,"SELECT ""opioid"" FROM ""patient_739"" WHERE ""drug"" = 'Prescribed'",
3dbc092974709a580db73d5d,What are the three most ordered lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date > (CURRENT_DATE - INTERVAL '1 year')) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
5a471bc5d991ced2d535cfb7,How many times irbesartan was ordered since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'irbesartan' AND strftime('%Y',prescriptions.starttime) >= '2100'",SELECT COUNT(*) FROM inventory WHERE product = 'irbesartan' AND order_date >= 2100,[{'COUNT(*)': 656}]
20a337b806f34bbcaf6383e9,Find out the number of medicines given to patient 10038933 in 2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM medicine_usage WHERE medicine_usage.patient_id = 10038933 AND STRFTIME('%y', medicine_usage.date) = '2100';",[{'COUNT(*)': 0}]
4ead555e8bf055e8e8c7bc2f,How many patients left the hospital during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE date_left >= (SELECT MAX(date_left) FROM patients) - INTERVAL '1 year';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
2a3c78cd78a7e5f8d977da20,When did patient 10021312 have his first microbiology test in 09/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-09' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT date FROM MicrobiologyTest WHERE MicrobiologyTest.PatientID = 10021312 AND STRFTIME('%y-%m', MicrobiologyTest.Date) = '2100-09' ORDER BY MicrobiologyTest.Date NULLS FIRST LIMIT 1",[]
a0ebb505e3207ec9be553166,What kind of diagnosis did patient 10036156 receive last throughout this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT COUNT(DISTINCT diagnosis_type) FROM diagnoses WHERE diagnoses.patient_id = 10036156 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
a6965f79793a92b7e6553d61,Can you tell me which were the top five most frequent specimens tested since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM results WHERE date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
4711376d06c7dea356e7adee,Was patient 10000032 bicarbonate tested on the first hospital stay?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),"SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10000032 AND lab_data.label = 'Bicarbonate' AND STRFTIME('%h', lab_data.timestamp) = 24",[{'COUNT(*)>0': 0}]
f67d746e41ace34ddad71fba,What is the protocol of anti-cancer drugs?,,SELECT DISTINCT protocol FROM drugs WHERE category = 'anti-cancer';,
42d77c1fd11fc0abbd3449b8,How much simethicone was prescribed to patient 10022017 last on their first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'simethicone' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(UNNEST(patient.prescriptions)) FROM patient WHERE patient.id = 10022017 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1;,[]
ab6c84f4aad1e16e5caea9b6,Count the number of patients who stayed throughout this year at transplant.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'transplant' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, transplant(date) AS transplant_date FROM patients WHERE transplant(date) IS NOT NULL) AS t1 WHERE t1.transplant_date BETWEEN DATE '2022-01-01' AND DATE '2022-12-31'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
808756e7c648673865499708,Show us the top three most common microbiology tests throughout this year.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t.name, COUNT(s.name) FROM (SELECT microbiology_test.name FROM microbiology_test WHERE DATETIME(microbiology_test.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t JOIN samples s ON t.name = s.name GROUP BY t.name ORDER BY COUNT(s.name) DESC LIMIT 3;",[]
c6e39eac55b1a26adabaa844,Could you list the three most frequently prescribed medicines in the same month after a diagnosis of coronary atherosclerosis of native coronary artery was made since 1 year ago?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of native coronary artery' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'coronary atherosclerosis of native coronary artery' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.uniquepid WHERE DATETIME(medication.medication_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_",
2c618c0f46c3debf9a6fcad3,Get me patient 10020786's total po intake input amount on 07/01/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-01'",SELECT SUM(intake_amount) FROM intake WHERE intake_patient_id = 10020786 AND intake_date BETWEEN '07/01/2020' AND '07/01/2020' AND intake_type = 'po intake',[{'SUM(inputevents.totalamount)': None}]
09469e7ae520d7c2a28ad15f,"What was the first dose of heparin flush (10 units/ml) during the last hospital encounter, prescribed to patient 10009628?",SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'heparin flush (10 units/ml)' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(heparin_flush.dose) FROM patients WHERE patients.id = 10009628 AND NOT patients.hospital_info.last_dischtime IS NULL ORDER BY patients.hospital_info.admittime DESC LIMIT 1;,[]
e0699671e9dc302a776e8354,"Since 1 year ago, has patient 10021938 visited an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM visit WHERE visit.patient = 10021938 AND visit.type = 'emergency' AND DATETIME(visit.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 0}]
71319107f961de47a8a7b439,What percentile is the mchc value of 34.6 among patients of the same age as patient 10026354 during their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.6",SELECT 34.6 FROM patients WHERE patients.age = (SELECT patients.age FROM patients WHERE patients.name = '10026354' AND NOT patients.dischtime IS NULL ORDER BY patients.admittime DESC LIMIT 1) AND NOT patients.dischtime IS NULL ORDER BY patients.admittime DESC LIMIT 1,
1e5faf727375a9ada1941625,What is the average total hospital cost for a procedure involving total esophagectomy?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(Total_Hospital_Cost) FROM (SELECT SUM(Total_Hospital_Cost) AS Total_Hospital_Cost FROM procedures WHERE procedures.Name = 'total esophagectomy' GROUP BY procedures.ID) AS subquery;,
aba66c29e51149f140d80325,What is the yearly maximum lr input for patient 10004733 since 113 days ago?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-113 day') GROUP BY strftime('%Y',inputevents.starttime)",SELECT MAX(lr_input) FROM read_brackets WHERE patient = 10004733 AND date = CURRENT_DATE - INTERVAL '113 days' GROUP BY date,[]
bcbe7556b4dbff73f99a68a6,Count up how many times patient 10018845 was admitted to the ICU since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT patient_id) FROM icu_admissions WHERE patient_id = 10018845 AND DATETIME(icu_admissions.admission_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}]
1117a3336b3c103b088eb297,"For patients previously diagnosed with compression of vein in 2100, what were the four most frequent specimens tested during the same hospital visit afterward?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of vein' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t3.specimen FROM (SELECT t2.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_time, patient.gender FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'compression of vein' AND STRFTIME('%y', diagnosis.diagnosis_time) = '2100') AS t1 JOIN (SELECT patient.uniquepid, specimen, specimen_type FROM patient JOIN sample ON patient.uniquepid = sample.patientid WHERE STRFTIME('%y', sample.sample_time) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_time < t2.sample_time AND t1.gender = t2.gender GROUP BY t2.specimen) AS t3 WHERE t3.c1 <= 4",
91f98b68f8351708b09a3b5f,When was the time of patient 10018328's first hospital discharge?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018328 ORDER BY admissions.dischtime ASC LIMIT 1,SELECT patient.hospital_discharge_time FROM patient WHERE patient.unique_patient_id = 10018328,[{'dischtime': '2154-02-09 15:15:00'}]
275184cf2bd75d7ada2cab2a,What is the total number of patients discharged from the hospital this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(DISTINCT patient_id) FROM brackets_discharged WHERE date_discharged >= CURRENT_DATE AND date_discharged < CURRENT_DATE + INTERVAL '1 year';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f6a020353c429522bafc3321,Has patient 13528 had any ill effects during a blood transfusion?,,SELECT COUNT(*) > 0 FROM illness_events WHERE illness_events.patient_id = 13528 AND illness_events.event_type = 'blood transfusion',
a12e0ce3ce5a8ad2bd8f3a5d,"What's the cost for drainage of right pleural cavity with drainage device, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure = 'Drainage of right pleural cavity with drainage device, percutaneous approach';",
ea31ed3fce1a143af74ceab2,Tell me the minimum overall hospital cost that includes vitamin e?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vitamin e' ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(overall_hospital_cost) FROM (SELECT overall_hospital_cost FROM (SELECT SUM(hospital_cost) FROM (SELECT hospital_cost FROM (SELECT patient_number FROM patients WHERE patient_number = 123) AS t1 JOIN prescriptions ON t1.prescription_id = prescriptions.prescription_id WHERE prescriptions.drug_name = 'vitamin e') AS t2 GROUP BY t2.patient_number) AS t3,
1603ed597a3810e80a4e2f15,"In the last hospital encounter, what was the insurance of patient 10006580?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT Encounter.Insurance FROM (SELECT * FROM Patient WHERE Patient.ID = 10006580 AND NOT Patient.LastHospitalEncounter IS NULL ORDER BY Patient.LastHospitalEncounter DESC LIMIT 1) AS Encounter;,[{'insurance': 'Medicaid'}]
888957dc10f4451e27bb31eb,"On the first hospital visit, was patient 10002495 diagnosed with any illness?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10002495 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.diagnosistime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
8c8b5170a56e94b0724e4b97,"For patients who were previously diagnosed with backache, unspecified, what are the top four most frequent treatments within 2 months since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'backache, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment, t.date FROM (SELECT 'backache, unspecified' AS treatment, CURRENT_DATE AS date FROM dual) AS t GROUP BY t.treatment) AS t1 JOIN (SELECT COUNT(treatment) AS c1 FROM (SELECT t.treatment, t.date FROM (SELECT 'backache, unspecified' AS treatment, CURRENT_DATE AS date FROM dual) AS t GROUP BY t.treatment) AS t2 ON t1.treatment = t2.treatment WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t1.treatment) AS t3 ORDER BY t3.c1 DESC LIMIT 4",
5a5f7cbc98a80e1a4f6e3b31,What total amount of ursodiol was prescribed to patient 10004235 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'ursodiol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'","SELECT SUM(pharmacy_item.amount) FROM pharmacy_item WHERE pharmacy_item.patient_id = 10004235 AND pharmacy_item.item = 'ursodiol' AND DATETIME(pharmacy_item.prescription_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', pharmacy_item.prescription_date) = '07'",[{'SUM(prescriptions.dose_val_rx)': None}]
53c9148b613c58bca3b23674,"Throughout this year, how many patients were prescribed dexamethasone?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dexamethasone' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",SELECT COUNT(*) FROM patients WHERE prescriptions.drug = 'Dexamethasone',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
88feed4e79da04e646ebc129,What was the name of the medication that patient 10027602 was last prescribed since 03/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT name FROM medication WHERE patient_id = 10027602 AND date_prescribed >= '2000-03-2100' ORDER BY date_prescribed DESC LIMIT 1,[{'drug': 'Sodium Chloride 0.9%  Flush'}]
6ed7efd8318499e011227c1c,When was the first time patient 10004457 had been prescribed medication through the po route since 09/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(date_prescribed) FROM prescriptions WHERE patient_id = 10004457 AND prescriptions.route = 'po' AND STRFTIME('%y-%m', date_prescribed) >= '2100-09'",[]
8410ba33ca60f450bef1f5d8,How is olanzapine (disintegrating tablet) typically consumed?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'olanzapine (disintegrating tablet)',"SELECT DISTINCT prescriber FROM olanzapine WHERE olanzapine = ""Olanzapine (Disintegrating Tablet)""",[]
00c6c90e6841d1dfe2515346,What are the top four most common diagnoses that patients were diagnosed with within the same month after receiving hemodialysis's in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.month FROM (SELECT month, diagnosis FROM diagnoses WHERE year = 2100) AS t1 JOIN (SELECT month, diagnosis FROM diagnoses WHERE year = 2100) AS t2 ON t1.month = t2.month) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 4",
28a2d17f20583959defd0234,What is the monthly maximum value of patient 10027445's weight since 14 months ago?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MAX(weight) FROM patients WHERE patient_id = 10027445 AND measurement_date >= DATEADD(month, -14, CURRENT_DATE) GROUP BY measurement_date;",[]
94ea79f626ba94bd76d643b1,What percentile of the lactate value is 2.7 among patients of the same age as patient 10005866 in their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.7","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, lactate.value, PERCENT_RANK() OVER (ORDER BY lactate.value NULLS FIRST) AS c1 FROM patient INNER JOIN lactate ON patient.patient_id = lactate.patient_id WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.patient_id = 10005866 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay_length NULLS FIRST LIMIT 1)) AS t1 WHERE t1.value = 2.7",
d8ee53098c33deb8fdb3b50b,What is the type of blood patient 97330 has.,,"SELECT ""blood_type"" FROM ""patient_97330"" WHERE ""patient_97330"" = 97330",
368476b74ef69f3552e2cb3d,Describe all prescriptions that patient 54894 received in the other department.,,SELECT * FROM prescriptions WHERE patient_id = 54894 AND department_id <> (SELECT department_id FROM prescriptions WHERE patient_id = 54894 AND department_id = 1),
29529a65ec54c70785eb5133,Count the number of hospital visits that patient 10029484 had since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10029484 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",SELECT COUNT(DISTINCT HOSP_VISIT_ID) FROM hospital_visits WHERE PATIENT_ID = 10029484 AND DATETIME >= CURRENT_TIMESTAMP - INTERVAL '1 year',[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
a11042428c7092cce5896974,Is the o2 saturation pulseoxymetry level of patient 10020187 second measured on the first ICU visit greater than the first measurement on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT o2_saturation_pulseoxymetry FROM (SELECT icu_data FROM icu_visits WHERE icu_visits.patient_id = 10020187 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1) AS icu_data ORDER BY icu_data.admittime NULLS FIRST LIMIT 1 OFFSET 1) > (SELECT o2_saturation_pulseoxymetry FROM (SELECT icu_data FROM icu_visits WHERE icu_visits.patient_id = 10020187 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1) AS icu_data ORDER BY icu_data.admittime NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
51ab705e6d5e1025e101e735,What was patient 10015931's weight the last time it was measured since 8 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-8 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT weight FROM patients WHERE patient_id = 10015931 AND measurement_date >= date_trunc('month', current_date) - INTERVAL '8 month' ORDER BY measurement_date DESC LIMIT 1",[]
b352e9e544d9e4edbcabcb01,"Among patients diagnosed with unspecified essential hypertension since 2100, what are the top four medications prescribed within 2 months to patients in their 50s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t1.name FROM (SELECT patient.name, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.subject WHERE diagnosis.diagnosis = 'unspecified essential hypertension' AND STRFTIME('%y', diagnosis.date) >= '2100') AS t1 JOIN (SELECT patient.name, medication.date FROM medication JOIN patient ON medication.patient = patient.subject WHERE patient.age BETWEEN 50 AND 59 AND STRFTIME('%y', medication.date) >= '2100') AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') ORDER BY COUNT(*) DESC LIMIT 4",
c4b9d1ad637c92074a327167,Show me patient 10012552's total amount of dextrose 5% input on 04/05/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-05'",SELECT SUM(input_dextrose_5%) FROM input WHERE patient_id = 10012552 AND input_date = '2100-04-05',[{'SUM(inputevents.totalamount)': None}]
32add9759f1cb2aad3668ce7,List the top four most common events that happened.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT Event, COUNT(*) FROM Log GROUP BY Event ORDER BY COUNT(*) DESC LIMIT 4;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
9b4d962443aad38251f870a8,When did patient 10039831 have the maximum value of mean blood pressure for the last time on their current ICU encounter?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(mean_blood_pressure) FROM patient WHERE patient_id = 10039831 AND icu_start_date IS NOT NULL;,[]
8de008a99045692b6c9079bb,What were the top five most often performed treatments for patients in their 30s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment FROM (SELECT 'surgery' AS treatment FROM patients WHERE t.age BETWEEN 30 AND 39) AS t1 JOIN (SELECT 'diagnosis' AS treatment FROM patients WHERE t.age BETWEEN 30 AND 39) AS t2 ON t1.treatment = t2.treatment WHERE DATETIME(t1.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY t1.treatment) AS t1 JOIN (SELECT 'treatment' AS treatment FROM patients WHERE t.age BETWEEN 30 AND 39) AS t2 ON t1.treatment = t2.treatment WHERE DATETIME(t1.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 5",
cd94bbb9784884dac45123cd,What are the top three most common microbiology tests that patients had after the diagnosis of malignant neoplasm of lower third of esophagus within the same hospital visit?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnosis.diagnosis_date, patient.had_contact",
222d8247ed139a5d5cd17c02,What was the name of the drug patient 10027602 was prescribed within 2 days after having received a percutaneous [endoscopic] gastrostomy [peg] procedure since 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,
b462e1aa1b901782d9358530,"Has patient 10038999 got a potassium, whole blood laboratory test?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 )","SELECT COUNT(*) FROM lab WHERE lab.patient = 10038999 AND lab.label = ""Potassium, Whole Blood""",[{'COUNT(*)>0': 0}]
78bac4549cb2e3ad9fa2a04f,When was patient 10005817 discharged from the hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = 10005817;,[{'dischtime': '2135-01-19 18:36:00'}]
3c7a16e5114441d4d413d8fd,Could you list patient 10011398's daily minimum weight on their first hospital encounter?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MIN(weight) FROM patients WHERE patient_id = 10011398 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1;,[]
02b3b650c8a76d49c5223798,Is patient 3277 subject to covid-19 testing?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_to_covid_19_testing = 1 AND patients.patient_id = 3277;,
c873185bf7745af0b9d816fe,When was the last time patient 10025612 had a respiratory rate that was less than 16.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 16.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(timestamp) FROM respiratory_rate WHERE patient_id = 10025612 AND respiratory_rate < 16.0,[]
42ab873a23dd37a3c747c4a1,Give me the total amount of nepro (full) given to patient 10018081.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nepro (full)' AND d_items.linksto = 'inputevents' ),"SELECT SUM(amount) FROM inventory WHERE patient_id = 10018081 AND product_name = ""Nepro (Full)""",[{'SUM(inputevents.totalamount)': None}]
25956b8c121a3452cf6a13da,When did the first input for patient 10004720 occur since 10/03/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-03' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_date) FROM input_data WHERE patient_id = 10004720 AND input_date >= '2100-10-03',[{'starttime': '2186-11-12 20:00:00'}]
848a65292fc28285ffa82551,Please calculate the total output for patient 10022017 since 06/06/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06'",SELECT SUM(output) FROM (,[{'SUM(outputevents.value)': 14835.0}]
b09c1296a97d4f7a4488f11f,How many hours have passed since the first time that patient 10039831 stayed in careunit discharge lounge in the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.admittime)) FROM patient WHERE patient.subject = '10039831' AND patient.dischtime IS NULL AND patient.admittime IS NOT NULL",[]
dcbeaf8a50d187f685e536c8,What was the name of patient 10039708's insurance during their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT ""Insurance"" FROM ""Patients"" WHERE ""ID"" = 10039708 AND NOT ""Last Hospital"" IS NULL ORDER BY ""Last Hospital"" DESC LIMIT 1",[{'insurance': 'Other'}]
9bcb25bfb75bf11f00162db1,What was the dose of lactated ringers that last month patient 10006053 was last prescribed?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND prescriptions.drug = 'lactated ringers' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT date_sub('month', CURRENT_DATE, MIN(date_prescribed)) as last_prescribed_month",[]
1d5c343c436c4699ca75db67,Patient 10013049's glucose second measured on the last hospital visit is greater than the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.value FROM lab WHERE lab.patient = 10013049 AND lab.label = 'glucose' AND NOT lab.value IS NULL ORDER BY lab.measured_at DESC LIMIT 1) > (SELECT lab.value FROM lab WHERE lab.patient = 10013049 AND lab.label = 'glucose' AND NOT lab.value IS NULL ORDER BY lab.measured_at DESC LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
adcd9306676f578f4acf1d8a,Get me the top five most frequent events since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT event, COUNT(*) FROM brackets WHERE year > 2100 GROUP BY event ORDER BY COUNT(*) DESC LIMIT 5;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
2872894a2d6be289cc0751d3,Has patient 10005817 undergone a (aorto)coronary bypass of two coronary arteries?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of two coronary arteries' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ),SELECT COUNT(*) FROM procedures WHERE patient_id = 10005817 AND procedure_name = '(Aorto)coronary bypass of two coronary arteries',[{'COUNT(*)>0': 0}]
4b5563f6063f368aaf4d032b,When is the earliest hospital visit for patient 92721?.,,SELECT MIN(Hospital.VisitDate) FROM Hospital WHERE Hospital.PatientID = 92721,
e5f98987539902de04cf8a9e,Could you tell me how many patients stayed in the med/surg careunit during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient_id) FROM patient_stays WHERE careunit = 'med/surg' AND DATETIME(patient_stays.stay_start_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
fab4f3241b1a4140593a2196,How many days has it been since the last stay of patient 10018081 in the careunit emergency department in the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1",SELECT COUNT(DISTINCT DATE) FROM bracket_table WHERE patient_id = 10018081 AND location = 'emergency room admit' AND enc_date = SELECT enc_date FROM bracket_table WHERE patient_id = 10018081 AND location = 'emergency room admit' AND enc_date = SELECT enc_date FROM bracket_table WHERE patient_id = 10018081 AND location = 'emergency room admit',[]
89383745e9cd66ac4837c91f,What was the drug name that patient 10024043 was last prescribed through the oral route on the last hospital stay?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(drug_name) FROM duckdb_prescriptions WHERE prescriber_id = 10024043 AND route = 'ORAL' AND hospital_stay_id = (SELECT MAX(hospital_stay_id) FROM duckdb_hospital WHERE patient_id = 10024043),[]
671549860b2c1a2b4f5752a3,Could you unfold the five most frequent outputs since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
65ed4479d7d3a2021cd1f024,"Since 1 year ago, what was the diagnosis for patient 10004733 the last time?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",SELECT diagnosis FROM diagnoses WHERE patient_id = 10004733 AND date_diagnosed >= (CURRENT_DATE - INTERVAL '1 year') ORDER BY date_diagnosed DESC LIMIT 1,
44760a38638babf2a64cc994,Provide the length in days of the last visit for patient 10009035 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT COUNT(DISTINCT visit_date) FROM visit_table WHERE patient_id = 10009035 AND icu_id = 2,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.186168982181698}]"
4883a2a4fe195a7f18fa9e6e,How many current patients are there in the 50s age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,SELECT COUNT(*) FROM patients WHERE age = '50s' AND current_patient = 'true',
9c4faa51bc29012ddcee7e11,What is the ward id that patient 19175 may be admitted?,,SELECT ward_id FROM admissions WHERE patient_id = 19175,
73482639c89e793869246809,What was the drug that was first prescribed to patient 10029291 via the im route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(drug) FROM prescriptions WHERE prescriptions.patient_id = 10029291 AND prescriptions.route = 'im',[]
ecfdce415b13a6552ae21b5a,What is patient 10004235's average metamyelocytes value in 03/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",SELECT AVG(Metamyelocytes) FROM Patient WHERE Patient.ID = 10004235 AND Date = '03/2100',[{'AVG(labevents.valuenum)': None}]
5b3ff38fc5977d41f2919e7f,Show me the top four most commonly prescribed drugs since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.drug, COUNT(t1.drug) FROM (SELECT prescriber.drug FROM prescriber WHERE STRFTIME('%y', prescriber.date) >= '2100') AS t1 JOIN (SELECT prescriber.drug FROM prescriber WHERE STRFTIME('%y', prescriber.date) >= '2100') AS t2 ON t1.drug = t2.drug GROUP BY t1.drug ORDER BY COUNT(t1.drug) DESC LIMIT 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]"
68a6646ad90adaa44fe6ddbb,"Has there been any calcium carbonate, bisacodyl, or nephrocaps ordered for patient 10021938 in 04/last year?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.drug IN ( 'calcium carbonate', 'bisacodyl', 'nephrocaps' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) FROM orders WHERE patient_id = 10021938 AND order_date BETWEEN '2004-01-01' AND '2004-12-31' AND order_type = 'Calcium Carbonate, Bisacodyl, or Nephrocaps'",[{'COUNT(*)>0': 0}]
fded99b20da76568aee99315,Tell me the number of patients discharged from the hospital in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT patients.dischtime IS NULL AND STRFTIME('%y', patients.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
6cdbe56001fefce8414c07e1,Has patient 10001217 visited an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM visit_log WHERE patient_id = 10001217 AND emergency_room = true,[{'COUNT(*)>0': 0}]
4127d2f4d3dde8b9a50cddeb,Can you tell me the five most frequent diagnoses throughout this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses WHERE date BETWEEN '2017-01-01' AND '2017-12-31' GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 5",
250459eeaf1e43b5affdfa0e,How many hours has it been since patient 10018081's last phosphate lab test on their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', Phosphate_Lab_Test_Time)) FROM Phosphate_Lab_Tests WHERE Patient_ID = 10018081 AND Hospital_ID = 1;",[]
e5de01d16191eb56d2a17817,Has patient 10037861 been given a diagnosis in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10037861 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100'",
b81ed5d5887f1e702281cc7c,What kind of medicine does patient 50480 take when they get a prescription from another hospital?,,SELECT m.name FROM medicine m INNER JOIN prescriptions p ON m.code = p.medicine WHERE p.patient_id = 50480 AND m.hospital_id <> (SELECT h.hospital_id FROM hospitals h WHERE h.hospital_name = 'The Other Hospital'),
931a6cae10afc8a4e19e7a2b,"What were the four most frequently diagnosed microbiology tests for patients who were diagnosed with encounter for palliative care before within the same hospital visit, since 1 year ago?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t3.NegativePressure, COUNT(t3.NegativePressure) FROM (SELECT t2.NegativePressure, COUNT(t2.NegativePressure) FROM (SELECT t1.NegativePressure, COUNT(t1.NegativePressure) FROM (SELECT SUM(t1.NegativePressure) AS NegativePressure FROM (SELECT * FROM diagnoses WHERE diagnoses.diagnosis_time >= (CURRENT_TIMESTAMP - INTERVAL '1 year')) AS t1 JOIN (SELECT * FROM encounters WHERE encounters.encounter_time >= (CURRENT_TIMESTAMP - INTERVAL '1 year')) AS t2 ON t1.encounter_id = t2.encounter_id WHERE t1.diagnosis = 'Encounter for palliative care' GROUP BY t1.NegativePressure) AS t3 JOIN (SELECT * FROM diagnoses WHERE diagnoses.diagnosis_time >= (CURRENT_TIMESTAMP - INTERVAL '1 year')) AS t4 ON t3.NegativePressure = t4.NegativePress",
572e3be6f4447f2f3dd8a46e,What is the price for the drug ferrous sulfate (liquid)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)' ),SELECT price FROM drugs WHERE drug = 'Ferrous Sulfate (Liquid)',
4c0ba2326075b47121880872,Give me patient 10035185's total amount of nacl 0.9% input.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) FROM input WHERE patient_id = 10035185 AND input_type = 'nacl 0.9%',[{'SUM(inputevents.totalamount)': None}]
35b706cc431e421ccc4d295f,What's the rank of the top four most common output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.event_type, COUNT(t.event_type) FROM (SELECT u.event_type FROM (SELECT a.event_type FROM events a WHERE a.rank = 1) u UNION ALL SELECT b.event_type FROM events b WHERE b.rank = 2) t GROUP BY t.event_type ORDER BY COUNT(t.event_type) DESC LIMIT 4","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
a7ffd50743215e43ab4b4249,Calculate the number of lidocaine jelly 2% (urojet) prescriptions last year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Lidocaine Jelly 2% (Urojet)' AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT(*)': 0}]
5cce095f827f40e0736c9405,Count the number of drugs prescribed since 03/2100 for patient 10037861.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10037861 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-03'",[{'COUNT(*)': 265}]
ec92f2209fc00778cd5a3157,How much does patient 10020944 weigh based on the last measurement since 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT SUM(weight) FROM patients WHERE patient_id = 10020944 AND measurement_date >= '2000-03-2100',[]
d9f612942f090356e944ba24,"What is the average total hospital cost for a patient diagnosed with hemiplegia, unspecified affecting left nondominant side since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE diagnosis = 'hemiplegia, unspecified affecting left nondominant side' AND DATETIME(cost_table.cost_date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY cost_table.patient_id) AS t1",
010b98b4248d540f98a42319,What was the overall amount of input for patient 10021666 since 01/16/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-16'",SELECT SUM(input) FROM input WHERE patient = 10021666 AND input_date >= '2001-01-16',[{'SUM(inputevents.totalamount)': 6140.0}]
bf8943fddda84358c2b49e35,What is the average expense for other endoscopy of small intestine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) ),SELECT AVG(expense) FROM procedures WHERE procedures.type = 'Other endoscopy of small intestine';,
ceb8581ad32d0000864d6c0b,What was the first value of patient 10019172's lab test for oxygen saturation in 11/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen saturation' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11' ORDER BY labevents.charttime ASC LIMIT 1","SELECT lab_result FROM lab_data WHERE lab_name = 'oxygen saturation' AND patient_id = 10019172 AND date_trunc('year', date) = date_trunc('year', CURRENT_DATE) AND date_trunc('month', date) = date_trunc('month', CURRENT_DATE)",[]
86831d5ce56c04ce7f23fd47,How many patients left the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT patient_id) FROM patient_left WHERE date_diff('year', patient_left.date, CURRENT_DATE) = 1",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
8fd77ab450ceaf3df06b0177,How many hyposmolality and/or hyponatremia patients were diagnosed within 2 months after being diagnosed with cachexia?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyposmolality and/or hyponatremia' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'hyposmolality and/or hyponatremia') AS t1 JOIN (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'cachexia') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month')",
1a2803a90ebc58ce4b381cce,Tally up the number of patients who received a granular casts lab test in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'granular casts' ) AND strftime('%Y',labevents.charttime) = '2100' )","SELECT COUNT(DISTINCT patient_id) FROM lab_results WHERE lab_name = 'granular casts' AND STRFTIME('%y', lab_date) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
3e872f05856966755e671a77,What was the last time that patient 10012853 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.hospital_id = 10012853;,[]
f4a479361b2f03676b79359d,What was the total albumin 25% amount given for patient 10018081 since 12/07/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-07'",SELECT SUM(albumin 25%) FROM albums WHERE patient_id = 10018081 AND date >= '2100-12-07',[{'SUM(inputevents.totalamount)': None}]
c85dcc855c873d1ffc99f027,What is today's outpatient schedule for dr. cannon?,,SELECT * FROM appointment WHERE doctor = 'Cannon' AND appointment_type = 'outpatient' AND date = '2022-01-01',
f7e72869cfd4d186d37a8a6d,"Has patient 10026354 undergone reposition left mandible with external fixation device, percutaneous approach?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 )","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10026354 AND procedures.procedure_name = ""Reposition left mandible"" AND procedures.external_fixation_device = ""Percutaneous approach""",[{'COUNT(*)>0': 0}]
77caf8ab10948c4b56ca183d,What are the five most ordered lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM lab_tests AS t WHERE t.year >= 2100 GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
87ea2c2233393dc64798684e,What were the five most frequent lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM lab_tests t WHERE DATETIME(t.test_date) >= DATETIME(CURRENT_DATE, '-1 year') GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
2d9caef46a791339e4a2731b,Which procedure was performed on patient 10016742 two times since 03/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",SELECT COUNT(DISTINCT t1.date) FROM (SELECT date FROM procedures WHERE patient = 10016742 AND date >= '2000-03-2100') AS t1 JOIN (SELECT date FROM procedures WHERE patient = 10016742 AND date >= '2000-03-2100') AS t2 ON t1.date = t2.date,
a3481de61e2fdd7ec5b2daad,"Number of patients who received a introduction of other therapeutic substance into heart, open approach procedure in 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.subject_id IN (SELECT patient.subject_id FROM patient WHERE patient.heart_rate > 120 AND patient.heart_rate < 150) AND patient.age < 18 AND STRFTIME('%y', patient.date_of_admission) = '2100'",
7183861df46553ab538458ae,Whats the protocol for the anticancer drugs?,,SELECT DISTINCT protocol FROM drugs WHERE function = 'anticancer';,
b0ef9ac5dcce6d06f4eb450d,Tell me the top three most commonly prescribed drugs in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE STRFTIME('%y', prescriptions.date) = '2100' GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 3",[]
55fe6d305b76e501677eed35,What was the name of the specimen that patient 10001725 received for the last time?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT specimen_name FROM (SELECT * FROM patients WHERE patient_id = 10001725) ORDER BY specimen_date DESC LIMIT 1;,[{'spec_type_desc': 'URINE'}]
79c093726d46e6acd2287106,"What was the name of the drug that patient 10018081 was prescribed with in the same hospital encounter after undergoing ileostomy, not otherwise specified during this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t3.drug_name FROM (SELECT t2.drug_name, t1.visit_id, t1.patient_id FROM (SELECT patient_id, visit_id FROM postgres_scan('', 'public', 'procedure_log') WHERE patient_id = 10018081 AND procedure_name = 'ileostomy, not otherwise specified') AS t1 JOIN (SELECT patient_id, drug_name FROM postgres_scan('', 'public', 'drug_log') WHERE patient_id = 10018081) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.visit_id = t2.visit_id + 1) AS t3 WHERE DATETIME(t3.drug_name, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')",
3fa947a7c4c696baf058e932,Is the value of hemoglobin of patient 10006580 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT hemoglobin FROM patients WHERE patient_id = 10006580 AND NOT patients.hospital_info IS NULL ORDER BY hemoglobin DESC LIMIT 1) < (SELECT hemoglobin FROM patients WHERE patient_id = 10006580 AND NOT patients.hospital_info IS NULL ORDER BY hemoglobin DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
23bba64a79ae703a2b84c6e6,What was the last time patient 10007818 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007818 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.hospitalid = 10007818;,[]
d17c786dec93d192f68c22dd,When was the last time patient 10027602 had input on 12/03/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-03' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_date) FROM input_table WHERE patient_id = 10027602 AND input_date BETWEEN '2022-12-03' AND '2022-12-03',[]
f46885deabda4129f8960805,Has patient 10037861 gone through any lab test since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10037861 AND STRFTIME('%y-%m', lab_tests.date) >= '2100-04'",[{'COUNT(*)>0': 1}]
366d08a0b63e3cc04f1a4df1,What are the prices of the drug albumin 25% (12.5g / 50ml)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' ),SELECT AVG(Price) FROM drugs WHERE Drug_Name = 'Albumin 25% (12.5g / 50ml)',
fa77bf576a4300f065e04807,What was the output that patient 10018845 first had since 04/09/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-09' ORDER BY outputevents.charttime ASC LIMIT 1 )",,[{'label': 'Void'}]
c70358d01148240eb97f8568,What was the maximum value of creatinine in patient 10031404's body since 05/2100?,"SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-05'",SELECT MAX(creatinine) FROM patient WHERE patient.id = 10031404 AND date >= '05/2100',[{'MAX(labevents.valuenum)': None}]
16a44e61297946c6928ab617,What was the name of the specimen test that patient 10026406 had for the first time in 01/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '01' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_type FROM specimen_table WHERE patient_id = 10026406 AND date_of_specimen = '2022-01-01' ORDER BY date_of_specimen NULLS FIRST LIMIT 1,[]
c4583562855d6e407a1c88ed,What is the minimum yearly number of patients who suffer from history of falling?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT MIN(YearlyPatients) FROM (SELECT YearlyPatients FROM ""falling_history"" GROUP BY YearlyPatients)",
6b42551afc7b875d354f4b01,When are the dr. gutknecht's rounds and procedures?,,"SELECT dr.gutknecht.rounds, dr.gutknecht.procedures FROM drawings WHERE drawings.item = 'dr. gutknecht';",
586ca890e966f98f077187c9,What was the average value of lipase in patient 10021487's body in 12/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12'",SELECT AVG(lipase) FROM patients WHERE patient_id = 10021487 AND date_assigned TO '12/this year',[{'AVG(labevents.valuenum)': None}]
25c1ae6ee1303d4325b02e56,When was the last time the heart rate of patient 10018081 registered greater than 73.0 yesterday?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 73.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM vital_signs WHERE patient_id = 10018081 AND heart_rate > 73.0 AND date = (CURRENT_DATE - INTERVAL '1 day'),[]
8131eb8d99a9ae08b543fab4,Has patient 10026255 been tested in the hemoglobin lab in 10/this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'",SELECT COUNT(*) > 0 FROM lab_results WHERE lab_name = 'hemoglobin' AND patient_id = 10026255 AND date_result_entered >= '2010-01-01' AND date_result_entered < '2010-12-31',[{'COUNT(*)>0': 0}]
9e7aa17566ee6e70df48c838,How many insertion of drug-eluting coronary artery stent(s) treatments were executed?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' ),SELECT COUNT(*) FROM procedures WHERE procedures.treatment = 'Insertion of drug-eluting coronary artery stent(s)';,[{'COUNT(*)': 0}]
b555ee213c4e95edc4e8b7e9,How many hours has it been since the first time that patient 10021487 was diagnosed with acute and subacute necrosis of liver in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE patient_id = 10021487 AND diagnosis_type = 'acute and subacute necrosis of liver' AND hospital_release_date IS NULL",
612076c066409c1c13b808e5,What is the common method for taking lidocaine 0.5%?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lidocaine 0.5%',SELECT * FROM duckdb_functions WHERE function_name = 'lidocaine 0.5%';,[]
99ce32579f34baf63f28f671,"On the current hospital visit, how many hours passed since the first physical restraints status diagnosis of patient 10004733?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'physical restraints status' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM Diagnoses WHERE patient_id = 10004733 AND diagnosis_type = ""Physical Restraints Status"" ORDER BY diagnosis_date DESC LIMIT 1;",
2142e73a54b9782926053e6a,Count the number of hospital visits patient 10021118 had since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(DISTINCT HOSP_VISIT_ID) FROM visit_table WHERE PATIENT_ID = 10021118 AND STRFTIME('%y', HOSP_VISIT_DATE) >= '2100';",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
53fbf62aeeffb338f67df6cc,Tell me the price of trimethoprim.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' ),SELECT price FROM products WHERE product = 'trimethoprim',
04c847911489606e9cc2a6d2,Was any medication prescribed to patient 10031404 on the last hospital visit?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10031404 AND NOT medication.dischtime IS NULL ORDER BY medication.admittime DESC LIMIT 1,[{'COUNT(*)>0': 1}]
d72f15251b85ed2e1b191e0f,List the drugs that should not be administered during procedure-one vessel?,,SELECT * FROM drugs WHERE NOT id IN (SELECT drug_id FROM procedures WHERE procedures.name = 'procedure-one vessel');,
d838d9dd02777dbf09b9e81b,How many times acetaminophen-caff-butalbital was ordered in the last year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetaminophen-caff-butalbital' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM orders WHERE product_name = ""Acetaminophen-Caff-Butalbital"" AND date_order_placed > (SELECT MAX(date_order_placed) FROM orders) - 365",[{'COUNT(*)': 0}]
af8069263b44e7b3d7b8dee2,What was the admission type for patient 10024043's first entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10024043 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT admission_type FROM admissions WHERE subject_id = 10024043 ORDER BY admissions.admission_date NULLS FIRST LIMIT 1;,[{'admission_type': 'EU OBSERVATION'}]
2b35fcda321bd6bbe4114dd2,Is patient 10018423's respiratory rate second measured on the last ICU visit greater than the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT (SELECT respiratory_rate FROM (SELECT patient_id, respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10018423) AS T2 JOIN (SELECT patient_id, icu_visit_date FROM patient_icu_visit WHERE patient_id = 10018423) AS T1 ON T1.patient_id = T2.patient_id WHERE T1.icu_visit_date = T2.icu_visit_date ORDER BY T1.icu_visit_date DESC LIMIT 1) > (SELECT respiratory_rate FROM (SELECT patient_id, respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10018423) AS T2 JOIN (SELECT patient_id, icu_visit_date FROM patient_icu_visit WHERE patient_id = 10018423) AS T1 ON T1.patient_id = T2.patient_id WHERE T1.icu_visit_date = T","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
dc27aa9c5779993d3b2034ed,What are the four most frequently tested specimens for patients that received arteriography of other intra-abdominal arteries previously within 2 months since 2100?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT patient.name, arteriography.date FROM arteriography JOIN patient ON arteriography.patient = patient.name WHERE arteriography.date BETWEEN '2100-01-01' AND '2100-12-31' AND arteriography.other_intra_abdominal_arteries = 'true') AS t2 GROUP BY t2.specimen) AS t3 GROUP BY t3.specimen) AS t4 WHERE t4.date BETWEEN '2100-01-01' AND '2100-12-31' AND DATETIME(t4.date) BETWEEN DATETIME(t3.date) AND DATETIME(t3.date, '+2 month') GROUP BY t4.specimen ORDER BY COUNT(t4.specimen) DESC LIMIT 4",
e2ae9a4a36ba36236e991b0e,How many patients underwent arteriography of other specified sites in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other specified sites' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT patient.subject, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.subject WHERE procedures.date BETWEEN '2100-01-01' AND '2100-12-31' AND procedures.type = 'arteriography of other specified sites') AS t1 JOIN (SELECT patient.subject, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.subject WHERE procedures.date BETWEEN '2100-01-01' AND '2100-12-31' AND procedures.type = 'arteriography of other specified sites') AS t2 ON t1.subject = t2.subject WHERE t1.date = t2.date",
7c43cec9b8ce603b7b6a81b1,"Since 07/06/2100, when did patient 10036156 receive an input for the first time?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-06' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT input_date FROM Inputs WHERE patient_id = 10036156 AND input_date >= DATE '2100-07-06' ORDER BY input_date NULLS FIRST LIMIT 1,[{'starttime': '2157-07-01 05:00:00'}]
ed6f8d67b33854602df8651f,How much is the drug named cepacol (menthol)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'cepacol (menthol)' ),"SELECT cepacol (menthol) FROM drugs WHERE drug_name = ""Cepacol (Menthol)""",
da7b960f34b7f3185ea6d045,What was the name of the medication that was first prescribed to patient 10029484 on their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT medication_name FROM prescriptions WHERE patient_id = 10029484 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1;,[{'drug': 'Bisacodyl'}]
ac30cc56e20308d54af2b8cd,When was the last time that patient 10022281 had a maximum SaO2 in the first ICU visit?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(SaO2) FROM (SELECT SaO2 FROM icu_visits WHERE icu_visits.had_diagnosis = true AND icu_visits.patient_id = 10022281 AND NOT icu_visits.outcome IS NULL ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1),[]
cb5360f692863a0eab68182e,What is the change in the medication of patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT (SELECT medication FROM patient WHERE patient.id = 10004733) AS today, (SELECT medication FROM patient WHERE patient.id = 10004733) AS yesterday WHERE today.date = '2022-01-01' AND yesterday.date = '2022-01-02'",[]
eba7513c50f91f2da09549f4,When was patient 10019172 prescribed aspirin and aspirin ec at the same time for the first time since 04/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10019172 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin ec' AND admissions.subject_id = 10019172 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.date_prescribed FROM (SELECT patient_id, date_prescribed FROM prescriptions WHERE prescription_name = 'aspirin' AND patient_id = 10019172) AS T1 JOIN (SELECT patient_id, date_prescribed FROM prescriptions WHERE prescription_name = 'aspirin ec' AND patient_id = 10019172) AS T2 ON T1.patient_id = T2.patient_id WHERE DATETIME(T1.date_prescribed) = DATETIME(T2.date_prescribed) ORDER BY T1.date_prescribed NULLS FIRST LIMIT 1",[]
f7dd12718e496d0937b3d1be,What is the percentile of 1.9 in a phosphate lab test conducted at the same age as patient 10007928 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.9","SELECT MIN(t1.c1) FROM (SELECT c1, c2 FROM (SELECT SUM(CASE WHEN p.age = (SELECT age FROM patient WHERE patient.id = 10007928 AND NOT patient.dischtime IS NULL ORDER BY patient.hospitaladmittime DESC LIMIT 1) THEN 1 ELSE 0 END) AS c1, 10007928 AS c2) AS t1 WHERE t1.c1 <= 1.9 AND t1.c2 >= 1.9",
67b61395fd1f2d6c03d0af1e,"Among patients aged 30s since 2100, what are the top three most common diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT * FROM patients WHERE age BETWEEN 30 AND 39) AS t1 JOIN (SELECT * FROM patients WHERE year >= 2100) AS t2 ON t1.name = t2.name GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 3",
399156b9ba93c105aec739fd,What was the name of the organism found in patient 10021487's last bronchoalveolar lavage microbiology test since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10021487 AND sample_type = 'bronchoalveolar lavage' AND date >= '2000-08-21' ORDER BY date DESC LIMIT 1,[]
e4e425cc7d58d5e7949bf727,"Since 1 year ago, has patient 10019917 received a diagnosis?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10019917 AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')",
dba29179e51c6b419b68143d,Can you tell me which were the top three most frequently tested specimens?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(specimen) FROM testing GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
f081cc4e63e6199eb7122b0c,Existe-t-il a genetic test that is recieved by patient 54700?,,SELECT EXISTS (SELECT * FROM lab WHERE lab.patient = 54700 AND lab.test = 'genetic'),
20ff0d8a96d5878700a5ea94,"Patient 10036156, when was your last mrsa screen microbiology test on the last hospital visit?",SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(date) FROM microbiology WHERE patient = 10036156 AND screen_type = 'mrsa screen microbiology',[]
0b19e40d278a97e915037e52,"Compared to yesterday, what were the new prescriptions for patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions FROM today WHERE patient_id = 10039831 AND date_sub('day', today.date, yesterday.date) > 0",[]
3f228b2d28b47133dbf76724,"For the patients with age 30s, what are the top four most frequent diagnoses since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM diagnoses WHERE age BETWEEN 30 AND 39 GROUP BY diagnosis HAVING MIN(year(diagnosis)) >= 2100) AS t1 WHERE t1.c1 <= 4",
24f447b683e61e944f998093,"For the last time, what was the medication that patient 10015860 was prescribed in 10/this year via the pr route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT name FROM medication WHERE id IN (SELECT medication_id FROM prescriptions WHERE patient_id = 10015860 AND route = 'pr' AND date_prescribed = SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10015860),[]
f32d842f0e3bf602efb3e22f,Calculate how many patients were in medical/surgical intensive care unit (micu/sicu) in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, icu.unit_type FROM patient INNER JOIN icu ON patient.unit_id = icu.unit_id WHERE icu.unit_type = 'medical/surgical intensive care unit' AND STRFTIME('%y', icu.unit_admission_date) = '2100') AS t1;",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
faa2fbd6a8db7bed5790ed25,Tell me the duration in days of patient 10022017's last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT SUM( Durations.days ) FROM (SELECT patient.admittime, patient.dischtime, patient.dischtime - patient.admittime AS days FROM patient WHERE patient.patient_id = 10022017) AS Durations","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.4736574068665504}]"
75ad30a366fbe3a6f2ed6f8a,Tell me the top three most common diagnoses for patients aged 30s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, COUNT(diagnosis) AS c FROM patients WHERE age BETWEEN 30 AND 39 GROUP BY diagnosis) AS t1 ORDER BY c DESC LIMIT 3",
87539c9734c671cc091d67fc,When last did patient 10018081 have the minimum diastolic blood pressure since 10/04/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-04' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MIN(diastolic_blood_pressure) FROM blood_pressure WHERE patient_id = 10018081 AND measurement_date >= '2100-10-04',[]
62ccca10373d7fea84d98e31,What were the three most frequent events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT Event, COUNT(*) FROM brackets GROUP BY Event ORDER BY COUNT(*) DESC LIMIT 3","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
7a476916387b8ccd604b7f3e,Could you tell me the top four most common procedures for patients aged 50s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.Name, COUNT(t1.Name) FROM (SELECT Name FROM procedures WHERE Age BETWEEN 50 AND 59 AND year(date) >= 2100) AS t1 JOIN patients AS t2 ON t1.patient = t2.id GROUP BY t1.Name ORDER BY COUNT(t1.Name) DESC LIMIT 4",
f8739799c8cf7c00eb97451a,"During this year, has patient 10011398 received a diagnosis?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10011398 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
a34a60cc88fbeb47c1d1c41d,What is the daily maximum value of weight for patient 10019385 in 03/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(weight) FROM patient_10019385 WHERE measurement_date = '2003-03-2100' GROUP BY measurement_date;,[]
37192bb658b60d3559cff295,"What are the five most commonly ordered procedures for patients who were previously diagnosed with noncompliance with renal dialysis, which occurred in the same hospital encounter since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.code, COUNT(t3.code) FROM (SELECT t2.code, COUNT(t2.code) FROM (SELECT patient.uniquepid, diagnosis.diagnosistime, patient.patientname FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'noncompliance with renal dialysis' AND STRFTIME('%y', diagnosis.diagnosistime) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, treatment.code, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE STRFTIME('%y', treatment.treatmenttime) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosistime < t2.treatmenttime AND t1.patientname = t2.patientname GROUP BY t2.code) AS t3 JOIN (SELECT patient.uniquepid, treatment.code, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON",
9a96aaa745308385eb906bb2,What was the name of the drug that patient 10012552 was prescribed in the same hospital visit after having received a single internal mammary-coronary artery bypass procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug_name FROM (SELECT patient.id, treatment.hospital_id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10012552 AND treatment.treatment_type = 'single internal mammary-coronary artery bypass') AS t1 JOIN (SELECT patient.id, drug.drug_name, treatment.hospital_id, treatment.treatment_date FROM drug JOIN patient ON drug.patient_id = patient.id WHERE patient.id = 10012552) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.hospital_id = t2.hospital_id AND t1.treatment_date < t2.treatment_date",
b3f5a532355044ec8ff3ee49,When did patient 10015860 receive the last bisacodyl and ondansetron prescription at the same time in 10/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bisacodyl' AND admissions.subject_id = 10015860 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10015860 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT SUM(DATE '10/01/2005') FROM patients WHERE patients.patient_id = 10015860 AND patients.drug_name = 'bisacodyl',[]
42b0089e4e28f35c3bd7f8e5,"On this month/30, what was the first arterial blood pressure systolic reading for patient 10018081?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(arterial_blood_pressure_systolic) FROM read_brackets_patient_10018081 WHERE date = SELECT date FROM read_brackets_patient_10018081 WHERE patient_id = 10018081,[]
c8f9a04c499ddf84d314c397,What was the first thing patient 10018328 had as output on 05/09/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-05-09' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT MIN(function(patient)) FROM patient WHERE patient.name = '10018328' AND STRFTIME('%y-%m-%d', patient.output) = '2100-05-09'",[]
a7957c2fffd3930db882e4cc,Count the number of patients who underwent a rbc lab test since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.lab_result(lab_name => 'rbc', date => CURRENT_DATE - INTERVAL '1 year') IS NOT NULL",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
5bd9ccae8a4d90eca4b4002c,What was the total po intake amount given for patient 10004235 on 03/24/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-24'",SELECT SUM(POintake) FROM intake WHERE Patient = 10004235 AND Date = '2000-03-24',[{'SUM(inputevents.totalamount)': None}]
b92c083ece2259339c38b5c1,"During the first hospital visit, was patient 10039708 admitted to an emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.emergency_room_admit = 'true' AND NOT admissions.dischtime IS NULL ORDER BY admissions.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
d062f51ae3bd2b4a5b501051,Give me the five most common treatments since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment FROM (SELECT 'surgery' AS treatment FROM (SELECT 'treatment' AS treatment FROM (SELECT 'diagnosis' AS treatment FROM (SELECT 'patient' AS treatment FROM (SELECT 'clinical trial' AS treatment FROM (SELECT 'observation' AS treatment FROM (SELECT 'specimen' AS treatment FROM (SELECT 'report' AS treatment FROM (SELECT 'date' AS treatment FROM (SELECT 'location' AS treatment FROM (SELECT 'device' AS treatment FROM (SELECT 'patient' AS treatment FROM (SELECT 'clinical trial' AS treatment FROM (SELECT 'observation' AS treatment FROM (SELECT 'specimen' AS treatment FROM (SELECT 'report' AS treatment FROM (SELECT 'date' AS treatment FROM (SELECT 'location' AS treatment FROM (SELECT 'device' AS treatment FROM (SELECT 'patient' AS treatment FROM (SELECT 'clinical trial' AS treatment FROM (SELECT 'observation' AS treatment FROM (SELECT 'specimen' AS treatment FROM (SELECT 'report' AS treatment FROM (SELECT 'date' AS treatment FROM (SELECT 'location' AS",
74cb952e6290049d94447a5f,Tell me the last output of patient 10005909 since 269 days ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-269 day') ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT STRFTIME('%Y-%m-%d %H:%M:%S', 'now') - INTERVAL '269 day') as last_output",[{'label': 'Void'}]
f8fd30d0d0f870b4bd2f4abe,What was the last time patient 10038999 had a blood culture microbiology test in 05/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology WHERE patient_id = 10038999 AND culture_type = 'blood culture' AND date BETWEEN '2000-05-2100' AND '2000-05-2100',[]
b440a7a78eb175aad7326406,Please retrieve the daily minimum amount of patient 10005817's albumin 5% input on the last hospital visit.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT MIN(brackets.albumin_5%) FROM brackets WHERE brackets.patient_id = 10005817 AND NOT brackets.hospital_dischtime IS NULL ORDER BY brackets.hospital_admittime DESC LIMIT 1;,[]
ea99947eb86635891276c5de,Does patient 76494 have a family history of ac/chr syst/dia hrt fail,,SELECT COUNT(*) > 0 FROM patients WHERE patients.family_history = 'ac/chr syst/dia hrt fail' AND patients.patient_id = 76494,
a6fc04dbbe1e0ba75ba30f18,What was the organism found in the first bronchoalveolar lavage test of patient 10021487 since 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism FROM tests WHERE patient_id = 10021487 AND test_type = 'bronchoalveolar lavage' AND date = '10/2100' ORDER BY date NULLS FIRST LIMIT 1,[]
9011b8d82bdbbf46bb8ecbb9,Show me the four most common microbiology tests performed this year.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT t.name, COUNT(t.name) FROM microbiology_tests t",[]
15e2ea64a2fe87620f2135f7,When was patient 10005348 last blood culture microbiologic test since 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(Blood_Culture_Microbiologic_Test_Date) FROM Microbiology_Tests WHERE Patient_ID = 10005348 AND Date_Collected >= '2000-07-2100',[]
d2d6e834bd7830831783fa05,What is the total number of days that have passed since patient 10021487's first asparate aminotransferase (ast) lab test in the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT COUNT(DISTINCT t1.c1) FROM (SELECT days_since_first_lab FROM (SELECT patient_id, lab_date FROM lab_data WHERE lab_name = 'asparate aminotransferase (ast)') AS t1 JOIN (SELECT patient_id, lab_date FROM lab_data WHERE patient_id = 10021487 AND lab_name = 'asparate aminotransferase (ast)') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.lab_date < t2.lab_date) AS t3;",[]
904c2c0c49be0f63d95d5358,Tell me the maximum total hospital cost that involves accidental poisoning from other specified plants in 2100.,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental poisoning from other specified plants' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(h.cost) AS c1 FROM heatl h WHERE h.heat_type = 'accidental poisoning from other specified plants' AND h.year = 2100 GROUP BY h.heat_type) AS t1;,
25d2b1ca042e80e4dec9ba6c,Has there been any pacu crystalloid intake given to patient 10008287 in 10/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pacu crystalloid intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',inputevents.starttime) = '10'","SELECT COUNT(*) FROM intake WHERE intake.patient_id = 10008287 AND intake.item = 'pacu crystalloid' AND DATETIME(intake.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', intake.date) = '10'",[{'COUNT(*)>0': 0}]
d53c2b6d7e4bf45b77a8dd12,What kind of blood patient 85700 has.,,SELECT patient.blood_type FROM patients WHERE patient.id = 85700;,
f3ae841b553febe658abd103,What is the difference between respiratory rate on patient 10031404 last measured on the last ICU visit compared to the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10031404 AND NOT icu_visit IS NULL ORDER BY measurement_time DESC LIMIT 1) - (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10031404 AND NOT icu_visit IS NULL ORDER BY measurement_time NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
f60d7cbfd76dabfff55dc3fa,Help me tell the name of the diagnosis patient 92846 received in the other department.,,SELECT diagnosis.name FROM diagnosis JOIN patient ON diagnosis.patient = patient.id WHERE patient.id = 92846 AND diagnosis.location = 'other department',
928843eaa6be302dc4f25820,What's the minimum total hospital cost involving a drug named ibuprofen suspension in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ibuprofen suspension' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost_type = 'drug' AND date BETWEEN '2000-01-01' AND '2000-12-31' AND drug = 'ibuprofen suspension' GROUP BY cost) AS t1,
15e5163ccc3e3c1f766d7f6a,Is the red blood cells level of patient 10021312 last measured on the first hospital visit greater than the second to last level measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab_result FROM lab_results WHERE lab_result_type = 'red blood cells' AND patient_id = 10021312 AND NOT hospital_visit_number IS NULL ORDER BY hospital_visit_number NULLS FIRST LIMIT 1) > (SELECT lab_result FROM lab_results WHERE lab_result_type = 'red blood cells' AND patient_id = 10021312 AND NOT hospital_visit_number IS NULL ORDER BY hospital_visit_number DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
c74358b1e7b5bc977788edc9,"What are the three frequently prescribed medications in the same month to the patients aged 60 or above after diagnosed with hypotension, unspecified in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypotension, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'hypotension, unspecified' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.start_date FROM medication JOIN patient ON medication.patient_id = patient.uniquepid WHERE patient.age >= 60 AND STRFTIME('%y', medication.start_date) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.start_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.start_date, 'start of month') GROUP BY t2.name) AS t3",
5fdedc40e18f8009f6111be2,Was nacl 0.9% administrated to patient 10015272 on their last ICU stay?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM admin_history WHERE admin_history.patient_id = 10015272 AND admin_history.admin_type = 'NACL 0.9%' AND NOT admin_history.end_date IS NULL ORDER BY admin_history.start_date DESC LIMIT 1,[{'COUNT(*)>0': 0}]
361dee11faf11169d073ea66,Number of patients who received a mediastinoscopy procedure in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'mediastinoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT id) FROM procedures WHERE procedure = 'mediastinoscopy' AND date_sub('year', CURRENT_DATE, date) > 1",
8444ba22b9c952cf50e50901,Can you confirm what was the first temperature celsius for patient 10021487 in their first ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT ""temperature_celsius"" FROM ""icu_visits"" WHERE ""patient_id"" = 10021487 AND NOT ""outcome"" IS NULL ORDER BY ""visit_date"" NULLS FIRST LIMIT 1;",[]
15f5e817e7a5d3115e1563e0,Get me patient 10005817's total output volume since 03/12/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-12'",SELECT SUM(output) FROM patient WHERE patient_id = 10005817 AND start_date >= '2100-03-12',[{'SUM(outputevents.value)': 41303.0}]
5df781cee8420b4e67b5b670,Could you show me the top three most common microbiology tests since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t3.test, COUNT(t3.test) FROM (SELECT t2.test, COUNT(t2.test) FROM (SELECT microbiology.test, COUNT(microbiology.test) FROM microbiology WHERE microbiology.year >= 2100 GROUP BY microbiology.test) AS t1 JOIN (SELECT test, COUNT(test) FROM (SELECT microbiology.test, COUNT(microbiology.test) FROM microbiology WHERE microbiology.year >= 2100 GROUP BY microbiology.test) AS t2 ON t1.test = t2.test) AS t3 GROUP BY t3.test ORDER BY COUNT(t3.test) DESC LIMIT 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
2ddc5aa70252d046606081e2,What organism was found in patient 10004733's first sputum test since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism FROM SputumMicrobiology WHERE patient_id = 10004733 AND sample_date >= '2000-08-2100' ORDER BY sample_date NULLS FIRST LIMIT 1,[]
693d2161daa94f0ac19a5ff2,What did patient 10006053 have first as the output on 11/17/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-17' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT patient.name, output.type, output.value FROM patient, output WHERE patient.output = output AND patient.id = 10006053 AND STRFTIME('%m/%d/%Y', patient.output) = '11/17/2100' ORDER BY patient.output.value NULLS FIRST LIMIT 1",[]
3c573f4b3f5561f9da5c2ca0,Count the number of patients who stayed in the previous year at trauma sicu (tsicu).,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'trauma sicu (tsicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT pid) FROM patients WHERE tsicu = 'trauma sicu (tsicu)' AND DATETIME(stay_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
2ddc53c4a796889b9c40ca78,What was the first medication that patient 10007058 was prescribed since 10/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT medication FROM prescriptions WHERE patient_id = 10007058 AND date >= '2000-10-21' ORDER BY date NULLS FIRST LIMIT 1,[{'drug': '5% Dextrose'}]
84c70bbe9310c79050cef5e6,"What was prescribed to patient 10018423 within 2 days following their measurement of cardiac sampling and pressure, left heart, percutaneous approach?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT t1.subject_id, t1.action_time FROM (SELECT subject_id, action_time FROM patient_actions WHERE action_type = 'cardiac sampling and pressure, left heart, percutaneous approach') AS t1 GROUP BY t1.subject_id HAVING MIN(t1.action_time) = t1.action_time) AS t2 JOIN (SELECT subject_id, name FROM patient_names WHERE patient_id = 10018423) AS t3 ON t2.subject_id = t3.subject_id WHERE t2.action_time < t3.action_time AND DATETIME(t2.action_time) BETWEEN DATETIME(t3.action_time) AND DATETIME(t3.action_time, '+2 day')",
56950cbe39154cd6825d8851,What are the four most frequently tested specimens for patients that received parenteral infusion of concentrated nutritional substances previously in the same month in this year?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.date FROM (SELECT patient.uniquepid, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.uniquepid WHERE treatment.treatment = 'Parenteral infusion of concentrated nutritional substances') AS t1 JOIN (SELECT patient.uniquepid, specimen, date FROM lab JOIN patient ON lab.patient = patient.uniquepid WHERE date BETWEEN '2001-01-01' AND '2001-12-31') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date BETWEEN DATETIME(t2.date, '-0 month') AND DATETIME(t2.date, '+0 month') GROUP BY t2.specimen) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 4",
214a7cc494b5ad3fd78e9765,"So, when is the earliest patient 28343 is going to come in the hospital?",,SELECT MIN(hospital_admittime) FROM patient WHERE patient_id = 28343,
ae5fdb3772ef4280f5cbd7d8,When was the first time that patient 10027602 on last month/29 had a heart rate that was less than 105.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 105.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime(patient.heart_rate, '%Y-%m-%d %H:%M:%S') as heart_rate_time",[]
7d02af05751b72aaed0916cd,What exactly was the last drug that patient 10001217 was prescribed in 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10001217 AND STRFTIME('%y-%m', prescriptions.date) = '2100-12' ORDER BY prescriptions.date DESC LIMIT 1;",[]
9e244cb537e766b890782d9a,What is the total volume of patient 10009628's input since 07/04/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04'",SELECT SUM(volume) FROM intake WHERE patient_id = 10009628 AND date >= '2100-07-04',[{'SUM(inputevents.totalamount)': 22950.0}]
a49ff217e1eaf845efa42727,"Since the first diagnosis of patient 10018081 with pure hypercholesterolemia on their current hospital encounter, how many days have passed?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = 'Pure hypercholesterolemia' AND patient_id = 10018081 AND database_name = current_database()",
46c7a622bf32b53e152dc112,When patient 10027445 was prescribed for the first time in 08/this year glucagon and insulin at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT COUNT(DISTINCT t1.start_date) FROM (SELECT patient.prescription_start_date, patient.patient_id FROM patient WHERE patient.patient_id = 10027445 AND patient.prescription_start_date BETWEEN '2008-01-01' AND '2008-12-31') AS t1 JOIN (SELECT patient.prescription_start_date, patient.patient_id FROM patient WHERE patient.patient_id = 10027445 AND patient.prescription_start_date BETWEEN '2008-01-01' AND '2008-12-31' AND prescription_name = 'insulin') AS t2 ON t1.start_date = t2.start_date WHERE DATETIME(t1.start_date, 'start of year') = DATETIME(t2.start_date, 'start of year') AND DATETIME(t1.start_date, 'start of month') = DATETIME(t2.start_date",[]
c630812541cf6dfbf08a52c9,List the top four most frequently tested specimens in this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT specimen, COUNT(specimen) FROM brackets WHERE year = 2012 GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 4;",[]
a301cbb555555b4a30c9dfbe,What is a checklist before lumb/lmbosac fus ant/ant?,,"SELECT * FROM patients WHERE procedures.lumb_lmbosac_fus_ant_ant = ""CHECKLIST""",
b56a14e89ad09be086852b0f,"Has patient 10013049 got a hematocrit, calculated lab test in 2100?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*) FROM lab WHERE lab.patient_id = 10013049 AND lab.lab_name = 'Hematocrit, Calculated' AND STRFTIME('%y', lab.date) = '2100'",[{'COUNT(*)>0': 0}]
484f6763a7263dfc6dd3843b,What's the platelet count change of patient 10021487 last measured on the current hospital visit compared to the second to last value measured on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10021487 AND lab_data.label = 'platelet count' ORDER BY lab_data.measurement_time DESC LIMIT 1) - (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10021487 AND lab_data.label = 'platelet count' ORDER BY lab_data.measurement_time DESC LIMIT 1 OFFSET 1);,"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
9c9100431bbeace3679922e0,How much does it cost to purchase phenobarbital?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital' ),SELECT DISTINCT cost FROM products WHERE product = 'phenobarbital';,
c6e0a3d4dc4ef5f0f7b05662,What were the top three diagnoses that had the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT t3.diagnosis, t3.c1, t3.c2 FROM (SELECT t2.diagnosis, t2.c1, t2.c2 FROM (SELECT * FROM diagnoses ORDER BY diagnosis NULLS FIRST LIMIT 3) AS t1 JOIN (SELECT * FROMBrackets WHERE Brackets.diagnosis = t1.diagnosis) AS t2 ON t1.diagnosis = t2.diagnosis) AS t3 JOIN (SELECT * FROM Brackets WHERE Brackets.diagnosis = t3.diagnosis) AS t4 ON t3.diagnosis = t4.diagnosis ORDER BY t4.c1 DESC LIMIT 1;",
1e04b4d24fdf02742f3ee567,Has there been any organism present in patient 10037861's last blood culture microbiology test since 07/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*) FROM microbiology WHERE microbiology.patient_id IN (SELECT patient.patient_id FROM patient WHERE patient.patient_id = 10037861) AND microbiology.blood_culture_date >= '2000-07-2100' AND microbiology.blood_culture_method = 'blood culture',[{'COUNT(*)>0': 0}]
7963b2f32402222a44a74bc2,Was patient 10002428 to the er during their last hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 10002428 AND patients.admission_location = 'emergency room admit' AND NOT patients.dischtime IS NULL ORDER BY patients.admittime DESC LIMIT 1,[{'COUNT(*)>0': 0}]
ad9224e407b2a53c4120193b,Count the number of patients who took oxycodone sr (oxycontin) this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'oxycodone sr (oxycontin)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.identifier) FROM patient WHERE patient.prescriptions.oxycodone_sr__oxycontin = 'SR' AND DATETIME(patient.prescriptions.start_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
acabae620677b5ffeff62317,Which are the four most common specimens tested since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT specimen, COUNT(specimen) FROM species_since_2000 GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]"
0f42767e5be8f1f3825dbebf,What was the total jackson pratt #1 output of patient 10020740 since 02/04/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jackson pratt #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-04'",SELECT COUNT(DISTINCT Jackson_Pratt_#1) FROM output WHERE patient_id = 10020740 AND output_date >= '2100-02-04',[{'SUM(outputevents.value)': None}]
f26956b68a52957757b13e45,What was the last time that patient 10015272 had the maximum value of white blood cells?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(WhiteBloodCells) FROM (SELECT WhiteBloodCells FROM WhiteBloodCells WHERE PatientID = 10015272),[]
0032247aa14645cbf758a680,Tell me the top four most commonly prescribed medications during the same hospital encounter to patients in their 50s who were diagnosed with other and unspecified hyperlipidemia.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t1.name FROM (SELECT prescriptions.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE prescriptions.drug_category = 'Other and unspecified hyperlipidemia' GROUP BY prescriptions.name) AS t1 WHERE t1.c1 <= 4",
970112eab9858a27e20a091f,Can you please tell me the name of the diagnosis that patient 73693 received from the other department?,,SELECT diagnosis FROM other_diagnoses WHERE other_diagnoses.patient_id = 73693,
e5feed6651e93e164fbd7c11,What was patient 10036156's total input amount of po intake during the last ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ),SELECT SUM(intake) FROM intake WHERE intake.patient = 10036156 AND intake.type = 'po intake' AND NOT intake.icu_visit IS NULL ORDER BY intake.icu_visit DESC LIMIT 1;,[{'SUM(inputevents.totalamount)': None}]
653ee6598cd92b3382f04431,"Has octreotide acetate, furosemide, or trazodone been prescribed since 20 months ago to patient 10019777?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.drug IN ( 'octreotide acetate', 'furosemide', 'trazodone' ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-20 month')","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient = 10019777 AND medication.date >= DATEADD(month, -20, CURRENT_DATE) AND medication.drug IN ('octreotide acetate', 'furosemide', 'trazodone')",[{'COUNT(*)>0': 0}]
5b078faf4cef1188372987db,Has patient 10001217 been administered any nacl 0.9% in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*) > 0 FROM admin_data WHERE admin_data.patient_id = 10001217 AND admin_data.drug_name = 'nacl 0.9%' AND DATETIME(admin_data.admin_time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year') AND STRFTIME('%m', admin_data.admin_time) = '12'",[{'COUNT(*)>0': 0}]
56fd4c77a08d2c69466f3daf,How is readi-cat 2 (barium sulfate 2% suspension) typically consumed?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)',SELECT * FROM brackets.questions WHERE questions.question_name = 'How is readi-cat 2 (barium sulfate 2% suspension) typically consumed?',[]
cc8811490b346c0fe68bf66b,How much does patient 10027602's weight differ from the second value measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patient_weight WHERE patient_id = 10027602 AND NOT patient_weight.date IS NULL ORDER BY patient_weight.date DESC LIMIT 1) - (SELECT weight FROM patient_weight WHERE patient_id = 10027602 AND NOT patient_weight.date IS NULL ORDER BY patient_weight.date NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
f3ecb8116711437750ac3fb5,What was the last time patient 10020740 was prescribed medications via the po/ng route on their first hospital visit?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1,"SELECT MAX(t1.c1) FROM (SELECT STRFTIME('%y-%m-%d %H:%M:%S', p.date) AS c1 FROM patient p WHERE p.subject = '10020740' AND NOT p.dischtime IS NULL ORDER BY p.date NULLS FIRST LIMIT 1) AS t1",[]
eedf0ba9662962adc4283987,"The last time , when was patient 10002495 prescribed insulin and atorvastatin at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10002495 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'atorvastatin' AND admissions.subject_id = 10002495 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT t1.date FROM (SELECT patient_id, prescription_date FROM prescriptions WHERE patient_id = 10002495 AND prescription_name = 'insulin') AS t1 JOIN (SELECT patient_id, prescription_date FROM prescriptions WHERE patient_id = 10002495 AND prescription_name = 'atorvastatin') AS t2 ON t1.patient_id = t2.patient_id WHERE DATETIME(t1.prescription_date) = DATETIME(t2.prescription_date)",[]
c919552da540025ef269dfef,Tell me all of the prescriptions patient 2518 was given in the other department,,SELECT prescriptions FROM rx WHERE patient_id = 2518 AND department <> (SELECT department FROM rx WHERE patient_id = 2518 AND prescriptions = 'Other Department Prescriptions'),
792f2622a77b8638438de22f,"For patients diagnosed with other specified retention of urine before, what are the top five most common treatments in the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified retention of urine' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, PATIENT_ID FROM (SELECT PATIENT_ID, INTERVAL_FROM_DAY(CURRENT_DATE - DATE(DIAGNOSIS_DATE)) AS days_since_diagnosis FROM diagnoses WHERE DIAGNOSIS_TYPE = 'Other specified retention of urine') AS t1 JOIN (SELECT PATIENT_ID, TREATMENT FROM treatments WHERE TREATMENT_TYPE = 'Other specified retention of urine') AS t2 ON t1.PATIENT_ID = t2.PATIENT_ID WHERE t1.days_since_diagnosis >= 0) AS t3 WHERE t3.PATIENT_ID IN (SELECT PATIENT_ID FROM (SELECT PATIENT_ID, INTERVAL_FROM_DAY(CURRENT_DATE - DATE(DIAGNOSIS_DATE)) AS days_since_diagnosis FROM diagnoses WHERE DIAGNOSIS_TYPE = 'Other specified retention of urine') AS t",
00ab16773d5c5cbe1e63f28b,Which are the top three most frequent procedures patients had within 2 months after being diagnosed with other opiates and related narcotics causing adverse effects in therapeutic use?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other opiates and related narcotics causing adverse effects in therapeutic use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, COUNT(t2.diagnosis) FROM (SELECT patient.id, diagnosis.diagnosis FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Other opiates and related narcotics causing adverse effects in therapeutic use') AS t1 JOIN patient ON t1.id = patient.id WHERE patient.diagnosis = 'Other opiates and related narcotics causing adverse effects in therapeutic use') AS t2 ON t2.id = patient.id WHERE t2.diagnosis = patient.diagnosis AND DATETIME(t2.diagnosis, 'start of month') BETWEEN DATETIME(patient.diagnosis, 'start of month') AND DATETIME(patient.diagnosis, 'start of month', '+2 month') GROUP BY t2.diagnosis) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis)",
5df1cd4b427c7adcfb315ff9,"During the last hospital encounter, what was the insurance plan of patient 10007795?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance_plan FROM patient WHERE patient.hospital_dischtime IS NULL AND patient.hospital_admittime = (SELECT MAX(hospital_admittime) FROM patient WHERE patient.subject_id = 10007795),[{'insurance': 'Medicare'}]
197b621f36437cbb2e24f71e,Tell me the minimum SaO2 of patient 10010471 since 66 days ago.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-66 day')","SELECT MIN(SaO2) FROM patients WHERE patient_id = 10010471 AND DATETIME(SaO2) >= DATETIME(CURRENT_TIME, '-66 day')",[{'MIN(chartevents.valuenum)': None}]
f517e3cce89ac464b8a1e6e1,What is the monthly average value of weight for patient 10007818?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10007818 GROUP BY month;,[]
57bfa65e25858649a7b7fdb1,Did patient 10039831 get a diagnosis in the last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10039831 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
8aff2d41878a4fe47a7284aa,Show me the length of stay in days of patient 10015860 from the last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', icu.stay.end_time) - STRFTIME('%j', icu.stay.start_time) AS length_of_stay_days","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.6421874999068677}]"
866f0e3f587b1c8992a48c02,What time was the first time the respiratory rate of patient 10020740 was less than 24.0 on 04/14/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 24.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-04-14' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT 04 AS _14_2100 FROM patients WHERE patient_id = 10020740 AND respiratory_rate < 24.0,[]
620fed67edcc618c82c9bb68,How many hours is it since patient 10004733 last received the magnesium lab test on their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab.last_result_date)) FROM lab WHERE lab.patient_id = 10004733 AND lab.lab_name = 'magnesium' AND lab.dischtime IS NULL;",[]
9ef4ff1a80eff792fae7eaf6,Calculate the number of patients diagnosed with other and unspecified escherichia coli [e. coli] in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified escherichia coli [e. coli]' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,
2ace025c677add406539f6bd,Is there any medication that patient 10039708 has received since 11/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10039708 AND STRFTIME('%y-%m', medication.date) >= '2100-11'",[{'COUNT(*)>0': 1}]
8e706a5e5f4902a5d9824238,Has patient 10037975 undergone any procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10037975;,[{'COUNT(*)>0': 1}]
fdf5c1e275419554ef051eb7,"In 2100, what were the top four most commonly tested specimens?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT specimen FROM (SELECT specimen, COUNT(*) FROM (SELECT current_specimen(specimen) AS specimen FROM (SELECT DISTINCT specimen FROM (SELECT current_specimen(specimen) AS specimen FROM spectra WHERE year = 2010 GROUP BY specimen) AS top_four_specimens JOIN spectra ON top_four_specimens.specimen = spectra.specimen GROUP BY specimen) AS top_two_specimens JOIN spectra ON top_two_specimens.specimen = spectra.specimen GROUP BY specimen) AS top_one_specimens JOIN spectra ON top_one_specimens.specimen = spectra.specimen GROUP BY specimen) AS final_specimens;",[]
188357b19ef7a1e1306dde6a,What is the average daily number of patients suffering from malignant neoplasm of unspecified part of unspecified bronchus or lung?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",SELECT AVG(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis_date) AS c1 FROM diagnoses WHERE diagnosis = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' GROUP BY diagnosis_date) AS t1,
ec87b2a66e1ee117d0c97694,What was the total of 0.9% sodium chloride that patient 10018423 had been prescribed in 05/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.drug = '0.9% sodium chloride' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'",SELECT COUNT(0.9% sodium chloride) FROM patients WHERE patient_id = 10018423 AND date_prescribed = '05/2100',[{'SUM(prescriptions.dose_val_rx)': None}]
cc8133f15a89f38b3c28c9e9,What was the name of the organism found in the first mini-bal microbiology test of patient 10027602 in 12/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10027602 AND date = '12/2100' AND sample_type = 'mini-bal' ORDER BY date NULLS FIRST LIMIT 1;,[]
ab7b619c104c7acdd3b347a6,"Number of patients who were given a drainage of left pleural cavity, percutaneous approach procedure since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date_of_procedure FROM t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t2.date_of_procedure >= DATEADD(year, -1, GETDATE())) AS t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t2.date_of_procedure = 'Left pleural cavity, percutaneous approach'",
a00135dbda426f37103c4031,Calculate the total volume of input by patient 10018081 on this month/29.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '29'",SELECT SUM(volume) FROM input WHERE patient = 10018081 AND input_date = CURRENT_DATE - INTERVAL '0 month 29',[{'SUM(inputevents.totalamount)': None}]
79435a6fda1d423ee215c027,Is there any genetic test that patient 14035 received?,,SELECT COUNT(*) > 0 FROM genomics WHERE patient_id = 14035,
ae62f6afd4c306068c936631,Reveal the five most frequently prescribed medications in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.name FROM (SELECT medication.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM medication WHERE STRFTIME('%y', medication.date) = '2100' GROUP BY medication.name) AS t1 WHERE t1.c1 <= 5;",[]
a2f8e369e61f50385ba06afd,Has patient 10016150 been given any diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10016150,[{'COUNT(*)>0': 1}]
395e9529519397ab2b92b3bf,When was the last input time since 05/14/2100 for patient 10027602?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-14' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10027602 AND input_time >= '2100-05-14';,[{'starttime': '2201-12-13 16:51:00'}]
35727539614c8de00c1936fa,Has a procedure been performed on patient 10013049?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10013049;,[{'COUNT(*)>0': 1}]
c06489b1989596c5c396021d,What code is associated with icd-11 for aphasia in icd-10?,,SELECT icd_11 FROM icd_mapping WHERE icd_10 = 'aphasia';,
3355ff6ec63f5859b0030ed5,List the four most frequent specimens that were tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT specimen, COUNT(*) FROM (SELECT specimen FROM inventory WHERE year >= 2100) GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 4;","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]"
3b1ed5c49626132195b70ec8,What was the name of the organism in the last abscess microbiology test of patient 10001217 since 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM microbiology_test WHERE patient_id = 10001217 AND microbiology_test_type = 'abscess' AND NOT microbiology_test_date IS NULL AND microbiology_test_date >= '2021-10-2100' ORDER BY microbiology_test_date DESC LIMIT 1,[]
e51c2dd489fa0ebf1c2b7700,What is the protocol used for the anticancer drugs?,,SELECT DISTINCT protocol FROM drugs WHERE use IN ('anticancer');,
94f9e6d642b39e6a9d1a0559,What is the maximum total cost for a hospital visit that involved a macrophage lab test?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophage' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(t.total_cost) FROM (SELECT s.quantity * p.unit_price AS total_cost FROM lab_data s JOIN prices p ON s.lab_date = p.ticker_time WHERE s.lab_name = 'macrophage') t;,
79cd6dad6ad9f5ff2c2684e6,What was the name of that first specimen test patient 10029484 got since 11/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_test(patient_id) FROM patients WHERE patient_id = 10029484 AND date_since = '11/2100' ORDER BY date_since DESC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}]
917adcbd5e526c5a6f592092,What was the first time patient 10029291 input time on 02/25/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-25' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10029291 AND input_time BETWEEN '2000-02-25 00:00:00' AND '2000-02-25 23:59:59';,[]
db9a6d17c2bdc3d58e519267,When was the first time that patient 10021487 had the minimum value of heart rate on 12/10/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-10' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(heart_rate) FROM patient_heart_rate WHERE patient_id = 10021487 AND measurement_date BETWEEN '2022-12-10' AND '2022-12-10',[]
5ec73b90a9326c7868163c73,When was the first time patient 10018081 was prescribed drugs via oral since 08/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'oral' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10018081 AND prescriptions.route = 'oral' AND STRFTIME('%y-%m', date_prescribed) >= '2100-08'",[]
e60031fe0c3c45aa32032148,Could you list the top five most common lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests UNION ALL SELECT lab_test FROM lab_tests) t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
dc414e02268ef72244d435fd,Is the value of bicarbonate last measured on the last hospital visit of patient 10019172 greater than its value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT bicarbonate FROM patients WHERE patient_id = 10019172 AND NOT last_hospital_visit IS NULL ORDER BY bicarbonate DESC LIMIT 1) > (SELECT bicarbonate FROM patients WHERE patient_id = 10019172 AND NOT last_hospital_visit IS NULL ORDER BY bicarbonate NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
d28d6593912738578589157f,What is the percentile of 80.0 in the ferritin lab test with the same age as patient 10002428 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 80.0","SELECT t1.c1 FROM (SELECT lab.ferritin, PERCENT_RANK() OVER (ORDER BY lab.ferritin NULLS FIRST) AS c1 FROM lab WHERE lab.age = (SELECT lab.age FROM lab WHERE lab.name = 'patient 10002428' AND lab.age IS NOT NULL ORDER BY lab.age DESC LIMIT 1)) AS t1 WHERE t1.ferritin = 80.0",
924d74602015e6d3739732e2,What were the four most frequent microbiology tests that occurred in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT t.name FROM (SELECT microbiology.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c FROM microbiology WHERE STRFTIME('%y', microbiology.date) = '2100' GROUP BY microbiology.name) AS t WHERE t.c <= 4",[]
6f420047cefd3ec90873fd93,What are the new prescriptions for patient 10018081 today compared to those received yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.new_prescriptions FROM prescriptions WHERE prescriptions.patient_id = 10018081 AND DATETIME(prescriptions.start_date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescriptions.start_date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
098b1301820b7d581a339d0f,What was the first time patient 10018081 was prescribed a medication using the iv drip route in 12/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT iv_drip.route_time FROM iv_drip WHERE iv_drip.patient_id = 10018081 AND DATETIME(iv_drip.route_time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', iv_drip.route_time) = '12' ORDER BY iv_drip.route_time NULLS FIRST LIMIT 1",[]
1d4b0f83e48e3a972b624537,Work out the total amount of input patient 10016742 received on 08/04/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '08-04'",SELECT SUM(input_patient_10016742) FROM input_patient WHERE input_patient_10016742_date = '08/04/2022';,[{'SUM(inputevents.totalamount)': None}]
7cbf3d09dcab163910469c88,What was the organism detected during the first urine microbiology test of patient 10037861 since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism FROM microbiology WHERE patient_id = 10037861 AND urine_microbiology = 1 AND date >= '2000-08-21' ORDER BY date NULLS FIRST LIMIT 1,[]
11a1a3c59f2b62a99f566f9f,Which are the top three most frequent output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT my_output_event, COUNT(*) FROM my_table WHERE my_column = 'some_value' AND STRFTIME('%Y', my_date) >= 2100 GROUP BY my_output_event ORDER BY COUNT(*) DESC LIMIT 3;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
89130abd0de50ce13b9c3566,What was the five most common lab test that was given during this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date BETWEEN '2022-01-01' AND '2022-12-31') AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5",[]
94d863c5097e63e95a31ebf4,"What is the minimum total cost of the hospital visits that involve a procedure named occlusion of right vertebral artery with intraluminal device, percutaneous approach since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure_name = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY procedures.patient_id) AS t1",
fec026b891afb9bccb1664e9,"Count the number of patients who received dilation of left external iliac vein with intraluminal device, percutaneous approach within 2 months after being diagnosed with operating room of hospital as the place of occurrence of the external cause in the last year.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, diagnoses.date_diagnosed FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'operating room of hospital' AND DATETIME(diagnoses.date_diagnosed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')) AS t1 JOIN (SELECT admissions.subject_id, procedures.date_procedure FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE procedures.procedure = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' AND DATETIME(procedures.date_procedure, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date_diagnosed < t2.date_procedure AND DATETIME(t2.date_",
bb12c577d54cdbb658f77087,"Since 12/2100, when did patient 10021118 receive their last medication via the po route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_submitted) FROM medication_requests WHERE patient_id = 10021118 AND medication_route = 'po' AND date_submitted >= '2012-12-2100',[]
6b992edeff1d490c7c58f9d0,Could you tell me the sex of patient 10019172?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10019172,SELECT MIN(sex) FROM patients WHERE patient_id = 10019172,[{'gender': 'F'}]
546a49550415320fbb9316ad,What was the last time in 05/this year patient 10018328 was prescribed a medication via the iv route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM iv_route WHERE patient_id = 10018328 AND date_prescribed >= '2005-01-01',[]
efd16ed6fcf1c6e667f9bca7,Calculate the number of people who had arteriography of cerebral arteries last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patienttype = 'arteriography of cerebral arteries' AND DATETIME(patient.diagnosisdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
e23231367907b1d48afece71,Give me patient 10026406's length of stay in days for the first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT MIN(LENGTH_OF_STAY) FROM icu WHERE PATIENT_ID = 10026406 AND NOT ICU_STAY_ORDER IS NULL ORDER BY ICU_STAY_ORDER NULLS FIRST LIMIT 1;,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.48175925901159644}]"
8e476e63901b7be2cdb602f9,Can you tell me what patient 10027602's first arterial blood pressure diastolic was since 08/13/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT patient.first_arterial_blood_pressure_diastolic FROM patient WHERE patient.id = 10027602 AND STRFTIME('%y-%m-%d', patient.first_arterial_blood_pressure_diastolic) >= '2100-08-13'",[]
ec4b556e4ac98f7c6485240b,Tell me the icd-11 code for candidias urogenital nec in icd-10?,,SELECT icd_11 FROM icd_10 WHERE icd_10 = 'candidias urogenital nec';,
45ea928adb31250e23c1e7d7,What's the maximum total cost of a hospital that involves suicidal ideation?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(total_cost) FROM (SELECT SUM(cost) AS total_cost FROM (SELECT cost FROM (SELECT 1 AS cost) AS suicidal_ideation) AS s1 JOIN (SELECT 1 AS cost) AS depression ON s1.item = depression.item) AS s2) AS suicidal_ideation_cost ON s2.item = suicidal_ideation_cost.item,
130ed6628164c3afe9589f2d,"What were the three most commonly ordered lab tests for patients who were previously diagnosed with hemorrhage of rectum and anus during the same hospital visit, since 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.time FROM diagnosis JOIN patient ON diagnosis.patient = patient.id WHERE diagnosis.type = 'hemorrhage of rectum and anus' AND STRFTIME('%y', diagnosis.time) >= '2100') AS t1 JOIN (SELECT patient.id, lab.name, lab.time FROM lab JOIN patient ON lab.patient = patient.id WHERE STRFTIME('%y', lab.time) >= '2100') AS t2 ON t1.id = t2.id WHERE t1.time < t2.time AND t1.patient = t2.patient GROUP BY t2.name) AS t3 WHERE t3.c1 <= 3",
a59aa4e1124cf98b542230d0,Tell me the total number of patients who were discharged from the hospital since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissed_date IS NULL AND DATETIME(dismissed_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
774183417c33e5ca1129707b,Tell me the average total hospital cost that involves methylnaltrexone in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(1) FROM stats WHERE name = 'methylnaltrexone' AND year = 2100,
336b4ae66fafe9409bbf3780,Tell me the maximum SaO2 in patient 10007058 since 11/25/2100.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-25'","SELECT MAX(SaO2) FROM brackets WHERE patient_id = 10007058 AND measurement_date >= ""11/25/2100""",[{'MAX(chartevents.valuenum)': None}]
5a702ecafc152197b73cc54c,"In 2100, how many patients were prescribed prasugrel?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prasugrel' AND strftime('%Y',prescriptions.starttime) = '2100' )","SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.prescriber = 'Prasugrel' AND STRFTIME('%y', patient.date) = '2100';",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d84033aab28898c9a733e209,Can you tell me how old patient 10039708 was in their last hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patient WHERE patient.id = 10039708 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1,
2599f881605016f342ed4ad8,What was the first value of o2 saturation pulseoxymetry patient 10001217 had on 12/04/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-04' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(O2_SATURATION_PULSEOXYMETRY) FROM pulseoxymetry WHERE PATIENT_ID = 10001217 AND DATETIME(measurement_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND measurement_date BETWEEN '2012-12-04' AND '2012-12-04'",[]
f85c9633e450cf4188a98ce3,Get me the top three most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT diagnosis, COUNT(*) FROM patients GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 3;","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]"
187e5274711fbc5acb26d92f,When did patient 10004733 first have a maximum heart rate yesterday?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT MAX(heart_rate) FROM patient WHERE patient.id = 10004733 AND DATETIME(heart_rate_date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
d59d0db4be4aa6b37d49b1ef,Has any organism been found in patient 10005817's last stool test conducted?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT COUNT(*) > 0 FROM organism WHERE organism.patient_id = 10005817 AND organism.stool_type = 'last stool',[{'COUNT(*)>0': 0}]
a5d91ebb2b0d935b9c493f9f,"In 2100, has patient 10019172 been diagnosed with any illness?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10019172 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100'",
273f6bc57bc0f792177dfd04,Has patient 10004733 received a enteral infusion of concentrated nutritional substances treatment since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM treatment_table WHERE treatment_table.patient_id = 10004733 AND treatment_table.treatment_type = 'enteral infusion of concentrated nutritional substances' AND STRFTIME('%y', treatment_table.treatment_date) >= '2100'",
02784e491e61842ddb4de275,Has patient 10004235 undergone a laparoscopic robotic assisted procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10004235 AND procedures.procedure_type = 'laparoscopic robotic assisted' AND STRFTIME('%y', procedures.date) >= '2100'",
177361783d0e88008a827338,Ya do you know if there was a genetic test patient 97330 received?,,SELECT COUNT(*) > 0 FROM results WHERE results.patient_id = 97330 AND results.result_type = 'genetic',
304ffa7e26d4e39086d0933b,What was patient 10001725's minimum value of basophils in 04/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND strftime('%Y-%m',labevents.charttime) = '2100-04'",SELECT MIN(Basophils) FROM (SELECT Basophils FROMPatient WHERE Patient_ID = 10001725) AS T WHERE T.Date = '04/2100',[{'MIN(labevents.valuenum)': None}]
757779a8ac74dd38488f923f,Retrieve the top four most frequent procedures that were delivered to patients within the same hospital visit after they received other endovascular procedures on other vessels.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.Name, COUNT(t3.Name) FROM (SELECT t2.Name, COUNT(t2.Name) FROM (SELECT patients.Name, procedures.procedure_time, patients.patient_id FROM procedures JOIN patients ON procedures.patient_id = patients.patient_id WHERE procedures.procedure_category = 'other endovascular procedures on other vessels') AS t1 JOIN (SELECT patients.Name, procedures.procedure_name, procedures.procedure_time, patients.patient_id FROM procedures JOIN patients ON procedures.patient_id = patients.patient_id WHERE procedures.procedure_category = 'procedure') AS t2 ON t1.Name = t2.Name WHERE t1.procedure_time < t2.procedure_time AND t1.patient_id = t2.patient_id GROUP BY t2.Name) AS t3 GROUP BY t3.Name ORDER BY COUNT(t3.Name) DESC LIMIT 4",
f8a06b403db41f5348bf90f8,What was the name of the organism found in patient 10021487's first bronchoalveolar lavage microbiological test since 03/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10021487 AND sample_type = 'bronchoalveolar lavage' AND date >= '2000-03-21' ORDER BY date NULLS FIRST LIMIT 1,[]
69662f679dde3d8d7bc6490c,Tell me the difference in the respiratory rate value for patient 10007058 second measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT respiratory_rate FROM (SELECT icu_visits FROM icu WHERE icu.patient_id = 10007058) AS T11 WHERE NOT T11.date IS NULL ORDER BY T11.date DESC LIMIT 1) - (SELECT respiratory_rate FROM (SELECT icu_visits FROM icu WHERE icu.patient_id = 10007058) AS T11 WHERE NOT T11.date IS NULL ORDER BY T11.date NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
6b473d162048ac1a1c32fab8,Could you retrieve the top four diagnoses that have the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT t4.diagnosis FROM (SELECT t3.diagnosis, DENSE_RANK() OVER (ORDER BY t3.c1 DESC) AS c2 FROM (SELECT t2.diagnosis, 100 - SUM(CASE WHEN patients.hiv_status = ""POSITIVE"" THEN 1 WHEN patients.hiv_status = ""NEGATIVE"" THEN 1 END) * 100 / COUNT(*) AS c1 FROM (SELECT patients.diagnosis, patients.hiv_status FROM patients WHERE patients.pack_year = 2005) AS t2 JOIN (SELECT t1.diagnosis, 100 - SUM(CASE WHEN patients.hiv_status = ""POSITIVE"" THEN 1 WHEN patients.hiv_status = ""NEGATIVE"" THEN 1 END) * 100 / COUNT(*) AS c1 FROM (SELECT patients.diagnosis, patients.hiv_status FROM patients WHERE patients.pack_year = 2005) AS t1 GROUP BY t1.diagnosis) AS t3) AS t4 WHERE t4.c2",
b1ea33dff472a7dc8ff3b3ca,Has any organism been found in the last sputum microbiological test of patient 10026255?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT COUNT(*) FROM organism WHERE organism.location = 'sputum' AND NOT patient.sputum_microbiology_last_date IS NULL AND patient.patient_id = 10026255,[{'COUNT(*)>0': 0}]
486be4b5d2429d76a159f7bb,Can you please elaborate on a ward identification that you can use to admit patient 64292?,,SELECT ward FROM patient WHERE patient = 64292;,
f907fb44dd458e21bcac102c,"What are the top five most common diagnoses that patients were diagnosed with during the same month after receiving bypass coronary artery, one artery from left internal mammary, open approach's this year?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id FROM patient WHERE patient.diagnosis = 'BYPASS CORONARY ARTERY, ONE ARTERY FROM LEFT INTERNAL MAMMARY, OPEN APPROACH') AS t1 JOIN (SELECT patient.id, diagnosis FROM diagnosis WHERE diagnosis = 'TOP FIVE MOST COMMON DIAGNOSIS') AS t2 ON t1.id = t2.id WHERE t1.diagnosis = t2.diagnosis AND DATETIME(t1.diagnosis, 'start of year') = DATETIME(t2.diagnosis, 'start of year') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 5",
99dc14e34af5f8b1b714560f,"Since 2100, how many patients received arteriography of femoral and other lower extremity arteries within 2 months after being diagnosed with other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM (SELECT subject_id, date_diff('month', diagnosed_date, current_date) AS months_since_diagnosed FROM (SELECT subject_id, date_diff('month', current_date, diagnosed_date) AS months_since_diagnosed FROM (SELECT subject_id, current_date FROM patients WHERE current_date >= '2100-01-01') AS t1 JOIN (SELECT subject_id, diagnosed_date FROM diagnoses WHERE diagnosed_date >= '2100-01-01') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date >= t2.diagnosed_date AND date_diff('month', t1.diagnosed_date, t2.diagnosed_date) BETWEEN 2 AND 6) AS t3 JOIN (SELECT subject_id, arteriography_date FROM arteriographies WHERE arteriography_date >= '2100-01",
32f8fa73cf7949fc25194b91,What was the last input time of patient 10018328 since 03/08/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-08' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10018328 AND input_time >= '2100-03-08',[{'starttime': '2154-05-02 11:12:00'}]
cbb2aecba43342d92debc795,What is the dosage of an opioid given to patient 21110?,,SELECT opioid_dosage FROM patient_opioids WHERE patient_id = 21110,
b789cd80cfb8838ab901d4a4,Has patient 10007795 been given any sort of diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient = 10007795,[{'COUNT(*)>0': 1}]
416848aeaf8b172ffb8fe4fb,What are the four most frequently performed treatments for patients in their 30s throughout this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT patient.name, treatment.treatment FROM treatment JOIN patient ON treatment.patient = patient.name WHERE treatment.treatment_date = CURRENT_DATE) AS t1 JOIN (SELECT patient.name FROM patient WHERE patient.age = 30) AS t2 ON t1.patient = t2.name) GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 4",
5190a9c7556f440558510c86,What new medications were added in the prescription of patient 10039831 today versus those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescription FROM patients WHERE patient_id = 10039831 AND date = '2022-10-01' EXCEPT SELECT prescription FROM patients WHERE patient_id = 10039831 AND date = '2022-10-02',[]
fb3d9d6acc0abd876c53799f,What was the minimum value of phosphate for patient 10020740 in 06/this year?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06'",SELECT MIN(phosphate) FROM lab WHERE patient = '10020740' AND date = '06/this year',[{'MIN(labevents.valuenum)': None}]
59db7aeb6bea824b6c800d5e,"When was the first time patient 10004733, on this month/25, had the minimum heart rate?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '25' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1","SELECT MIN(heart_rate) FROM patient WHERE patient.patient_id = 10004733 AND DATETIME(heart_rate_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month') AND STRFTIME('%d', heart_rate_date) = '25';",[]
99266f3b67eb6112916a4b55,Tell me the total volume of input that patient 10021487 was given since 12/14/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-14'",SELECT SUM(volume) FROM input WHERE patient = 10021487 AND date >= '2100-12-14',[{'SUM(inputevents.totalamount)': 169730.0}]
c32cd76c5b0aa08c81251752,How many mupirocin nasal ointment 2% prescriptions took place in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'mupirocin nasal ointment 2%' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Mupirocin Nasal Ointment 2%' AND STRFTIME('%y', prescriptions.date) = '2100';",[{'COUNT(*)': 0}]
27672ae2ddb12a394c90cad6,Get me the top three most frequent medications that patients were prescribed with within the same month after being diagnosed with traumatic shock since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'traumatic shock' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.subject_id, medication.medication, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.subject_id WHERE STRFTIME('%y', medication.medication_date) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_date, 'start of month') GROUP BY",
283bf444d3fe0d8412a24dc1,What was the name of the drug that was last prescribed for patient 10026255 since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug_name FROM prescriptions WHERE prescriptions.patient_id = 10026255 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-05' ORDER BY prescriptions.date DESC LIMIT 1",[{'drug': 'Lorazepam'}]
aa3736eecab5271da4440d63,Calculate the number of patients discharged from the hospital in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, 2100 AS dismiss_year FROM tbl WHERE dismiss_year IS NOT NULL) AS t1 JOIN (SELECT subject_id, 2100 AS admit_year FROM tbl WHERE admit_year IS NOT NULL) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.dismiss_year = t2.admit_year",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
5272430cbc48927e9597669b,"On 07/26/this year, when did patient 10016742 receive an input for the first time?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-26' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT input_date FROM input_table WHERE patient_id = 10016742 AND DATETIME(input_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m-%d', input_date) = '07-26' ORDER BY input_date NULLS FIRST LIMIT 1;",[]
11c93be39a2819fec36e2a6b,Does patient 65759 have a record of hypotension nec in his / her family?,,SELECT COUNT(*) > 0 FROM hypotension_nec WHERE hypotension_nec.patient_id = 65759,
3a3ab651adc4530ed40be652,"What is the average total cost of the hospital, which includes medicines called dronabinol?",SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dronabinol' ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.total_cost) FROM (SELECT SUM(T2.medicine_cost) AS total_cost FROM (SELECT AVG(T3.medicine_cost) AS medicine_cost FROM medicines AS T3 JOIN patient_medicines AS T4 ON T3.medicine_id = T4.medicine_id JOIN patients AS T5 ON T5.patient_id = T4.patient_id WHERE T3.medicine_name = 'dronabinol') AS T2 GROUP BY T2.medicine_cost) AS T1,
5d83b1d1c458bcc64023c23e,Can you provide the maximum monthly number of patients diagnosed with gas pain?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gas pain' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT MAX(monthly_number_of_patients) FROM patients WHERE diagnosis = 'gas pain';,
4f40841ba5cc7ce273305a27,What was the total metoprolol succinate xl dose prescribed for patient 10039997 in 09/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09'",SELECT SUM(Metoprolol Succinate XL) FROM medication WHERE Patient_ID = 10039997 AND Drug_Date BETWEEN '2000-09-2100' AND '2000-09-2100',[{'SUM(prescriptions.dose_val_rx)': None}]
6c5ae1376c35e10f1ed23a4e,What were some of the five common specimen tests given since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",SELECT 5 AS _common_specimen_tests FROM brackets_question WHERE year >= 2100;,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
bd35ad803e2438c6ada8a6b8,Calculate the length of patient 10025612's first stay in the ICU in days.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', ICU_LENGTH(10025612, 1)) AS first_stay_length","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.229965277016163}]"
6d461d83bedc6045d8cf7019,Retrieve the top three most frequent diagnoses of patients with age in their 30s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT diagnosis, date_part('year', age) AS age_year FROM patients WHERE age_year BETWEEN 2050 AND 2100) AS t1 JOIN (SELECT diagnosis, date_part('year', age) AS age_year FROM patients WHERE age_year BETWEEN 2050 AND 2100) AS t2 ON t1.diagnosis = t2.diagnosis WHERE t1.age_year = t2.age_year GROUP BY t1.diagnosis ORDER BY COUNT(t1.diagnosis) DESC LIMIT 3;",
ee666395a082d03bb08f340b,What number of patients stayed in coronary care unit (ccu) in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM coronary_care_unit WHERE year = 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
5767b253bcb5c54fa1aaaadc,Tell me the top five most commonly prescribed medications.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.name FROM (SELECT prescriptions.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions GROUP BY prescriptions.name) AS t1 WHERE t1.c1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
2eb0abd516a6a45b4329852b,Has patient 10005909 been diagnosed with any diseases since 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10005909 AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100'",
f42f69255942463a3df596bb,What was the name of the output that patient 10038999 had last since 05/19/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT ""output"" FROM ""patients"" WHERE ""patient"" = 10038999 AND ""last_output"" = '05/19/2100'",[{'label': 'Foley'}]
871e1ec7efc82f4a5c9d293c,"Are patient 10018081's sodium, urine levels second measured on the current hospital visit less than the levels first measured on the current hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )",,"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
ab607c4930656aed65054027,Has magnesium sulfate (bolus) been administrated to patient 10005909 since 03/02/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02'","SELECT COUNT(*) > 0 FROM administration WHERE administration.patient_id = 10005909 AND administration.drug = 'magnesium sulfate (bolus)' AND STRFTIME('%y-%m-%d', administration.date) >= '2100-03-02'",[{'COUNT(*)>0': 0}]
58c7b81fff91803d70fcd674,What should i do following the coronar arteriogr-2 cath procedure?,,SELECT * FROM brackets WHERE question = 'What should i do following the coronar arteriogr-2 cath procedure',
c9981e6cc2c40b04592f3206,Which medication was patient 10009035 prescribed within 2 days following the extracorporeal circulation auxiliary to open heart surgery procedure in 05/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT patient.prescriptions FROM patient WHERE patient.patient_id = 10009035 AND patient.location = 'heart surgery') AS t1 JOIN (SELECT patient.prescriptions FROM patient WHERE patient.patient_id = 10009035 AND patient.location = 'extracorporeal circulation auxiliary to open heart surgery') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.start_date < t2.start_date AND DATETIME(t2.start_date) BETWEEN DATETIME(t1.start_date) AND DATETIME(t1.start_date, '+2 day')",
669a0b2733d0accec1a73720,What is the recorded sex of patient 10015931?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10015931,SELECT recorded_sex FROM patients WHERE patient_id = 10015931;,[{'gender': 'M'}]
34f825ce946e62cf44c7f3f5,"How many days have passed since patient 10004733 had the last cholesterol, total lab test on their current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result.result_date)) FROM lab_result WHERE lab_result.patient_id = 10004733 AND lab_result.result_type = ""Cholesterol, Total"" AND lab_result.result_date = ""2022-01-01""",[]
1efc0b4233b41debd5e85794,What is the number of ICU visits for patient 10031404 since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM icu_visits WHERE icu_visits.patient_id = 10031404 AND DATETIME(icu_visits.visit_time) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}]
bfa8588d08b6cab7568a7c34,When did patient 10021118 first take the microbiology test since 11/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT date_first_test('microbiology', '10021118', '11/2100')",[{'charttime': '2161-11-15 21:45:00'}]
a6e9aa314afc2689dfc084db,Tell me the three most frequent medical diagnoses throughout this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.MedicalDiagnosis, COUNT(t1.MedicalDiagnosis) FROM (SELECT t2.MedicalDiagnosis FROM ""medical_diagnoses"" AS t2 JOIN (SELECT ""medical_diagnosis_id"" FROM ""medical_diagnoses"" WHERE ""medical_diagnosis_date"" = '2021-01-01') AS t1 ON t2.medical_diagnosis_id = t1.medical_diagnosis_id) GROUP BY t1.MedicalDiagnosis ORDER BY COUNT(t1.MedicalDiagnosis) DESC LIMIT 3",
87278f47491e99c15504a52a,"How many times was a insertion of infusion device into superior vena cava, percutaneous approach procedure conducted since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into superior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'Insertion of infusion device into superior vena cava, percutaneous approach' AND STRFTIME('%y', procedures.date) >= '2100';",
1938082694abfabf0da88e32,What is the reimbursement standard for the genetic and chromosome tests?,,SELECT STD_REimbursement FROM Test_Types WHERE Test_Type = 'Genetic' OR Test_Type = 'Chromosome';,
44962ace42f808407fa6647a,What was the first lipase lab value for patient 10019172 in 10/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(Lipase) FROM lab WHERE Lab_Patient_ID = 10019172 AND Date LIKE '%10%' AND Date LIKE '%this year%',[]
5869a0526721f0fc5641901e,What is the name of a procedure patient 10007795 underwent two or more times since 14 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-14 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT name FROM procedures WHERE patient_id = 10007795 AND date_part('month', age(current_date, date_part('month', procedures.date) - 14)) >= 2",
519ec63fd6ee4ba4f86c8048,Can you tell me when patient 10007928 had their first blood culture microbiology test in 04/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT patient.name, microbiology.blood_culture_date FROM patient WHERE patient.id = 10007928 AND STRFTIME('%y-%m', microbiology.blood_culture_date) = '2100-04' ORDER BY microbiology.blood_culture_date NULLS FIRST LIMIT 1",[]
f6014eac249a07ee280d9634,What was the name of the specimen test which patient 10019777 has last received in their last hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT specimen_type FROM visit WHERE patient_id = 10019777 AND NOT visit.hospital_id IS NULL ORDER BY visit.hospital_admission_date DESC LIMIT 1,[{'spec_type_desc': 'STOOL'}]
f3e47e3f679e8381a5c4a2b6,Tell me all the prescriptions that patient 10539 received in the other department.,,SELECT prescriptions FROM received WHERE patient_id = 10539 AND department = 'other',
74be377366123df29a790c8c,How many patients received esophagogastroduodenoscopy [egd] with closed biopsy treatment within 2 months after being diagnosed with acute posthemorrhagic anemia in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute posthemorrhagic anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'esophagogastroduodenoscopy [egd] with closed biopsy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date FROM (SELECT subject_id, diagnosis_date FROM acute_posthemorrhagic_anemia WHERE diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31') AS t1 JOIN (SELECT subject_id, treatment_date FROM acute_posthemorrhagic_anemia WHERE treatment_date BETWEEN '2100-01-01' AND '2100-12-31' AND treatment_type = 'closed biopsy') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t2.treatment_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month')",
df2081f769425d13a4ff054f,Count the number of current patients whose ages fall within the 40s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT(DISTINCT patient_id) FROM current_patients WHERE age BETWEEN 40 AND 49,
d199f2338fccc1376de62441,How much will it cost me to get other repair of vessel done?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) ),SELECT DISTINCT cost FROM repair WHERE repair_type = 'Other repair of vessel';,
7e0d52249e45d956b457e7f7,Can you report the last arterial blood pressure mean for patient 10031757 during the first ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT ARTERIAL BLOOD PRESSURE FROM (SELECT ARTERIAL BLOOD PRESSURE FROM icu_arterial_blood_pressure WHERE icu_id = 1 AND patient_id = 10031757) ORDER BY icu_stay_duration DESC LIMIT 1;,[]
60fa5859e5561740ec7d024d,What is dr. turner's outpatient schedule today?,,SELECT T1.start_time FROM appointment T1 JOIN patient T2 ON T1.patient_id = T2.patient_id WHERE T2.patient_name = 'Dr. Turner' AND T1.start_time = CURRENT_TIMESTAMP;,
2f795d71a3f4c1f8e411ce55,Is the anion gap level of patient 10008454 second measured on the first hospital visit greater than the first level measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT anion_gap(level) FROM patient WHERE patient.hospital_number = 1 AND NOT patient.hospital_number IS NULL ORDER BY patient.hospital_admission_date NULLS FIRST LIMIT 1 OFFSET 1) > (SELECT anion_gap(level) FROM patient WHERE patient.hospital_number = 1 AND NOT patient.hospital_number IS NULL ORDER BY patient.hospital_admission_date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
a76ac4f3407058b120923fca,What was the first drug that was prescribed to patient 10021938 via the pr route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(drug_name) FROM prescriptions WHERE patient_id = 10021938 AND route = 'pr',[]
fc4da0d8a328e76fa47d035f,What percentile is the value of 32.0 in asparate aminotransferase (ast) among patients of the same age as patient 10039997 on the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.0",SELECT percent_rank() FROM (SELECT * FROM patients WHERE patients.age = (SELECT patients.age FROM patients WHERE patients.name = '10039997' AND NOT patients.dischtime IS NULL ORDER BY patients.admittime NULLS FIRST LIMIT 1) AND NOT patients.admittime IS NULL ORDER BY patients.age NULLS FIRST LIMIT 1) WHERE patients.value = 32.0,
cc2d4eae2f2d008d9c2c9518,How many patients from the 40s age group are currently admitted?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT(DISTINCT patient_id) FROM patients WHERE age GROUP BY age HAVING age LIKE '40s%' AND is_currently_admitted = true,
358fa6004175aca2698df8bb,How many operating rooms are currently available?,,SELECT COUNT(*) FROM Operating_Rooms WHERE Available = true;,
2bc23738094540fb7b4e565e,Can you provide me the monthly maximum amount of dextrose 50% that patient 10020944 received during the first hospital visit?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MAX(Dextrose_50%) AS monthly_max FROM hospital_readmissions WHERE patient_id = 10020944 AND NOT date_disched IS NULL ORDER BY date_admitted NULLS FIRST LIMIT 1;,[]
0831dece04ef846871b1b934,What was the diagnosis for patient 10003046 the first time in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10003046 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100' ORDER BY diagnoses.diagnosis_date NULLS FIRST LIMIT 1",
0bc993a64b3b18610af5e89f,Has patient 10027445 visited the hospital throughout this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10027445 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM visit WHERE visit.patient_id = 10027445 AND DATETIME(visit.visit_time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
95475af06738ffe0fb4f1c65,What was the first measurement of heart rate in patient 10031757's body on their last ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM icu_heart_rate WHERE icu_heart_rate.icu_id IN (SELECT icu_id FROM icu WHERE patient_id = 10031757) AND NOT icu_heart_rate.icu_id IN (SELECT icu_id FROM icu WHERE patient_id = 10031757 AND NOT icu.out_time IS NULL ORDER BY icu.admit_time DESC LIMIT 1)),[]
d064155c1b69cfe53b508d1e,Is the value of o2 flow last measured on the last hospital visit of patient 10015931 less than its value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT o2_flow FROM lab_data WHERE lab_data.patient_id = 10015931 AND NOT lab_data.hospital_release = 0 ORDER BY lab_data.measurement_date DESC LIMIT 1) < (SELECT o2_flow FROM lab_data WHERE lab_data.patient_id = 10015931 AND NOT lab_data.hospital_release = 0 ORDER BY lab_data.measurement_date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
b8e9f61b8a98b3f23dc93f99,When was patient 10024043's first discharge from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10024043 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(dischtime) FROM (SELECT dischtime FROM patient_discharge WHERE patient_id = 10024043),[{'dischtime': '2117-02-04 11:53:00'}]
473b5484bdbc4e254b426c4c,"For patients diagnosed with hemorrhage of rectum and anus throughout this year, what are the top five most recurrent treatments within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t1.subject_id, t2.treatment FROM (SELECT subject_id, treatment FROM procedures WHERE treatment = 'hemorrhage of rectum and anus throughout this year') AS t1 JOIN (SELECT subject_id, treatment FROM procedures WHERE treatment = 'rectal and anal massage throughout this year') AS t2 ON t1.subject_id = t2.subject_id) AS t3 WHERE t3.treatment = (SELECT treatment FROM procedures WHERE procedures = 'rectal and anal massage throughout this year' LIMIT 1) GROUP BY t3.treatment HAVING COUNT(*) > 2",
6c8ad401188a69f144f026f6,What was the total number of patients on pacu since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT id) FROM patients WHERE date >= CURRENT_DATE - INTERVAL '1 year' AND ward = 'pacu',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
de050e3cfdd8c8ef07cdf7bc,What are the five most common diagnoses of patients in their 60 or above since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.uniquepid WHERE diagnosis.diagnosis_date >= '2100-01-01' AND patient.age >= 60) AS t1 WHERE t1.c1 <= 5",
b4cddff0a459aeb457378e32,Gather the total number of times patient 10007795 visited the hospital.,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10007795,SELECT COUNT(DISTINCT patient_id) FROM visit_table WHERE patient_id = 10007795;,[{'COUNT( DISTINCT admissions.hadm_id )': 5}]
826d5f58864744f66f50a9f1,Is patient 44848 subject to a test for covid-19?,,SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 44848 AND lab_results.result_value = 'covid-19',
1ec2b4e6ddcdc9a62d1209df,What was the total volume of drainage bag that patient 10021487 had on this month/16?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'drainage bag' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'","SELECT SUM(Drainage_Bag) FROM ""Discharge"" WHERE ""Patient_ID"" = 10021487 AND ""Date"" = CURRENT_DATE - INTERVAL '1 month / 16'",[{'SUM(outputevents.value)': None}]
cbcc848bf46b8605d7a0735d,What is patient 10027445's sex?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10027445,SELECT patients.sex FROM patients WHERE patients.id = 10027445;,[{'gender': 'F'}]
e54938671b05e5c6ac687af2,What were the top three most often performed treatments for patients in their 30s during this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT UNNEST(treatments) AS treatment FROM patients WHERE age BETWEEN 30 AND 39) AS t1 JOIN (SELECT patient_id, treatments FROM procedures WHERE procedures.year = 2022) AS t2 ON t1.patient_id = t2.patient_id GROUP BY t1.treatment) AS t3 GROUP BY t3.treatment ORDER BY COUNT(t3.treatment) DESC LIMIT 3",
0e38c574dc705f0c26a2aa69,"On the first hospital encounter, what amount of bisacodyl was prescribed to patient 10025463?",SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'bisacodyl',SELECT prescriptions.dose FROM prescriptions WHERE prescriptions.patient_id = 10025463 AND prescriptions.drug = 'bisacodyl' ORDER BY prescriptions.date NULLS FIRST LIMIT 1,[{'SUM(prescriptions.dose_val_rx)': None}]
333d0beec3e1c8b7b38dc15e,"Has patient 10021487 been given a test on bilirubin, total, body fluid in 2100?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, body fluid' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10021487 AND lab_results.result_value = 2100 AND lab_results.result_name = ""Bilirubin, Total, Body Fluid""",[{'COUNT(*)>0': 0}]
c07d03f18cb3b7eb6a97c463,Tell me the amount of foley patient 10039831 had since 266 days ago.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-266 day')",SELECT COUNT(foley) FROM patients WHERE patient_id = 10039831 AND date_since > (CURRENT_DATE - INTERVAL 266 DAY),[{'SUM(outputevents.value)': None}]
6e294cbd69afc45c3375e07d,Has patient 10005909 had any diagnoses?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10005909;,[{'COUNT(*)>0': 1}]
95a2c61973863427b73ef937,What is the price for the drug levetiracetam?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'levetiracetam' ),"SELECT levetiracetam FROM drugs WHERE levetiracetam = "" levetiracetam """,
5330e3cf45faedb3477005e6,Can you provide the total number of outputs patient 10027445 had since 08/13/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-08-13'",SELECT COUNT(*) FROM outputs WHERE patient_id = 10027445 AND date >= '2008-13-2100',[{'SUM(outputevents.value)': 13561.0}]
189fc63254a11c6dfeb8fba5,Calculate the number of patients diagnosed with alkalosis.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) ),SELECT COUNT(DISTINCT patient_id) FROM diagnoses WHERE diagnosis = 'alkalosis';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
a39e1668093aab21fc2f126e,Show me patient 10029484's total volume of output since 10/23/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-23'","SELECT SUM(output) FROM ""output"" WHERE patient = 10029484 AND date >= '2100-10-23'",[{'SUM(outputevents.value)': 725.0}]
d7c14bbe3a56d6a3b48cc26d,When did patient 94757 last have medication that should be taken regularly?,,SELECT MAX(Medication.LastDoseDate) FROM Medication WHERE Medication.PatientId = 94757 AND Medication.Frequency = 'regular',
0f2f3ef0fa1e36d951c5a42f,What was patient 10007818's weight the last time it was measured since 8 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-8 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(weight) FROM patients WHERE patient_id = 10007818 AND measurement_date >= DATEADD(month, -8, CURRENT_DATE)",[]
bef2c1e139eac11ba6f699ee,Do you know the minimum albumin value of patient 10002495 on the first hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' ),SELECT MIN(albumin) FROM encounters WHERE patient_id = 10002495 AND NOT is_hospital_exit = true,[{'MIN(labevents.valuenum)': None}]
f14d33079f86bdf9032e4b84,What is the recently prescribed medication for patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescriptions FROM patients WHERE patient_id = 10018081 WHERE prescriptions.date = '2022-01-01',[]
05bb819666668fc43bad2666,When did the last discharge from the hospital happen for patient 10023239?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10023239 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = 10023239;,[]
d5ae1b4f859d19123f8193a4,Get me the top five most frequent diagnoses for patients of age 30s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",SELECT diagnosis FROM patients WHERE age BETWEEN 30 AND 39 AND year = 2100 GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 5;,
74d3878c8b5bd8025d7a304d,When was the last time that patient 10018081 had the minimum value of diastolic blood pressure on 12/29/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1","SELECT MIN(diastolic_blood_pressure) FROM patient_10018081 WHERE diastolic_blood_pressure IS NOT NULL AND DATETIME(diastolic_blood_pressure, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m-%d', diastolic_blood_pressure) = '12-29'",[]
c2498660106f0841540500d3,"Give me the top four most frequent procedures that patients were given in the same hospital encounter after receiving reposition left mandible with external fixation device, percutaneous approach.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.Procedure, COUNT(t4.Procedure) FROM (SELECT t3.Procedure, COUNT(t3.Procedure) FROM (SELECT t2.Procedure, COUNT(t2.Procedure) FROM (SELECT patient.Name, action.Action_Time, patient.Piece_ID, patient.Game_ID, patient.Team_ID, patient.Opponent_ID, patient.Health, patient.Hospitals, patient.Home_Team, patient.Away_Team FROM patient JOIN action ON patient.Player_ID = action.Player_ID WHERE action.Action_Type = 'Reposition left mandible with external fixation device, percutaneous approach') AS t2 GROUP BY t2.Procedure) AS t3 JOIN (SELECT patient.Name, action.Action_Time, patient.Piece_ID, patient.Game_ID, patient.Team_ID, patient.Opponent_ID, patient.Health, patient.Hospitals, patient.Home_Team, patient.Away_Team FROM patient JOIN action ON patient.Player_ID = action.Player_ID WHERE action.Action_",
17940d37a58d13908074e9d2,How often did patient 10007795 go to the ICU in 2100?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y',icustays.intime) = '2100'","SELECT COUNT(DISTINCT STRFTIME('%y', ICU_ADMIT_DATE)) FROM ICU_USAGE WHERE PATIENT_ID = 10007795 AND STRFTIME('%y', ICU_ADMIT_DATE) = '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 0}]
6316365253c771062657103d,"Show the number of patients who underwent introduction of other therapeutic substance into heart, open approach.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id FROM patients WHERE heart_rate = ""other therapeutic substance introduction, open approach"") AS t1 JOIN (SELECT subject_id FROM patients WHERE heart_rate = ""introduction of other therapeutic substance into heart, open approach"") AS t2 ON t1.subject_id = t2.subject_id WHERE t1.heart_rate = ""introduction of other therapeutic substance into heart, open approach""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
2ed30506921aece493589863,How much does a procedure known as partial hepatectomy cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure = 'partial hepatectomy';,
c625c297bb0d8ff6dc0c20fa,"What was the drug that patient 10022017 prescribed for within 2 days after the procedure of excision of left saphenous vein, percutaneous endoscopic approach on their last hospital encounter?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10022017 AND treatment.treatment = 'excision of left saphenous vein, percutaneous endoscopic approach' AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1) AS t1 JOIN (SELECT patient.id, prescription.drug FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE patient.id = 10022017 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
ec028c849e3b43c508834d3c,When was patient 10027445 discharged from the hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM (SELECT dischtime FROM patient_discharge WHERE patient_id = 10027445),[]
ef2cdb36472c00261392f95a,"What is the average total hospital cost which involves exposure to other specified factors, initial encounter since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'exposure to other specified factors, initial encounter' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(ci) AS c1 FROM (SELECT 1 AS ci FROM diagnoses WHERE d = 'exposure to other specified factors') AS t1 JOIN (SELECT 1 AS ci FROM encounters WHERE e = 'initial encounter') AS t2 ON t1.d = t2.d WHERE t1.ci >= 2100 GROUP BY t1.c1) AS t3,
3fad6d968be4660d18e4a33a,"During their last ICU visit, what was patient 10007928's last heart rate?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,"SELECT STRFTIME('%Y-%m-%d %H:%M:%S', patient.last_icu_visit) AS ""last_icu_visit"", patient.heart_rate AS ""heart_rate"" FROM patient WHERE patient.id = 10007928 ORDER BY patient.last_icu_visit DESC LIMIT 1;",[]
a4b29cbfbb96679f14e6eac0,How many patients were diagnosed with unspecified essential hypertension during the same hospital visit after the previous diagnosis with aortic valve disorders?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'aortic valve disorders' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.diagnosis_time, patient.patient_location, patient.admit_time FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'unspecified essential hypertension') AS t1, (SELECT patient.subject_id, diagnosis.diagnosis_time, patient.patient_location, patient.admit_time FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'aortic valve disorders') AS t2 WHERE t1.diagnosis_time < t2.diagnosis_time AND t1.subject_id = t2.subject_id",
87d7d4cf52e2d839fed96143,Can you tell me which were the top three most frequently tested specimens since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(specimen) FROM testing WHERE year >= 2100 GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
6277e9a8851e3c1a4ad9cd6e,Please list out the monthly maximum weight of patient 10004235 since 1 year ago.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10004235 AND date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY date,[]
5eed4e1b791b78ba28273ed6,"How many days have elapsed since the first time in the current hospital visit that patient 10021487 was diagnosed with closed dislocation, multiple cervical vertebrae?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed dislocation, multiple cervical vertebrae' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT SUM(DATEDIFF('day', DiagnosedDate, CURRENT_TIMESTAMP)) FROM diagnoses WHERE PatientID = 10021487 AND Diagnosis = 'Closed dislocation, multiple cervical vertebrae'",
81aaa658176632cb934fc8b2,Has patient 10012853 been given a diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patientId = 10012853;,[{'COUNT(*)>0': 1}]
cb4e4e55e551ad021bb55fc0,When was the last time that patient 10015931 has had the minimum SaO2 on this month/08?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '08' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1","SELECT MAX(SaO2) FROM (SELECT SaO2 FROM patients WHERE patient_id = 10015931) WHERE date_part('month', current_timestamp) = date_part('month', current_timestamp) AND date_part('day', current_timestamp) = date_part('day', current_timestamp)",[]
3f525ce33fe40722b1b64deb,How many lidocaine jelly 2% (urojet) prescriptions took place in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Lidocaine Jelly 2% (Urojet)' AND STRFTIME('%y', prescriptions.date) = '2100';",[{'COUNT(*)': 0}]
f4cfc4a663fd49aeace78486,Are there any changes in the prescribed drugs of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM drugs WHERE patient_id = 10018081,[]
f5024826f56df8252bfc76ad,Tally up the number of patients who received a ck-mb index lab test since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb index' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT t1.subject, t2.date FROM (SELECT subject, DATE('2022-01-01') AS date FROM patients WHERE subject = 'CK-MB INDEX') AS t1 JOIN lab_data ON t1.subject = lab_data.subject AND t1.date = lab_data.date) AS t2 WHERE t2.date >= DATEADD(year, -1, CURRENT_DATE)",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d559f760db83349c7ce1a73b,"What were the five most frequently ordered procedures for patients who had also received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.code FROM (SELECT t2.code, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, procedure.date FROM procedure JOIN patient ON procedure.patient = patient.id WHERE procedure.type = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic') AS t1 JOIN (SELECT patient.id, procedure.code, procedure.date FROM procedure JOIN patient ON procedure.patient = patient.id) AS t2 ON t1.id = t2.id GROUP BY t2.code) AS t3 WHERE t3.c1 <= 5",
4dffe3f7f7770e47d3e5fdc8,Tell me patient 10029291's maximum value of mean blood pressure on the last ICU visit.,SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ),SELECT MAX(mean_blood_pressure) FROM (SELECT mean_blood_pressure FROM (SELECT patient_id FROM patients WHERE patient_id = 10029291) AS t1 JOIN icu_visits AS t2 ON t1.patient_id = t2.patient_id) AS t3;,[{'MAX(chartevents.valuenum)': None}]
8f20718e8f7720e51c34a9b9,What are the four diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT diagnosis FROM (SELECT diagnosis, MAX(six_month_mortality_rate) AS max_rate FROM (SELECT diagnosis, six_month_mortality_rate FROM bracket_mortality WHERE six_month_mortality_rate IS NOT NULL) AS six_month_mortality GROUP BY diagnosis) AS diagnoses ORDER BY max_rate DESC LIMIT 4;",
535fa7171aca46e1fa19b72d,What was the name of the medication that was first prescribed to patient 10003046?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriber.name FROM prescriber JOIN patient ON prescriber.patient_id = patient.id WHERE patient.id = 10003046 ORDER BY prescriber.date NULLS FIRST LIMIT 1;,[{'drug': 'Iso-Osmotic Dextrose'}]
f0ed8bc2f755ef37eb17af6e,Did patient 10021938 receive any surgery on their last hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM surgery WHERE surgery.patient_id = 10021938 AND NOT surgery.hospital_id IS NULL ORDER BY surgery.hospital_id DESC LIMIT 1;,[{'COUNT(*)>0': 1}]
c4342f86b05d451aef82a90f,When and where are the rounds and procedures of dr. sullivan?,,SELECT WHEN AND WHEREDr. Sullivan:Rounds AND Procedures;,
6fc2d38e2e0de21eec21ab72,Count the number of patients that were discharged in the last year from the hospital.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT date_disched IS NULL AND date_disched >= (SELECT MAX(date_admitted) FROM patients) - INTERVAL '1 year';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
b669eb9d598ff80ab9e5f8e6,Has patient 10002495 had any surgeries in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10002495 AND STRFTIME('%y', procedures.procedure_date) = '2100'",
5d54f26da17bc7fdbfc404d3,What are the five frequently prescribed medications for patients diagnosed with unspecified condition of brain previously within the same month?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified condition of brain' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = ""UNOBTRUSIVE DEMENTIA"") AS t1 JOIN (SELECT patient.uniquepid, medication.medication, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.patient_id) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_date, 'start of month') GROUP BY t2.medication) AS t3 WHERE t3.c1 <= 5",
474e88f3f2489ae5e866536c,What was the last weight of patient 10039831 since 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(weight) FROM patients WHERE patient_id = 10039831 AND date >= '03/2100',[]
1591c0dee928de6151cbaf4a,When was the first time the systolic blood pressure of patient 10018081 was measured since 11/27/2100 at less than 113.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 113.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-27' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT systolic(blood_pressure) FROM patient_10018081 WHERE systolic(blood_pressure) < 113.0 AND measurement_date >= '2000-11-27',[]
3f5ac405fb5c105f76ea0b91,What was the output that patient 10004235 first had during the first ICU stay?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),"SELECT ""output"" FROM ""icu_stays"" WHERE ""icu_stays"".""patient_id"" = 10004235 AND NOT ""icu_stays"".""end_time"" IS NULL ORDER BY ""icu_stays"".""start_time"" NULLS FIRST LIMIT 1",[{'label': 'Foley'}]
09315d12007c47ae3fb400b6,What drug was prescribed to patient 10005817 for the last time since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescription_date, prescription_name FROM prescriptions WHERE patient_id = 10005817 AND STRFTIME('%y-%m', prescription_date) >= '2100-12' ORDER BY prescription_date DESC LIMIT 1",[{'drug': 'HYDROmorphone (Dilaudid)'}]
588567d3a7f9d7e575cf5435,What was the last arterial blood pressure mean value that patient 10022017 had on 10/03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(arterial_blood_pressure_mean) FROMPressureMeasurements WHERE patient_id = 10022017 AND measurement_date = '2100-10-03',[]
18b181c1e5e0cb0999cf255c,"In total, what was the input amount of gt flush that patient 10038933 received in their last ICU stay?",SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ),SELECT SUM(input_amount) FROM icu WHERE icu.patient_id = 10038933 AND icu.output_amount IS NULL AND icu.room = 'brackets',[{'SUM(inputevents.totalamount)': None}]
cb2de03e599b89ef00694c72,What was the name of the specimen that patient 10016150 received for the last time since 01/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_name FROM patients WHERE patient_id = 10016150 AND date_since = '01/2100' ORDER BY date_since DESC LIMIT 1,[{'spec_type_desc': 'URINE'}]
f8d0aedd069c1450d7d6264f,What was the name of the drug that was prescribed last to patient 10019385 since 19 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-19 month') ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.drug_name FROM prescriber WHERE prescriber.patient_id = 10019385 AND DATETIME(prescriber.start_date) >= DATETIME(CURRENT_TIME, '-19 month') ORDER BY prescriber.start_date DESC LIMIT 1",[{'drug': 'Nitroglycerin SL'}]
3fc571e83a604003d6461674,Calculate the number of patients who underwent a laboratory test for hematocrit since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient_id) FROM lab_results WHERE lab_result_name = 'hematocrit' AND date_sub('year', lab_results.date, CURRENT_DATE) > 1",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
09f8601bdd6e63b61b06c516,Calculate the length in days of patient 10016810's first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT COUNT(*) FROM icu WHERE icu.patient_id = 10016810 AND icu.start_date = (SELECT MIN(start_date) FROM icu WHERE icu.patient_id = 10016810),"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.488912038039416}]"
09b1b086d491d385b6744dd6,Give me the total amount of output since 12/25/2100 for patient 10004733.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-25'",SELECT SUM(output) FROM bracket_output WHERE patient_id = 10004733 AND date >= '2012-12-25',[{'SUM(outputevents.value)': 17410.0}]
33bb875daecee7aae0a79d8a,Can you tell me the top four most common treatments for patients in their 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.treatment, COUNT(t4.treatment) FROM (SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, COUNT(t2.treatment) FROM (SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT '40s' AS treatment, COUNT(40s) FROM (SELECT '40s' AS treatment, COUNT(40s) FROM people WHERE people.age BETWEEN 40 AND 49) AS t1 GROUP BY t1.treatment) AS t2 GROUP BY t2.treatment) AS t3 GROUP BY t3.treatment) AS t4 GROUP BY t4.treatment ORDER BY COUNT(t4.treatment) DESC LIMIT 4",
61f764dd9a145b1cc50e9c25,What was the first dose of glucagon that patient 10023239 was prescribed on the first hospital stay?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'glucagon' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(dose) FROM prescriptions WHERE prescriptions.patient_id = 10023239 AND prescriptions.drug_name = 'Glucagon',[]
0821be3636ee8eab640a750b,"Show me the top four most frequent diagnoses that patients were diagnosed with within 2 months after receiving extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic in 2100.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT diagnosis FROM patients WHERE patients.diagnosis = (SELECT diagnosis FROM patients WHERE patients.treatment = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' AND DATETIME(patients.diagnosis) BETWEEN DATETIME(patients.treatment) AND DATETIME(patients.treatment, '+2 month')) GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 4",
62ce1e3f90c3aa7b3c7ffd03,Can you provide the total number of outputs patient 10011398 had since 12/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-26'",SELECT COUNT(*) FROM output WHERE patient_id = 10011398 AND output_date >= '12/26/2100',[{'SUM(outputevents.value)': 4314.0}]
398270a5b400092bfc10afcb,When did patient 10018081 first have the minimum amount of base excess in the current hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT MIN(bracket_column) FROM (SELECT column1, column2, column3, column4, column5, column6 FROM patient WHERE patient.patient_id = 10018081 AND patient.hospital_location = 'TRANSFER FROM HOSP/EXTRAM') AS subquery;",[]
8b39463fdf4a8b3980e64af0,What is the ward identification of patient 7375 able to be admitted to?,,SELECT wardid FROM admissions WHERE patientid = 7375 AND able_to_admit = 1,
821e3fe48e8557a30caa67cf,What is the checklist you should prepare prior to having destruct chest wall les?,,SELECT checklist FROM destruct_chest_wall_les;,
13d656d846a740eeb1467267,Give me the top three most common lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT lab_test, COUNT(lab_test) FROM lab_results GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
8b02463508e571bad82c1b76,What was the first iron value during the first hospital visit for patient 10039708?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'iron' ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT MIN(Iron) FROM ""brackets"" WHERE ""Hospital Visit"" = 1 AND ""Patient ID"" = 10039708;",[]
c010215bbebd2aff0b853669,Calculate how many patients were in psychiatry in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND strftime('%Y',transfers.intime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM psychiatry WHERE year = 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c49e0c36f1c60e8aa2266956,Provide the length in days of the first visit for patient 10021118 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT COUNT(DISTINCT ICU.visit_date) FROM ICU WHERE ICU.patient_id = 10021118,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.4872453697025776}]"
8f9580ef1cb64c4525680b2f,Tell me the length of time in days for patient 10027445's first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT MIN(LENGTH(STAY_DATE)) FROM ICU WHERE PATIENT_ID = 10027445,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.8090046290308237}]"
2fa8b86ac44e632ee829dec6,What total amount of gabapentin was prescribed to patient 10002495?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND prescriptions.drug = 'gabapentin',SELECT SUM(gabapentin) FROM prescriptions WHERE patient_id = 10002495;,[{'SUM(prescriptions.dose_val_rx)': None}]
67aeef950338b9e353377442,"How many hours has it been since patient 10018081's first urinary tract infection, site not specified diagnosis in their current hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = 10018081 AND diagnosis.diagnosis_type = 'urinary tract infection, site not specified' AND diagnosis.hospital_release_date IS NULL",
fb87e4c3918b28e10f458a76,What was patient 10027602's first csf;spinal fluid's microbiology test time during the previous month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'csf;spinal fluid' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT MIN(csf__spinal_fluid) FROM microbiology WHERE microbiology.patient_id = 10027602 AND DATETIME(microbiology.timestamp, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month')",[]
9a022decba9cb56ac65b6689,Has patient 10021487 been given any procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10021487 AND STRFTIME('%y', procedures.date) >= '2100'",
97197e658fa88a996aa97c83,When was the last input of patient 10014729 on 03/06/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-06' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10014729 AND input_time BETWEEN '2100-03-06 00:00:00' AND '2100-03-06 23:59:59';,[]
d1fc20ee02b9ce89df2bb4e6,What was the total dosage of vitamin e prescribed to patient 10020944?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'vitamin e',SELECT SUM(dosage) FROM prescriptions WHERE prescriptions.patient_id = 10020944 AND prescriptions.drug_name = 'Vitamin E',[{'SUM(prescriptions.dose_val_rx)': None}]
1914be2bfb5f57050076ba8f,Was patient 10020187 admitted into the emergency room in the previous year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM admissions WHERE patient_id = 10020187 AND emergency_room_admission = 'YES' AND DATETIME(admission_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT(*)>0': 0}]
0266d6e5d007484e57bf12d6,What was the name of the drug that was first prescribed to patient 10020944 through the iv drip route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT name FROM pharmacology WHERE prescription_route = 'IV DRIP' AND patient_id = 10020944 ORDER BY prescription_date NULLS FIRST LIMIT 1,[]
7e84feafb736e70b619b4009,Calculate the total volume of input for patient 10029484 since 04/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-12'",SELECT SUM(volume) FROM intake WHERE patient = 10029484 AND date >= '2100-04-12',[{'SUM(inputevents.totalamount)': 2540.0}]
b57f674a925a484550b4afa9,When did patient 10004422 have the first diastolic blood pressure to be less than 64.0 in the first ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 64.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(diastolic_bp) FROM (SELECT diastolic_bp FROM icu_diagnoses WHERE icu_diagnoses.icu_id IN (SELECT icu_ids FROM icu_patients WHERE icu_patients.patient_id = 10004422) AND diastolic_bp < 64.0),[]
346ee07f02d16abcf7f62e9e,What is the white blood cells percentile of 12.1 among patients of the same age as patient 10001217 on their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 12.1","SELECT DISTINCT t1.c1 FROM (SELECT lab.c1, PERCENT_RANK() OVER (ORDER BY lab.c1 NULLS FIRST) AS c2 FROM lab WHERE lab.lab_name = 'white blood cells' AND lab.patient_id IN (SELECT patient.patient_id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.patient_id = 10001217 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay DESC LIMIT 1))) AS t1 WHERE t1.c2 = 12.1",
695b3083856ab31c0cd2853e,"How much does a procedure known as occlusion of right femoral artery with intraluminal device, percutaneous approach cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right femoral artery with intraluminal device, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure_name = ""Occlusion of right femoral artery with intraluminal device, percutaneous approach"";",
a3355859e69721c3baf952d0,What percentile is the hematocrit value of 35.4 in the same age group as patient 10008454 on the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 35.4","SELECT t1.c1 FROM (SELECT patient.age, hematocrit.hematocrit, PERCENT_RANK() OVER (PARTITION BY patient.age ORDER BY hematocrit.hematocrit NULLS FIRST) AS c1 FROM patient WHERE patient.patient_id = 10008454 AND NOT patient.dischtime IS NULL ORDER BY patient.age NULLS FIRST LIMIT 1) AS t1 WHERE t1.hematocrit = 35.4",
421b9af53a232e69883ca462,How many patients from the 50s age group are currently admitted?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,SELECT COUNT(DISTINCT admissions.subject_id) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age GROUP BY admissions.age HAVING admissions.age = 50,
af972afb21a4db1766988356,Total number of patients who had arteriography of other intra-abdominal arteries in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient_id, treatment_date FROM procedures WHERE procedures.treatment_date = ANY (SELECT date FROM (VALUES ('2021-01-01'), ('2021-02-01'), ('2021-03-01')) AS t(date)) AS t1 JOIN (SELECT patient_id, treatment_date FROM procedures WHERE procedures.treatment_date = ANY (SELECT date FROM (VALUES ('2021-01-01'), ('2021-02-01'), ('2021-03-01')) AS t(date)) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.treatment_date < t2.treatment_date AND procedures.treatment_type = 'Arteriography of other intra-abdominal arteries'",
4fd2779af0fb5ce25434c775,Could you list the top five most common lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date >= DATEADD(year, -1, CURRENT_DATE)) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
771257ca5b02630533cafe73,Calculate how many patients were in discharge lounge since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT(*) FROM patients WHERE NOT patients.discharge_location IS NULL AND patients.discharge_location = 'discharge lounge' AND STRFTIME('%y', patients.discharge_date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
7101ce2540d2798377dc1ae1,When since 07/2100 did patient 10018081 get the last microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology WHERE patient_id = 10018081 AND date >= '2000-07-2100',[{'charttime': '2134-09-17 06:24:00'}]
6cc10dddb478d438f52a9dfb,What was the specimen test ranked at three that was done most commonly in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(specimen) FROM brackets GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3",[]
e152d27a95ebcc62820b1622,"How many days have passed since the first time patient 10018081 received a lab test of chloride, urine on their current hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result.result_date)) FROM lab_result WHERE lab_result.patient_id = 10018081 AND lab_result.result_type = 'chloride, urine' AND lab_result.result_date = CURRENT_TIMESTAMP;",[]
5b981e188f8028d8f045d245,"What's the cost of a procedure named repair upper artery, open approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair upper artery, open approach' ) )","SELECT COST(DISTINCT 'procedure') FROM procedures WHERE PROCEDURE_NAME = 'repair upper artery, open approach';",
1f02c929b05a2d1eae19aa43,What was the last time on 03/31/2100 patient 10021666 had a minimum heart rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-31' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MIN(heart_rate) FROM patient WHERE patient_id = 10021666 AND measurement_time BETWEEN '2003-03-31 21:00:00' AND '2003-03-31 21:00:00',[]
3b0e6898490e151ff0c9d63d,Calculate the number of patients with other ventral hernia without mention of obstruction or gangrene who were diagnosed.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ventral hernia without mention of obstruction or gangrene' ) ),"SELECT COUNT(DISTINCT patient.identifier) FROM patient WHERE patient.diagnosis = ""OTHER VENTRAL HERNIA WITHOUT MENTION OF OBSTRUCTION OR GANGRENE""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
df7a774b0aacbddb0a1facfe,In what ways can ciprofloxacin 0.3% ophth soln be ingested?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin 0.3% ophth soln',SELECT * FROM ingestion_methods WHERE ingested_product = 'ciprofloxacin 0.3% ophth soln',[]
fdd1695a1c8a50679d56e863,What was the name of the drug that patient 10022017 was first prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT name FROM duckdb_prescriptions WHERE patient_id = 10022017 ORDER BY date NULLS FIRST LIMIT 1;,[{'drug': 'Sodium Chloride 0.9%  Flush'}]
014255e2a1eb9d957a380379,Have any procedures been carried out on patient 10035185 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",SELECT COUNT(*) > 0 FROM procedures WHERE patient_id = 10035185 AND date_since >= 2100,
8f125e3b053c0f80a6182cc5,What is the recently prescribed medication for patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM medication WHERE patient_id = 10039831 AND date = '2022-03-01',[]
eb1d1c55d70459e5c91b366d,What is the average total cost of the hospital that includes a medicine named trimethoprim since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM medicine WHERE name = 'trimethoprim' AND year >= 2100 GROUP BY patient_id) AS t1,
adfd9a5399c408d1e11a4aa2,What is the reimbursement standard for gene and chromosome testing?,,SELECT STDDEV(reimbursement) FROM brackets_question WHERE question LIKE '%gene and chromosome%',
aee372f28e8cc6e1deeb4d36,What are patient 10021487's changes in mean blood pressure last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT mean_blood_pressure FROM patient_10021487 WHERE icu_visits = (SELECT COUNT(DISTINCT icu_id) FROM patient_10021487 WHERE patient_id = 10021487) AND measurement_time = (SELECT MAX(measurement_time) FROM patient_10021487 WHERE icu_visits = (SELECT COUNT(DISTINCT icu_id) FROM patient_10021487 WHERE patient_id = 10021487))) - (SELECT mean_blood_pressure FROM patient_10021487 WHERE icu_visits = (SELECT COUNT(DISTINCT icu_id) FROM patient_10021487 WHERE patient_id = 10021487) AND measurement_time = (SELECT MAX(measurement_time) FROM patient_10021487 WHERE icu_visits = (SELECT COUNT(DISTINCT icu_id) FROM patient_1002148,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
99768e192fa0360d8a7cae90,How many doses of lidocaine jelly 2% (urojet) have been prescribed to patient 10038081 since 07/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10038081 AND prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND STRFTIME('%y-%m', prescriptions.date) >= '2100-07'",[{'SUM(prescriptions.dose_val_rx)': None}]
e447bf35d8f5b5f515e7b40e,What is the minimum daily number of patients diagnosed with closed fracture of dorsal [thoracic] vertebra without mention of spinal cord injury since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of dorsal [thoracic] vertebra without mention of spinal cord injury' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT MIN(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis_date) AS c1 FROM diagnoses WHERE diagnosis = 'CLOSED FRACTURE OF DORSALIAN VERTEBRA WITHOUT MENTION OF SPINAL CORD INJURY' AND STRFTIME('%y', diagnosis_date) >= '2100' GROUP BY diagnosis_date) AS t1",
e0581975db0c811fc20544d6,Tell me patient 10038933's total multivitamins input amount in their last ICU visit.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'multivitamins' AND d_items.linksto = 'inputevents' ),SELECT SUM(Multivitamins) FROM icu WHERE Patient = 10038933 AND NOT ICU_DETAILS LIKE '%last%',[{'SUM(inputevents.totalamount)': None}]
a69b592f91b063a29a0fb688,Did patient 10012853 receive a laboratory test on their first hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10012853 AND NOT lab_results.result_date IS NULL ORDER BY lab_results.result_date NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
a903f7427fcbfe8c1598e7c7,What was the name of the last specimen test which patient 10027602 has received since 02/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_type FROM bracket_data WHERE patient_id = 10027602 AND date_received >= '2000-02-21' ORDER BY date_received DESC LIMIT 1,[{'spec_type_desc': 'URINE'}]
e328aff459ba450aa7b31950,Provide the total input volume for patient 10029291 since 03/01/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-01'",SELECT SUM(input_volume) FROM intake_table WHERE patient_id = 10029291 AND input_date >= '2100-03-01';,[{'SUM(inputevents.totalamount)': 76005.0}]
2a882b413da76b5d3b4d828a,What was the name of the organism discovered in the first abscess test of patient 10007795 in 04/this year?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM abscess_organisms WHERE patient_id = 10007795 AND sample_date = '04/2020' ORDER BY sample_date NULLS FIRST LIMIT 1,[]
57280c52999208a8f3104301,"Since 06/30/2100, what was the yearly maximum dose of dextrose 5% for patient 10026354?","SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-30' GROUP BY strftime('%Y',inputevents.starttime)",SELECT MAX(Dose) FROM Dextrose_5% WHERE Patient = 10026354 AND Date >= '2000-06-30' GROUP BY Date,[]
92847b18dd8be297f01979a1,How many days have passed since patient 10018081 got his last diagnosis of candidiasis of mouth in this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnoses.patient_id = 10018081 AND diagnoses.diagnosis = 'candidiasis of mouth' AND diagnoses.dischtime IS NULL;",
51f451ef32c9bcc8c27f43e9,How much does patient 10027602 change in weight second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patients WHERE patient_id = 10027602 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime NULLS FIRST LIMIT 1) - (SELECT weight FROM patients WHERE patient_id = 10027602 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
c3138909fa5b171f0d57fabd,What's the minimum daily number of patients who had hypovolemic shock in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypovolemic shock' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",SELECT MIN(daily_patients) FROM patients WHERE hypovolemic_shock = TRUE AND year = 2100;,
878106bea4b63d355fcf0ef6,Count the number of patients that were discharged from the hospital.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT(DISTINCT patient_id) FROM notifications WHERE notification_type = 'discharged';,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
cdd93c0461e3923a22aa155f,Show me the top three most frequent events that took place since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT event, COUNT(*) FROM events WHERE date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY event ORDER BY COUNT(*) DESC LIMIT 3","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
94ebd65b4f618bfded23ea2d,"Give me the count of drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedures that occurred in the last year.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.drainage = 'right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedures' AND DATETIME(procedures.date) BETWEEN DATETIME(CURRENT_TIME, '-1 year') AND DATETIME(CURRENT_TIME, '-1 year')",
cf5d62cfdfa23393641e93c8,How many days was patient 10038999 in the intensive care unit during their first visit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT COUNT(DISTINCT DATE) FROM intensive_care_unit WHERE patient_id = 10038999 AND NOT intensive_care_unit.dischtime IS NULL ORDER BY intensive_care_unit.admittime NULLS FIRST LIMIT 1,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 8.836469906847924}]"
dc77bd8543dca1e8f57847aa,Inform me about the total amount of patient 10004235's input since 03/21/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-21'",SELECT SUM(input) FROM brackets WHERE patient = 10004235 AND input_date >= '2100-03-21',[{'SUM(inputevents.totalamount)': 122382.0}]
e27430eb77cfd3fc0183209f,What was the name of the organism found in the last microbiological examination of patient 10001725's urine in their last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM (SELECT microbiological_data FROM patient WHERE patient.hospital_encounter_id IN (SELECT MAX(hospital_encounter_id) FROM patient WHERE patient.uniquepatientid = 10001725 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1) AND microbiological_data.specimen_type = 'urine' AND NOT microbiological_data.organism_name IS NULL ORDER BY microbiological_data.microbiology_date DESC LIMIT 1) AS subquery;,[]
3f384b70bd3be24de7ec5ac2,What was the admission type for patient 10001725 during their last hospital admission?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10001725 ORDER BY admissions.admittime DESC LIMIT 1,"SELECT ""admission_type"" FROM ""patient"" WHERE ""patient_id"" = 10001725 AND NOT ""dischtime"" IS NULL ORDER BY ""admittime"" DESC LIMIT 1;",[{'admission_type': 'EW EMER.'}]
9f637b49dd6bf5b92a192d46,"What are the three most commonly ordered procedures for patients who were previously diagnosed with intestinal infection due to other organism, not elsewhere classified, which occurred during the same hospital visit since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_time, patient.location FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'intestinal infection due to other organism, not elsewhere classified' AND STRFTIME('%y', diagnosis.diagnosis_time) >= '2100') AS t1 JOIN (SELECT patient.name, treatment.treatment, treatment.treatment_time, patient.location FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE STRFTIME('%y', treatment.treatment_time) >= '2100') AS t2 ON t1.name = t2.name WHERE t1.diagnosis_time < t2.treatment_time AND t1.location = t2.location GROUP BY t2.treatment) AS t3 WHERE t3.c1 <= 3",
f97301033f6fab945614f220,Has any organism been found in the first mrsa screen microbiological test of patient 10029484 since 05/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT COUNT(*) FROM organism_screen_microbiology WHERE patient_id = 10029484 AND screen_date >= '2000-05-2100' AND test_name = 'mrsa screen microbiology, 1st'",[{'COUNT(*)>0': 0}]
36fa0c204674ed02e032e699,When is the earliest of patient 7400's next visit to other departments?,,SELECT MIN(visit_date) FROM visit_table WHERE patient_id = 7400 AND visit_type = 'other departments',
3658db3e1651d577b0730f29,Show me the top five most frequent output instances.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT OUTPUT, COUNT(*) FROM brackets GROUP BY OUTPUT ORDER BY COUNT(*) DESC LIMIT 5;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
3a2f38d0445a8f3784327832,What was the other myectomy time for patient 4718?,,SELECT date FROM procedures WHERE patient = 4718 AND procedure = 'myectomy' AND date <> (SELECT date FROM procedures WHERE patient = 4718 AND procedure = 'myectomy'),
d92a728db326dded231e11ba,When was the first time of input for patient 10004733 on 12/28/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-28' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(date_input) FROM input_table WHERE patient_id = 10004733 AND date_input LIKE '%12/%28/%',[]
e72bc975b9c19bf0df3b5f9f,When was the first time during their first hospital encounter when patient 10031404 had the maximum value of lactate dehydrogenase (ld)?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT MIN(patient.age) FROM patient WHERE patient.id = 10031404 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.age DESC LIMIT 1,[]
95e4cfa052e3d03fe0ffacbd,How many hours has it been since the first diagnosis of anemia in chronic kidney disease in patient 10004733 on this hospital stay?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in chronic kidney disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnoses.patient_id = 10004733 AND diagnoses.diagnosis = 'Anemia in chronic kidney disease' AND DATETIME(diagnoses.diagnosis_date, 'start of hospital stay') = DATETIME(CURRENT_TIME, 'start of hospital stay')",
11f17f3d6fad511b3db76b80,What is the cost of a diagnosis of automatic implantable cardiac defibrillator in situ?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'automatic implantable cardiac defibrillator in situ' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure = 'automatic implantable cardiac defibrillator in situ';,
9c3f5b2ff13b604dcdc88353,Tell me patient 10009628's total volume of output since 03/03/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-03'","SELECT SUM(output) FROM ""patient10009628"" WHERE ""date"" >= '2100-03-03'",[{'SUM(outputevents.value)': 6293.0}]
ad7bed12453ee529baf37784,Has patient 10004457 received any lab tests since 22 months ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND datetime(labevents.charttime) >= datetime(current_time,'-22 month')","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10004457 AND DATETIME(lab_tests.lab_date) >= DATETIME(CURRENT_TIME, '-22 month')",[{'COUNT(*)>0': 1}]
e4c9451763f7e1edfdb8a185,What were the four frequent output events that occurred in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT,[]
caa992eaae720918e04f0b4d,Which are the five most common specimens tested throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM (SELECT specimen FROM postgres_scan('', 'public', 'species')) GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5;",[]
4db20b840c3b030a56108b21,What was the last time of patient 10027602 mini-bal microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MIN(brackets.time) FROM (SELECT time FROM microbiology WHERE patient_id = 10027602 AND test_type = 'mini-bal') AS brackets WHERE brackets.time >= '03/2100',[]
e8441aac72dc1ce7428bd942,Show me patient 10021487's total oral gastric output amount on this month/16.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'oral gastric' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'",SELECT SUM(total_oral_gastric_output) FROM patient_gastric WHERE patient_id = 10021487 AND month = SELECT EXTRACT(MONTH FROM CURRENT_DATE) AND day = SELECT EXTRACT(DAY FROM CURRENT_DATE) AND current_time = SELECT EXTRACT(TIME FROM CURRENT_DATE),[{'SUM(outputevents.value)': None}]
1b56d7ab012fcdd2c4eec4c3,"What would the maximum yearly number of patients diagnosed with catatonic type schizophrenia, unspecified be since 2100?","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'catatonic type schizophrenia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT MAX(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis.patient_id) AS c1 FROM diagnosis WHERE diagnosis.diagnosis = 'CATATONIC TYPE SCHIZOPHRENIA, UNOBSERVED' AND STRFTIME('%y', diagnosis.date) >= '2100' GROUP BY STRFTIME('%y', diagnosis.date)) AS t1",
2202303447142eaeb02bfd69,What is the minimum value of phosphate on patient 10021666 in 03/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",SELECT MIN(phosphate) FROM patients WHERE patient_id = 10021666 AND measurement_date BETWEEN '2003-03-2100' AND '2003-03-2100',[{'MIN(labevents.valuenum)': None}]
2e016fdfd5dd7f3e7f3be7cd,List the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving percutaneous abdominal drainage in this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.patientid WHERE treatment.treatmenttype = 'percutaneous abdominal drainage' AND DATETIME(treatment.treatmentdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.patientid WHERE DATETIME(diagnosis.diagnosisdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosisdate) BETWEEN DATETIME",
1b34ed1fb8e15ce853b7f472,"First time, what drug was prescribed for patient 10007818 in 07/this year?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10007818 AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '07' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[]
7597553ab7e09923b877dd3e,What was the first specimen test given to patient 10018328 in 02/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_test FROM visit_log WHERE patient_id = 10018328 AND visit_date BETWEEN '2022-02-01' AND '2022-02-31' ORDER BY visit_date NULLS FIRST LIMIT 1,[]
94c43966b63036608d8e4089,What was the drug that patient 10018501 prescribed for within 2 days after the procedure of alcohol detoxification in 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10018501 AND treatment.date = '2100-08-01') AS t1 JOIN (SELECT patient.id, prescription.drug FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE patient.id = 10018501) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
02aa04b3e6868db7eb1fed99,What are the three frequently prescribed medications in the same month to the patients aged 40s after diagnosed with coronary atherosclerosis of native coronary artery throughout this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of native coronary artery' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.age, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'coronary atherosclerosis of native coronary artery' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.age, medication.name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.patient_id WHERE patient.age BETWEEN 40 AND 49 AND DATETIME(medication.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.age = t2.age WHERE t1.diagnosis_date < t2.date AND DATETIME(t1.",
66a7bb5b8a5d8c05eb6fe97c,Get me the top three most frequent medications that patients were prescribed with in the same month after being diagnosed with unspecified infectious and parasitic diseases.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified infectious and parasitic diseases' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'INFECTIOUS AND PARASITIC DISEASES, UNOBTAINABLE') AS t1 JOIN (SELECT patient.uniquepid, medication.medication, medication.drug_date FROM medication JOIN patient ON medication.patient_id = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.drug_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.drug_date, 'start of month') GROUP BY t2.medication) AS t3 WHERE t3.c1 <= 3",
fef989a873a0244ffbcecf45,"On 05/21/2100, when was the last input time of patient 10018423?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-05-21' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10018423 AND input_time BETWEEN '2100-05-21 00:00:00' AND '2100-05-21 23:59:59';,[]
88903941545e70b4a021e3b2,"In the last year, how many (aorto)coronary bypass of four or more coronary arteries procedures were conducted?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.coronary_bypass_type = '(Aorto)coronary bypass of four or more coronary arteries' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",
80d49c51633413262b935409,When was the last staph aureus swab microbiology test of patient 10004422's performed on their last hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(date) FROM microbiology WHERE microbiology.patient_id IN (SELECT patient.id FROM patient WHERE patient.hospital_id IN (SELECT hospital.id FROM hospital WHERE patient.id = 10004422 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1)) AND microbiology.swab_type = 'staph aureus',[]
1f4cec0d64925a794dace1cd,What was prescribed to patient 10027602 within 2 days following their percutaneous [endoscopic] gastrostomy [peg] in 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.date FROM (SELECT t1.subject_id, t1.date FROM (SELECT patient.subject_id, procedures.date FROM patient JOIN procedures ON patient.subject_id = procedures.subject_id WHERE patient.subject_id = 10027602 AND procedures.percutaneous__endoscopic__gastrostomy__peg = 12 AND STRFTIME('%y-%m', procedures.date) = '2100-12') AS t1 GROUP BY t1.subject_id HAVING MAX(t1.date) = '2100-12-31' AND MIN(t1.date) = '2100-12-01') AS t2 JOIN (SELECT patient.subject_id, prescriptions.date FROM patient JOIN prescriptions ON patient.subject_id = prescriptions.subject_id WHERE patient.subject_id = 10027602 AND STRFTIME('%y-%m', prescriptions.date) = '2100-12') AS t3 ON t2.subject_id =",
1cd31dccc70c46d3c3d8d825,Can you show me the drug that patient 10016150 was last prescribed in their last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECTdrugs.drug_name FROM drugs WHERE drugs.patient_id = 10016150 AND NOT drugs.drug_date IS NULL ORDER BY drugs.drug_date DESC LIMIT 1,[{'drug': 'Aspirin'}]
3ae2168575144fa7bff0773b,Is patient 4758 subject to the test covid-19?,,SELECT COUNT(*) > 0 FROM tests WHERE tests.patient_id = 4758 AND tests.test_name = 'covid-19',
733c21a9f57a3bc179010c01,How many hours have elapsed since the first time on their current hospital encounter patient 10004733 got a epithelial cells lab test?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result.result_date)) FROM lab_result WHERE lab_result.patient_id = 10004733 AND lab_result.result_type = 'epithelial cells' ORDER BY lab_result.result_date NULLS FIRST LIMIT 1;",[]
2f8dde64c76d63b846def4a0,What is the maximum total cost of the hospital visits that included a procedure called other operations on intestines since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other operations on intestines' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.proc_name = 'other operations on intestines' AND DATETIME(cost_table.visit_date) >= DATETIME(CURRENT_DATE, '-1 year') GROUP BY cost_table.pat_name) AS t1",
57db051f5e8f25c8927f61ad,How many times patient 10012552 came to the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10012552 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM hospital WHERE patient_id = 10012552 AND DATETIME(hospital.admittime) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
d3085358f26b085a3251d71d,Count the number of patients who were given the indomethacin since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'indomethacin' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.lastname = 'indomethacin' AND DATETIME(patient.lastname) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 4}]
dac65a4d9eca6e3f5529ae4b,What should i do in advance of bile duct incision nec,,"SELECT * FROM procedures WHERE procedure_name = ""Bile duct incision NEC""",
37919d0f8db2140219307c6f,Have patient 14990 an appointment in another department?,,SELECT COUNT(*) > 0 FROM appointments WHERE appointments.patient_id = 14990 AND appointments.location <> 'another department',
82d8a7640bee5ba7059a425f,When was the last hospital discharge time for patient 10014354?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10014354 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_dischtime) FROM hospital WHERE hospital.patient_id = 10014354;,[]
f710a9e23d2b119bb3cbd7d6,"During the last year, how many extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic procedures were conducted?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.lobe = 'left lower lung lobe' AND procedures.procedure = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic procedures'",
fb1c9ab851ce79aecda9c32e,Tell me the total number of patients who were discharged from the hospital in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, dates.dischtime FROM admissions JOIN dates ON admissions.dischdate = dates.dischtime WHERE dates.dischtime IS NOT NULL AND DATETIME(dates.dischtime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')) AS t1 JOIN (SELECT admissions.subject_id, dates.dischtime FROM admissions JOIN dates ON admissions.dischdate = dates.dischtime WHERE dates.dischtime IS NOT NULL AND DATETIME(dates.dischtime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE DATETIME(t1.dischtime) = DATETIME(t2.dischtime)",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
b6b5cdff0364757e59ebb7a4,What was the amount of or ebl output patient 10008287 had?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ),"SELECT COUNT(*) FROM ""output"" WHERE ""patient"" = 10008287 AND ""output_type"" = 'or ebl'",[{'SUM(outputevents.value)': None}]
004aab9ab72eb76ab6d10d57,What is the total number of patients who stayed in careunit medical/surgical intensive care unit (micu/sicu) during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.careunit = ""MEDICAL/SURGICAL INTENSIVE CARE UNIT (MICU/SICU)"" AND DATETIME(patient.staydate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
10a09034b24ebc5ea1fcd470,Is the lymphocytes level of patient 10037928 last measured on the last hospital visit less than the first level measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.value FROM lab WHERE lab.patient = 10037928 AND NOT lab.result IS NULL ORDER BY lab.date DESC LIMIT 1) < (SELECT lab.value FROM lab WHERE lab.patient = 10037928 AND NOT lab.result IS NULL ORDER BY lab.date DESC LIMIT 1) AND lab.label = 'lymphocytes'),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
24c0ef475388f60e725ccbc1,Did patient 10037861 receive the procedure of a right heart cardiac catheterization in the first hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10037861 AND procedures.procedure_name = 'right heart cardiac catheterization' AND NOT procedures.date IS NULL ORDER BY procedures.date NULLS FIRST LIMIT 1;,[{'COUNT(*)>0': 0}]
92de51735371a46e81acc845,When did patient 10022281 depart hospital for the first time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022281 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(departure_date) FROM patient WHERE patient.id = 10022281,[]
617b9e75f3c58dee20062f3c,Can you tell me the last time patient 10021312 had a maximum heart rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM patient WHERE patient_id = 10021312,[]
59612d635a641261872944e4,What's the cost of a procedure called extracorporeal circulation auxiliary to open heart surgery?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ),"SELECT DISTINCT cost FROM procedures WHERE name = ""Extracorporeal circulation auxiliary to open heart surgery""",
cdba77ccb92d5b91ada3a6dc,When will patient 31854 be next seen by the hospital?,,"SELECT nextafter(current_timestamp, 31854.0) as next_seeing",
99282beda9432fdc84953229,Has patient 27146 ever had any side effects while he/she is receiving a blood transfusion?,,"SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 27146 AND diagnoses.side_effects = ""blood transfusion""",
f5f0f6336f05d930f6059ee3,What percentile of the mcv value is 85.0 among patients of the same age as patient 10004733 on this hospital stay?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 85.0","SELECT DISTINCT t1.c1 FROM (SELECT mcv, c1 FROM (SELECT patient_id, mcv, c1 FROM (SELECT a.patient_id, a.mcv, c1 FROM (SELECT patient_id, mcv, c1 FROM patient_10004733 UNION ALL SELECT patient_id, mcv, c1 FROM patient_10004733_copy) AS a GROUP BY a.patient_id, a.mcv, c1 HAVING mcv = 85.0) AS t1 JOIN (SELECT patient_id, mcv, c1 FROM (SELECT patient_id, mcv, c1 FROM patient_10004733 UNION ALL SELECT patient_id, mcv, c1 FROM patient_10004733_copy) AS a GROUP BY a.patient_id, a.mcv, c1 HAVING mcv = 85.0) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.mcv = t2.mcv",
327a6b8b85b9df578f97d124,"What's the average monthly number of patients who were diagnosed with chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction?","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT AVG(MONTHLY_PATIENTS) FROM gastric_ulcer_chronic_or_unspecified WHERE HEMORRHAGE_WITHOUT_OBSTRUCTION = 1,
133bfd224364a0a162d9e323,Does patient 57050 have some overseas travel history.,,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 57050 AND patients.overseas_travel_history IS NOT NULL,
b727c4a8aaf41e038a4aabf6,What is the average yearly number of patients who suffer from coronary atherosclerosis of autologous vein bypass graft?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(Yearly Number of Patients) FROM ""coronary atherosclerosis of autologous vein bypass graft"" WHERE ""Coronary Atherosclerosis"" = 'Coronary Atherosclerosis'",
04aa90b4226c2ae74327b579,What was the name of the output which patient 10004733 had last had since 03/07/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT output_name FROM duckdb_outputs WHERE patient_id = 10004733 AND output_date >= '2100-03-07' ORDER BY output_date DESC LIMIT 1,[{'label': 'Foley'}]
4433eb04729dc3101c0b6e05,Is the white blood cells value of patient 10005817 last measured on the first hospital visit greater than the value from the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab.value FROM lab WHERE lab.patient = 10005817 AND NOT lab.value IS NULL ORDER BY lab.date NULLS FIRST LIMIT 1) > (SELECT lab.value FROM lab WHERE lab.patient = 10005817 AND NOT lab.value IS NULL ORDER BY lab.date NULLS FIRST LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
c79aa16d36ce764a13078e7b,How can i disinfect the room in which there is a quarantine?,,SELECT * FROM sanitize WHERE room = 'quarantine';,
aa5ad9ebeb0fafd7b1afae6f,What was the name of the organism at the last sputum test of patient 10038081?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM sputum_tests WHERE patient_id = 10038081 ORDER BY sample_time DESC LIMIT 1;,[]
e94967759cb45a5c074573d6,Has patient 10024043 been given any sort of diagnosis during this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10024043 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
0221f690fdea162c568ad8dc,What was the admission type when patient 10004422 first entered the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10004422 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1","SELECT ""Admission Type"" FROM ""patient_table"" WHERE ""Patient ID"" = 10004422 ORDER BY ""Hospital Admission Date"" NULLS FIRST LIMIT 1;",[{'admission_type': 'EW EMER.'}]
22e0dcfd0402820cca140ef2,What was the last drug that was prescribed to patient 10038081 via the pr route in their last hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(drug_id) FROM (SELECT drug_id FROM prescriptions WHERE prescriptions.patient_id = 10038081 AND prescriptions.route = 'pr' AND NOT prescriptions.drug_id IS NULL AND prescriptions.drug_id <> ANY(SELECT previous_drug_id FROM prescriptions WHERE prescriptions.patient_id = 10038081 AND prescriptions.route = 'pr' AND prescriptions.drug_id IS NOT NULL) GROUP BY prescriptions.patient_id HAVING COUNT(DISTINCT prescriptions.drug_id) > 0),[]
d2664490e75476fb8fcc2c63,What amount of syringe (iso-osmotic dextrose) has been prescribed to patient 10022017 for the last time in 10/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND prescriptions.drug = 'syringe (iso-osmotic dextrose)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10022017 AND prescriptions.drug = 'syringe (iso-osmotic dextrose)' AND STRFTIME('%y-%m', prescriptions.date_prescribed) = '2100-10'",[]
6232ae4db195276a3e324143,Was patient 10000032 tested on pt in 08/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08'","SELECT COUNT(*) FROM lab_data WHERE lab_data.patient_id = 10000032 AND lab_data.field = 'pt' AND STRFTIME('%y-%m', lab_data.date) = '2100-08'",[{'COUNT(*)>0': 0}]
946656a7c18d9898d7d2613c,Can you provide the minimum daily number of patients diagnosed with long term (current) use of insulin?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of insulin' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",SELECT MIN(diagnosis.daily_number_of_patients) FROM diagnosis WHERE diagnosis.long_term_use_of_insulin = 'current',
a81a9ceee607e440b6b6e0ef,Count the total patients who were prescribed desmopressin acetate since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'desmopressin acetate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.patienttype = 'acute' AND DATETIME(patient.prescriptiondate) >= DATETIME(CURRENT_TIME, '-1 year') AND patient.prescriptiondrug = 'desmopressin acetate'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
37f2202c7041980e8e71b098,What are the top three most frequent microbiology tests that patients were diagnosed with malignant neoplasm of lower third of esophagus within 2 months since 2100?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT t3.code FROM (SELECT t2.code, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'malignant neoplasm of lower third of esophagus' AND STRFTIME('%y', diagnosis.date) >= '2100') AS t1 JOIN (SELECT patient.subject_id, microbiology.code, microbiology.date FROM microbiology JOIN patient ON microbiology.patient_id = patient.subject_id WHERE STRFTIME('%y', microbiology.date) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.code) AS t3 WHERE t3.c1",
811775f5b19375275b6b4825,Show me the total amount of patient 10007928's output since 04/07/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07'","SELECT SUM(output) FROM ""patients"" WHERE ""patient_id"" = 10007928 AND ""output_date"" >= '2100-04-07'",[{'SUM(outputevents.value)': 6660.0}]
6033e2bfc3a0657f188b7149,What was the name of the last specimen test which patient 10019385 has received in 03/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT specimen_type FROM (SELECT patient_id, specimen_type, DATE_FROM_STRING('03/2100', 'MM/YYYY') AS date_test FROM patient_specimens WHERE patient_id = 10019385) AS subquery WHERE date_test = (SELECT MAX(date_test) FROM patient_specimens WHERE patient_id = 10019385)",[]
8890920db6fabe97648a1d64,Has patient 10007795 had any surgeries in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 10007795 AND STRFTIME('%y', patients.admittime) = '2100'",
82de427493ba0005e55da2e9,Can you tell me the top five diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t5.diagnosis, t5.c1, t5.c2, t5.c3 FROM (SELECT t4.diagnosis, t4.c1, t4.c2, t4.c3, 100.0 * t4.c3 / SUM(t4.c3) OVER () AS c3_percentile FROM (SELECT t3.diagnosis, t3.c1, t3.c2, t3.c3 FROM (SELECT t2.diagnosis, t2.c1, t2.c2, 100.0 * t2.c2 / SUM(t2.c2) OVER () AS c2_percentile FROM (SELECT t1.diagnosis, t1.c1, t1.c2 FROM (SELECT 'AORTAL TACHYCARDIA' AS diagnosis, 42.4 AS c1, 10.0 AS c2 FROM grades WHERE course = 'AORTAL TACHYCARDIA') AS t1 GROUP BY t1.diagnosis) AS t2 JOIN (",
74d605424dff525f198b0afe,Has patient 10016810 received a medication prescription since 1 year ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM medication_prescriptions WHERE medication_prescriptions.patient_id = 10016810 AND DATETIME(medication_prescriptions.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 1}]
e6ffbc5a3950db37fba4014e,When did patient 10037861 have his last microbiology test in 10/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT date FROM Microbiology WHERE patient_id = 10037861 AND date BETWEEN '2010-10-2100' AND '2010-10-2100' ORDER BY date DESC LIMIT 1,[]
8d5bb2ecca85dfad41515eb5,Has patient 10010471 been admitted to the emergency room since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.location = 'emergency room admit' AND DATETIME(admissions.admission_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 0}]
cf07a721765b700935e376f5,How much is the difference of basophils of patient 10038992 last measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT Basophils FROM Patients WHERE Patient_ID = 10038992 AND NOT FirstHospitalVisit IS NULL ORDER BY Basophils DESC LIMIT 1) - (SELECT Basophils FROM Patients WHERE Patient_ID = 10038992 AND NOT FirstHospitalVisit IS NULL ORDER BY Basophils NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
43d295b14df7663a4b921316,What is the cost for a drug named nicotine patch?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nicotine patch' ),SELECT cost FROM drugs WHERE name = 'nicotine patch';,
1f207d94f4dd9613e4d69a5d,"In 2100, how often was introduction of other therapeutic substance into peripheral artery, percutaneous approach done?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.year = 2100 AND procedures.name = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach'",
7793a26811956045c0aad41d,"For patients who were diagnosed with acute venous embolism and thrombosis of subclavian veins , what are the top four most common medications that followed afterward during the same hospital visit?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute venous embolism and thrombosis of subclavian veins' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate, patient.venue FROM diagnosis JOIN patient ON diagnosis.patientid = patient.patientid WHERE diagnosis.diagnosis = 'acute venous embolism and thrombosis of subclavian veins') AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.startdate, patient.venue FROM medication JOIN patient ON medication.patientid = patient.patientid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.startdate AND t1.venue = t2.venue GROUP BY t2.name) AS t3 WHERE t3.c1 <= 4",
7e458af0dc3da0d261bc5436,When was the last time when patient 10021312 was prescribed vancomycin and 0.9% sodium chloride at the same time in 09/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10021312 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10021312 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",,[]
df6d9f1646fc387c7952ce10,"Is the value of patient 10009628's hemoglobin, second measured on the first hospital visit, less than the first value measured on the first hospital visit?",SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT hemoglobin FROM patient WHERE patient.patient_id = 10009628 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1) < (SELECT hemoglobin FROM patient WHERE patient.patient_id = 10009628 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
a2dcdcf12890887cb1bf85a7,What is the minimum monthly number of cases for unspecified atrial flutter?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial flutter' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT MIN(monthly_cases) FROM diagnoses WHERE atrial_flutter = 'unspecified',
b58e546890ee6007f8e2974b,"Last year, how many patients were diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis FROM (SELECT SUM(CASE WHEN chronic_kidney_disease_stage = 'i' THEN 1 ELSE 0 END) AS stage_i, SUM(CASE WHEN chronic_kidney_disease_stage = 'ii' THEN 1 ELSE 0 END) AS stage_ii, SUM(CASE WHEN chronic_kidney_disease_stage = 'iii' THEN 1 ELSE 0 END) AS stage_iii, SUM(CASE WHEN chronic_kidney_disease_stage = 'iv' THEN 1 ELSE 0 END) AS stage_iv, id FROM hypertensive_chronic_kidney_disease WHERE hypertensive_chronic_kidney_disease_unspecified = 0) AS t1 WHERE stage_i = 1 OR stage_ii = 1 OR stage_iii = 1 OR stage_iv = 1",
d365fe598240a0df514f9daa,Count how many current patients are aged 60 or above.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT(*) FROM patients WHERE age >= 60,
b7b00a485da3ac7c2a9f4f8e,What was the admission type for patient 10026354 during their first hospital admission?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10026354 ORDER BY admissions.admittime ASC LIMIT 1,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10026354 AND NOT admissions.dischtime IS NULL ORDER BY admissions.admittime NULLS FIRST LIMIT 1,[{'admission_type': 'URGENT'}]
855969a5637352d329e6b650,Which are the five top specimens that were tested in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",SELECT TOP(5) FROM (SELECT * FROM specimens WHERE year = 2000) AS subquery;,[]
6a7c1eb2cf2a97c8f56e8695,What specimen test was given in 12/2100 to patient 10008454 for the last time?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_test FROM history WHERE patient_id = 10008454 AND date = '12/2100' ORDER BY date DESC LIMIT 1,[]
017d9aef746962d1c3d9d52e,When did patient 10027445 last receive a mrsa screen microbiology test since 08/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM mrsa_screen_microbiology WHERE patient_id = 10027445 AND date >= '2000-08-2100',[]
eeb43c515ff535d263e55711,"What is the minimum total cost of hospitalization that includes the reticulocyte count, absolute laboratory test since 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'reticulocyte count, absolute' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(Lab.cost) AS c1 FROM Lab WHERE Lab.labname = 'reticulocyte count, absolute' AND STRFTIME('%y', Lab.date) >= '2100' GROUP BY Lab.patientID) AS t1",
1af0e5232d922453e5d2e3ae,How many patients received unilateral simple mastectomy treatment in the same month after having been diagnosed with acquired absence of breast and nipple in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of breast and nipple' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, date_trunc('month', diagnosis_date) AS diagnosis_month FROM diagnoses WHERE diagnosis = 'Acquired absence of breast and nipple' AND STRFTIME('%y', diagnosis_date) = '2100') AS t1, (SELECT subject_id, date_trunc('month', treatment_date) AS treatment_month FROM treatments WHERE treatment = 'Unilateral simple mastectomy' AND STRFTIME('%y', treatment_date) = '2100') AS t2 WHERE t1.diagnosis_month = t2.treatment_month",
8a1b6e9c62cf3eae76e1d86d,How many current patients are there in the 60 or above age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT(*) FROM patients WHERE age >= 60,
88a6c24100e056a0cd5afdeb,"What is the number of extirpation of matter from coronary artery, one artery, percutaneous approach procedures carried out?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from coronary artery, one artery, percutaneous approach' )","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'Extirpation of matter from coronary artery, one artery, percutaneous approach';",[{'COUNT(*)': 0}]
423eabf79f7a6b056f9dea1e,What is the minimum monthly number of patients diagnosed with personal history of traumatic brain injury since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of traumatic brain injury' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MIN(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis_date) AS c1 FROM diagnoses WHERE personal_history = 'traumatic brain injury' AND STRFTIME('%y', diagnosis_date) >= '2100' GROUP BY diagnosis_date) AS t1",
2ada7dac8b465ec817534276,What was the amount of neutra-phos that was prescribed to patient 10036156 for the first time in 07/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug = 'neutra-phos' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT neutra_phos FROM prescriptions WHERE prescriptions.patient_id = 10036156 AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '07' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[]
562f824477376311916b88db,Patient 10008287 was diagnosed during their first hospital visit for the last time with what?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT MAX(diagnosis_date) FROM diagnoses WHERE patient_id = 10008287 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnosis_date NULLS FIRST LIMIT 1,
47d86d0e205097ff162381f7,When did patient 10027602 last have a minimum value of diastolic blood pressure on last month/29?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT last(diastolic_blood_pressure) FROM patient WHERE patient_id = 10027602 AND date_submitted = last_month(29),[]
392945487423b16d5daec3fe,"For patient 10039831, what was the first hematocrit, calculated reading in their current hospital encounter?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) ORDER BY labevents.charttime ASC LIMIT 1",SELECT SUM(hematocrit) FROM read_hematocrit WHERE patient_id = 10039831 AND hematocrit IS NOT NULL,[]
ca8aadc66b1fcaf0dbac962e,"How many patients had a glucose, pleural lab test?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, pleural' ) )","SELECT COUNT(DISTINCT patient_id) FROM lab_results WHERE lab_name = ""Glucose, Pleural""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c6db806375506c37524257d8,Has patient 10027602 received any diagnoses since 1 year ago?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10027602 AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')",
408218a9af14aa7ec6f3f966,How much does it cost for ondansetron?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ondansetron' ),SELECT DISTINCT cost FROM prescriptions WHERE prescriptions.drug = 'ondansetron',
c1e6eda2955990fe92f24709,What are the five frequently ordered drugs for patients diagnosed with unspecified condition of brain previously in the same month?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified condition of brain' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = ""BRAIN CONDITION, UNKNOWN"") AS t1 JOIN (SELECT patient.id, drug.drug, drug.drug_date FROM drug JOIN patient ON drug.patient_id = patient.id) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.drug_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.drug_date, 'start of month') GROUP BY t2.drug) AS t3 WHERE t3.c1 <= 5",
c84349e69cbe2cf09f686cd5,Retrieve the top five most frequent medications that patients were prescribed within 2 months after being diagnosed with unspecified vascular insufficiency of intestine since 1 year ago.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified vascular insufficiency of intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.patientid WHERE diagnosis.diagnosis = 'UNOBTRUSIVE VASCULAR INSUFFICIENCY OF INTESTINE' AND DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, medication.medication, medication.medicationdate FROM medication JOIN patient ON medication.patientid = patient.patientid WHERE DATETIME(medication.medicationdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.medicationdate AND DATETIME(t2.medicationdate) BETWEEN DATETIME(t1.di",
94c68a26042492f18d7f5c60,What was the duration in days of patient 10014354's last stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', ICU_LENGTH(10014354, 'day')) as duration FROM ICU_LENGTH WHERE patient_id = 10014354 AND NOT ICU_LENGTH(10014354, 'day') IS NULL ORDER BY duration DESC LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.2415625010617077}]"
c916df49979cb247be8c50a6,Give me the total volume of output for patient 10039831 since 01/19/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'","SELECT SUM(output) FROM ""output"" WHERE patient = 10039831 AND date >= '01/19/2100';",[{'SUM(outputevents.value)': 6680.0}]
5572350469c75b9bc5b406cd,"What are the five most frequently given diagnoses for patients who had previously had extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic in the same month, since 1 year ago?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id FROM patient WHERE patient.name = 'Jane Doe') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis FROM diagnosis JOIN patient ON diagnosis.patientId = patient.id WHERE diagnosis.diagnosis = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic') AS t2 ON t1.id = t2.patientId WHERE t1.date - t2.date < INTERVAL '1 year' AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 5",
3189eb16865c13742abd3f7a,Is patient 12726 scheduled to have an appointment in another department?,,SELECT,
2be33c796f39654a64acc2af,"What are the five most commonly tested specimens for patients who were diagnosed with chronic osteomyelitis, site unspecified previously within the same month, throughout this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic osteomyelitis, site unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.time FROM (SELECT patient.name, diagnosis.time FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.diagnosis = 'chronic osteomyelitis, site unspecified') AS t1 JOIN (SELECT patient.name, specimen, time FROM biopsy JOIN patient ON biopsy.patient = patient.name WHERE YEAR(time) = 2016) AS t2 ON t1.name = t2.name WHERE t1.time < t2.time AND DATETIME(t1.time, 'start of month') = DATETIME(t2.time, 'start of month') GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 5",
8946a6077d0e165e482e261f,What are the four most frequent microbiology tests in this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT t.test_name, COUNT(t.test_name) FROM Microbiology_Tests t WHERE DATETIME(t.test_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 4;",[]
8ffeebf80d9e33afb70ec3ec,Please list out the monthly average weight of patient 10004422 in 2100.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10004422 AND year = 2100 GROUP BY month,[]
cb462d0dd320361bdac44dad,What are the five diagnoses with the lowest 3-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate, 5 AS _diagnoses FROM (SELECT 3 AS _month_survival_rate,",
21ee43d3aa608dce16db8951,How much calcium carbonate was prescribed the last time on the first hospital stay to patient 10021938?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'calcium carbonate' ORDER BY prescriptions.starttime DESC LIMIT 1,"SELECT MAX(days_since_first_hospital_stay) FROM (SELECT patient_id, prescriber_id, days_since_first_hospital_stay FROM prescriptions WHERE patient_id = 10021938 AND prescriber_id = 'calcium carbonate')",[]
04f7c8bdde444d9384216f93,Calculate the number of ICU visits of patient 10020786.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ),SELECT COUNT(DISTINCT icu_visit) FROM icu_visits WHERE icu_patient_id = 10020786;,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
15a45174676987c6a3c0c4af,What percentile does a urea nitrogen value of 15.0 for patient 10001725 place in today on the first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 15.0",SELECT 10001725.today.percentile FROM 10001725.today WHERE 10001725.today.urea_nitrogen = 15.0,
bebd7cec45abb76dc9e4534c,What was a drug that patient 10001217 was prescribed for within the same hospital visit after receiving central venous catheter placement with guidance in this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.hospital_id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE patient.patient_id = 10001217 AND treatment.treatment_description = 'central venous catheter placement with guidance' AND DATETIME(treatment.treatment_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')) AS t1 JOIN (SELECT patient.hospital_id, prescription.drug FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE patient.patient_id = 10001217 AND DATETIME(prescription.prescription_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')) AS t2 ON t1.hospital_id = t2.hospital_id WHERE t1.treatment_date < t2.prescription_date AND DATETIME(t1.treat",
4a1dbfdbd15e295406eef0bf,Has patient 10020306 been treated with a unilateral simple mastectomy procedure since 1 year ago?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM treatment WHERE treatment.patient_id = 10020306 AND treatment.treatment_type = 'unilateral simple mastectomy' AND DATETIME(treatment.treatment_date) >= DATETIME(CURRENT_TIME, '-1 year')",
5f14e8eaef40b6633ce2e6dc,How was patient 10020944 admitted to the hospital in terms of admission type for the first time?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020944 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020944 ORDER BY admissions.admission_date NULLS FIRST LIMIT 1,[]
848f58c164e2f0878c1c9ce1,Has patient 10004235 been oxygen saturation tested in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen saturation' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10004235 AND lab_results.test_name = 'oxygen saturation' AND STRFTIME('%y', lab_results.result_date) = '2100'",[{'COUNT(*)>0': 0}]
fc8ee142c3b432f169fa7cdc,What are the five frequently ordered medications for patients diagnosed with esophageal reflux previously during the same hospital visit?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_time, patient.patient_location FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Esophageal reflux') AS t1 JOIN (SELECT patient.name, medication.name, medication.medication_time, patient.patient_location FROM medication JOIN patient ON medication.patient_id = patient.patient_id) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_time < t2.medication_time AND t1.patient_location = t2.patient_location GROUP BY t2.name) AS t3 WHERE t3.c1 <= 5",
53ff8403c661d26f398402c6,What is the average yearly number of patients who suffer from unspecified sinusitis (chronic)?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",SELECT AVG(YEAR(Date)) FROM Postgres_DB.Patient WHERE Sinusitis = 'unspecified',
f094acde3e855985c85bc122,What were the top five diagnoses most frequently diagnosed since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t5.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) as rank",
c8d18210963921f83f907052,What are the top three most commonly diagnosed conditions since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT diagnosis, COUNT(*) FROM diagnoses WHERE date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 3",
ebde9f1b9d393f71e485fb70,Is patient 18677 having a history of suppurat peritonitis nec in his/her family?,,"SELECT COUNT(*) > 0 FROM patients WHERE patients.family_id = 18677 AND patients.diagnosis = ""SUPURAT PERITONITIS NEC""",
061afbb7908a8ff0d6a68a50,Has patient 10005866 been admitted into an emergency room since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.emergency_room_admittance = 'yes' AND DATETIME(admissions.admission_time) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 0}]
46a12514c3bab25439a23710,Show me the length of time in days patient 10014729 was in the ICU during the last visit.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1",SELECT SUM(LENGTH(TIMESTAMP '2022-06-01 10:30:00') - LENGTH(TIMESTAMP '2022-06-01 00:00:00')) as days_in_icu,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.471168980933726}]"
c26556c5555cff100d6a8a02,What are the prices for the drug called aspirin (buffered)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' ),SELECT price FROM drugs WHERE name = 'aspirin (buffered)',
7b04b1222708b5e1f1411219,"What was the maximum value of creatinine, urine for patient 10038992 during the last hospital visit?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine, urine' )","SELECT MAX(Creatinine, Urine) FROM lab WHERE Patient = 10038992 AND Visit = (SELECT MAX(Visit) FROM lab WHERE Patient = 10038992);",[{'MAX(labevents.valuenum)': None}]
42cb30e92eb50866f96a3d15,Calculate the sum of patient 10004235's input since 01/20/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-20'",SELECT SUM(Input) FROM input WHERE Patient = 10004235 AND Date >= '2100-01-20',[{'SUM(inputevents.totalamount)': 122382.0}]
87a08ba4fb163b2b667c4c13,When was the last time patient 10021487 was measured with a SaO2 greater than 97.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 97.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(measurement_time) FROM measurements WHERE patient_id = 10021487 AND SaO2 > 97.0,[]
9a574ab97db06ee700de7520,How many hours have passed since the first time patient 10039831 has received a calculated total co2-lab test in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', test_date)) FROM lab_results WHERE patient_id = 10039831 AND lab_name = 'calculated total co2-lab' AND hospital_location = 'current hospital' ORDER BY test_date DESC LIMIT 1;",[]
28bdbd0cf00eb27eaead2cf5,When was the last time that patient 10007818's respiratory rate was measured at greater than 18.0 on 07/20/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 18.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '07-20' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(datetime(respiratory_rate, '07/20/this year')) FROM patient WHERE patient_id = 10007818 AND respiratory_rate > 18.0",[]
6b5916a645e1dcf8aaef7a8d,What is the name of the drug that shouldn't be administered during lt heart angiocardiogram?,,SELECT name FROM drugs WHERE administer_during_lt_heart_angiocardiogram = 'no',
2ea0eb184438ab7110b6c335,"Fetch the top five most frequent procedures that were administered to patients within 2 months after they had drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.procedure FROM (SELECT t2.procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.uniquepid WHERE procedures.procedure = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic') AS t1 JOIN (SELECT patient.uniquepid, procedures.procedure, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.procedure) AS t3 WHERE t3.c1 <= 5",
7cfc885a581b81aedac1d706,What are the top five most commonly diagnosed conditions this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) as rank",
6388862788004bf9b1e4345a,Can you tell me when patient 10004733's last microbiology test was since 05/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(microbiology_date) FROM microbiology WHERE microbiology.patient_id = 10004733 AND microbiology.type = 'last' AND STRFTIME('%y-%m', microbiology_date) >= '2100-05'",[{'charttime': '2174-12-13 12:35:00'}]
bf6f9f9621257cc2c12df1dc,When did patient 10038999 have the mesothelial cells lab test for the first time in 06/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1","SELECT lab_date FROM lab_results WHERE patient_id = 10038999 AND lab_name = 'mesothelial cells' AND STRFTIME('%y-%m', lab_date) = '2100-06' ORDER BY lab_date NULLS FIRST LIMIT 1",[]
6e592987e710b1b2fcd180e0,What's the red blood cells change of patient 10009628 last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.result FROM lab WHERE lab.patient = 10009628 AND NOT lab.result IS NULL ORDER BY lab.date DESC LIMIT 1) - (SELECT lab.result FROM lab WHERE lab.patient = 10009628 AND NOT lab.result IS NULL ORDER BY lab.date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
112f416ddb62edda1db7a561,How much is the maximum total hospital bill for a visit that involves a mcv test throughout this year?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",SELECT MAX(T1.total_hospital_bill) FROM (SELECT SUM(T2.hospital_bill) AS total_hospital_bill FROM (SELECT T3.hospital_bill FROM (SELECT 50 AS hospital_bill FROM USER_TABLE AS T3 UNION ALL SELECT 100 AS hospital_bill FROM USER_TABLE AS T3 UNION ALL SELECT 50 AS hospital_bill FROM USER_TABLE AS T3 UNION ALL SELECT 100 AS hospital_bill FROM USER_TABLE AS T3) AS T2 GROUP BY T2.patient_id) AS T1,
a54cc5aec8ac14dc7dd2bdbe,What medicine does patient 84476 take after being prescribed by our hospital's other department?,,SELECT t2.name FROM (SELECT * FROM patient WHERE id = 84476) AS t1 JOIN prescription AS t2 ON t1.id = t2.patient_id WHERE t1.department = 'other',
8121c662bf6e3f319ab5b9f9,List the top three most frequent events occurring.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT Event, COUNT(*) FROM brackets GROUP BY Event ORDER BY COUNT(*) DESC LIMIT 3;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
733f66f03dc1de20e998d218,How much glucagon was prescribed since 05/2100 for the last time to patient 10020306?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(t1.glucagon) FROM (SELECT glucagon FROM prescriptions WHERE prescriptions.patient = 10020306 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-05') AS t1;",[]
08996b07e2ed8aa176fe423e,Could you tell me the five most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t1.Microbiology, COUNT(t1.Microbiology) FROM (SELECT Microbiology FROM procedures WHERE Microbiology = 'appendix probe') AS t1 JOIN procedures AS t2 ON t1.Microbiology = t2.Microbiology GROUP BY t1.Microbiology ORDER BY COUNT(t1.Microbiology) DESC LIMIT 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
7e3ec87fbaccb0f0ab6de255,When did patient 10018845 get input for the first time?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) ORDER BY inputevents.starttime ASC LIMIT 1,SELECT input_date FROM input_history WHERE patient_id = 10018845 ORDER BY input_date NULLS FIRST LIMIT 1;,[{'starttime': '2184-10-08 05:03:00'}]
8dc67c242df7f0e88cce307e,What was the first drug that patient 10007818 had been prescribed via the pr route since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(drug_date) FROM prescriptions WHERE patient_id = 10007818 AND route = 'pr' AND drug_date >= '2000-05-21',[]
a1c948ed4a09091c1d92be84,Whats the code that works with icd-11 mal neo lower 3rd esoph in icd-10?,,SELECT icd_10 FROM icd_tables WHERE icd_11 = 'MALNEO LOWER 3RD ESOPH',
c247847fea9d213094a3045f,What are the five most frequently administered procedures for patients aged 40s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.Admins, COUNT(t1.Admins) FROM (SELECT admins.admin_name FROM admins WHERE admins.d_age BETWEEN 40 AND 49) AS t1 JOIN procedures ON t1.Admins = procedures.admin_name WHERE STRFTIME('%y', procedures.proc_date) >= '2100' GROUP BY t1.Admins ORDER BY COUNT(t1.Admins) DESC LIMIT 5",
9564984f5e6bba259c9cbe18,"What are the five most commonly diagnosed diagnoses for patients who had previously received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic within the same month since 1 year ago?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id FROM patient WHERE patient.name = 'Alice') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'LEFT LOWER LOBE BRONCHUS' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.id = t2.id GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 5",
e456aafa65dbfb805ba11016,When was patient 10020740's respiratory rate first measured less than 20.0 in their first ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 20.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(RespiratoryRate) FROM (SELECT RespiratoryRate FROM (SELECT ICUStay FROM (SELECT PatientId FROM (VALUES (10020740)) AS T1 JOIN (VALUES (1)) AS T2 ON T1.PatientId = T2.PatientId WHERE T1.PatientId = 10020740 AND NOT T1.ICUStay IS NULL ORDER BY T1.ICUStay BY HEADER FIRST LIMIT 1) AS T3 WHERE T3.RespiratoryRate < 20.0),[]
27c5230565a9e53ebebd7913,Show me patient 10004733's total volume of output since 05/19/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19'","SELECT SUM(output) FROM ""output"" WHERE patient = 10004733 AND date >= '2000-05-19'",[{'SUM(outputevents.value)': 17410.0}]
ee08d24fe58b44292d96dfdc,"How much is introduction of nutritional substance into upper gi, via natural or artificial opening?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) )","SELECT SUM(swallowing_time) FROM swallowing_table WHERE swallowing_route = 'INTRODUCTION OF NUTRITIONAL SUBSTANCE INTO UPPER GI, VIA NATURAL OR ARTIFICIAL OPENING';",
86a5036ec7d536605431efaf,Tell me the name of the diagnosis that patient 10039831 received the first time in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT name FROM diagnoses WHERE patient = 10039831 AND STRFTIME('%y', date) = '2100' ORDER BY date NULLS FIRST LIMIT 1",
00854efb1da3fe176150292d,What new drugs are prescribed for patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT date_diff('day', TIMESTAMP '2022-01-01 00:00:00', TIMESTAMP '2022-01-02 00:00:00') AS days_since_start, prescription_id, prescription_name FROM prescriptions WHERE patient_id = 10039831 AND date_diff('day', TIMESTAMP '2022-01-01 00:00:00', TIMESTAMP '2022-01-02 00:00:00') <= 1",[]
72a2d6a35e2ba5c873f1a881,Has patient 10027445 had any medication prescribed since 07/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10027445 AND STRFTIME('%y-%m', medication.date) >= '2100-07'",[{'COUNT(*)>0': 1}]
92968aac60b31a25b1b7a9e2,Get me the top four most frequent drugs that patients were prescribed in the same month after being diagnosed with other place in hospital as the place of occurrence of the external cause throughout this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other place in hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis_date BETWEEN DATE '2022-01-01' AND DATE '2022-12-31' AND diagnoses.place = 'other place in hospital') AS t1 JOIN (SELECT admissions.subject_id, prescriptions.drug, prescriptions.prescription_date FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE prescriptions.prescription_date BETWEEN DATE '2022-01-01' AND DATE '2022-12-31') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.prescription_date AND DATET",
cb9ca5309bb33b28efa1b130,Calculate the number of patients who were discharged from the hospital during this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE NOT patient.dischtime IS NULL AND DATETIME(patient.dischtime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
137633ed86ab2d0d0059f5c2,"How many hours have elapsed since the first time in the current hospital visit patient 10021487 received a lab test for bilirubin, total, ascites?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, ascites' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_test_time)) FROM lab_tests WHERE patient_id = 10021487 AND lab_test_name = ""Bilirubin, Total, Ascites""",[]
b6dc114c7f1dd675d8ee88a1,Did patient 10018081 have any medication prescribed on their last hospital encounter?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10018081 AND NOT medication.dischtime IS NULL ORDER BY medication.admittime DESC LIMIT 1;,[{'COUNT(*)>0': 1}]
cdc697ea9fbefe7b34b817f1,What drug was first prescribed to patient 10009035 since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10009035 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-05' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[{'drug': 'Aspirin'}]
91db324bae8dcd9a03f5f6ba,What was the name of the diagnosis that patient 10018081 received for the last time since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT diagnosis_name FROM diagnoses WHERE diagnoses.patient_id = 10018081 AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100' ORDER BY diagnoses.diagnosis_date DESC LIMIT 1",
2dc6aa9a4ecdf77dc85c452e,Retrieve patient 10018423's monthly minimum weight since 03/2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MIN(weight) FROM patients WHERE patient_id = 10018423 AND date >= '03/2100' GROUP BY date_trunc('month', date);",[]
62e57b2d710776dc9693105a,What was the total of calcium acetate that patient 10021938 had been prescribed on the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'calcium acetate',SELECT SUM(caffeine_acetate) FROM patients WHERE patient_id = 10021938 AND NOT patient_hospital_info.last_dischtime IS NULL ORDER BY patient_hospital_info.admittime DESC LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
adac729f5e8b6d9ceaf2e454,Tell me the length of time in days for patient 10010471's first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', ICU.STAY.OUT - ICU.STAY.IN) as LENGTH_OF_STAY","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.907152778003365}]"
8ce0acf858783aaaafbc6c86,When was the last time patient 10012552 was measured heart rate greater than 78.0 in the first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 78.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(heart_rate_measurement_time) FROM (SELECT heart_rate_measurement_time FROM patient_heart_rate WHERE patient_id = 10012552 AND NOT icu_number IS NULL ORDER BY icu_number NULLS FIRST LIMIT 1) WHERE heart_rate > 78.0;,[]
7d276bb7858da3e756c5b278,Give me patient 10025612's total amount of or crystalloid intake input.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ),SELECT SUM(intake_amount) FROM intake WHERE intake_patient_id = 10025612 AND intake_item = 'or crystalloid',[{'SUM(inputevents.totalamount)': None}]
7e323066fd515e38f24d8cbe,"What are the five frequently tested specimens for patients that received insertion of intraluminal device into inferior vena cava, percutaneous approach previously within the same hospital visit since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intraluminal device into inferior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t5.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS ""rank"" FROM (SELECT t4.subject, t4.specimen, t1.hospital_visit_id FROM (SELECT t3.subject, t3.specimen, t2.hospital_visit_id FROM (SELECT patient.subject, device.specimen, visit.hospital_visit_id FROM device, patient, visit WHERE device.type = 'intraluminal' AND patient.subject = device.subject AND visit.hospital_visit_id = device.hospital_visit_id AND STRFTIME('%y', visit.visit_date) >= '2100') AS t2 JOIN (SELECT patient.subject, device.specimen, visit.hospital_visit_id FROM device, patient, visit WHERE patient.subject = device.subject AND visit.hospital_visit_id = device.hospital_visit_id AND STRFTIME('%y', visit.visit_date) >= '2100') AS t3 ON t2.subject = t3",
b184bcbbaadeb5289f8fd10a,What are the four most frequently ordered medications that patients in their 20s were prescribed in the same month after they were diagnosed with tobacco use disorder?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'tobacco use disorder') AS t1 JOIN (SELECT admissions.subject_id, medications.name, medications.date FROM medications JOIN admissions ON medications.admission_id = admissions.admission_id WHERE admissions.age BETWEEN 20 AND 29) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 4",
311010fa82081b7438a008c0,"How much is the cost of the family history of malignant neoplasm of trachea, bronchus, and lung diagnosing?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of trachea, bronchus, and lung' ) )","SELECT DISTINCT cost FROM brackets_questions WHERE question = 'What is the cost of the family history of malignant neoplasm of trachea, bronchus, and lung diagnosing?'",
102866b5841e8a98e3f1d51b,Can you list patient 10031404's monthly average weight?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10031404 GROUP BY month,[]
7809b76d2d7b213240cd949c,How many hours have passed since the first time that patient 10004733 stayed in careunit medicine on this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', careunit.admittime)) FROM careunit WHERE careunit.patient = 10004733 AND careunit.location = 'medicine' AND DATETIME(careunit.admittime, 'start of encounter') = DATETIME(CURRENT_TIME, 'start of encounter');",[]
e4c2baa72dfc40ca402c8ebc,Is patient 10018081's heart rate last measured on the current ICU visit less than the second to last value measured on the current ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT heart_rate FROM icu_heart_rate WHERE icu_heart_rate.icu_id IN (SELECT icu_id FROM icu WHERE icu.patient_id = 10018081) AND icu.out_time IS NULL) < (SELECT heart_rate FROM icu_heart_rate WHERE icu_heart_rate.icu_id IN (SELECT icu_id FROM icu WHERE icu.patient_id = 10018081) AND icu.out_time IS NULL ORDER BY heart_rate DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
81fecc104d9ef8ac42378b81,Show me the top five most common treatments for patients aged 20s since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment FROM (SELECT * FROM patients WHERE t1.age BETWEEN 20 AND 29) AS t1 JOIN (SELECT * FROM diagnoses WHERE t1.year >= 2100) AS t2 ON t1.treatment = t2.treatment GROUP BY t1.treatment) AS t3 ORDER BY COUNT(t3.treatment) DESC LIMIT 5",
0bf3d99fa1e1eb8dd643a066,Was patient 10007818 on any solution in the first ICU stay?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) FROM icu_stays WHERE icu_stays.had_patient_10007818 AND icu_stays.nurse_id IS NOT NULL AND icu_stays.stay_duration = (SELECT MIN(stay_duration) FROM icu_stays WHERE icu_stays.had_patient_10007818),[{'COUNT(*)>0': 0}]
a370a79ac614fe8fa9d3408a,What output did patient 10021487 have for the first time since 12/15/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-15' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT STRFTIME('%d/%m/%Y', CURRENT_TIMESTAMP) AS current_time",[{'label': 'Foley'}]
6560334262dd340b665256e1,List the top five most common events that happened throughout this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT Event, COUNT(Event) FROM brackets GROUP BY Event ORDER BY COUNT(Event) DESC LIMIT 5",[]
f22796c3c0a1bd93d011883d,Has patient 10038999 experienced any surgeries?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10038999,[{'COUNT(*)>0': 1}]
9e60028a3774be29f175d420,Can you tell me about patient 10016150's age in the last hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT demographics.age FROM demographics WHERE demographics.subject_id = 10016150 AND NOT demographics.dischtime IS NULL ORDER BY demographics.admittime DESC LIMIT 1,
304008138415ff886f9fa539,Show me the total amount of patient 10008454's output on this month/02.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '02'",SELECT SUM(output) FROM output WHERE patient_id = 10008454 AND date = '2022-01-02',[{'SUM(outputevents.value)': None}]
0ebcf64e6e88ffe234e3a991,What was the total amount of input for patient 10026354 since 07/21/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-21'",SELECT SUM(input) FROM input WHERE patient = 10026354 AND date >= '07/21/2100',[{'SUM(inputevents.totalamount)': 7100.0}]
2d135d2b1bde82eddce53d88,What are the three most ordered lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT lab_test, COUNT(lab_test) FROM lab_tests GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
63b6c9677e2f1cde57d31e73,How much does patient 10004422 change in weight last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT weight FROM patients WHERE patient_id = 10004422 AND NOT patients.hospital_info IS NULL ORDER BY timestamp DESC LIMIT 1) - (SELECT weight FROM patients WHERE patient_id = 10004422 AND NOT patients.hospital_info IS NULL ORDER BY timestamp DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
fcf30c1dc6ce58162c86998c,What was the five most common microbiology test conducted in this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.microbiology_test, COUNT(t.microbiology_test) FROM (SELECT json_extract(data, '$.microbiology_test') as microbiology_test FROMbrackets) t GROUP BY t.microbiology_test ORDER BY COUNT(t.microbiology_test) DESC LIMIT 5",[]
f1cc5fc4c2d7e41e0b9536dd,Tell me the name of the specimen test that patient 10022281 last received in their first hospital encounter?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,"SELECT specimen_type FROM (SELECT patient_id, specimen_type FROM microbiome WHERE patient_id IN (SELECT patient_id FROM (SELECT patient_id, encounter_date FROM encounter WHERE patient_id = 10022281 ORDER BY encounter_date DESC LIMIT 1)",[{'spec_type_desc': 'MRSA SCREEN'}]
3831c2c777259f2c220dcceb,Tell me the type of blood of patient 13440?,,"SELECT ""type"" FROM ""blood"" WHERE ""patient"" = '13440'",
fc73eadf00468623cbf19884,Tell me what the top five most commonly prescribed drugs are since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.drug FROM (SELECT prescriber.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriber WHERE STRFTIME('%y', prescriber.date) >= '2100' GROUP BY prescriber.drug) AS t1 WHERE t1.c1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
389610e48fedce18d3b1ef8d,"What are the four frequently ordered drugs for patients diagnosed with other and unspecified alcohol dependence, continuous previously in the same hospital visit, since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, continuous' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t1.drug FROM (SELECT admissions.subject, diagnoses.diagnosis_date, admissions.admittime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""OTHER AND UNSPECIFIED ALCOHOL DEPENDENCE"" AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100') AS t1 JOIN (SELECT admissions.subject, medications.drug, medications.drug_start_time, admissions.admittime FROM medications JOIN admissions ON medications.admission_id = admissions.admission_id WHERE STRFTIME('%y', medications.drug_start_time) >= '2100') AS t2 ON t1.subject = t2.subject WHERE t1.diagnosis_date < t2.drug_start_time AND DATETIME(t2.drug_start_time) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.di",
6b59462d8c8e0692f930ee62,What did patient 10020740 first have as output on 03/30/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-30' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT 30 FROM ""patient_10020740"" WHERE ""output"" = '03/30/2100'",[]
9dea9102653c7bfb36386393,"How many days have passed since patient 10004733 got her first diagnosis of cerebral artery occlusion, unspecified with cerebral infarction on their current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = ""CEREBRAL ARTERY OCCLUSION, UNKNOWN WITH CEREBRAL INFARCTION"" AND patient_id = 10004733;",
770ad5d0ecd285dc97b984b2,Is that patient 5849 has an appointment in another department?,,SELECT COUNT(*) > 0 FROM appointments WHERE appointments.patient_id = 5849 AND appointments.department_id <> (SELECT departments.department_id FROM departments WHERE departments.name = 'Cardiology'),
d4bd03642b6b6c5ff9cd88ac,Tell me the average heart rate for patient 10006580's body since 08/13/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13'",SELECT AVG(heart_rate) FROM body_data WHERE patient_id = 10006580 AND date >= '2100-08-13',[{'AVG(chartevents.valuenum)': None}]
96055c134a9e795b09937032,Are you letting me know if patient 14397 is subject to covid-19 testing?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_to_covid_19_testing = 1 AND patients.unique_patient_id = 14397,
cfb014c016bea7b3e220c08f,How many patients were present in the surgical intensive care unit (sicu) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'surgical intensive care unit (sicu)' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, SURGICAL_INTENSIVE_CARE_UNIT(sicu) AS surgical_unit FROM patient WHERE SURGICAL_INTENSIVE_CARE_UNIT(sicu) = 1) AS t1 WHERE STRFTIME('%y', t1.surgical_unit.admit_date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ea52341a69ca686cb059fc2c,Has there been any diagnosis that patient 10004733 has received in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10004733 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100'",
5487ee77cca76c582ae0fd80,What was the first measurement of o2 saturation pulseoxymetry that patient 10022017 had on the first ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(O2_SATURATION_PULSEOXymetry) FROM (SELECT O2_SATURATION_PULSEOXymetry FROM (SELECT * FROM ICU WHERE ICU.patient = 10022017) AS ICU WHERE NOT ICU.outgoing AND ICU.unit = 1) AS ICU_O2_SATURATION_PULSEOXymetry;,[]
fccae88f01f7fd8906029a4f,What's the ward id patient 90165 can go to?,,SELECT ward_id FROM patient WHERE patient_id = 90165,
37fa4b05690e4fda0cc395bf,When was the first time patient 10038933 had a medication prescribed via the td route since 28 months ago?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'td' AND datetime(prescriptions.starttime) >= datetime(current_time,'-28 month') ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(date_prescribed) FROM medication_prescriptions WHERE patient_id = 10038933 AND route = 'td' AND date_prescribed >= DATEADD(month, -28, CURRENT_DATE)",[]
6bade51b85498f959d6a659c,How much did patient 10004235 weigh the first time it was measured in 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT patient.weight FROM patient WHERE patient.patient_id = 10004235 AND strftime(patient.weight_date, '%y-%m') = '2100-03' ORDER BY patient.weight_date NULLS FIRST LIMIT 1",[]
95a56ae5ea17a6e60f36afb6,Can you provide me with an example of how many operating rooms are available now?,,SELECT COUNT(*) FROM inventory WHERE part_number = 'operating-room';,
23b4c91212b33b3feec1624d,Calculate the number of patients who underwent a laboratory test for % hemoglobin a1c since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) AND strftime('%Y',labevents.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.a1c_percent FROM (SELECT subject_id, a1c_percent FROM lab_data WHERE year >= 2100) AS t1 JOIN lab_data AS t2 ON t1.subject_id = t2.subject_id WHERE t2.a1c_percent = '% hemoglobin a1c')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
18134bb405cad581e0aaef9f,What is the cost of unspecified protein-calorie malnutrition diagnostic?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified protein-calorie malnutrition' ) ),SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = 'Unspecified protein-calorie malnutrition',
d18670a4c314b569054a32a3,"During the first hospital encounter, what was the monthly maximum dose of dextrose 5% for patient 10005909?","SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MAX(Dose) FROM (SELECT Dose FROM Inventory WHERE Patient = 10005909 AND Name = 'dextrose 5%') AS T;,[]
f111218b574bd10dcf361deb,What are the four most frequent procedures for patients who are in their 60 or above in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.Name, COUNT(t1.Name) FROM (SELECT t2.Name FROM (SELECT patient.Name FROM patient WHERE patient.Age >= 60) AS t1 JOIN (SELECT treatment.Name FROM treatment WHERE treatment.Year = 2100) AS t2 ON t1.Name = t2.Name) GROUP BY t1.Name ORDER BY COUNT(t1.Name) DESC LIMIT 4",
de4256f2df1bf1aaa0eb15bb,"Give me the top three most commonly prescribed medications during the same hospital encounter to patients aged 50s after they were diagnosed with congestive heart failure, unspecified during this year.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate, patient.age FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'CONGESTIVE HEART FAILURE, UNDESCRIBED' AND DATETIME(diagnosis.diagnosisdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.dosage, diagnosis.diagnosisdate, patient.age FROM medication JOIN patient ON medication.patientid = patient.uniquepid WHERE patient.age BETWEEN 50 AND 59 AND DATETIME(medication.dosage, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.di",
287474d13b646c19858f98f7,What was the name of the specimen that patient 10026255 received for the first time since 04/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_received FROM (SELECT * FROM Patient WHERE patient_id = 10026255) AS T1 JOIN (SELECT * FROM Specimen WHERE date_received >= '2000-04-2100') AS T2 ON T1.specimen_id = T2.specimen_id ORDER BY T2.date_received NULLS FIRST LIMIT 1,[{'spec_type_desc': 'SPUTUM'}]
a3f40dc2c562eaeeb1b1acb1,What is the average total hospital cost for a patient diagnosed with family history of other specified malignant neoplasm?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of other specified malignant neoplasm' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.patient_name = 'family history of other specified malignant neoplasm' GROUP BY cost_table.patient_name) AS t1,
8527b64a6629ebc78cca2a01,"What are the three most commonly taken specimens for patients that received introduction of other thrombolytic into peripheral vein, percutaneous approach previously within 2 months in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into peripheral vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, DATE_SUB('month', t1.date, t2.date) AS monthdiff FROM (SELECT patient.specimen, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.patient WHERE diagnosis.diagnosis = 'introduction of other thrombolytic into peripheral vein, percutaneous approach') AS t1 JOIN (SELECT patient.specimen, date FROM procedures JOIN patient ON procedures.patient = patient.patient WHERE procedures.date) AS t2 ON t1.patient = t2.patient WHERE t1.monthdiff BETWEEN 0 AND 2) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 3",
1fae11bc2be174f27630c683,Was patient 10026255 to the emergency room in the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM patient WHERE patient.emergency_room_admittime >= (SELECT MAX(emergency_room_admittime) FROM patient WHERE patient.subject = 10026255) AND DATETIME(patient.emergency_room_admittime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT(*)>0': 0}]
b89ae914fde1da12628b1901,What are the four most common diagnoses of patients in their 40s?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis, COUNT(*) FROM patients WHERE age BETWEEN 40 AND 49 GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 4",
1f76d064d52e32276438fbaf,What are the various ways to consume cinacalcet?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'cinacalcet',"SELECT DISTINCT ON (path) path FROM (SELECT path, consume_cinacalcet() AS value FROM (SELECT 'consuming cinacalcet' AS path) UNION ALL SELECT 'downstream', value FROM (SELECT 'downstream', consume_cinacalcet() AS value FROM (SELECT 'downstream', NULL AS value FROM (SELECT 'upstream', value FROM (SELECT 'upstream', NULL AS value FROM (SELECT 'downstream', value FROM (SELECT 'upstream', value FROM (SELECT 'downstream', NULL FROM (SELECT 'upstream', value FROM (SELECT 'downstream', NULL FROM (SELECT 'upstream', value FROM (SELECT 'downstream', NULL FROM (SELECT 'upstream', value FROM (SELECT 'downstream', value FROM (SELECT 'downstream', NULL FROM (SELECT 'upstream', value FROM (SELECT 'upstream', value FROM (SELECT 'downstream', value FROM (SELECT 'downstream', NULL FROM (SELECT 'downstream', value FROM (SELECT 'downstream', value FROM (SELECT 'downstream', NULL FROM (SELECT 'downstream', value FROM (SELECT 'downstream', value FROM (SELECT 'downstream', NULL FROM (SELECT '",[{'route': 'ORAL'}]
bf14cf17da2349955ab8ea66,"Since 16 months ago, what was the first recorded weight for patient 10038999?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-16 month') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(weight_kg) FROM weights WHERE patient_id = 10038999 AND date_captured >= '2016-01-01',[]
920ad0d7946eb3abca368599,What were the most frequent diagnoses among the top three this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t1.subject_id, t1.diagnosis FROM (SELECT subject_id, diagnosis FROM (VALUES (1, 'diabetes'), (2, 'hypertension'), (3, 'hyperkinetics')) AS t1 GROUP BY t1.subject_id) AS t2 JOIN (SELECT subject_id, diagnosis FROM (VALUES (1, 'diabetes'), (2, 'hypertension'), (3, 'hyperkinetics')) AS t3 ON t2.subject_id = t3.subject_id WHERE DATETIME(t2.diagnosis, 'start of year') = DATETIME(t3.diagnosis, 'start of year') GROUP BY t3.diagnosis) AS t2 JOIN (SELECT subject_id, diagnosis FROM (VALUES (1, 'diabetes'), (2, 'hypertension'), (3, 'hyperkinetics')) AS t3 ON t2.subject_id =",
81f790401d1b25c6eebdd607,What was the total of pantoprazole patient 10020944 had been prescribed in 03/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'pantoprazole' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'",SELECT SUM(pantoprazole) FROM patients WHERE patient_id = 10020944 AND date_prescribed BETWEEN '03/01/2016' AND '03/31/2016',[{'SUM(prescriptions.dose_val_rx)': None}]
b0e746871a7c5eea41ef06b4,Inform me about the total amount of patient 10006580's input since 05/02/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-02'",SELECT SUM(input) FROM input WHERE patient = 10006580 AND date >= '2100-05-02',[{'SUM(inputevents.totalamount)': 5149.0}]
68d2cf8d2fa30727fc51e480,Tell me the five most frequent medical diagnoses throughout this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.MedicalDiagnosis, COUNT(t1.MedicalDiagnosis) FROM (SELECT t2.MedicalDiagnosis FROM ""schema"".""schema"" AS t2 JOIN ""schema"".""documents"" AS t3 ON t2.DocumentID = t3.DocumentID WHERE t2.DocumentID = ANY(SELECT t3.DocumentID FROM ""schema"".""documents"" AS t3 JOIN ""schema"".""schema"" AS t2 ON t3.DocumentID = t2.DocumentID WHERE t2.DocumentID = ANY(SELECT t1.DocumentID FROM ""schema"".""documents"" AS t1 JOIN ""schema"".""schema"" AS t2 ON t1.DocumentID = t2.DocumentID WHERE t2.DocumentID = ANY(SELECT t1.DocumentID FROM ""schema"".""documents"" AS t1 JOIN ""schema"".""schema"" AS t2 ON t1.DocumentID = t2.DocumentID WHERE YEAR(t1.DocumentDate) = 2011))) AS t1 GROUP BY t1.MedicalDiagnosis ORDER BY COUNT(t1.MedicalDiagnosis) DESC",
00144320e5ae44ed871c5db7,Show me the top three most frequent events that took place.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT event, COUNT(*) FROM events GROUP BY event ORDER BY COUNT(*) DESC LIMIT 3;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
77b6bd619a1302c0e9f16e66,What was the drug that was last prescribed to patient 10039708 via the ih route since 08/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(drug_prescribed_date) FROM drugs WHERE patient_id = 10039708 AND route = 'ih' AND drug_prescribed_date >= '2008-08-2100',[]
8511198e010ebb4b33fcc4e3,What was the aggregate input volume for patient 10007058 since 38 days ago?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-38 day')",SELECT AVG(input_volume) FROM input_volume WHERE patient_id = 10007058 AND input_time >= (CURRENT_TIMESTAMP - INTERVAL 38 DAY);,[{'SUM(inputevents.totalamount)': 10975.0}]
d83e90e0fe19b6017850565d,What is the recorded sex of patient 10020306?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306,SELECT recorded_sex FROM patients WHERE patient_id = 10020306;,[{'gender': 'F'}]
4637ee6f3a563e19535756a3,What were the four most frequently given diagnoses for patients who received partial hepatectomy previously within 2 months this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT diagnosis, COUNT(diagnosis) FROM patients WHERE partial_hepatectomy = 1 AND date_part('year', hep_date) = date_part('year', CURRENT_DATE) AND date_part('month', hep_date) BETWEEN date_part('month', CURRENT_DATE) - 2 AND date_part('month', CURRENT_DATE) GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 4",
d1177dfd4cf0c6b2da2111a1,Give me the total amount of nacl 0.9% given to patient 10039831 since 03/03/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-03'",SELECT COUNT(*) FROM inventory WHERE patient_id = 10039831 AND product_name = 'nacl 0.9%' AND date_of_entry >= '2100-03-03',[{'SUM(inputevents.totalamount)': None}]
7d3ded586776af8013c94a0f,"For patient 10018081, how many days have passed since the last diagnosis with urinary tract infection, site not specified on this hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnoses.patient_id = 10018081 AND diagnoses.diagnosis_type = 'urinary tract infection, site not specified'",
6975f69a4cfb65e6179fba81,When did patient 10007795 receive the last mrsa screen microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM mrsa_screen_microbiology WHERE patient_id = 10007795 AND date >= '2000-03-2100',[]
896c8f2f1440f307d4f71409,How many patients were administered ipratropium bromide neb?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium bromide neb' ),SELECT COUNT(DISTINCT patient_id) FROM administered_drugs WHERE drug = 'Ipratropium Bromide Neb';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e17c8e6fc29a5b5e084734c4,What is the change in the medication of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM medication_usage WHERE patient_id = 10018081 AND date = CURRENT_DATE - INTERVAL '1 day',[]
d84b738e8882f159cbf1debf,"Among patients who were diagnosed with postinflammatory pulmonary fibrosis, what were the top four most common microbiology tests conducted during the same month in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t4.microbiology_test, COUNT(t4.microbiology_test) FROM (SELECT t3.microbiology_test, COUNT(t3.microbiology_test) FROM (SELECT t2.microbiology_test, COUNT(t2.microbiology_test) FROM (SELECT t1.microbiology_test, COUNT(t1.microbiology_test) FROM diagnoses AS t1 JOIN postinflammatory_pulmonary_fibrosis AS t2 ON t1.postinflammatory_pulmonary_fibrosis_id = t2.postinflammatory_pulmonary_fibrosis_id WHERE t1.year = 2100 GROUP BY t1.microbiology_test) AS t2 JOIN (SELECT patient_id, microbiology_test, COUNT(microbiology_test) FROM microbiology GROUP BY patient_id, microbiology_test) AS t3 ON t2.patient_id = t3.patient_id WHERE t2.month = t3",
afce68a2f7090e5fa3220930,What was the insurance for patient 10040025 during the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT MIN(insurance) FROM (SELECT insurance FROM patient WHERE patient.hospital_number = 1) AS subquery WHERE patient.hospital_sequence = 1;,[{'insurance': 'Other'}]
1cfbdedba5f3d901870e5290,What's the percentile of 18.1 in a white blood cells lab test at the same age as patient 10026354 during the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 18.1","SELECT DISTINCT t1.c1 FROM (SELECT lab.c1, PERCENT_RANK() OVER (ORDER BY lab.c1 NULLS FIRST) AS c2 FROM lab WHERE lab.c1 = 18.1 AND lab.patient = (SELECT patient.id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.id = 10026354 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay NULLS FIRST LIMIT 1))) AS t1 WHERE t1.c2 = 1",
dc9b3236056266b458fff17f,How many hours has it been since patient 10004733 stayed in the careunit medical/surgical intensive care unit (micu/sicu) during this hospital visit for the first time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.staydate)) FROM patient WHERE patient.staydate = STRFTIME('%Y-%m-%d', CURRENT_TIME) AND patient.subject = 10004733 AND patient.dischtime IS NULL",[]
095a491640c35f9a56195a9d,"Among patients who took central venous catheter placement with guidance since 1 year ago, what are the top three most frequent diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT diagnoses.diagnosis FROM diagnoses WHERE diagnoses.date BETWEEN (SELECT cath.date FROM central_venous_cath cath WHERE cath.date BETWEEN DATEADD(year, -1, GETDATE()) AND DATEADD(year, -1, GETDATE())) AND DATEADD(month, 2, (SELECT cath.date FROM central_venous_cath cath WHERE cath.date BETWEEN DATEADD(year, -1, GETDATE()) AND DATEADD(year, -1, GETDATE()))) GROUP BY diagnoses.diagnosis ORDER BY COUNT(*) DESC LIMIT 3",
d8faa21afb298080c233542b,How many gemfibrozil prescriptions were administered?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Gemfibrozil';,[{'COUNT(*)': 0}]
3d5c60968afcd59588d2af3b,What was the name of the medication which patient 10025463 was prescribed within 2 days after receiving other electric countershock of heart since 11/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-11' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT patient.id FROM patient WHERE patient.id = 10025463) AS t1 JOIN (SELECT patient.id, medication.name FROM medication JOIN patient ON medication.patient = patient.id WHERE patient.id = 10025463) AS t2 ON t1.id = t2.patient WHERE t2.name = 'Other Electric Countershock of Heart' AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
6f3c178cf388c0f60f63cd4a,When did patient 10029484 receive a ptt lab test on the first occasion?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT lab.lab_date FROM lab WHERE lab.patient_id = 10029484 AND lab.lab_name = 'ptt' ORDER BY lab.lab_date NULLS FIRST LIMIT 1,[]
3f09bed66cb7c82a92b7dcb0,Could you retrieve the top three most common outputs?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",SELECT COUNT(DISTINCT output) FROM code ORDER BY COUNT(DISTINCT output) DESC LIMIT 3,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
837051daccd7778c8114f640,What was the admission type when patient 10008287 last entered the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10008287 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1","SELECT ""admission_type"" FROM ""patient_table"" WHERE ""patient_id"" = 10008287 ORDER BY ""hospital_admission_date"" DESC LIMIT 1",[]
be97d5c806f9525cdc91ee8c,What was the name of the medication that patient 10040025 was prescribed in the same hospital visit after receiving a arteriography of renal arteries procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of renal arteries' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.name FROM (SELECT patient.uniquecarrier, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.patientid WHERE patient.patientid = 10040025 AND treatment.treatmenttype = 'arteriography of renal arteries') AS t1 JOIN (SELECT patient.uniquecarrier, medication.name FROM medication JOIN patient ON medication.patientid = patient.patientid WHERE patient.patientid = 10040025) AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.treatmenttime < t2.treatmenttime AND t1.patientid = t2.patientid",
5c31e3d97360a4d0dc136eba,What was the five most common microbiology test conducted in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.microbiology_test, COUNT(t.microbiology_test) FROM (SELECT json_extract(data, '$.microbiology_test') as microbiology_test FROM (SELECT json_extract(data, '$.metadata.conducted_by') as data FROM runs WHERE json_extract(data, '$.metadata.conducted_by') = 'John Doe' AND json_extract(data, '$.metadata.conducted_at') = '2022-01-01') AS t GROUP BY t.microbiology_test ORDER BY COUNT(t.microbiology_test) DESC LIMIT 5) AS subquery;",[]
6b87c27e7eaa3734d66015e0,How many medications were prescribed in 04/this year to patient 10012853?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10012853 AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '04';",[{'COUNT(*)': 0}]
ea58b388c8e0a4f382814580,When did patient 10007818 first have their maximum mean blood pressure on 07/07/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '07-07' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",SELECT MAX(mean_blood_pressure) FROM patient WHERE patient_id = 10007818 AND date_of_measurement = '07/07/2022',[]
bfff3b930069caa7a3444608,When was patient 10006053's respiratory rate last measured greater than 17.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(RespiratoryRate) FROM (SELECT RespiratoryRate FROM RespiratoryRate WHERE PatientID = 10006053) WHERE RespiratoryRate > 17.0,[]
d768135cc45a97c5f9aa32bc,"Since 03/05/2100, when did patient 10008454 have their first input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(intake_date) FROM intake_table WHERE intake_table.patient_id = 10008454 AND intake_date >= '2100-03-05',[{'starttime': '2110-11-30 18:15:00'}]
e0cf2f53e348a811ec32082d,What was the insurance for patient 10016150 during their first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT MIN(insurance) FROM patients WHERE patient_id = 10016150 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1,[{'insurance': 'Medicare'}]
bc354ef513b2215446177f31,Count the number of hospital visits patient 10038933 had during the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10038933 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT visit_date) FROM visit_table WHERE patient_id = 10038933 AND visit_date BETWEEN DATEADD(year, -1, CURRENT_DATE) AND CURRENT_DATE",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
03cc245c1d997582959cd48a,What is the average monthly number of cases for other specified coagulation defects since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT AVG(t1.MonthlyNumber) FROM (SELECT COUNT(Id) AS MonthlyNumber FROM Postgres_Db.Cases WHERE OtherSpecifiedCoagulationDefect = 'true' AND Duration >= 1 YEAR GROUP BY Month) AS t1,
1a52e19cc4c2bea04555d722,What was patient 10035185's yearly maximum weight?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10035185 GROUP BY date,[]
bc7d9cca70c0c64f7dd707af,What was the total sertraline dose that patient 10016742 has been prescribed in 08/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'sertraline' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08'",SELECT SUM(sertraline) FROM prescriptions WHERE patient_id = 10016742 AND date = '2000-08-2100',[{'SUM(prescriptions.dose_val_rx)': None}]
ab750c2c23f2234be8a906a3,"How many hours has it been since patient 10021487's first cardiac complications, not elsewhere classified diagnosis in the current hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.diagnosis = 'CARDIAC COMPLICITIS NOT ELSEWHERE' AND patient.subject = 10021487,
9f9170a12486ac9447866fbe,Could you show me the top five most common microbiology tests throughout this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.Microbiology, COUNT(t.Microbiology) FROM (SELECT Microbiology FROM (SELECT * FROM (SELECT ""Staphonyl"" AS Microbiology FROM Operations WHERE Year = 2015) UNION ALL (SELECT ""Staphonyl"" AS Microbiology FROM Operations WHERE Year = 2016) UNION ALL (SELECT ""Staphonyl"" AS Microbiology FROM Operations WHERE Year = 2017) UNION ALL (SELECT ""Staphonyl"" AS Microbiology FROM Operations WHERE Year = 2018) UNION ALL (SELECT ""Staphonyl"" AS Microbiology FROM Operations WHERE Year = 2019)) AS t GROUP BY t.Microbiology ORDER BY COUNT(t.Microbiology) DESC LIMIT 5",[]
16e880e54314b4d23201e4d1,Retrieve the top three most common lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT lab_test, COUNT(lab_test) FROM lab_results GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 3;","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
3783e47702fc97ed7cdea710,Can you provide the maximum monthly number of patients diagnosed with attention deficit disorder with hyperactivity?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MAX(monthly_diagnoses) FROM diagnoses WHERE diagnosis = ""Attention deficit disorder with hyperactivity""",
f1e84b550c51a00e780daaa4,"What are the three most frequently administered laboratory tests for patients previously diagnosed with nontoxic uninodular goiter within the same hospital visit, in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nontoxic uninodular goiter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnosis.diagnosis_date, patient.patient_location FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND diagnosis.diagnosis_name = 'nontoxic uninodular goiter') AS t1 JOIN (SELECT patient.subject_id, test.test_name, test.test_date, patient.patient_location FROM test JOIN patient ON test.patient_id = patient.subject_id WHERE test.test_date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.test_date AND t",
115e3caf13dbeb8dd223df9f,How many patients were discharged from hospitals in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'","SELECT COUNT(DISTINCT id) FROM patients WHERE NOT discharge_date IS NULL AND STRFTIME('%y', discharge_date) = '2100';",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
a803b49ece53f378a4fcf0d6,What is the maximum total cost of a hospital stay involving closed fracture of four ribs in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of four ribs' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.totalcost) FROM (SELECT SUM(cost) AS totalcost FROM cost WHERE cost.fracture = 'closed' AND cost.ribs = 4 AND STRFTIME('%y', cost.date) = '2100' GROUP BY cost.patient) AS t1",
c85d0450240f7e339aaec76c,Did patient 10021666 have lab testing in 03/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'","SELECT COUNT(*) FROM lab_testing WHERE lab_testing.patient_id = 10021666 AND lab_testing.date = ""2003-02-10""",[{'COUNT(*)>0': 0}]
7fd810ebd8c88d468eab802e,Has patient 10006053 received a laboratory test for mesothelial cell since 03/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'","SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10006053 AND lab_data.mesothelial_cell IS NOT NULL AND STRFTIME('%y-%m', lab_data.date) >= '2100-03'",[{'COUNT(*)>0': 0}]
799e8f8735eda5e3dfa8855f,"What are the four most commonly prescribed medications for patients diagnosed with candidiasis of mouth previously within the same hospital visit, during this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'candidiasis of mouth' AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, medications.name, medications.date FROM medications JOIN admissions ON medications.admission_id = admissions.admission_id WHERE DATETIME(medications.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.date AND DATETIME(t1.admission",
c13460734de88497b6d17501,How many people were diagnosed with acute kidney failure with lesion of tubular necrosis since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure with lesion of tubular necrosis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(*) FROM diagnoses WHERE diagnosis = ""Acute kidney failure with lesion of tubular necrosis"" AND year >= 2100",
5183db2bbd72b5cf7d8b5c0c,When were the drugs ketorolac and acetaminophen iv prescribed to patient 10021118 for the first time this month at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ketorolac' AND admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen iv' AND admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT DATETIME(0, 0, 0, 0) FROM drugs WHERE drugs.patient_id = 10021118 AND drugs.drug_name = 'ketorolac' AND DATETIME(0, 0, 0, 0) FROM drugs WHERE drugs.patient_id = 10021118 AND drugs.drug_name = 'acetaminophen iv' AND DATETIME(0, 0, 0, 0) FROM drugs WHERE drugs.patient_id = 10021118 AND DATETIME(0, 0, 0, 0) FROM drugs WHERE drugs.patient_id = 10021118 AND DATETIME(0, 0, 0, 0) FROM drugs WHERE drugs.patient_id = 10021118 AND DATETIME(0, 0, 0, 0) FROM drugs WHERE drugs.patient_id = 10021118 AND DAT",[]
fe0907fe6e75c814af68b01f,Has any organism been found in patient 10038999's last microbiological immunology (cmv) test since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'immunology (cmv)' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*) > 0 FROM microbiology WHERE patient_id = 10038999 AND microbiology_type = 'immunology (cmv)' AND year >= 2100,[{'COUNT(*)>0': 0}]
5075b95436488f53e5f7976e,"Was patient 10007818 given a test on potassium, urine on the first hospital stay?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) FROM brackets_admin.PatientTests WHERE PatientId = 10007818 AND TestName = 'Potassium, Urine'",[{'COUNT(*)>0': 0}]
cc2dcf3bb997c63533f8349f,"What was the drug that patient 10021118 prescribed for within 2 days after the procedure of bypass coronary artery, two arteries from coronary artery, open approach since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.uniquecarrier, treatment.treatdate FROM treatment JOIN patient ON treatment.patientid = patient.patientid WHERE patient.patientid = 10021118 AND treatment.treatment = 'bypass coronary artery, two arteries from coronary artery, open approach' AND STRFTIME('%y-%m', treatment.treatdate) >= '2100-03') AS t1 JOIN (SELECT patient.uniquecarrier, prescription.drug, prescription.presdate FROM prescription JOIN patient ON prescription.patientid = patient.patientid WHERE patient.patientid = 10021118 AND STRFTIME('%y-%m', prescription.presdate) >= '2100-03') AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.treatdate < t2.presdate AND DATETIME(t2.presdate) BETWEEN DATETIME(t1.treatdate) AND DATETIME(t1.treat",
e4b5f1fc800b0d54f32ed37b,Tell me the minimum total hospital cost that includes benign neoplasm of cerebral meninges in 2100.,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'benign neoplasm of cerebral meninges' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(2100) FROM bracket_table WHERE benign_neoplasm_of_cerebral_meninges = 'benign neoplasm of cerebral meninges',
f8334a7c23e689cadd23c209,Was patient 10008454 administered any solution during the first hospital visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM administration_history WHERE administration_history.patient_id = 10008454 AND NOT administration_history.hospital_id IS NULL ORDER BY administration_history.hospital_admission_date NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
b3f9074de167c69e1b75d061,Has patient 10037928 in 11/this year been given a urea nitrogen lab test?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11'","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10037928 AND lab_tests.lab_test_name = 'urea nitrogen' AND DATETIME(lab_tests.lab_test_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', lab_tests.lab_test_date) = '11'",[{'COUNT(*)>0': 0}]
3310a57f349b527861680281,"What is the price of the drug, finasteride?",SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'finasteride' ),SELECT DISTINCT cost FROM drugs WHERE name = 'Finasteride';,
563951219388e9d8f1ba0f30,How many days have passed since last time that patient 10004733 stayed in careunit neurology in their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1","SELECT SUM(DATEDIFF('day', TimestampNeurology, TimestampCurrent)) FROM (SELECT TimestampNeurology, TimestampCurrent FROM (SELECT CareUnitNeurology.TimestampNeurology, Admission.TimestampCurrent FROM CareUnitNeurology JOIN Admission ON CareUnitNeurology.AdmissionId = Admission.AdmissionId WHERE Admission.SubjectId = 10004733 AND CareUnitNeurology.CareUnitId = 15658) AS T)",[]
3ac2379c5a6246bfa08fe92d,What was the amount of void output patient 10001217 had on 12/04/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'",SELECT SUM(VoidOutput) FROM OutputFiles WHERE PatientID = 10001217 AND Date = '12/04/2020',[{'SUM(outputevents.value)': None}]
c6666ef9e4ba2cde6ec58824,Give me the count of diagnostic ultrasound of abdomen and retroperitoneum procedures that occurred.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of abdomen and retroperitoneum' ),SELECT COUNT(*) FROM procedures WHERE procedures.type = 'diagnostic ultrasound of abdomen and retroperitoneum',[{'COUNT(*)': 0}]
c7de791a9a6825a9859e12f1,Could you tell me the name of the drug prescribed to patient 10025463 within the same hospital visit after the cardiac mapping procedure since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug_name FROM (SELECT patient.name, procedure.date, patient.patient_id, procedure.location FROM patient JOIN procedures ON patient.patient_id = procedures.patient_id WHERE patient.name = 'Jane Doe' AND procedures.date >= '2000-08-2100' AND procedures.location = 'cardiac mapping') AS t1 JOIN (SELECT patient.name, drug.drug_name, drug.date FROM patient JOIN drugs ON patient.patient_id = drugs.patient_id WHERE patient.name = 'Jane Doe' AND drug.date >= '2000-08-2100') AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND t1.patient_id = t2.patient_id",
db408655e01275e4bcc8c7bc,Is the patient 10021666 a male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10021666,SELECT patients.gender FROM patients WHERE patients.ssn = 10021666,[{'gender': 'M'}]
0d68d613cbc5bfb69833795a,Please tell me the sex of patient 10026406.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10026406,SELECT sex FROM patients WHERE patient_id = 10026406,[{'gender': 'M'}]
013f12f8af555d68080086d8,When was the first input time for patient 10011398 since 11/23/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-23' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10011398 AND input_time >= '2100-11-23',[{'starttime': '2146-12-15 12:30:00'}]
a5e4283c5899fd833228b799,What are the five most common laboratory tests undertaken by patients within the same month following a diagnosis of alcohol withdrawal since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol withdrawal' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, t2.date_diagnosed FROM (SELECT patient.name, diagnosis.date_diagnosed FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Alcohol withdrawal') AS t1 JOIN (SELECT patient.name, lab_test, date_tested FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.patient_id WHERE lab_tests.date_tested >= '2100-01-01') AS t2 ON t1.name = t2.name WHERE t1.date_diagnosed < t2.date_tested AND DATETIME(t1.date_diagnosed, 'start of month') = DATETIME(t2.date_tested, 'start of month') GROUP BY t3.lab_test ORDER BY COUNT(t3.lab_test) DESC LIMIT 5",
498d2f4e14ef15f20bc02818,What is the cost for a drug named vancomycin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' ),"SELECT ""cost"" FROM ""drug"" WHERE ""name"" = 'vancomycin'",
1b86b72d44dcdc58ba833804,What was the first time patient 10003400 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(dischtime) FROM patient WHERE patient.hospital_discharge_id = 10003400,[]
ac5dd63a7a7e12dbdb8de9e2,Was patient 10005817 given any sort of diagnosis on the first hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10005817 AND NOT diagnoses.date IS NULL ORDER BY diagnoses.date NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
8cbc6f9057443ffd3cb11a50,How much does humalog cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'humalog' ),SELECT humalog FROM brackets.prices WHERE product = 'humalog';,
d1d3935b2877cebd687efc35,How much difference is there in phosphate levels among patient 10015931 second measured on the first hospital visit compared to the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT phosphate FROM patients WHERE patient_id = 10015931 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1) - (SELECT phosphate FROM patients WHERE patient_id = 10015931 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
cd5489d01e1749510fc86424,How much does the ph change in patient 10021666 last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab_data.value FROM lab_data WHERE lab_data.patient_id = 10021666 AND lab_data.type = 'ph' ORDER BY lab_data.timestamp DESC LIMIT 1) - (SELECT lab_data.value FROM lab_data WHERE lab_data.patient_id = 10021666 AND lab_data.type = 'ph' ORDER BY lab_data.timestamp NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
93ee1ffd46ebada0f537dc47,Give me the top four most frequent lab tests that patients were given after being diagnosed with need for prophylactic vaccination and inoculation against influenza within the same hospital visit since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'need for prophylactic vaccination and inoculation against influenza' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.lab_test, COUNT(t4.lab_test) FROM (SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT t1.subject_id, t1.diagnosis, t2.lab_test, t2.date FROM t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis = 'NEED FOR PROPHYLACTIC VACCINATION AND INOCULATION AGAINST INFLUENZA' AND STRFTIME('%y', t2.date) >= '2100') AS t2 JOIN (SELECT t1.subject_id, t1.diagnosis, t2.lab_test, t2.date FROM t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE STRFTIME('%y', t2.date) >= '2100') AS t3 ON t2.subject_id = t3.subject_id WHERE t2.diagnosis",
86ab734fd86c4c14b393eecc,Tell me about the three most common specimens tested in 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen FROM (SELECT specimen, COUNT(specimen) AS num FROM 2100 GROUP BY specimen) AS subquery ORDER BY num DESC LIMIT 3",[]
85fc1e7aa9384773068ded3c,What is the percentile of 3.6 for a creatinine test given the same age as patient 10004733 in the current hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 3.6","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, lab.result, PERCENT_RANK() OVER (ORDER BY lab.result NULLS FIRST) AS c1 FROM lab JOIN patient ON lab.patient_id = patient.patient_id WHERE lab.label = 'Creatinine' AND patient.patient_id = 10004733 AND patient.hospital_version = 'CURRENT') AS t1 WHERE t1.result = 3.6",
081ba7feccd490013f102984,What was the total ondansetron dose prescribed for patient 10001725 on their last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'ondansetron',SELECT SUM(ondansetron) FROM patients WHERE patient_id = 10001725 AND NOT patients.dischtime IS NULL ORDER BY patients.admittime DESC LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
fdd3a31fb9173995b776c5b2,Tell me the average SaO2 of patient 10021938 on last month/14.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '14'","SELECT AVG(SaO2) FROM ""patient_10021938"" WHERE ""date"" = 'last month/14'",[{'AVG(chartevents.valuenum)': None}]
a4d744501a505ad53e491d0c,How much does a medication called ezetimibe cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' ),SELECT DISTINCT cost FROM medication WHERE name = 'Ezetimibe';,
ea8b16320ebc9e5ee3d92c14,"Since 03/2100, what was the last drug that patient 10012853 was prescribed through the iv route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM patient_10012853 WHERE route = 'iv' AND date_prescribed >= '2003-03-2100',[]
903e1faa90ee9926eebe6781,"Today compared to yesterday, what new medication does patient 10018081's prescription include?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescriptions.new_medication FROM prescriptions WHERE prescriptions.patient_id = 10018081,[]
d7fb401aec234c8c77430b13,"How much is the average total hospital bill for a visit that involves a cholesterol, pleural test since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, pleural' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(Total_Hospital_Bill) FROM (SELECT SUM(Total_Hospital_Bill) FROM Postgres_Query('s', 'SELECT ''Total_Hospital_Bill'' FROM ''hospital_bill_summary'' WHERE ''date'' >= ''2022-01-01'' AND ''diagnosis'' = ''cholesterol, pleural test'' GROUP BY ''date''') AS Avg_Total_Hospital_Bill;",
031f4556ea1fe707a94f58bb,When did patient 10007818 receive a serology/blood microbiology test last?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'serology/blood' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(date) FROM microbiology WHERE microbiology.patient_id = 10007818 AND microbiology.test_type = 'Serology/blood',[]
dac5c6aaac6b57cdc328694e,What are the consumption methods of glipizide xl?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'glipizide xl',SELECT DISTINCT consumption_method FROM products WHERE product_name = 'Glipizide XL';,[]
d468712401b6ab1b27a362ee,Can you tell me the cost of other electric countershock of heart?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ),SELECT cost FROM other_electric_countershock WHERE heart = 'heart',
ab4e1e2da052427fa2ed9d07,"What is the maximum total hospital cost, which includes vaginal enterocele, congenital or acquired since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'vaginal enterocele, congenital or acquired' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(si.cost) AS c1 FROM (SELECT s.cost FROM (SELECT 1 AS cost FROM duckdb_columns WHERE column_name = 'vaginal_enterocele') AS s JOIN (SELECT 1 AS cost FROM duckdb_columns WHERE column_name = 'congenital_or_acquired') AS t2 ON s.column_name = t2.column_name GROUP BY s.patient_id) AS t1,
54b2b03726835ece7168728e,What was the first time patient 10021938 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10021938 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(hospital_dischtime) FROM patient WHERE patient_id = 10021938,[]
8da39f47f61d4bd9b47d1f6e,How many patients were prescribed the drug multivitamins w/minerals since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'multivitamins w/minerals' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.had_prescriptions_since(CURRENT_DATE - INTERVAL '1 year') AND patient.prescriptions LIKE '%multivitamins w/minerals%',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
3ac8f2ef698c9eee139d3ece,"What are the four most typically ordered procedures for patients previously diagnosed with calculus of kidney, which took place within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.keyword FROM (SELECT t2.keyword, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosistime, patient.patientname FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'calculus of kidney') AS t1 JOIN (SELECT patient.uniquepid, treatment.keyword, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosistime < t2.treatmenttime AND t1.patientname = t2.patientname GROUP BY t2.keyword) AS t3 WHERE t3.c1 <= 4",
eb6a1301664df928ab91d795,What were the first ptt values of patient 10039831?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT MIN(ptt) FROM ptt WHERE patient_id = 10039831,[]
cd81a8fa98d2679535f3372d,How many times did patient 10023239 go to the hospital this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM patient WHERE patient.hospital_id = 10023239 AND DATETIME(patient.admittime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
c1bb80af8e65bc3a342a8f5f,"Can you find the three most frequent drugs that were prescribed within 2 months after a swelling, mass, or lump in head and neck diagnosis was given since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'swelling, mass, or lump in head and neck' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquecarrier, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.patientid WHERE diagnosis.diagnosis = 'Swelling, mass, or lump in head and neck' AND DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquecarrier, prescription.drug, prescription.prescriptiondate FROM prescription JOIN patient ON prescription.patientid = patient.patientid WHERE DATETIME(prescription.prescriptiondate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.diagnosisdate < t2.prescriptiondate AND DATETIME(t2.prescriptiondate) BETWEEN DATETIME(t1.diagnosisdate) AND DATETIME(t1.",
d2963971f5b061724d770e2c,When did patient 10035185 have a last ptt laboratory test in the first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT last_ptt_laboratory FROM hospital_visits WHERE patient_id = 10035185 AND NOT hospital_visits.order = 0,[]
d6c396b04821fd366efe7a49,Show me the yearly minimum weight of patient 10027602 since 12/2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' GROUP BY strftime('%Y',chartevents.charttime)",SELECT MIN(weight) FROM patients WHERE patient_id = 10027602 AND date >= '12/2100' GROUP BY date,[]
055d52386664ba496c850da1,Can you tell me the cost for the procedure called fluoroscopy of multiple coronary arteries using other contrast?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) ),SELECT cost FROM procedures WHERE procedure = 'fluoroscopy of multiple coronary arteries using other contrast',
36c7455252fe5e86cee2f9ff,Could you count the number of times patient 10016810 visited the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10016810 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT patient_id) FROM visits WHERE patient_id = 10016810 AND DATETIME(visit_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
b4ebdda80c6329d3a8363c7e,Do you know of the drug that is not to be administered during the refus lmb/lmbsac pst/pst procedure?,,SELECT * FROM p WHERE NOT refus_lmb_lmbsac_pst_pst;,
4972d1004d8c1ef2af211806,"Tell me the minimum total cost of a hospital that involved dysphagia, unspecified since 2100.","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, unspecified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(T1.c1) FROM (SELECT SUM(T2.c2) AS c1 FROM (SELECT 1 AS c2 FROM diagnoses WHERE dysphagia = 'unspecified') AS T1 JOIN (SELECT 1 AS c2 FROM procedures WHERE year < 2100) AS T2 ON T1.c1 = T2.c1 GROUP BY T1.c1),
cb28a22dfa640e40700d6ace,What were the top five most common microbiology tests for patients who were previously diagnosed with encounter for attention to other artificial openings of digestive tract in the same hospital encounter?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for attention to other artificial openings of digestive tract' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t5.microbiology_test FROM (SELECT t4.microbiology_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS microbiology_rank FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_location FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Encounter for attention to other artificial openings of digestive tract"") AS t1 JOIN (SELECT admissions.subject_id, microbiology_test, diagnoses.diagnosis_date, admissions.admission_location FROM microbiology JOIN admissions ON microbiology.admission_id = admissions.admission_id) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND t1.admission_location = t2.admission_location GROUP BY t4.microbiology_test) AS t3 JOIN (SELECT admissions.subject_id, microbi",
6f95b08ff006a4983b0050f6,What was the admission type for patient 10027445's last admission to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10027445 ORDER BY admissions.admission_date DESC LIMIT 1;,[]
04da33946099754d422c8015,"Since 16 months ago, what was the monthly maximum dose of packed red blood cells for patient 10021487?","SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-16 month') GROUP BY strftime('%Y-%m',inputevents.starttime)","SELECT MAX(packed_red_blood_cells) FROM (SELECT * FROM patient_packed_red_blood_cells WHERE patient_id = 10021487) WHERE date >= DATEADD(month, -16, CURRENT_DATE) GROUP BY date",[]
1459009171aa5baa3803a221,What's the monthly average weight of patient 10005817 during their first hospital visit?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10005817 AND NOT month IS NULL ORDER BY visit_date NULLS FIRST LIMIT 1,[]
ded63a32010e347a3a99d26d,Ist patient 5142 subject to covid-19 testing,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_to_covid_19_testing = 1 AND patients.unique_patient_id = 5142,
880554dbb2de7644801cbf6e,Can you tell me the four most frequent diagnoses since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses WHERE date >= (CURRENT_DATE - INTERVAL '1 year') GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 4",
56ed63e758861043fc857932,What was the first diagnosis for patient 10017492 since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",SELECT diagnosis FROM diagnoses WHERE patient_id = 10017492 AND year >= 2100 ORDER BY year NULLS FIRST LIMIT 1,
f2147dbedaab703750fcd937,Do you believe patient 97395 has received any additional fluid received in blood culture bottles test?,,"SELECT COUNT(*) FROM additional_fluid WHERE patient_id = 97395 AND test_name = ""Blood Culture Bottles""",
2694b78056d19869dc331d60,What was the name of that output that patient 10021938 first had since 01/15/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-15' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM output WHERE patient = '10021938' AND date < '2100-01-15' ORDER BY date NULLS FIRST LIMIT 1,[{'label': 'Void'}]
83d85a4fb249a66c71ea4700,Could you tell me the gender of patient 10004733?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10004733,SELECT MIN(patient_gender) FROM patients WHERE patient_id = 10004733,[{'gender': 'M'}]
8a498aa27f9b433e78ba0a00,What is the type of blood that patient 60136 has?,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 60136;",
2b9a9c55cdacdabc16a4f556,When last did patient 10008454 have the minimum systolic blood pressure since 38 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-38 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MIN(systolic_blood_pressure) FROM bracket_table WHERE patient_id = 10008454 AND measurement_time >= (CURRENT_TIMESTAMP - INTERVAL '38 day'),[]
efe02e55b9988af366a8030b,"For patients previously diagnosed with migraine with aura, without mention of intractable migraine without mention of status migrainosus , what were the three most frequent specimens tested within 2 months afterward?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'migraine with aura, without mention of intractable migraine without mention of status migrainosus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT patient.name, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.diagnosis = 'Migraine with aura, without mention of intractable migraine without mention of status migrainosus') AS t1 JOIN (SELECT patient.name, specimen FROM lab JOIN patient ON lab.patient = patient.name) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.specimen) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 3",
5d890144fe08088c541a7324,What was the last prescription for patient 10003400 since 01/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10003400 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-01' ORDER BY prescriptions.date DESC LIMIT 1",[{'drug': 'HYDROmorphone (Dilaudid)'}]
e277a867e388255263046134,"Tell me the average total cost of a hospital visit involving a phosphate, urine lab test?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate, urine' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table JOIN lab_table ON cost_table.cost_id = lab_table.cost_id WHERE lab_table.lab_name = 'phosphate, urine' GROUP BY cost_table.patient_id) AS t1",
00beff4406c2ee10ac9621fe,"Did patient 10040025 get a prescription for clonidine patch 0.2 mg/24 hr, atorvastatin, or prasugrel in their first hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'clonidine patch 0.2 mg/24 hr', 'atorvastatin', 'prasugrel' )",SELECT COUNT(*) > 0 FROM patient WHERE patient.patient_id = 10040025 AND patient.hospital_count = 1 AND (patient.prescriptions = 'Clonidine Patch 0.2 mg/24 hr' OR patient.prescriptions = 'Atorvastatin' OR patient.prescriptions = 'Prasugrel'),[{'COUNT(*)>0': 0}]
ccf873476d02f981c461b5c0,Can you tell me the total amount of neutra-phos that patient 10004422 has been prescribed in 01/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.drug = 'neutra-phos' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01'","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10004422 AND medication.drug = 'neutra-phos' AND DATETIME(medication.date) BETWEEN DATETIME('01/year') AND DATETIME('01/year', '+1 year')",[{'SUM(prescriptions.dose_val_rx)': None}]
e280cc138d720a1fb7cde282,What was the last value of patient 10039831's lab test for platelet count in 12/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(lab_result) FROM lab WHERE lab.patient_id = 10039831 AND lab.lab_name = 'platelet count' AND DATETIME(lab.lab_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', lab.lab_date) = '12';",[]
898a1010e152158643c29ae2,Work out the total amount of input patient 10038999 received since 04/08/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-08'",SELECT SUM(input_patient_10038999) FROM input_patient WHERE input_patient_10038999 = '04/08/2100',[{'SUM(inputevents.totalamount)': 36935.0}]
b0e33df4abb89b92c708cf89,Tell me the icd-11 code for fetal/neonatal jaund nos in icd-10?,,"SELECT icd_11 FROM icd_translator WHERE icd_10 = ""Fetal/neonatal jaund NOS""",
9f59f271601c4130d2301520,What was the weight of patient 10016742 first since 14 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(weight) FROM patients WHERE patient_id = 10016742 AND date < CURRENT_DATE - INTERVAL '14 month',[]
754791666185be2763502622,When has patient 10016742 last had the epithelial cells maximum value in 07/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(epithelial_cells) FROM patient_10016742 WHERE date = '07/2100',[]
296dc134fad4a300a3e8605b,"What is the minimum total cost at a hospital including a glucose, ascites laboratory test in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(total_cost) FROM (SELECT cost FROM (SELECT SUM(cost) AS cost FROM lab WHERE lab.type = 'glucose, ascites') AS subquery) AS subquery2 WHERE subquery2.cost = 2100",
d37cc2f82fab01c5b66069e1,What was the last time of input for patient 10039831 since 04/08/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-08' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10039831 AND input_time >= '2100-04-08',[{'starttime': '2115-12-30 13:05:00'}]
1c0fc6d294954a3775cc36df,Does patient 23436 have a appointment at another department?,,SELECT COUNT(*) FROM appointments WHERE appointments.patient_id = 23436 AND appointments.department_id <> (SELECT departments.department_id FROM departments WHERE departments.department_name = 'Cardiology'),
98d4523a1fa9d300734adcb5,How much did patient 10020944 weigh when measured for the last time since 28 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT date_part('year', weight_date) - date_part('year', current_date) AS age, weight_kg",[]
df2943ec147894b6e5bfbe4f,What is dr. caron's outpatient schedule today?,,SELECT dr.caron.outpatient_schedule.today() FROM duckdb_databases() WHERE database_name = 'main';,
f5565e8dca592ac7658c9ee6,What was patient 10004720's daily average value of body weight in 2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT AVG(body_weight) FROM patient_weight WHERE patient_id = 10004720 AND measurement_time BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY measurement_time,[]
4d08394da0f7341675850575,When did patient 10007795 first leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(date_left) FROM patient WHERE patient.subject_id = 10007795;,[{'dischtime': '2136-05-02 16:35:00'}]
4483be10999dcd201f1ef4fe,What was the first time patient 10036156 was prescribed a medication using the po/ng route in 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT strftime(patient.po_ng, '%d/%m/%Y') as first_po_ng_date",[]
07ee97c7d111eb378921826a,What is the minimum total cost of the hospital visits which include the medicine named fluticasone propionate 110mcg in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fluticasone propionate 110mcg' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.total_cost) FROM (SELECT SUM(medication.quantity * medicine.unit_price) AS total_cost FROM medicine JOIN patient ON medicine.patient_id = patient.id JOIN visit ON patient.id = visit.patient_id WHERE medicine.name = 'fluticasone propionate 110mcg' AND STRFTIME('%y', visit.visit_date) = '2100') AS t1",
cbe81158af8ca0c5186959f0,Tell me the five most common lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.lab_test, COUNT(t1.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE year > 2100 GROUP BY lab_test) AS t1 JOIN lab_results ON t1.lab_test = lab_results.lab_test GROUP BY t1.lab_test ORDER BY COUNT(t1.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
7f9f201c03d5f3b1e2d247ca,What's the count of patients who left the hospital in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(DISTINCT patient_id) FROM hospital_exit_stats WHERE EXIT_YEAR = YEAR(CURRENT_DATE);,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e459f2e457c29b8387ed9964,"What are the three most frequently taken specimens for patients diagnosed with traumatic shock previously during the same hospital visit, since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT t2.subject, t2.diagnosis, t1.specimen, t1.time FROM (SELECT subject, diagnosis, specimen, time FROM patients WHERE diagnosis = 'traumatic shock') AS t1 JOIN (SELECT subject, diagnosis, specimen, time FROM patients WHERE diagnosis = 'traumatic shock') AS t2 ON t1.subject = t2.subject WHERE t1.time < t2.time AND DATETIME(t2.time) >= DATETIME(CURRENT_TIME, '-1 year')) AS t3 GROUP BY t3.specimen ORDER BY rank NULLS FIRST LIMIT 3",
612f8fa49f7f4fdc5d2bc4b6,Tell me the name of the diagnosis that patient 10039997 received last during their first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10039997 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.admittime DESC LIMIT 1,
3825f15fdd46e295e266d4e2,What was the specimen test ranked at five that was done most commonly since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",SELECT specimen FROM questions WHERE rank = 5 AND date > (SELECT date FROM questions WHERE id = 1) GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 1,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
3359b6d79281a1940ec5c65c,Could you list the daily average dextrose 5% input of patient 10039831 on this ICU visit?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT AVG(DEXTROSE_5%) FROM ICU WHERE ICU.PATIENT_ID = 10039831 AND ICU.VISIT_DATE = 'daily',[]
21fe976dd2fd2be6db9c01b6,When are dr. davis's rounds and procedures?,,"SELECT r.round_time, p.procedure FROM rounds AS r JOIN procedures AS p ON r.round_time = p.round_time JOIN doctors AS d ON d.doctor_id = p.doctor_id WHERE d.doctor_name = 'Dr. Davis'",
6d8c0ea325ed343de1ad7c30,"Hey, what was patient 10016150's minimum triglycerides value since 02/2100?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycerides' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-02'",SELECT MIN(Triglycerides) FROM patients WHERE Patient_ID = 10016150 AND Date >= '2000-02-2100',[{'MIN(labevents.valuenum)': None}]
55bae74b1c4dde44613794ce,What is the maximum total hospital cost which involves closed fracture of seven ribs since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of seven ribs' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.total_cost) FROM (SELECT SUM(cost) AS total_cost FROM cost_table WHERE cost_table.description = 'closed fracture of seven ribs' AND STRFTIME('%y', cost_table.date) >= '2100' GROUP BY cost_table.patient_id) AS t1",
ac9b3f14d853d992c65f6faa,Did patient 10027602 have jevity 1.2 (full) given in their last ICU visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jevity 1.2 (full)' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM icu_visits WHERE icu_visits.patient_id = 10027602 AND icu_visits.unit_type = 'jevity 1.2 (full)',[{'COUNT(*)>0': 0}]
95a628ad73ca8b9a1ccdf74a,Find out the number of drugs given to patient 10013049 in 06/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-06'",SELECT COUNT(*) FROM medication_usage WHERE patient_id = 10013049 AND date_used = '2100-06',[{'COUNT(*)': 0}]
290b08ec95402e357dd162b0,Can you please tell me the name of the diagnosis that patient 54894 received in another department?,,SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 54894 AND diagnoses.department_id <> (SELECT DISTINCT department_id FROM departments WHERE department_name = 'diagnoses'),
01898f9cb797a1bb35415331,Could you please tell me the name of the diagnosis patient 23002 received at another department?,,SELECT diagnosis FROM patients WHERE department <> (SELECT department FROM patients WHERE id = 23002),
6f1c6d1e65b0d7b96f895ca2,What's the SaO2 difference of patient 10039997's body last measured on the first ICU visit compared to the value second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT sao2 FROM patients WHERE patient_id = 10039997) AND (SELECT sao2 FROM patients WHERE patient_id = 10039997) - 1,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
d800d11c3e81f4be09d09c2f,When was first time the heart rate of patient 10027602 was greater than 63.0 in their first ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM icu WHERE icu.patient_id = 10027602 AND NOT icu.out_time IS NULL ORDER BY icu.admission_time NULLS FIRST LIMIT 1) WHERE heart_rate > 63.0,[]
5c8ae752cc0cbe2cb6d28a89,Tell me patient 10021487's total volume of output on 12/09/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-09'","SELECT COUNT(*) FROM output WHERE output.patient = 10021487 AND STRFTIME('%y-%m-%d', output.date) = '2100-12-09'",[{'SUM(outputevents.value)': None}]
56ec103efc85ce4ed535ee32,"In this year, has patient 10021118 been diagnosed with anything?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10021118 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
04d135a8d8db7bcb4130bb9b,Tell me the name of the diagnosis that patient 10027602 received first since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis_name FROM diagnoses WHERE diagnoses.patient_id = 10027602 AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100' ORDER BY diagnoses.diagnosis_date NULLS FIRST LIMIT 1",
ffbd3d45d651d7e4ecf8aeaa,Could you fetch the top five most common specimens tested since 2100 for me?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(*) FROM inventory WHERE date >= '2100-01-01' GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
37949c207b150e40794621cb,"Compared to yesterday, what new drugs are present in the prescription of patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescription FROM drugs WHERE patient_id = 10039831 AND date = '2022-12-31' EXCEPT SELECT prescription FROM drugs WHERE patient_id = 10039831 AND date = '2022-12-30',[]
fe646e876da3a9452e4e05ea,"What's the number of patients who were laceration of intercostal blood vessels, left side, initial encounter diagnosed since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'laceration of intercostal blood vessels, left side, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT admissions.subject, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'LAceration of intercostal blood vessels, left side' AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100') AS t1 JOIN (SELECT admissions.subject, procedures.procedure_date FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE procedures.procedure = 'LAceration of intercostal blood vessels, left side' AND STRFTIME('%y', procedures.procedure_date) >= '2100') AS t2 ON t1.subject = t2.subject WHERE t1.diagnosis_date < t2.procedure_date",
42ed29ca7381139bed4af657,Show me patient 10011398's total or urine output since 01/19/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'",SELECT SUM(total) FROM my_table WHERE patient = 10011398 AND output_type = 'urine' AND date >= '01/19/2100',[{'SUM(outputevents.value)': None}]
0a5e5b2f22a73ebf9ddd7a3a,When was the last hospital discharge of patient 10025463?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10025463 ORDER BY admissions.dischtime DESC LIMIT 1,SELECT MAX(hospital_discharge_date) FROM hospital WHERE hospital.patient_id = 10025463;,[{'dischtime': '2137-10-09 15:30:00'}]
038c76dd2c59256fd7b9ae46,Tell me the average total hospital cost that includes ritonavir in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ritonavir' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost <= 1000 AND date = '2100-01-01' AND prescriber = 'ritonavir' GROUP BY prescriber) AS t1,
d6b45e0644198773e61b027c,How many patients since 2100 were diagnosed with suicidal ideation within the same month after the first diagnosis with panic disorder without agoraphobia?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'panic disorder without agoraphobia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'suicidal ideation' AND date_part('year', diagnosis_date) >= 2100) AS t1, (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'panic disorder without agoraphobia' AND date_part('year', diagnosis_date) >= 2100) AS t2 WHERE t1.subject_id = t2.subject_id AND t1.diagnosis_date < t2.diagnosis_date AND date_part('month', t1.diagnosis_date) = date_part('month', t2.diagnosis_date)",
c56c95b8d5030cf37d0e4528,"What was the name of the medication that patient 10002495 was prescribed within the same day after receiving a assistance with cardiac output using balloon pump, continuous procedure in 06/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.name FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10002495 AND treatment.type = 'assistance with cardiac output using balloon pump, continuous' AND STRFTIME('%y-%m', treatment.date) = '2100-06') AS t1 JOIN (SELECT patient.id, medication.name FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.id = 10002495 AND STRFTIME('%y-%m', medication.date) = '2100-06') AS t2 ON t1.id = t2.id WHERE DATETIME(t1.date) = DATETIME(t2.date)",
5e3559038c113cb814682141,What is the difference in patient 10007818's weights last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patient WHERE patient.patient_id = 10007818 AND NOT patient.hospital_info.last_dischtime IS NULL ORDER BY weight DESC LIMIT 1) - (SELECT weight FROM patient WHERE patient.patient_id = 10007818 AND NOT patient.hospital_info.last_dischtime IS NULL ORDER BY weight NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
992e5ae1a94aabac75308495,When was the first time patient 10008454 had the minimum heart rate on 12/07/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-07' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(heart_rate) FROM patient_heart_rate WHERE patient_id = 10008454 AND measurement_time BETWEEN '2000-12-07' AND '2000-12-07',[]
64d3df17e06aa81f9ecdc580,"Has ampicillin-sulbactam, 0.9% sodium chloride (mini bag plus), or 0.9% sodium chloride been prescribed in their current hospital visit to patient 10039831?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'ampicillin-sulbactam', '0.9% sodium chloride (mini bag plus)', '0.9% sodium chloride' )","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10039831 AND medication.dischtime IS NULL AND (medication.name = 'Ampicillin-Sulbactam, 0.9% Sodium Chloride (Mini Bag Plus)' OR medication.name = '0.9% Sodium Chloride (Mini Bag Plus)')",[{'COUNT(*)>0': 0}]
9e64c0910dc58e2ef996f7c0,When was the last hospital discharge of patient 10003400?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM bracket_hospital_discharge WHERE patient_id = 10003400;,[{'dischtime': '2137-09-02 17:05:00'}]
d7533f37a1589e2a8f4df73e,What's the average total cost of a hospital that involves a procedure called fiber-optic bronchoscopy throughout this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure_name = 'fiber-optic bronchoscopy' AND date BETWEEN '2000-01-01' AND '2000-12-31' GROUP BY patient_id) AS t1,
7c2ab9c849f250ca7ae3054c,When was the first microbiological test of patient 10027445 since 04/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM microbiology WHERE patient = 10027445 AND date >= '2000-04-2100',[{'charttime': '2142-07-31 06:07:00'}]
1a16b0cbd84a464357e6fb02,How many current patients are there that are 20s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29,SELECT COUNT(*) FROM patients WHERE age BETWEEN 20 AND 29 AND current_patient = true,
3bd09b282f97fbf5a9f40eaf,Show the weight changes of patient 10027602 last measured on the last hospital visit compared to the value second to last measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT weight_change FROM patient_weight WHERE patient_id = 10027602 AND measurement_time = (SELECT MAX(measurement_time) FROM patient_weight WHERE patient_id = 10027602 AND measurement_time IS NOT NULL)) - (SELECT weight_change FROM patient_weight WHERE patient_id = 10027602 AND measurement_time = (SELECT MAX(measurement_time) FROM patient_weight WHERE patient_id = 10027602 AND measurement_time IS NOT NULL) - INTERVAL '1 day')),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
6f9909683d56ed89f9e559bc,Is patient 20589 a person with a family history of any health problems?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.family_history = 'health problems' AND patients.uniquepatientid = 20589,
56cc6ac2512f4026f211bada,"How many patients had a diagnosis of pain in joint, shoulder region since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in joint, shoulder region' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT diagnosis_id) FROM diagnoses WHERE diagnosis = 'pain in joint, shoulder region' AND year >= 2100",
17b596080425a3e13fe4f66b,Can you show me the top four frequent output events throughout this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT OUTPUT.EVENT, COUNT(OUTPUT.EVENT) FROM INPUT, OUTPUT WHERE INPUT.EVENT = OUTPUT.EVENT AND INPUT.YEAR = 2012 GROUP BY OUTPUT.EVENT ORDER BY COUNT(OUTPUT.EVENT) DESC LIMIT 4",[]
4d6effcf91960c4bd023a47c,Has any organism been found in patient 10038081's first blood (cmv ab) test conducted since 10/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (cmv ab)' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT COUNT(*) > 0 FROM organism WHERE organism.patient_id = 10038081 AND organism.blood_cmv_ab = 1 AND STRFTIME('%y-%m', organism.date) >= '2100-10'",[{'COUNT(*)>0': 0}]
89f0db596b270220fda6c25f,Which were the five most frequently ordered laboratory tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.test_name, COUNT(t.test_name) FROM lab_tests AS t WHERE DATETIME(t.test_date) >= DATETIME(CURRENT_DATE, '-1 year') GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
2f8b95322025bab1d2c8da4f,Has patient 10006053 been prescribed a specific drug since 11/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10006053 AND prescriptions.drug_name = 'Paracetamol' AND STRFTIME('%y-%m', prescriptions.date) >= '2100-11'",[{'COUNT(*)>0': 1}]
da971f3a5b73f3990bd5cb3f,When was the first time that patient 10038999 was prescribed soln and lactulose since 04/2100 at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactulose' AND admissions.subject_id = 10038999 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'soln' AND admissions.subject_id = 10038999 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT MIN(date_prescribed) FROM medication WHERE medication.patient_id = 10038999 AND medication.drug_name = 'soln' AND STRFTIME('%y-%m', date_prescribed) >= '2100-04' INTERSECT SELECT MIN(date_prescribed) FROM medication WHERE medication.patient_id = 10038999 AND medication.drug_name = 'lactulose' AND STRFTIME('%y-%m', date_prescribed) >= '2100-04'",[]
b63dbd1722b760241e7465c7,When were the drugs pantoprazole and ondansetron prescribed to patient 10007928 for the first time in 04/this year at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10007928 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10007928 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT MIN(pharmacy_time) FROM medication WHERE medication.patient_id = 10007928 AND medication.drug_name IN ('ondansetron', 'pantoprazole') AND DATETIME(pharmacy_time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', pharmacy_time) = '04'",[]
ccb20fe5f0ec69b335b58f1c,What is the outpatient schedule today for dr. minutillo?,,SELECT SUM(todays_appointments) FROM dr_minutillo WHERE dr_minutillo.location = 'outpatient';,
e56a5abd1ccdf45d55cee224,When did patient 10005348 get a microbiology test for the last time since 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology WHERE patient_id = 10005348 AND date >= '2000-02-2100',[{'charttime': '2130-10-27 17:02:00'}]
af7ad9cea92641ef8e97f7c1,What were the four most commonly performed lab tests throughout this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT t.test_name FROM lab_tests t WHERE t.test_date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY t.test_name ORDER BY COUNT(*) DESC LIMIT 4,[]
7170b2897858fa87237babee,"Can you tell me how many open reduction of fracture with internal fixation, humerus procedures were done in 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.year = 2100 AND procedures.type = ""OPEN REDUCTION OF FRACTURE WITH INTERNAL FIXATION, HUMERUS""",
e72e07c6e4ff2480d2708585,Could you list the four diagnoses that had the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT diagnosis FROM (SELECT diagnosis, 6 * month(deathDate) / 100 AS sixMonthMortality FROM (SELECT deathDate, diagnosis FROM diagnoses JOIN patients ON diagnoses.patientId = patients.patientId WHERE 6 * month(deathDate) / 100 < 1) AS sixMonthMortality) AS diagnoses6Month WHERE diagnosis IN ('Aorticane', 'Aortoclith', 'Aortodisk', 'Beckwith-Hartley') ORDER BY sixMonthMortality DESC LIMIT 4",
4aaf4f3c76752b37f232e69b,Could you fetch the top three most common specimens tested in 2100 for me?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(specimen) FROM 2000 GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3;",[]
78512e3b7c9ea984222bfee1,How many tramadol prescription instances took place since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)': 9}]
fe0a92b8a22e8c88cd9c413a,"In the first hospital visit, did patient 10018845 come to the ER?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM (SELECT visit_id FROM patient_visits WHERE patient_id = 10018845 AND NOT visit_type = 'emergency room admit' AND visit_rank = 1),[{'COUNT(*)>0': 0}]
192595f3a72877272b046e55,How is potassium chl 20 meq / 1000 ml d5 1/2 ns taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5 1/2 ns',,[]
cac9008f4f2f7e8937a4e13a,What were the top four diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT diagnosis, 3 AS month, 10.5 AS rate FROM diagnoses ORDER BY rate DESC LIMIT 4;",
c32224fbcb946a4db57012a7,What is the percentile ranking of a asparate aminotransferase (ast) test value of 33.0 for patients of the same age as patient 10007795 during their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 33.0",SELECT percent_rank FROM (SELECT * FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.id = 10007795 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1) AND patient.ast = 33.0) AS subquery;,
7363a00d1729eca1fc81049b,"How much is the minimum total hospital bill for a visit that involves a bicarbonate, urine test since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate, urine' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.total_hospital_bill) FROM (SELECT SUM(h.amount) AS total_hospital_bill FROM patient p JOIN hospitalization h ON p.hospitalization_id = h.hospitalization_id JOIN lab l ON p.lab_id = l.lab_id WHERE l.lab_name = 'Bicarbonate, Urine' AND DATETIME(h.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1",
828e19c5d77504383bc65778,Give me the length of stay in days for patient 10018501 during their first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', ICU.LENGTH(10018501, 'day')) AS length_of_stay_in_days","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.9412152781151235}]"
5c9e3563429336a3a6497c07,What are the top five most frequent drugs prescribed to patients in the same hospital encounter after the diagnosis of other pulmonary embolism without acute cor pulmonale?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other pulmonary embolism without acute cor pulmonale' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.admittime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Other pulmonary embolism without acute cor pulmonale') AS t1 JOIN (SELECT admissions.subject_id, prescriptions.drug, prescriptions.prescriptions_time, admissions.admittime FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_time < t2.prescriptions_time AND t1.admittime = t2.admittime GROUP BY t2.drug) AS t3 WHERE t3.c1 <= 5",
21dbea03500cf77a64577287,What is the name of the drug that is not to be given during packed cell transfusion?,,SELECT name FROM drugs WHERE NOT name LIKE '%during packed cell transfusion%',
f046a738ce962ca3221afcbd,"During this year, has patient 10007928 been in an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(*) > 0 FROM emergency_room_visits WHERE patient_id = 10007928 AND visit_duration > 0,[{'COUNT(*)>0': 0}]
ac9fc03c65beee9fae66c482,What is the cost of a diagnosis for suicidal ideation?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) ),SELECT 'cost' FROM (SELECT * FROM diagnoses WHERE description = 'suicidal ideation') AS diagnoses_table;,
d3bf0e541f1e4e8cb0f4066a,How many patients were discharged from the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT id) FROM patients WHERE NOT dismissed_date IS NULL AND date_sub('year', dismissed_date, CURRENT_DATE) > 1",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
bdb2fa4bcffae40f48f57a25,What was the name of the organism found in patient 10019172's last urine microbiological test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM microbiology WHERE microbiology.patient_id = 10019172 AND microbiology.type = 'urine' AND NOT microbiology.organism_name IS NULL ORDER BY microbiology.date DESC LIMIT 1;,[]
438eaca992b625cafb55b6db,Give me the four most frequent procedures performed.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT procedures, COUNT(*) FROM procedures GROUP BY procedures ORDER BY COUNT(*) DESC LIMIT 4;","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Central venous catheter placement with guidance'}, {'long_title': 'Other nonoperative respiratory measurements'}]"
ebdf09b1cf8d52950fe299a1,When was the last time that patient 10020740 was prescribed a medication in 04/this year via po?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM medication WHERE patient_id = 10020740 AND prescription_method = 'po' AND date_prescribed >= '2022-04-01',[]
7aeb94856d35a70807387853,What was the total amount of polyethylene glycol prescribed to patient 10037861 since 08/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.drug = 'polyethylene glycol' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'",SELECT SUM(polyethylene_glycol) FROM prescriptions WHERE patient_id = 10037861 AND start_date >= '08/2100',[{'SUM(prescriptions.dose_val_rx)': None}]
2616e051ac4579e504b2e48d,"During their first hospital encounter, what was the diagnosis for patient 10004720 the first time?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis FROM encounters WHERE patient_id = 10004720 AND NOT encounters.dischtime IS NULL ORDER BY encounters.admittime NULLS FIRST LIMIT 1,
4ad4465cd7b99c50bc48d1df,Count the number of current patients whose ages fall within the 50s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,SELECT COUNT(DISTINCT patient_id) FROM current_patients WHERE age BETWEEN 50 AND 59,
86e5eb5831ba084a42761fa6,What was the first time patient 10017492 received vitamin b12 in a lab test on the first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT lab.timestamp FROM lab WHERE lab.patient_id = 10017492 AND lab.vitamin = 'b12' ORDER BY lab.timestamp NULLS FIRST LIMIT 1;,[]
e50c094ffc2b4008e3005839,What is the reimbursement standard for cerebrovascular mri,,"SELECT MAX(reimbursement) FROM ""brackets"" WHERE question = 'Cerebrovascular MRI'",
7cf79d6d78b98237ceed2c66,What is dr. robinson's outpatient schedule today?,,SELECT dr.robinson.outpatient.schedule TODAY;,
6a368f5c49fd5add94776985,"So, the last mcv test result for the patient 10004720 in 12/this year was?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1",SELECT MAX(MCV) FROM MCV WHERE Patient.ID = 10004720 AND Date.Month = 12 AND Date.Year = 2016,[]
c0fcaebf5fe4de9b0da7c35c,How much morphine sr (ms contin) had been prescribed to patient 10021312 in total in 08/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'morphine sr (ms contin)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08'","SELECT SUM(MORPHINE_SR_MSCONTIN) FROM medications WHERE MEDICATED_PATIENT_ID = 10021312 AND STRFTIME('%y-%m', MEDICATION_DATE) = '2100-08';",[{'SUM(prescriptions.dose_val_rx)': None}]
195a853f0ef04bb3011b271b,When did patient 10018081 have a first metamyelocytes laboratory test in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MAX(date) FROM lab WHERE lab.patient = 10018081 AND lab.test = 'first metamyelocytes' AND DATETIME(lab.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', lab.date) = '12'",[]
3d6be9c3bab36afdf6303321,When were patient 10007795 first prescribed for metronidazole (flagyl) and ns at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10007795 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ns' AND admissions.subject_id = 10007795 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",SELECT MIN(bracket_start) FROM (SELECT TIMESTAMP_NS(prescription_time) AS prescription_time FROM prescriptions WHERE patient_id = 10007795 AND prescription_drug = 'Metronidazole (Flagyl)') AS subquery WHERE subquery.prescription_time BETWEEN (SELECT TIMESTAMP_NS(prescription_time) FROM prescriptions WHERE patient_id = 10007795 AND prescription_drug = 'NS'),[]
60bf7b753de50724e7fe0465,Quantify the number of patients who were tested for anticardiolipin antibody igm.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igm' ) ),"SELECT COUNT(DISTINCT patient.subject) FROM patient INNER JOIN lab ON patient.subject = lab.patient_id WHERE lab.lab_name = ""Anticardiolipin Antibody IGM""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
55089d9089a6992078371da4,"What are the five most frequently ordered medications that patients in their 50s were prescribed within 2 months after they were diagnosed with other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age BETWEEN 50 AND 59 AND DATETIME(medication.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.diagn",
34e916a3d87884c2b17eed2f,Can you tell me the five most frequent microbiology tests this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.Microbiology, COUNT(t.Microbiology) FROM (SELECT t.Microbiology FROM (SELECT * FROM Transactions WHERE t.Year = 2015) AS t GROUP BY t.Microbiology) AS t GROUP BY t.Microbiology ORDER BY COUNT(t.Microbiology) DESC LIMIT 5",[]
5bfa45301dea4f2fbecbb26b,"For patient 10016742, what were the last mch lab results in 07/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(lab.mch) FROM lab WHERE lab.patient = 10016742 AND STRFTIME('%y-%m', lab.date) = '2100-07'",[]
64417089c0eeb8c42da6c9c2,Count the number of patients who were given the phosphorus since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.phosphorus >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d594afe3713d185962186bc5,What was the organism's name of the first sputum microbiology test done on patient 10009049 in the last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT organism_name FROM sputum_microbiology WHERE patient_id = 10009049 AND NOT hospital_exit_date IS NULL ORDER BY microbiology_date NULLS FIRST LIMIT 1;,[]
e5b66a1b55593f1824235d1a,"Provide a list of the three most common diagnoses that patients were diagnosed with during the same month after undergoing the resection of vessel with replacement, thoracic vessels procedure in 2100.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'resection of vessel with replacement, thoracic vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, procedures.date FROM procedures JOIN patient ON procedures.patient_id = patient.uniquepid WHERE procedures.procedure = 'resection of vessel with replacement, thoracic vessels' AND STRFTIME('%y', procedures.date) = '2100') AS t1 JOIN (SELECT patient.uniquepid, diagnoses.diagnosis, diagnoses.date FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.uniquepid WHERE STRFTIME('%y', diagnoses.date) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 3",
7b67c7a9bff55320d436972c,Has patient 10011398 undergone a white blood cells laboratory test since 11/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-11'","SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10011398 AND lab_tests.label = ""White Blood Cells"" AND STRFTIME('%y-%m', lab_tests.date) >= '2100-11'",[{'COUNT(*)>0': 0}]
9862dfab336a7e119e848d7f,What are the average daily number of patients diagnosed with acute alcoholic hepatitis in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic hepatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT AVG(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis_date) AS c1 FROM diagnoses WHERE diagnosis = ""ACUTE ALCOHOLIC HEPATIS"" AND STRFTIME('%y', diagnosis_date) = '2100' GROUP BY diagnosis_date) AS t1",
5da9ae74c519002875122c59,What is the drug that isnt to be taken during opn/oth rep aortic valve??,,"SELECT drug FROM patients WHERE patients.drug_status = ""NOT TO BE TAKEN"" AND patients.diagnosis = ""OPN/OTH REP AORTIC VALVE""",
b6cdfe2edf6838e152af3c54,What the name of the diagnosis that patient 14467 received in the other department?,,SELECT diagnosis_name FROM diagnoses WHERE patient_id = 14467 AND department_id <> (SELECT department_id FROM departments WHERE name = 'Other department'),
5401b6a61d136580b9f69be2,If so is there a genetic test that patient 26218 gets?,,SELECT COUNT(*) FROM brackets WHERE patients.patient_id = 26218,
9e5c20a2a5d9bd9a11019222,What was patient 10004733's monthly maximum value of body weight since 20 months ago?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-20 month') GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MAX(body_weight) FROM patient_weight WHERE patient_id = 10004733 AND time_since > (CURRENT_TIMESTAMP - INTERVAL '20 month') GROUP BY date_trunc('month', time_since);",[]
5a7a92c1e36cc66dc5a226ab,"So, what was the last respiratory rate of patient 10019777 on their last ICU visit?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,"SELECT STRFTIME('%respiratory_rate', ICU_ARRIVAL_DATE) AS 'respiratory_rate'",[]
d4183c39d460be6d47009fdd,"What was the first total protein, csf reading for patient 10014078?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(total_protein) AS csf_reading FROM protein_data WHERE patient_id = 10014078,[]
444002e65b58c6f479197866,Can you calculate how many patients were prescribed gemfibrozil?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil' ),"SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE prescription_name = ""Gemfibrozil""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
676f00b844b8685a14e6582b,What is today's outpatient schedule with dr. smith?,,"SELECT * FROM appointments WHERE provider = 'dr. smith' AND appointment_type = 'outpatient' AND date = strftime(CURRENT_DATE, '%Y-%m-%d')",
53fca8bfc5f88cb4209eec38,Can you tell me how old patient 10035185 was on the first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.age FROM patient WHERE patient.id = 10035185 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1,
a8bfb5881309bbc205af6f0e,What is patient 10035185's minimum basophils value on the first hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ),SELECT MIN(Basophils) FROM (SELECT Basophils FROM patient WHERE patient.Encounter = 1) WHERE patient.StaffID = 10035185,[{'MIN(labevents.valuenum)': None}]
5e4bfc749171bceb6b2332d1,When was patient 10014729 last given an input since 03/06/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-06' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(date_input) FROM input_table WHERE patient_id = 10014729 AND date_input >= '2100-03-06',[{'starttime': '2125-03-01 20:37:00'}]
e71e7a24a4702232c71f8271,Can you tell me the first time patient 10021487 had a diastolic blood pressure that was greater than 63.0 since 21 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-21 day') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(blood_pressure) FROM (,[]
131f8932f899a611506ecd2b,How many hours have it been since the first stay of patient 10021487 on this hospital stay in the careunit trauma sicu (tsicu)?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.hospital_stay_date)) FROM patient WHERE patient.uniquepatientid = 10021487 AND patient.hospital_stay_date IS NOT NULL AND patient.current_careunit = 'trauma sicu (tsicu)'",[]
2040aaebd3c0a403ffa1269c,What was the medication patient 10026354 was prescribed for the first time via iv drip?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(date_prescribed) FROM medication WHERE medication.patient_id = 10026354 AND medication.route = 'iv drip',[]
0fd2ccbe30809ad0253a004f,How many patients were in med/surg/trauma this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/trauma' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t.subject_id) FROM (SELECT subject_id, visit_date FROM (SELECT subject_id, visit_date FROM patients WHERE med_surg_trauma = 't0001') AS t WHERE DATETIME(t.visit_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
eb31ac4eb5e1f45dc5b80313,What was the name of the medicine that was given to patient 10038933 within 2 days post procedure of percutaneous [endoscopic] gastrostomy [peg]?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,
d518a22ef06007a9c93db34b,"Count the number of patients during the last year who received a introduction of other therapeutic substance into peripheral artery, percutaneous approach procedure.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient_id) FROM procedures WHERE procedures.percutaneous_approach = 'other therapeutic substance' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
6b1ddc68db0377487658c10b,What is the recently prescribed medication for patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT today(date) FROM medication WHERE patient_id = 10004733 AND date = '2022-01-01',[]
f90c169bc5f07a8ae6dacece,Get me the top four most common diagnoses since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis, COUNT(*) FROM diagnoses WHERE date > CURRENT_DATE - INTERVAL '1 year' GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 4;",
22f6471acc2d184e7cfeeb6f,Tell me the blood type of patient 58649?,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 58649",
553e1ea6ccc3dcb9caf59f18,When was the first time of input for patient 10027602 on this month/05?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '05' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(BloodPressure) FROM input WHERE Patient = 10027602 AND Date = CURRENT_DATE - INTERVAL '05 month' AND Time = '12:00:00',[]
6a3568128f729d82972746f2,When did patient 10038933 have a mchc lab test for the first time in 09/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y-%m',labevents.charttime) = '2100-09' ORDER BY labevents.charttime ASC LIMIT 1","SELECT lab.timestamp FROM lab WHERE lab.patient_id = 10038933 AND lab.lab_name = 'mchc' AND STRFTIME('%y-%m', lab.timestamp) = '2100-09' ORDER BY lab.timestamp NULLS FIRST LIMIT 1",[]
407f290d6f4319cdd21a777e,What was the last weight of patient 10005817 recorded since 14 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(weight) FROM patients WHERE patient_id = 10005817 AND date >= CURRENT_DATE - INTERVAL '14 month',[]
5b31e1e9fd15d53ccceb7195,Has a procedure been performed on patient 10019172 in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10019172 AND STRFTIME('%y', procedures.date) = '2100'",
2eaf0a50018f2abf03e6f2da,What is the average cost of a hospital that involves neoplasm of unspecified nature of endocrine glands and other parts of nervous system?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'neoplasm of unspecified nature of endocrine glands and other parts of nervous system' ) ) GROUP BY cost.hadm_id ) AS T1,"SELECT AVG(Cost) FROM ""hospital"" WHERE ""description"" = 'neoplasm of unspecified nature of endocrine glands and other parts of nervous system'",
b5ebca4336ca90885d7d6381,Show me the top five most common diagnoses of patients aged 60 or above since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(diagnosis) FROM patients WHERE age >= 60 AND DATETIME(diagnosis) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 5",
430d5d3db66a6f64ebeb3879,Did patient 10021487 have any monos lab tests done during their first hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monos' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10021487 AND lab_results.lab_name = 'monos',[{'COUNT(*)>0': 0}]
063d2d7c311c16f3cc0916a7,What were the top five most common specimen tests conducted throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM (SELECT specimen FROM microbiology WHERE year = 2022) GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5",[]
2e16f3d29c3aeed69b6e3b78,What was the total volume of foley that patient 10004235 had on 03/21/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-21'",SELECT SUM(Foley) FROM 03_21_2023 WHERE Patient = 10004235,[{'SUM(outputevents.value)': None}]
38e7715444818223680cc90f,How many hours have passed since patient 10021487 last received a laboratory test of eosinophils during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result.result_date)) FROM lab_result WHERE lab_result.patient_id = (SELECT patient.subject_id FROM patient WHERE patient.subject_id = 10021487 AND patient.dischtime IS NULL) AND lab_result.result_type = 'eosinophils' ORDER BY lab_result.result_date DESC LIMIT 1;",[]
fa665d6909377d977664e7fd,"For the first time in 12/2100, when was patient 10008454 prescribed famotidine and metoprolol tartrate at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10008454 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metoprolol tartrate' AND admissions.subject_id = 10008454 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",,[]
db037fde5163630eb1dacbe1,Does patient 6440 have a history of travelling overseas?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.patient_id = 6440 AND patients.history_overseas = 'travelled overseas',
ebd3a49f285aab80f2f09b02,When did the last hospital discharge of patient 10020786 occur?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020786 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_discharge_date) FROM patient WHERE patient_id = 10020786;,[{'dischtime': '2189-06-13 17:20:00'}]
f58bd3fca803b73088423ede,What does it cost to get automatic implantable cardiac defibrillator in situ diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'automatic implantable cardiac defibrillator in situ' ) ),SELECT DISTINCT cost FROM parameters WHERE parameter = 'automatic implantable cardiac defibrillator in situ';,
3fbce8b880d773477b429d71,"How many hours has elapsed since the first time during their current hospital encounter patient 10021487 had received a albumin, pleural lab test?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_timestamp)) FROM lab_table WHERE lab_table.patient_id = 10021487 AND lab_table.lab_name = 'albumin, pleural'",[]
f18eb420cfdd900530bf3999,"For patients who were diagnosed with duodenitis, without mention of hemorrhage in 2100, what are the top three most common medications that followed afterward in the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'duodenitis, without mention of hemorrhage' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Duodenitis, without mention of hemorrhage' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.id, medication.name, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE STRFTIME('%y', medication.medication_date) = '2100') AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_date, 'start of month') GROUP BY t2.name) AS t3 WHERE t",
a6b419a3f82d564950633030,Could you tell me the gender of patient 10016742?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10016742,SELECT gender FROM patients WHERE patient_id = 10016742,[{'gender': 'F'}]
ce45eba5e3053962a503afb0,Count the patients who are currently admitted.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(DISTINCT patient_id) FROM admissions WHERE currently_admitted = 'true';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4ad13911a0c3cadf96e3052c,Fetch the top four most frequent procedures that were administered to patients within 2 months after they had continuous invasive mechanical ventilation for 96 consecutive hours or more since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for 96 consecutive hours or more' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, t1.date FROM (SELECT date, procedures.procedure FROM procedures JOIN patients ON procedures.patient = patients.subject WHERE procedures.date BETWEEN '2000-01-01' AND '2000-12-31' GROUP BY date, procedures.procedure HAVING COUNT(*) > 2) AS t1 JOIN (SELECT patients.subject, procedures.procedure FROM procedures JOIN patients ON procedures.patient = patients.subject WHERE procedures.date BETWEEN '2000-01-01' AND '2000-12-31' GROUP BY patients.subject, procedures.procedure HAVING COUNT(*) > 2) AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t3.procedure ORDER BY COUNT(t3.procedure",
4694f530b836736c5f4fd656,What are the top five common diagnoses since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses WHERE date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 5",
caaf86100f832f6892b85b8f,What was the last heart rate value that patient 10001725 had during the first ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(heart_rate) FROM icu_heart_rate WHERE icu_number = 1 AND patient_id = 10001725;,[]
cfd20a468254386f9a520dca,Did patient 10015931 come into the ER during the previous year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM patient WHERE patient.subject_id = 10015931 AND patient.location = 'emergency room admit' AND DATETIME(patient.admittime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT(*)>0': 0}]
654c90f267446af8ba8f70b5,What is the number of patients that received a bands test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bands' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT id) FROM patients WHERE bands_test_date > (CURRENT_DATE - INTERVAL '1 year'),[{'COUNT( DISTINCT admissions.subject_id )': 0}]
7afd7257fd278efbcb7b33ad,What's the cost of a drug known as miconazole nitrate vag cream 2%?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'miconazole nitrate vag cream 2%' ),"SELECT DISTINCT cost FROM drugs WHERE name = ""Miconazole Nitrate Vag Cream 2%""",
1d69c2e9a177101cfd62efed,What was the last asparate aminotransferase (ast) value in 10/this year for patient 10019172?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1",SELECT MIN(asparate_aminotransferase_ast) FROM patient_10019172 WHERE date = '10/this year',[]
5cbd34f92a55a8e7c2f987ce,What's the daily average weight of patient 10007058 during the last month?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT AVG(weight) FROM patients WHERE patient_id = 10007058 AND date BETWEEN DATEADD(month, -1, CURRENT_DATE) AND CURRENT_DATE",[]
067ed21678e9244b701465c3,Was patient 10008287 given a bicarbonate lab test during the last hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10008287 AND lab_results.lab_name = 'bicarbonate' AND lab_results.date_visited = (SELECT MAX(date_visited) FROM lab_results WHERE lab_results.patient_id = 10008287 AND lab_results.lab_name = 'bicarbonate'),[{'COUNT(*)>0': 0}]
2de4e7fa2f4e70e798676fe5,What are the three most common output instances since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT COUNT(DISTINCT ""output"") FROM ""output"" WHERE ""year"" >= 2100 GROUP BY ""output"" ORDER BY COUNT(*) DESC LIMIT 3","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
cb26755fc90d31c8a991b39a,What was the first thing patient 10014078 had as output on 09/08/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-08' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT STRFTIME(CURRENT_TIMESTAMP, '%Y-%m-%d %H:%M:%S') FROM output WHERE patient_id = 10014078 AND STRFTIME(CURRENT_TIMESTAMP, '%m-%d') = '09-08' ORDER BY id NULLS FIRST LIMIT 1",[]
b5b17c29fa86af65cfe72d48,Has patient 10018423 been to the E.R.?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM patient_table WHERE patient_id = 10018423 AND location = 'emergency room admit',[{'COUNT(*)>0': 0}]
bfa5c2646e642966bfa98418,What is the percentile creatinine value of 1.6 among patients of the same age as patient 10007818 on their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.6","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, creatinine.value, PERCENT_RANK() OVER (ORDER BY creatinine.value NULLS FIRST) AS c1 FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.id = 10007818 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1) AND creatinine.value = 1.6) AS t1 WHERE t1.c1 <= 5 AND t1.c1 >= 3",
e93e1b76d0204d31a3174cc1,What is the total number of patients who were discharged from the hospital last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT date_discharged IS NULL AND date_discharged >= (SELECT MIN(date_admitted) FROM patients WHERE date_admitted >= CURRENT_DATE - INTERVAL '1 year'),[{'COUNT( DISTINCT admissions.subject_id )': 0}]
6260379332c5d91d2221013d,What was the last dose of glyburide that during their first hospital encounter was prescribed to patient 10038933?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'glyburide' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(gly_dose) FROM gly_table WHERE patient_id = 10038933 AND NOT is_hospital_1 = 0,[]
b661bb18d48da0b0b3f54277,"Since 2100, how many patients required amitriptyline?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT id) FROM patients WHERE require_amitriptyline = 'true' AND year >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 3}]
9e7913d9465b0471d710f65b,"What is the price of the drug, ciprofloxacin iv?",SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' ),SELECT DISTINCT price FROM drugs WHERE name = 'ciprofloxacin iv',
0702bc77d929f78085010bb0,What was the name of the organism that was found during the last pleural fluid test of patient 10021487 during this hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM organism_search WHERE organism_search_id = (SELECT organism_search_id FROM patient_organism_summary WHERE patient_id = 10021487 AND hospital_location = 'transfer from hospital to home' AND sequence_number = (SELECT MAX(sequence_number) FROM patient_organism_summary WHERE patient_id = 10021487));,[]
96b8daf19be21be478a7950f,How many individuals are current patients in their 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT(DISTINCT patient_id) FROM patients WHERE current_patient = 'true' AND age >= 60;,
8e22c703d632798f42282434,"What was the last dose of nifedipine in 11/2100, prescribed to patient 10021938?","SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.drug = 'nifedipine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(dose) FROM prescriptions WHERE prescriptions.patient_id = 10021938 AND prescriptions.drug_name = 'nifedipine' AND STRFTIME('%y-%m', prescriptions.date) = '2100-11';",[]
05a9aa5bb494b962444ac354,What was the dose of docusate sodium (liquid) that was last prescribed to patient 10016742 since 03/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'docusate sodium (liquid)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug_dose FROM prescriptions WHERE prescriptions.patient_id = 10016742 AND prescriptions.drug_name = 'docusate sodium (liquid)' AND STRFTIME('%y-%m', prescriptions.date) >= '2100-03' ORDER BY prescriptions.date DESC LIMIT 1",[]
c8359c96bf05ca8e01953b73,Has patient 10004457 undergone percutaneous transluminal coronary angioplasty [ptca]?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous transluminal coronary angioplasty [ptca]' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ),,[{'COUNT(*)>0': 0}]
e406dc4e0b4d87d40b90a07f,When did patient 10038933 receive sputum microbiology test the first time since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM microbiology WHERE patient = 10038933 AND sputum_microbiology = 1 AND date >= '2000-03-2100',[]
303a07985f7ef56f4d234d7e,Has patient 10026255 acquired any medication since 10/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'",SELECT COUNT(*) > 0 FROM medication_usage WHERE patient_id = 10026255 AND acquisition_date >= '10/2100',[{'COUNT(*)>0': 1}]
2dd263172f5bf1ae381c6af1,What was the insurance for patient 10031404 in the first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,[{'insurance': 'Other'}]
bf7d668907b28a333bad876e,What were the four most common tests conducted on specimens since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT t.test_name, COUNT(t.test_name) FROM tests t WHERE t.date >= (CURRENT_DATE - INTERVAL '1 year') GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]"
0920f71c3325e1a9f1fa383b,Count the number of patients who took neutra-phos in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'neutra-phos' AND strftime('%Y',prescriptions.starttime) = '2100' )","SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.patient_name = 'Neutra-Phos' AND STRFTIME('%y', patient.date) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
bc8eaff8a367f984fb5ce7ab,What was the first medication that patient 10026406 was prescribed via iv route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(drug_date) FROM medication WHERE patient_id = 10026406 AND route = 'iv',[]
5ad0b756f0eced9a61f3f0e2,What is the difference between heart rate on patient 10011398 measured at 2100-12-27 10:00:00 compared to the value measured at 2100-12-27 09:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' ),SELECT (SELECT heart_rate FROM patient_10011398 WHERE measurement_time = '2100-12-27 10:00:00') - (SELECT heart_rate FROM patient_10011398 WHERE measurement_time = '2100-12-27 09:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' )"": None}]"
e123951f763462b9fe67c32c,What are the top three most frequently prescribed drugs throughout this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.drug FROM (SELECT prescriber.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriber WHERE DATETIME(prescriber.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY prescriber.drug) AS t1 WHERE t1.c1 <= 3;",[]
a5828bf7dab24b1221372dc4,How many people had a test for h in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'h' ) AND strftime('%Y',labevents.charttime) = '2100' )","SELECT COUNT(DISTINCT ""person"") FROM ""test"" WHERE ""year"" = 2100 AND ""test"" = 'h'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
fe47357d4996af8b8acb6162,What is the name of the medication that was prescribed to patient 10004422 for the last time via the po route in 01/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT name FROM medication WHERE prescription_date = '2000-01-2100' AND patient_id = 10004422 AND route = 'po' ORDER BY prescription_date DESC LIMIT 1,[]
e48fc73023f959a4fcf5c5c4,What is the cost of percutaneous [endoscopic] gastrostomy [peg]?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ),,
2a3d64117cc11a9362dcd9fd,List the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving central venous catheter placement with guidance since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.centralvenouscath, t1.guidance, t1.duration FROM (SELECT centralvenouscath, guidance, duration FROM procedures WHERE procedures.guidance = 'central venous catheter placement') AS t1 JOIN (SELECT diagnosis, guidance, duration FROM diagnoses WHERE diagnoses.guidance = 'diagnoses related to central venous catheter placement') AS t2 ON t1.centralvenouscath = t2.diagnosis) AS t3 WHERE t3.guidance = 'guidance' AND t3.duration BETWEEN INTERVAL (2 month) PRECEDING AND INTERVAL (2 month) FOLLOWING GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 5",
412c53a53a3b1c06f1f68772,What was the time it took for patient 13528 to undergo c.a.t. scan of thorax?,,"SELECT TIMESTAMPDIFF(HOUR, start_time, end_time) FROM procedures WHERE patient_id = 13528 AND procedures.name = 'c.a.t. scan of thorax'",
fa39db2734c74d5812a74112,When was the first time patient 10027602 had input since 11/26/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(date_input) FROM input_table WHERE patient_id = 10027602 AND date_input >= '2100-11-26',[{'starttime': '2201-10-30 12:08:00'}]
bebeb2104d4c95aa591562d9,"In this year, what was the last diagnosis for patient 10015860?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",SELECT last_diagnosis FROM diagnoses WHERE patient_id = 10015860 AND diagnosis_date = 2022,
0c11df1e6368179cdb62d5ea,What were the top four most common procedures?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT procedures.name, COUNT(*) FROM procedures GROUP BY procedures.name ORDER BY COUNT(*) DESC LIMIT 4;","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Central venous catheter placement with guidance'}, {'long_title': 'Other nonoperative respiratory measurements'}]"
437ed2f1fe3f680053f1e3de,"Tell me the number of cases of inspection of tracheobronchial tree, via natural or artificial opening endoscopic that occurred since 1 year ago.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.name = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
652d19150532597e8cba1e58,Has patient 10020306 been given any diagnosis since 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient = 10020306 AND STRFTIME('%y', diagnoses.date) >= '2100'",
136857d990a96067b0872cae,Can you tell me the name of the output patient 10022281 had for the last time since 233 days ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-233 day') ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT name FROM output WHERE patient = 10022281 AND date = CURRENT_DATE - INTERVAL '233 day' ORDER BY date DESC LIMIT 1,[{'label': 'Foley'}]
3753ef6947f42f1a4e5a6a63,Has patient 9474 ever experienced any side effects during a blood transfusion?,,SELECT COUNT(*) > 0 FROM blood_transfusion WHERE patient_id = 9474 AND side_effects = 'experienced',
7993e77f8701f72acc7a2d5b,How much 0.9% sodium chloride was prescribed the last time on the last hospital encounter to patient 10019568?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = '0.9% sodium chloride' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10019568 AND prescriptions.drug_name = '0.9% Sodium Chloride' AND NOT prescriptions.end_time IS NULL ORDER BY prescriptions.start_time DESC LIMIT 1;,[]
44b000c0c7e63ce369e8fcb0,Can you tell me if patient 10039997 is male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10039997,SELECT MIN(CLINICAL_SEX) FROM patients WHERE PATIENT_ID = 10039997,[{'gender': 'F'}]
3ec7578f9e5421f0bb600bba,Calculate the length of stay in days for patient 10001217's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', ICU.LENGTH(10001217, 1)) AS length_of_stay_days","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.118032407015562}]"
0367956da12e06e2e598864f,How many patients received left heart cardiac catheterization within the same hospital visit after being diagnosed with phlebitis and thrombophlebitis of superficial veins of upper extremities?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'phlebitis and thrombophlebitis of superficial veins of upper extremities' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'left heart cardiac catheterization' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.diagnosis_time, patient.hospital_id FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'phlebitis and thrombophlebitis of superficial veins of upper extremities') AS t1 JOIN (SELECT patient.subject_id, diagnosis.diagnosis_time, patient.hospital_id FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'left heart cardiac catheterization') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_time < t2.diagnosis_time AND t1.hospital_id = t2.hospital_id",
28150962c7244064887e1cfd,What is the minimum daily number of cases for acute diastolic (congestive) heart failure in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute diastolic (congestive) heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",SELECT MIN(daily_cases) FROM (SELECT COUNT(*) AS daily_cases FROM acute_diastolic_heart_failure WHERE year = 2100 GROUP BY date),
6ee1790753b54f997c67b31c,"What are the five most frequently given lab tests for patients that were diagnosed with dislocation of jaw, initial encounter previously during the same hospital visit, since 1 year ago?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab FROM (SELECT t2.lab, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'Dislocation of jaw, initial encounter' AND DATETIME(diagnoses.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT admissions.subject_id, lab FROM labs JOIN admissions ON labs.admission_id = admissions.admission_id WHERE DATETIME(labs.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+1 month') GROUP BY t2.lab) AS t3 WHERE t3.c1 <= 5",
c205b51f6231b94810bd8849,"In 05/this year, when did patient 10018328 receive their last medication via the po/ng route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_submitted) FROM patient_medication WHERE patient_id = 10018328 AND route = 'po/ng' AND date_submitted >= '2005-01-01',[]
6ea26188016a8e0dcae6f2ca,When are dr. shears's rounds and procedures?,,"SELECT dr.shears.rounds, dr.shears.procedures FROM dual;",
0c46bd9e9a1925278db28a40,Can you name the procedure/treatment that patient 10038081 was given two or more times in 10/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-10' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT treatment, date FROM patient WHERE patient.id = 10038081) AS t1 JOIN (SELECT treatment, date FROM patient WHERE patient.id = 10038081) AS t2 ON t1.treatment = t2.treatment WHERE t1.date < t2.date AND STRFTIME('%y-%m', t1.date) = '2100-10' GROUP BY t1.treatment HAVING COUNT(t1.treatment) >= 2",
8576dc17a71fd1f052b49898,Has patient 10018081 gone through any procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10018081;,[{'COUNT(*)>0': 1}]
5ccd34698e938f99b49819c5,"What is the minimum monthly number of patients affected by cerebral aneurysm, nonruptured?","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral aneurysm, nonruptured' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MIN(monthly_number_of_patients) FROM patients WHERE condition = 'Cerebral aneurysm, nonruptured'",
3cd0a6cd42161066ac6ee01a,What were the three most often conducted microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3",SELECT test_name FROM microbiology_tests WHERE date >= (SELECT MAX(date) FROM microbiology_tests WHERE date < '1 year ago') GROUP BY test_name ORDER BY COUNT(*) DESC LIMIT 3,"[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
240b36c04ba129e0ec06c297,Tell me the maximum total hospital cost that involves cellulitis and abscess of trunk since 2100.,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cellulitis and abscess of trunk' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(h.cost) AS c1 FROM patient p JOIN diagnosis d ON p.diagnosis_id = d.diagnosis_id JOIN treatment t ON p.treatment_id = t.treatment_id JOIN hospital h ON p.hospital_id = h.hospital_id WHERE d.diagnosis = 'cellulitis and abscess of trunk' AND STRFTIME('%y', h.accident_date) >= '2100' GROUP BY p.patient_id) AS t1",
0d0fa264d945b5ef90978c92,What was the last hospital discharge time for patient 10022017?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_dischtime) FROM transfer WHERE patient_id = 10022017,[{'dischtime': '2189-09-16 15:00:00'}]
8794ed581e861d00471884fd,How many patients were discharged during the last year from hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissal_date IS NULL AND DATETIME(dismissal_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year');",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
510cd856f97ccd8e1ae62400,How many prescriptions were prescribed during the previous year for milk of magnesia?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'milk of magnesia' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = ""Milk of Magnesia"" AND DATETIME(prescriptions.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT(*)': 0}]
28df687aecadf8f1d696c1f6,When has patient 10018845 been given phosphate test for the last time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(date_phosphate_test) FROM lab_data WHERE patient_id = 10018845,[]
3d09ada3209f58b132f11030,Show me the length of time in days patient 10031757 was in the ICU during the last visit.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', visit.leave_time) - STRFTIME('%j', visit.arrival_time) FROM visit WHERE visit.patient_id = 10031757 AND NOT visit.arrival_time IS NULL ORDER BY visit.arrival_time DESC LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.1996527779847383}]"
cc8d52ea13df2c173004e53e,Has patient 10015272 undergone a mch test?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ),SELECT COUNT(*) FROM lab_results WHERE lab_results.patient_id = 10015272 AND lab_results.result_type = 'mch',[{'COUNT(*)>0': 0}]
f14d881d1381c847c13301a6,Did patient 73713 have overseas travel history?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.overseas_travel = '73713',
2e5708405e832d182494a66b,What was the amount of straight cath output patient 10020740 had since 03/06/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'straight cath' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06'",SELECT SUM(Straight_Cath_Output) FROM gcs_bucket WHERE Patient_ID = 10020740 AND Straight_Cath_Output_Date >= '2100-03-06',[{'SUM(outputevents.value)': None}]
e96c71afca103a3a2ccb1ec7,"The first time since 09/2100, when was patient 10006053 prescribed 0.9% sodium chloride and midazolam at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10006053 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'midazolam' AND admissions.subject_id = 10006053 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT STRFTIME('%y-%m', MIN(STRFTIME('%y-%m', CURRENT_TIME, '-09 year'))) FROM medication WHERE medication.patient_id = 10006053 AND medication.drug_name = '0.9% sodium chloride' INTERSECT SELECT STRFTIME('%y-%m', MIN(STRFTIME('%y-%m', CURRENT_TIME, '-09 year'))) FROM medication WHERE medication.patient_id = 10006053 AND medication.drug_name = 'midazolam'",[]
72692c9fe3d361f082e66556,What was the drug that was prescribed to patient 10015860 for the last time on their last hospital visit via the po/ng route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1,"SELECT prescriber.drug FROM (SELECT patient.id, patient.hospital_info.visit_number, prescriber.drug FROM patient JOIN prescriber ON patient.id = prescriber.patient_id WHERE patient.id = 10015860 AND NOT patient.hospital_info.dischtime IS NULL ORDER BY patient.hospital_info.admittime DESC LIMIT 1) AS innerQuery WHERE innerQuery.drug = 'PO/NG' ORDER BY innerQuery.visit_number DESC LIMIT 1;",[]
f93e415636fa3dd73984e7dc,What's the percentile of 6.0 in a alanine aminotransferase (alt) lab test at the same age as patient 10029484 during their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 6.0",SELECT SUM(alt) FROM (SELECT alt FROM lab_data WHERE lab_data.patient_id = 10029484 AND lab_data.result_date = (SELECT lab_data.result_date FROM lab_data WHERE lab_data.patient_id = 10029484 AND lab_data.lab_name = 'alanine aminotransferase (alt)') GROUP BY alt) WHERE alt >= 6.0,
880b5cd212d4e5ed720e455e,What was the total nacl 0.9% amount given for patient 10021666?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),SELECT SUM(NACL_0.9%) FROM brackets WHERE patient_id = 10021666;,[{'SUM(inputevents.totalamount)': None}]
bba4bfd7b72b61f4f0a2b01a,Has patient 10020740 been treated with a parenteral infusion of concentrated nutritional substances procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ),SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10020740 AND procedures.procedure_name = 'Parenteral infusion of concentrated nutritional substances',[{'COUNT(*)>0': 0}]
a1d4a46462d0cd1e638cddc8,What was the count of patients who were tested for magnesium since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient_id) FROM lab_results WHERE lab_result = 'magnesium' AND date_result >= CURRENT_DATE - INTERVAL '1 year',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
1e644096c1912f2f70a3c917,What was patient 10015860's insurance name during the first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.insurance_name FROM patient WHERE patient.patient_id = 10015860 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1,[{'insurance': 'Other'}]
4b381a5f887c98f632753d0c,What is the protocol of the anticancer drugs?,,SELECT DISTINCT protocol FROM anticancer_drugs;,
f1189d2c589416c9c81ca80e,"Since the first time patient 10004733 was diagnosed with chronic kidney disease, unspecified in this hospital visit, how many days have passed?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosed_date)) FROM diagnoses WHERE patient_id = 10004733 AND diagnosis_name = 'chronic kidney disease, unspecified' AND database_name = 'main' AND hospital_name = 'Hospital A';",
fbeef7a4b32462cf2f85c7ab,And what was the first time patient 10038933 was prescribed medication using the td route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(drug_start_date) FROM medication WHERE patient_id = 10038933 AND route = 'td',[]
b463fec617a5b7561a49f7e8,"Get me the top four most frequent drugs that patients were prescribed in the same month after being diagnosed with accidental cut, puncture, perforation or hemorrhage during heart catheterization in 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental cut, puncture, perforation or hemorrhage during heart catheterization' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.drug, COUNT(t3.drug) FROM (SELECT t2.drug, DATE_DIFF('CREATIONDATE', t1.diagnosisdate, month) AS days FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'ACCIDENTAL CUT, PUNCTURE, PERFORATION, HEMORRHAGE' AND STRFTIME('%y', diagnosis.diagnosisdate) = '2100') AS t1 JOIN (SELECT patient.uniquepid, prescription.drug, prescription.creationdate FROM prescription JOIN patient ON prescription.patientid = patient.uniquepid WHERE STRFTIME('%y', prescription.creationdate) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.creationdate AND DATE_DIFF('CREATIONDATE', t1.diagnosisdate, month) BETWEEN 0 AND 1 GROUP",
e07cb0702bd8c962c980b344,Can you tell me patient 10002495's daily minimum weight since 19 months ago?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MIN(weight) FROM patients WHERE patient_id = 10002495 AND date >= CURRENT_DATE - INTERVAL '19 month' GROUP BY date,[]
abc85f653325ca0da7e82fce,"What are the four most commonly tested specimens for patients who were diagnosed with other fluid overload previously within 2 months, since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.date FROM (SELECT patient.uniquepid, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'other fluid overload') AS t1 JOIN (SELECT patient.uniquepid, specimen, date FROM sampling JOIN patient ON sampling.patientid = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.specimen) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 4",
0f1f7818e92f4038e40e8fb5,"Show me the top five most commonly prescribed drugs during the same hospital encounter to the patients aged 40s after diagnosed with epilepsy, unspecified, not intractable, without status epilepticus.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t1.drug FROM (SELECT drugs.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patients.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'EPILEPSY, UNSPECIFIED, NOT INTRACTABLE, WITHOUT STATUS EPILEPTICUS') AS t1 JOIN (SELECT patients.subject_id, drugs.drug, drugs.drug_date FROM drugs JOIN patients ON drugs.patient_id = patients.subject_id WHERE patients.age BETWEEN 40 AND 49) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.drug_date AND DATETIME(t1.diagnosis_date, 'start of day') = DATETIME(t2.drug_date, 'start of day') GROUP",
567c419acd4847f820befc6f,"How many people were diagnosed with depressive disorder, not elsewhere classified in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'depressive disorder, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT diagnosis.patient_id) FROM diagnosis WHERE diagnosis.diagnosis_name = 'DEPRESSIVE DISORDER, NOT ELSEWHERE CLASSIFIED' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100'",
69b677906abcc409eb49619a,Show me the top four most frequent diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 4;","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Hyperlipidemia, unspecified'}, {'long_title': 'Essential (primary) hypertension'}]"
88a7e76c42b80b33bdb68d60,Show me the top three diagnoses with the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT diagnosis, 3 AS month_3_mortality",
61dc7e082e6c06af309663c7,When did patient 10002495 have the last maximum mcv value in 06/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(mcv) FROM patients WHERE patient_id = 10002495 AND date BETWEEN '06/2022' AND '06/2022',[]
725f32d2feda840d1ff1d579,The last time patient 10021487 was prescribed sodium bicarbonate and 5% dextrose at the same time since 11/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10021487 AND medication.drug_name = '5% dextrose' AND DATETIME(medication.start_date) >= DATETIME('11/2100') AND DATETIME(medication.start_date) = DATETIME('11/2100', '-0 day')",[]
66d3360a6cad5a5a584ea115,"What are the four most frequent diagnoses that patients were diagnosed within the same month after having received a extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic procedure since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE treatment.treatment_type = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic procedure' AND STRFTIME('%y', treatment.date) >= '2100') AS t1 JOIN (SELECT patient.name, diagnosis.diagnosis, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE STRFTIME('%y', diagnosis.date) >= '2100') AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 4",
4c376d728b885b57cae6d692,"How many people had a test for amylase, body fluid?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, body fluid' ) )","SELECT COUNT(DISTINCT ""subject_id"") FROM ""amylase, body fluid""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d9529dbe9af1c4a2f0911379,Has patient 10002495 been tested on phosphate in 06/this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06'","SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10002495 AND lab_data.label = 'Phosphate' AND DATETIME(lab_data.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', lab_data.date) = '06'",[{'COUNT(*)>0': 0}]
ef514e32ea077744d1c08f2e,Could you retrieve the top four most conducted lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT lab_test FROM lab_tests ORDER BY lab_test DESC LIMIT 4,"[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
986a2a3bde40fef4fc375ef2,What were the top three most frequent microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t.microbiology, COUNT(t.microbiology) FROM (SELECT microbiology FROM microbiology_tests WHERE date > CURRENT_DATE - INTERVAL '1 year') AS t GROUP BY t.microbiology ORDER BY COUNT(t.microbiology) DESC LIMIT 3;","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
43a04bb201473909218db1f2,Has there been a epithelial cells lab test performed on patient 10018081 during this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')","SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10018081 AND lab_data.lab_name = 'epithelial cells' AND DATETIME(lab_data.lab_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')",[{'COUNT(*)>0': 0}]
d999d5a343bd58aa54b40298,Could you retrieve the top five diagnoses that have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t5.diagnosis, t5.3 AS three_month_mortality_rate FROM (SELECT t4.diagnosis, t4.3 AS three_month_mortality_rate FROM (SELECT t3.diagnosis, t3.3 AS three_month_mortality_rate FROM (SELECT t2.diagnosis, t2.3 AS three_month_mortality_rate FROM (SELECT t1.diagnosis, t1.3 AS three_month_mortality_rate FROM (SELECT 'Overall' AS diagnosis, 3 AS three_month_mortality_rate) AS t1 GROUP BY t1.diagnosis) AS t2 GROUP BY t2.diagnosis) AS t3 GROUP BY t3.diagnosis) AS t4 GROUP BY t4.diagnosis ORDER BY t4.three_month_mortality_rate DESC LIMIT 5;",
5dcb3867960ccfe76a673b5e,What were the top five most common diagnoses since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(*) FROM diagnoses WHERE date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 5",
9191a69ae68cf1a4e5e3ebba,When was the last time on the first ICU stay patient 10020944's SaO2 was greater than 99.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 99.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(admit_date) FROM patient WHERE patient_id = 10020944 AND icu_stay = 1 AND sao2 > 99.0,[]
13fab13d5c28d10640de8024,"In their first hospital encounter, how old was patient 10037861?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.age FROM patients WHERE patient.id = 10037861 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1,
615f5677e858fc4ef464a1a0,Tell me the daily average amount of patient 10021118's nacl 0.9% input in this month.,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(amount) FROM input WHERE patient_id = 10021118 AND input_type = 'nacl 0.9%' AND date_part('month', date) = date_part('month', CURRENT_DATE) AND date_part('day', date) = date_part('day', CURRENT_DATE)",[]
a5137665c5ab5a44b8006d8e,What is the minimum total hospital cost that includes a procedure called laparoscopic partial cholecystectomy?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic partial cholecystectomy' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(total_hospital_cost) FROM procedures WHERE procedure_name = 'laparoscopic partial cholecystectomy';,
9e9072f0ced4b6c391c00916,"For patients who undertook right heart cardiac catheterization during the same month, what are the top three most frequent specimens tested afterward in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.time FROM (SELECT patient.specimen, cardiac.time FROM cardiac JOIN patients ON cardiac.patient = patients.subject_id WHERE cardiac.time BETWEEN '2009-01-01 00:00:00' AND '2009-01-01 00:00:00' AND cardiac.type = 'right heart cardiac catheterization') AS t1 JOIN (SELECT patient.specimen, sample.time FROM sample JOIN patients ON sample.patient = patients.subject_id WHERE sample.time BETWEEN '2010-01-01 00:00:00' AND '2010-01-01 00:00:00' AND sample.type = 'specimen') AS t2 ON t1.patient = t2.patient WHERE t1.time < t2.time AND DATETIME(t1.time, 'start of month') = DAT",
2532d7b2500ba53d5b6005e9,When had patient 10009035 first been prescribed for metoprolol tartrate and senna at the same time in 05/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metoprolol tartrate' AND admissions.subject_id = 10009035 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'senna' AND admissions.subject_id = 10009035 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",SELECT DATETIME '2100-05-01 12:35:01' FROM patients WHERE patients.patient_id = 10009035 WHERE patients.patient_name = 'Alice' AND patients.age = 30,[]
3d734e7730e119eb7ecbb9e5,How many people got prescriptions for fish oil (omega 3) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fish oil (omega 3)' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.patient_name = 'fish oil (omega 3)' AND STRFTIME('%y', patient.date_of_prescription) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f79c2af96dde359ecee262e9,Can you tell me which four diagnoses have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT t4.diagnosis, t4.c1, t4.c2, t4.c3 FROM (SELECT t3.diagnosis, t3.c1, t3.c2, t3.c3 FROM (SELECT t2.diagnosis, t2.c1, t2.c2, t2.c3 FROM (SELECT t1.diagnosis, t1.c1, t1.c2, t1.c3 FROM (SELECT '1500-0101' AS diagnosis, 0.333 AS c1, 0.333 AS c2, 0.333 AS c3) AS t1 GROUP BY t1.diagnosis) AS t2 JOIN (SELECT '1500-0101' AS diagnosis, 0.333 AS c1, 0.333 AS c2, 0.333 AS c3) AS t3 ON t2.diagnosis = t3.diagnosis) AS t4 ORDER BY t4.c3 DESC LIMIT 1",
bea830fb10c315727fb3899b,When did since 05/2100 patient 10018081 take the last microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT date FROM microbiology WHERE patient_id = 10018081 AND date >= '2005-01-2100' ORDER BY date DESC LIMIT 1,[{'charttime': '2134-09-17 06:24:00'}]
4eaa02f29374fda17d73e7cc,What is the average total hospital cost for a procedure involving single internal mammary-coronary artery bypass since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure = 'single internal mammary-coronary artery bypass' AND year >= 2100 GROUP BY patient.id) AS t1,
c7279aab21fca4862f9c138a,"On the last hospital visit, what was patient 10026406's insurance plan?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance_plan FROM patients WHERE patient.hospital_visits = (SELECT COUNT(*) FROM hospital_visits WHERE patient_id = 10026406 ORDER BY hospital_visits.hospital_date DESC LIMIT 1);,[{'insurance': 'Other'}]
4a6773499778d85e09dc660a,"Since 2100, how many patients had been diagnosed with dementia, unspecified, without behavioral disturbance?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dementia, unspecified, without behavioral disturbance' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT diagnosis_id) FROM diagnoses WHERE diagnosis = 'DEMENTIA, UNSPECIFIED, WITHOUT BEHAVIORAL DISTURBANCE' AND year >= 2100",
bb12c097d6c3840101205ef8,What was the five most common lab test that was given in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE year = 2100) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5",[]
cd733e64db1b7801954ac9ac,Where are the single rooms out there now?,,SELECT room_name FROM rooms WHERE room_type = 'single';,
02bd66cb3a751f53d4accb0a,"What number of hours has it been since the last time patient 10004733 was diagnosed with dysphagia, oropharyngeal phase in their current hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, oropharyngeal phase' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnoses.patient_id = 10004733 AND diagnoses.diagnosis = 'dysphagia, oropharyngeal phase' AND diagnoses.current_hospital_encoding = 1",
afe1bb1212af5b8def3b6bca,List the top four most frequent microbiology tests that were given to patients after they were diagnosed with acute embolism and thrombosis of deep veins of right upper extremity during the same hospital encounter.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute embolism and thrombosis of deep veins of right upper extremity' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t3.Microbiology, COUNT(t3.Microbiology) FROM (SELECT t2.Microbiology, COUNT(t2.Microbiology) FROM (SELECT patient.Name, diagnosis.Diagnosis, treatment.Treatment, patient.Age FROM diagnosis JOIN treatment ON diagnosis.Diagnosis = treatment.Diagnosis JOIN patient ON diagnosis.Patient = patient.Name WHERE diagnosis.Diagnosis = 'Acute embolism and thrombosis of deep veins of right upper extremity') AS t1 JOIN (SELECT patient.Name, microbiology.Microbiology, microbiology.Timestamp FROM microbiology JOIN patient ON microbiology.Patient = patient.Name) AS t2 ON t1.Name = t2.Name WHERE t1.Diagnosis = t2.Microbiology GROUP BY t2.Microbiology) AS t3 GROUP BY t3.Microbiology ORDER BY COUNT(t3.Microbiology) DESC LIMIT 4",
755568f5da1aa36f192dbdd8,Have any lab tests been performed on patient 10027445 in this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM LabTests WHERE LabTests.patientId = 10027445 AND DATETIME(LabTests.testDate, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
4f00325c6536b67bbcfa20b1,What was the number of patients that were given a mch test during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT t1.subject, t2.mch FROM (SELECT subject, MCH FROM (SELECT STATUS, DATE FROM (SELECT PATIENT, DATE FROM (SELECT STATUS, DATE FROM (SELECT PATIENT, DATE FROM (SELECT STATUS, DATE FROM (SELECT PATIENT, DATE FROM (SELECT STATUS, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT PATIENT, DATE FROM (SELECT P",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
6a7324498e10c064190ceb7f,What are the three most frequently prescribed drugs since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE STRFTIME('%y', prescriptions.date) >= '2100' GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]"
c8c5c2ee11a8da094f25c3bc,What was the last dose of ondansetron that patient 10025612 was prescribed during the first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'ondansetron' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT ndansetron FROM 'prescriptions.csv' WHERE patient_id = 10025612 AND hospital_dischtime IS NULL ORDER BY prescriptions.drug_date DESC LIMIT 1;,[]
0d0dfd8344c44ef1ba5abcc4,What was the name of patient 10014078's insurance in the last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance FROM patient WHERE patient.patient_id = 10014078 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1,[{'insurance': 'Medicaid'}]
c060af6a8bb23ffdee50e730,What was the first input time of patient 10004733 since 10/30/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-30' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10004733 AND input_time >= '2100-10-30',[{'starttime': '2174-12-04 12:34:00'}]
935352db3b3a1d247e88bdc4,How many days have passed since patient 10004733 had the last alanine aminotransferase (alt) lab test in the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab.result_date)) FROM lab WHERE lab.patient_id = 10004733 AND lab.lab_name = 'alanine aminotransferase (alt)' AND lab.result_date = (SELECT MAX(result_date) FROM lab WHERE lab.patient_id = 10004733 AND lab.lab_name = 'alanine aminotransferase (alt)');",[]
99abc2a37fa7ff26ae5a4483,Give me the three most common treatments.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT Treatment, COUNT(Treatment) FROM patients GROUP BY Treatment ORDER BY COUNT(Treatment) DESC LIMIT 3","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Other nonoperative respiratory measurements'}]"
7ec0ab7e9f87fb5c34405276,What was the first time since 03/2100 patient 10029291 was prescribed a medication via the neb route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM medication WHERE patient_id = 10029291 AND route = 'neb' AND date_prescribed >= '2003-03-2100',[]
b4c01b9c3a018f29ade4acf5,When was the last time that patient 10001725 has been prescribed medication via the po/ng route in their first hospital visit?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM diagnoses JOIN prescriptions ON diagnoses.patient_id = prescriptions.patient_id WHERE diagnoses.patient_id = 10001725 AND prescriptions.route = 'PO/NG',[]
8f3e188a5ef2fa6208206b5f,Patient 10014729 was diagnosed in their last hospital encounter for the first time with what?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT patient.age FROM patient WHERE patient.patient_id = 10014729 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1,
5a7361bff9784d49a8234e8a,What is the minimum total hospital cost that involved a procedure called other enterostomy since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other enterostomy' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure = 'other enterostomy' AND year >= 2100 GROUP BY patient.id) AS t1,
32176427d268868d414b69a1,Has patient 10038933 been admitted into the emergency room since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.location = 'emergency room admit' AND STRFTIME('%y', admissions.admit_date) >= '2100'",[{'COUNT(*)>0': 0}]
7172db99077f820626236cfa,What is the total number of other fasciectomy procedures that took place since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other fasciectomy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.type = 'other fasciectomy' AND STRFTIME('%y', procedures.date) >= '2100'",
e69db8778c92e5eec552f1eb,Has there been a hospital admission for patient 10005817 in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10005817 AND STRFTIME('%y', admissions.admission_date) = '2100'",[{'COUNT(*)>0': 0}]
aca1e0e3be80e222d3b95be5,"How many hours has it been since the first time that patient 10021487 was diagnosed with cardiac complications, not elsewhere classified on this hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosed_date)) FROM diagnoses WHERE patient_id = 10021487 AND diagnosis = 'cardiac complications, not elsewhere classified' AND STRFTIME('%j', diagnosed_date) > STRFTIME('%j', CURRENT_TIME);",
5f1dc42ba1c4cd7cad30e93d,What was the last time of input of patient 10027602 on last month/28?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '28' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT MAX(input_time) FROM input_table WHERE patient_id = 10027602 AND input_time BETWEEN DATEADD(month, -1, CURRENT_DATE) AND DATEADD(month, -1, CURRENT_DATE) + INTERVAL '28 days'",[]
d50ac96f2f625bb2840762bf,What was the last dose of alteplase (catheter clearance) that on their last hospital visit was prescribed to patient 10019777?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'alteplase (catheter clearance)' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(catheter_clearance) FROM patients WHERE patient_id = 10019777 AND prescription_date = 'last hospital visit',[]
c7913f24b079937963ea9f4f,What was the total number of patients on vascular in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT admissions.subject, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""VASCULAR TENSION HEADACH"" AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""VASCULAR TENSION HEADACH"" AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.subject = t2.subject WHERE t1.diagnosis_date < t2.diagnosis_date",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
29af2e5e1ea84750efeb2ac2,When did patient 10013049 get discharged from the hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10013049 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = 10013049;,[]
b9ac1bb7e36dd0d95acbf39c,Can you tell the three most frequent lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.lab_test, COUNT(t1.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE year >= 2100) AS t1 JOIN lab_results ON t1.lab_test = lab_results.lab_test GROUP BY t1.lab_test ORDER BY COUNT(t1.lab_test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
0a8c46b684e72300d29c18aa,What drug was prescribed to patient 10010471 for the last time?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescription_name FROM prescriptions WHERE patient_id = 10010471 ORDER BY prescription_date DESC LIMIT 1;,[{'drug': 'LORazepam'}]
fceaf877c094825a80b15f57,"What were the last potassium, whole blood results for patient 10018081 since 12/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(Potassium, Whole Blood) FROM lab WHERE Patient = 10018081 AND Date >= '12/2100'",[]
b3c91b713aa0b269e1c13630,Calculate patient 10007818's total output since 06/07/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-07'","SELECT SUM(output) FROM ""brackets"" WHERE patient = 10007818 AND date >= '2100-06-07'",[{'SUM(outputevents.value)': 31939.0}]
a0c63dd8ba51ee400d101df7,Could you tell me the name of the drug prescribed to patient 10027602 in the same day after the insertion or replacement of external ventricular drain [evd] procedure since 05/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,
25036a06119f918d2956f2e6,Give me the total amount of output since 11/16/2100 for patient 10010471.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-16'","SELECT COUNT(*) FROM ""output"" WHERE ""patient_id"" = 10010471 AND ""date"" >= '2000-11-16'",[{'SUM(outputevents.value)': 180.0}]
690cfb24a4808aace8c6a75a,How much does patient 10019777 change in weight second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patient WHERE patient.hospital_stay_id IN (SELECT patient.hospital_stay_id FROM patient WHERE patient.id = 10019777 ORDER BY patient.hospital_stay_id DESC LIMIT 1) AND NOT patient.hospital_stay_id IS NULL ORDER BY patient.hospital_stay_id NULLS FIRST LIMIT 1 OFFSET 1) - (SELECT weight FROM patient WHERE patient.hospital_stay_id IN (SELECT patient.hospital_stay_id FROM patient WHERE patient.id = 10019777 ORDER BY patient.hospital_stay_id DESC LIMIT 1) AND NOT patient.hospital_stay_id IS NULL ORDER BY patient.hospital_stay_id NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
dd91706df84d8357cdef457f,What are the immuno-cancer drugs that have been on for the last 5 years.,,"SELECT * FROM products WHERE category = 'immuno-cancer drugs' AND date_sub('year', products.date, current_date) <= 5;",
d754a3e8d810070834fab3af,What is the average total hospital cost that involves other appendectomy procedure in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other appendectomy' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure = 'other appendectomy' AND year = 2100 GROUP BY patientId) AS t1,
ae4b7b569f1122fb6951ca6f,Get me patient 10016810's total output volume in the last ICU stay.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ),SELECT SUM(output) FROM (,[{'SUM(outputevents.value)': 5090.0}]
c616ccb02a7104766a7ca4e7,"What's the cost of a procedure called excision of left saphenous vein, percutaneous endoscopic approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'excision of left saphenous vein, percutaneous endoscopic approach';",
c9e6ec1ba862ca6788412403,"In 2100, what are the top three most frequent medications prescribed within the same hospital visit to the patients in their 60 or above after they were diagnosed with other ascites?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ascites' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_date, patient.patient_id FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Other ascites') AS t1 JOIN (SELECT patient.name, medication.name, medication.date, patient.patient_id FROM medication JOIN patient ON medication.patient_id = patient.patient_id WHERE patient.age >= 60) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.date AND t1.patient_id = t2.patient_id GROUP BY t2.name) AS t3 WHERE t3.c1 <= 3",
0bcf658b419c2cb56787d659,Tell me the insurance plan in place for patient 10005909 in the first hospital encounter.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,"SELECT insurance_plan FROM (SELECT patient_id, encounter_id, insurance_plan FROM (SELECT patient_id, encounter_id, NULL FROM patient_encounters WHERE patient_id = 10005909) AS t1 WHERE encounter_id = 1) AS t2 WHERE insurance_plan IS NOT NULL",[{'insurance': 'Other'}]
b3ed67a0532299ba3cb949a9,Show me the five most common microbiology tests performed.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.test_name, COUNT(t.test_name) FROM microbiology_tests t GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 5;","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
7b673569df3b4b123b597c43,Is the arterial blood pressure diastolic reading for patient 10019172 second measured on the first ICU visit greater than the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT arterial_blood_pressure_diastolic FROM icu_visits WHERE icu_visits.patient_id = 10019172 AND NOT icu_visits.departed = 0 ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1) > (SELECT arterial_blood_pressure_diastolic FROM icu_visits WHERE icu_visits.patient_id = 10019172 AND NOT icu_visits.departed = 0 ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
109bdf00fc8e0bc665794600,Has patient 10022880 entered the hospital since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022880 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10022880 AND DATETIME(admissions.admit_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 1}]
f3bebe99a5275c408f17b181,Has patient 10005909 undergone laboratory tests since 03/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10005909 AND STRFTIME('%y-%m', lab_tests.date) >= '2100-03'",[{'COUNT(*)>0': 1}]
b43b8df345f082e968c0504d,When did patient 10038081 first get the mrsa screen's microbiology test since 01/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT date(test_date) FROM lab_tests WHERE patient_id = 10038081 AND test_type = 'mrsa screen''s microbiology' AND date(test_date) >= '2000-01-2100' ORDER BY date(test_date) NULLS FIRST LIMIT 1,[]
f0042425f5c80fc4ec492cf0,What are the top five most common medications prescribed within 2 months to the patients aged 60 or above after they were diagnosed with diplopia?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'diplopia') AS t1 JOIN (SELECT patient.id, medication.name, medication.date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age >= 60) AS t2 ON t1.id = t2.id WHERE DATETIME(t1.diagnosis_date) BETWEEN DATETIME(t2.date) AND DATETIME(t2.date, '+2 month') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 5",
d41f44da71b3e6d40f476229,"Among patients diagnosed with impaired fasting glucose, what were the top three most common microbiology tests conducted within 2 months since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'impaired fasting glucose' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT t3.microbiology_test, COUNT(t3.microbiology_test) FROM (SELECT t2.microbiology_test, t1.FastingGlucose FROM (SELECT FastingGlucose, COUNT(FastingGlucose) FROM patients WHERE FastingGlucose = 'Impaired' GROUP BY FastingGlucose) AS t1 JOIN (SELECT Microbiology, COUNT(Microbiology) FROM patients WHERE Microbiology = 'Impaired' GROUP BY Microbiology) AS t2 ON t1.FastingGlucose = t2.Microbiology WHERE t1.FastingGlucose = t2.Microbiology GROUP BY t3.microbiology_test ORDER BY COUNT(t3.microbiology_test) DESC LIMIT 3",
1757227b484201499ac650b9,Has patient 10022041 received a laboratory test for vitamin b12?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ),SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10022041 AND lab_results.result_name = 'vitamin b12',[{'COUNT(*)>0': 0}]
aaca78ea66f02f483ebdf478,What's the cost of a procedure called regional lymph node excision?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'regional lymph node excision' ) ),"SELECT COST(DISTINCT ""regional lymph node excision"") FROM procedures;",
5d27d425de44d1e9e60bb681,What was the count of patients who were tested for troponin t since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND strftime('%Y',labevents.charttime) >= '2100' )",SELECT COUNT(DISTINCT id) FROM patients WHERE lab_name = 'troponin t' AND year >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
493ddb9a69efd787e0396f81,Has patient 10027602 received any laboratory testing in this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10027602 AND DATETIME(lab_results.result_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT(*)>0': 0}]
ed72f24083966a774f22b122,What was the name of the output that patient 10031757 got first since 06/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT output_name FROM duckdb_outputs WHEREpatient_id = 10031757 AND STRFTIME('%y-%m-%d', date) >= '2100-06-05' ORDER BY date NULLS FIRST LIMIT 1",[{'label': 'OR EBL'}]
e7db6c421273de71b7f9b8a7,What is the average cost to the hospital that involves personal history of other diseases of digestive system?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other diseases of digestive system' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(C1) FROM (SELECT SUM(CASE WHEN PERSONAL_HISTORY = 'OTHER DISEASES OF DIGESTIVE SYSTEM' THEN 1 ELSE 0 END) AS C1 FROM (SELECT PERSONAL_HISTORY FROM (SELECT * FROM information_schema.columns WHERE table_name = 'patients') AS T1 JOIN (SELECT * FROM information_schema.columns WHERE table_name = 'diagnoses') AS T2 ON T1.personal_history = T2.personal_history) AS T3) AS T4 JOIN (SELECT * FROM information_schema.columns WHERE table_name = 'cost') AS T5 ON T4.c1 = T5.c1,
213a702cca16592f4d19705a,Was patient 10015931 given a magnesium lab test on the last hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),"SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10015931 AND lab_data.label = 'magnesium' AND DATETIME(lab_data.date) = DATETIME(CURRENT_TIME, '-1 day')",[{'COUNT(*)>0': 0}]
f8afb5281dcdfe12ea07f322,How much is the price for lenalidomide (revlimide)15mg?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lenalidomide (revlimide)15mg' ),"SELECT ""price"" FROM ""products"" WHERE ""product"" = 'lenalidomide (revlimide)15mg'",
5e947ca43ffbad49cde64c05,"I mean, what is the reimbursement standard for cerebrovascular mri?",,SELECT SUM(reimbursement) FROM procedures WHERE procedure_name = 'Cerebrovascular MRI',
098602cc877f3e4c36bc908a,"Among the patients of age 60 or above in 2100, what are the top five most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.uniquepid WHERE diagnosis.year = 2100 AND patient.age >= 60) AS t1 GROUP BY t1.diagnosis) AS t2 WHERE t2.c1 <= 5;",
ed2e1e9eb814e9ee71358ddb,When was the first input of patient 10004733 since 05/10/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-10' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(intake_date) FROM intake_table WHERE patient_id = 10004733 AND intake_date >= '2100-05-10',[{'starttime': '2174-12-04 12:34:00'}]
ea237bbea67442bc6b962cce,How many patients were diagnosed with alkalosis after already being diagnosed with postinflammatory pulmonary fibrosis within 2 months?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM (SELECT subject_id, DATE '2022-01-01' AS diagnosis_date FROM (SELECT subject_id FROM (SELECT 1 AS subject_id, 'alkalosis' AS diagnosis FROM (SELECT 1 AS subject_id, 'postinflammatory pulmonary fibrosis' AS diagnosis FROM (SELECT 1 AS subject_id, 'diagnosis' AS diagnosis FROM (SELECT 1 AS subject_id, 'treatment' AS diagnosis FROM (SELECT 1 AS subject_id, 'information' AS diagnosis FROM (SELECT 1 AS subject_id, 'assessment' AS diagnosis FROM (SELECT 1 AS subject_id, 'questionnaire' AS diagnosis FROM (SELECT 1 AS subject_id, 'referral' AS diagnosis FROM (SELECT 1 AS subject_id, 'treatment' AS diagnosis FROM (SELECT 1 AS subject_id, 'hospitalization' AS diagnosis FROM (SELECT 1 AS subject_id, 'exacerbation' AS",
af07d2b195d6add6909c4f64,When will patient 17953 next go to the hospital?,,SELECT patient.hospital_stay FROM patient WHERE patient.unique_patient_id = 17953 ORDER BY patient.hospital_stay DESC LIMIT 1,
19bbba7c30b65e559cde2364,Tell me the top four most frequent lab tests that patients were given during the same hospital encounter after being diagnosed with dependence on respirator [ventilator] status in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on respirator [ventilator] status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,
70fb08c9ae39f471ccb4c81a,Can you show me the top five most common procedures conducted?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.procedure, COUNT(t1.procedure) FROM procedures AS t1 JOIN results AS t2 ON t1.result = t2.result GROUP BY t1.procedure ORDER BY COUNT(t1.procedure) DESC LIMIT 5","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Central venous catheter placement with guidance'}, {'long_title': 'Coronary arteriography using two catheters'}, {'long_title': 'Other nonoperative respiratory measurements'}]"
d0bd21030a9fe3f066df09b3,Was patient 10022880 diagnosed with any type of disease in the last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10022880 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
06ba722e2ac0589ffacd1249,How many hours have elapsed since the last time on this hospital visit patient 10039831 received a lab test for creatinine?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_test_time)) FROM lab_tests WHERE lab_test_name = 'Creatinine' AND patient_id = 10039831 AND hospital_dischtime IS NULL ORDER BY lab_test_time DESC LIMIT 1;",[]
951e44d16291cab791c2b2dc,What was the drug that patient 10020740 was prescribed for within the same day after undergoing continuous invasive mechanical ventilation for less than 96 consecutive hours in 04/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug FROM (SELECT patient.subject_id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.subject_id WHERE patient.subject_id = 10020740 AND treatment.type = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' AND STRFTIME('%y-%m', treatment.date) = '2100-04') AS t1 JOIN (SELECT patient.subject_id, drug.drug FROM drug JOIN patient ON drug.patient_id = patient.subject_id WHERE patient.subject_id = 10020740 AND STRFTIME('%y-%m', drug.date) = '2100-04') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day')",
8f1e4140fd54d60a4a21a46e,What drug was first prescribed to patient 10021938?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient = 10021938 ORDER BY prescriptions.date NULLS FIRST LIMIT 1;,[{'drug': 'Senna'}]
6ec318a2ef73df94df5bdcae,Has any organism been found in patient 10007058's last microbiological serology/blood test in 11/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND microbiologyevents.spec_type_desc = 'serology/blood' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*) > 0 FROM microbiology WHERE microbiology.patient_id = 10007058 AND microbiology.date = '11/2100' AND microbiology.serology_blood = 'negative',[{'COUNT(*)>0': 0}]
dd2c47d5a140368a2b1f07a1,When was patient 10006053's last input during their last ICU visit?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,"SELECT STRFTIME('%Y-%m-%d %H:%M:%S', patient.input_time) AS input_time",[{'starttime': '2111-11-15 14:03:00'}]
f9f35588ccc8bc79535ff166,Give me the three most common treatments since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT treatment, YEAR(date) AS year FROM table1 WHERE YEAR(date) >= 2100) AS t1 GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 3",
956020fbb55b1050204ceebd,What's the name of the med that shouldn't be given during exc/dest hrt lesion open.,,SELECT name FROM medication WHERE NOT to_be_given_during_exercise = 'exc/dest hrt lesion open',
05708c73dfad0a3f4781563a,Could you count the number of times patient 10010471 visited the hospital?,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10010471,SELECT COUNT(DISTINCT visit_date) FROM hospital_visits WHERE patient_id = 10010471,[{'COUNT( DISTINCT admissions.hadm_id )': 2}]
1792bdbac4e9db2d02bb207a,Could you list the three diagnoses that had the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY t2.c1 DESC) AS c2 FROM (SELECT t1.diagnosis, 100 - SUM(CASE WHEN t1.deaths = 0 THEN 1 WHEN t2.days >= 30 THEN 1 ELSE 0 END) * 100 / COUNT(*) AS c1 FROM (SELECT t2.diagnosis, t2.days, COUNT(*) AS deaths FROM t2 WHERE t2.diagnosis = 'BLADDER CANCER/CHRONIC URETERIC SYNDROME' GROUP BY t2.diagnosis, t2.days) AS t1 JOIN (SELECT t2.diagnosis, 100 - SUM(CASE WHEN t2.days >= 30 THEN 1 ELSE 0 END) * 100 / COUNT(*) AS c1 FROM (SELECT t2.diagnosis, 100 - SUM(CASE WHEN t2.days >= 30 THEN 1 ELSE 0 END) * 100 /",
19aa80f1a14f42697fdcba60,What was the total ostomy (output) volume that patient 10018081 had since 11/30/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-30'",SELECT SUM(ostomy_(output)) FROM intake WHERE patient_id = 10018081 AND date >= '2100-11-30',[{'SUM(outputevents.value)': None}]
3e4e9c6556f0bae69a76633d,When did patient 10027602 last receive a blood culture microbiology test since 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(blood_culture_microbiology.date) FROM blood_culture_microbiology WHERE blood_culture_microbiology.patient_id = 10027602 AND STRFTIME('%y-%m', blood_culture_microbiology.date) >= '2100-07'",[]
9e13de1d202dab1dcf105976,"In the last hospital visit, what age was patient 10025463?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT MIN(age) FROM visit WHERE patient = 10025463 AND NOT is_dischtime IS NULL ORDER BY visit.admittime DESC LIMIT 1,
ab4e7468a6d2dfc3bdbc9ff6,Is patient 15821 having an appointment in another department?,,SELECT COUNT(*) > 0 FROM appointments WHERE appointments.patient_id = 15821 AND appointments.department_id <> (SELECT departments.department_id FROM departments WHERE departments.name = 'Cardiology'),
783bda443eb8e764428abb4d,"When has patient 10001217 last had the total protein, csf minimum value since 12/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MIN(protein_csf) FROM patients WHERE patient_id = 10001217 AND measurement_date >= '12/2100',[]
a2c56aa731442cc35b8f88dc,When has patient 10002495 been prescribed medication for the first time on the first hospital encounter via the iv route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1,,[]
9235d1bea2de86e8bfe34a29,Do you know the method of disinfection in the quarantine room?,,SELECT * FROM methods WHERE method_name = 'disinfection in the quarantine room';,
708d239b2f7785ac668db27a,What drug was the first drug prescribed for patient 10027445 since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10027445 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-05' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[{'drug': 'Ipratropium Bromide MDI'}]
48990ab07c7867ac45c57394,Tell me the top three most frequently tested specimens since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",SELECT top_three_species FROM (,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
b3b289b80bbadf3f9be2ebc4,What was the time it took for patient 14467 to undergo cv cath plcmt w guidance?,,SELECT cv_cath_plcmt_w_guidance(14467) FROM patients WHERE patient_id = 14467;,
c62c1e4f5598bb12f5d680d7,What was the last specimen test that was given to patient 10010471?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(specimen_test) FROM lab_data WHERE patient_id = 10010471;,[{'spec_type_desc': 'BLOOD CULTURE'}]
055c46f26772f5e92ff54ba1,What are the top four most frequent microbiology tests that patients were diagnosed with rheumatic disorders of both mitral and aortic valves in the same hospital encounter in 2100?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t4.Microbiology, COUNT(t4.Microbiology) FROM (SELECT t3.Microbiology, STRFTIME('%y', t3.Date) as MicrobiologyYear FROM (SELECT t2.Microbiology, t2.Date FROM (SELECT 'Aortic Valve' as Microbiology, STRFTIME('%y', t2.DiagnosisDate) as MicrobiologyYear FROM AorticValveDiagnoses t2 JOIN (SELECT PatientID, DiagnosisDate FROM RheumaticDisorders WHERE RheumaticDisorders.valveType = 'mitral') AS t3 ON t2.PatientID = t3.PatientID WHERE t2.Diagnosis = 'rheumatic disorders of both mitral and aortic valves') AS t4 WHERE STRFTIME('%y', t4.MicrobiologyYear) = '2100' GROUP BY t4.Microbiology ORDER BY COUNT(t4.Microbiology) DESC LIMIT 4",
ce7b67d7433c0b9c16be0a5f,Is the urea nitrogen value of patient 10002428 last measured on the first hospital visit less than the value from the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT urea_nitrogen FROM patients WHERE patient_id = 10002428 AND NOT date_dischtime IS NULL ORDER BY date_admittime NULLS FIRST LIMIT 1) < (SELECT urea_nitrogen FROM patients WHERE patient_id = 10002428 AND NOT date_dischtime IS NULL ORDER BY date_admittime NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
ab3ab99eb3d4c75a7da40497,When was the first time patient 10038081 had the minimum SaO2 on 10/13/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-13' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1","SELECT MIN(SaO2) FROM ""patient_10038081"" WHERE measurement_date = '10/13/2100'",[]
c35d03883eff2c60ecc563cf,How many patients in 2100 were prescribed bupivacaine 0.1%?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupivacaine 0.1%' AND strftime('%Y',prescriptions.starttime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date_prescribed FROM (SELECT subject_id, date_of_entry FROM patients WHERE date_of_entry BETWEEN '2100-01-01' AND '2100-12-31') AS t1 JOIN (SELECT subject_id, date_prescribed FROM prescriptions WHERE prescriptions.date_prescribed BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.subject_id = t2.subject_id WHERE t2.date_prescribed BETWEEN '2000-01-01' AND '2000-12-31' AND prescriptions.drug = 'Bupivacaine 0.1%')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d0d4ddd524dec4c4fd73c769,What is the patient count for midazolam prescription since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND STRFTIME('%y', prescriptions.start_date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e48106054f3e117d2fac314f,"Has albuterol 0.083% neb soln, sulfameth/trimethoprim ds, or furosemide been prescribed to patient 10000032 since 04/2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND prescriptions.drug IN ( 'albuterol 0.083% neb soln', 'sulfameth/trimethoprim ds', 'furosemide' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10000032 AND medication.date >= '04/2100' AND medication.drug IN ('albuterol 0.083% neb soln', 'sulfameth/trimethoprim ds', 'furosemide')",[{'COUNT(*)>0': 0}]
e365380a427eb3377fda91fe,When was first time the heart rate of patient 10027602 was greater than 63.0 during their first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM patient_10027602 WHERE patient_id = 10027602 AND NOT icu_start_date IS NULL ORDER BY icu_start_date NULLS FIRST LIMIT 1) WHERE heart_rate > 63.0,[]
f9926355acee735005a5866f,What are the five most frequent procedures for patients aged 60 or above since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.Procedure, COUNT(t1.Procedure) FROM (SELECT t1.Procedure, t1.Age FROM (SELECT Procedure, Age, DATE(CURRENT_DATE) - DATE(Birthdate) AS Age) AS t1 WHERE t1.Age >= 60) AS t2 WHERE t2.Procedure = t1.Procedure AND STRFTIME('%y', t1.Birthdate) >= '2100' GROUP BY t1.Procedure ORDER BY COUNT(t1.Procedure) DESC LIMIT 5",
a280ab4c51d6d7b334f1d575,Is the arterial blood pressure systolic level of patient 10018081 second measured on the current ICU visit less than first measured on the current ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT MIN(arterial_blood_pressure_systolic) FROM (SELECT arterial_blood_pressure_systolic FROM icu WHERE icu.patient_id = 10018081 AND icu.visit_number = 2) AS subquery) < (SELECT MIN(arterial_blood_pressure_systolic) FROM (SELECT arterial_blood_pressure_systolic FROM icu WHERE icu.patient_id = 10018081 AND icu.visit_number = 1) AS subquery),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
cea6be007be41bfc9fde406e,Could you fetch the top five most common specimens tested during this year for me?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM inventory WHERE year = YEAR(CURRENT_DATE) GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5;",[]
6a91b9dd415016e5b1793284,Can you tell which medicine was first prescribed to patient 10037861 via the neb method in their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'neb' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT medication.drug_name FROM medication WHERE medication.patient_id = 10037861 AND medication.prescription_method = 'neb' ORDER BY medication.prescription_date NULLS FIRST LIMIT 1;,[]
a9d61cc491cc934c6edf1a8c,"Compared to yesterday, what are the new prescriptions for patient 10018081 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescriptions FROM patients WHERE patient_id = 10018081 WHERE date = '2022-10-01',[]
9d3038ee311cade2b5621bce,What are the methods for taking metformin xr (glucophage xr)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'metformin xr (glucophage xr)',"SELECT DISTINCT ON (method) method, description FROM methods WHERE method LIKE '%metformin xr (glucophage xr)' ORDER BY method;",[]
4c5c196bc7d2b79d1ed73ecf,Has any medication been prescribed to patient 10020786 since 07/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'","SELECT COUNT(*) > 0 FROM medication_prescriptions WHERE medication_prescriptions.patient_id = 10020786 AND STRFTIME('%y-%m', medication_prescriptions.date) >= '2100-07'",[{'COUNT(*)>0': 1}]
8ad9e925a3bc2f9da4940ed1,"How many times was a excision of left main bronchus, via natural or artificial opening endoscopic procedure done during the last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'excision of left main bronchus, via natural or artificial opening endoscopic procedure' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",
764bf48effd7c27c0d7ddc70,Provide the sum total of inputs for patient 10011398 since 03/22/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-22'","SELECT SUM(input) FROM (SELECT input FROM read_csv_auto('patient_10011398_input.csv', timestampformat='%m/%d/%Y') WHERE timestamp >= '03/22/2100')",[{'SUM(inputevents.totalamount)': 12080.0}]
4ae4d8179801e38d38744603,What are the three most frequent procedures for patients who are in their 50s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,
02cf1de606c045cf18e72370,What does it cost to get esophageal obstruction diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal obstruction' ) ),SELECT SUM(cost) FROM brackets WHERE diagnosis = 'esophageal obstruction',
1dea4d1c505f3a5797f16236,When did patient 10038999 have the last SaO2 to be less than 99.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 99.0 ORDER BY chartevents.charttime DESC LIMIT 1,"SELECT SAO2 FROM read_brackets('patient_10038999', 'SAO2') WHERE SAO2 < 99.0",[]
5e33fcec4342525311fca4cc,"When was the last time the respiratory rate of patient 10018081 was greater than 21.0, on this ICU visit?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 21.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(timestamp) FROM respiratory_rate WHERE patient_id = 10018081 AND respiratory_rate > 21.0,[]
926dd0924833df1c1df58531,What is the minimum hospital cost to include a drug called nicotine polacrilex since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nicotine polacrilex' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(hospital_cost) FROM brackets WHERE drug_name = 'nicotine polacrilex' AND year >= 2100,
8ad38d6021157f461e8be73d,What is the list of things to do before you go through the incision of mediastinum procedure?,,SELECT * FROM procedures WHERE name = 'incision of mediastinum';,
d78eee745ce372a0b010f81a,When did patient 10038999 first have a swab microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'swab' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT MIN(lab_date) FROM lab WHERE lab_type = 'swab' AND patient_id = 10038999,[]
8ab3e1bbd488c2eaae721412,Show me the top five most common treatments for patients aged 50s since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment, t2.age FROM (SELECT treatment, age FROM patients WHERE age BETWEEN 50 AND 59) AS t1 JOIN (SELECT patient_id, age FROM patients WHERE age BETWEEN 50 AND 59) AS t2 ON t1.patient_id = t2.patient_id WHERE t2.age >= 50 AND DATETIME(t2.age) >= DATETIME(CURRENT_TIME, '-1 year')) AS t3 GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 5",
617a17c6fecd772da2fb9fb1,When did the first discharge from the hospital happen for patient 10012853?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(dischtime) FROM patient WHERE patient.subject = 10012853,[{'dischtime': '2175-04-10 16:55:00'}]
19971ad86aeae49201fc7a93,"What are the four most commonly prescribed medications for patients diagnosed with monoclonal gammopathy previously within the same month, throughout this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'monoclonal gammopathy' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'MONOCLONAL GAMMOPATHY') AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.uniquepid WHERE DATETIME(medication.medication_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_date, 'start of month') GROUP BY t2.name) AS t3 WHERE t3.c1",
cece63fb84d3cf5a6e97cb83,What is the name of the treatment given to patient 10007795 two times on the first hospital stay?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT t1.treatment_name FROM (SELECT treatment_name, COUNT(treatment_date) AS c1 FROM treatment WHERE patient_id = 10007795 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1) AS t1 WHERE t1.c1 = 2",
7c37ccb48483a3d417233092,Is patient 10018501's mcv last measured on the first hospital visit greater than the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 ),,"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
9e4d892692bac7261d1c86af,"What is the code which is assigned to icd-11, to referring to legal blindness-usa def that occurs in icd-10?",,"SELECT icd_11 FROM legal_blindness_usa WHERE icd_10 = ""DEF456"";",
b83e75dcbb1f8cc1a0718f8a,"What are the five most frequently administered laboratory tests for patients previously diagnosed with methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere in the same month, in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.month, COUNT(t3.month) FROM (SELECT t2.month, t2.patient_id FROM (SELECT t1.patient_id, t1.diagnosis_date FROM (SELECT ""patient_1"" AS patient_id, ""2021-01-01"" AS diagnosis_date FROM grades WHERE grade = 'methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere') AS t1 GROUP BY t1.patient_id HAVING COUNT(*) > 1) AS t2 JOIN (SELECT t1.patient_id, t1.month FROM (SELECT ""patient_1"" AS patient_id, ""2021-01-01"" AS month FROM grades WHERE grade = 'methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere') AS t1 GROUP BY t1.patient_id HAVING COUNT(*) > 1) AS t3 ON t2.patient_id = t3.patient_",
d2f1256d39dcc2e6a1fea9cc,When was the first time the respiratory rate of patient 10020187 registered less than 20.0 on 02/03/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 20.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-02-03' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(respiratory_rate) FROM respiratory_rate WHERE patient_id = 10020187 AND measurement_date = '2100-02-03' AND respiratory_rate < 20.0,[]
ff7b7029d2eb43d96f2ee688,What drug was the first drug prescribed for patient 10019172 in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriber.drug FROM prescriber WHERE prescriber.patient_id = 10019172 AND STRFTIME('%y-%m', prescriber.date) = '2100-11' ORDER BY prescriber.date NULLS FIRST LIMIT 1;",[]
6daaebd1833641ba81afc130,Get me patient 10004733's total gt flush input amount since 09/09/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-09'",SELECT SUM(GtFlush) FROM patient WHERE PatientId = 10004733 AND GtFlushDate >= '2100-09-09',[{'SUM(inputevents.totalamount)': None}]
a14cb4f846f35ff7611f1dbc,List the top three most frequent lab tests since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t.lab_test, COUNT(t.lab_test) AS lab_count","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
a00e9493a4dac3d8a11100c3,When was the last blood culture microbiology test performed during the previous month for patient 10027602?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MICROBIOLOGY_DATE FROM microbiology_data WHERE MICROBIOLOGY_TYPE = 'blood culture' AND MICROBIOLOGY_DATE = (SELECT MICROBIOLOGY_DATE FROM microbiology_data WHERE MICROBIOLOGY_TYPE = 'blood culture' AND MICROBIOLOGY_DATE = (SELECT MAX(MICROBIOLOGY_DATE) FROM microbiology_data WHERE MICROBIOLOGY_TYPE = 'blood culture' AND MICROBIOLOGY_ID IN (SELECT MICROBIOLOGY_ID FROM microbiology_data WHERE MICROBIOLOGY_TYPE = 'patient' AND MICROBIOLOGY_ID = 10027602)) - INTERVAL '1 month'),[]
408a90b2c2390990c83c0be0,When was the last time patient 32592 had a medication which should be regularly taken?,,SELECT MAX(date_submitted) FROM medication_reminders WHERE patient_id = 32592 AND frequency = 'regular';,
f5b7b1f39d3f36c2baf21b63,Can you tell me the last recorded weight for patient 10010471 since 27 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-27 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT last_recorded_weight FROM patients WHERE patient_id = 10010471 AND DATETIME(last_recorded_weight) >= DATETIME(CURRENT_TIME, '-27 month')",[]
e7626ed5099c3df4e2766996,"Since 29 months ago, what was the last recorded weight for patient 10013049?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-29 month') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(weight) FROM patients WHERE patient_id = 10013049 AND measurement_date >= '2029-01-01',[]
6496ef7a5d347a3e46d2bec0,Could you list the five most frequently prescribed medicines within the same hospital visit after a diagnosis of unspecified acquired hypothyroidism was made in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.had_diagnosis FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""UNOBTAINABLE ACHYLOID"" AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100') AS t1 JOIN (SELECT admissions.subject_id, medicines.name, medicines.date_prescribed FROM medicines JOIN admissions ON medicines.admission_id = admissions.admission_id WHERE STRFTIME('%y', medicines.date_prescribed) = '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.date_prescribed AND DATETIME(t1.diagnosis_date) BETWEEN DATETIME(t2.date",
131676838dec830d875d80ad,Retrieve the top five most common diagnoses for patients with age 30s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT diagnosis, age FROM patients WHERE age BETWEEN 30 AND 39 YEAR TO SEA) AS t1 GROUP BY t1.diagnosis ORDER BY COUNT(t1.diagnosis) DESC LIMIT 5",
b2506d21f50185686a959e38,Count the number of times that other incision of brain was performed.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ),SELECT COUNT(*) FROM procedures WHERE procedures.name = 'other incision of brain',[{'COUNT(*)': 0}]
b587cd8c1c145a6a99b52e8e,What precautions should be taken after a rt heart angiocardiogram procedure?,,SELECT * FROM post_procedures WHERE procedure = 'rt heart angiocardiogram';,
f301f472f3dfd88f91cb2316,How many hospitalized patients do we currently have?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE hospitalized = true;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
39881273c6b26ba01d54e3ee,"For the first time since 07/2100, what specimen test did patient 10038992 get?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_test FROM patients WHERE patient_id = 10038992 AND date_of_first_specimen_test >= '2000-07-2100',[{'spec_type_desc': 'BLOOD CULTURE'}]
79fe38dca4831802e82026a6,Has patient 10025612 taken a packed red blood cells drug in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*) FROM packed_red_blood_cells WHERE patient_id = 10025612 AND date_packed = DATEADD(year, -1, DATEADD(month, 12, CURRENT_DATE))",[{'COUNT(*)>0': 0}]
6b2bc626482c4ebd317ba6ea,"Since 2100, what was patient 10012552 diagnosed with for the last time?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",SELECT diagnosis FROM patients WHERE patient_id = 10012552 AND year >= 2100 ORDER BY year DESC LIMIT 1,
f5ddb5194586e227ab8610fc,I would like to know what dr. reeves's on today's outpatient schedule.,,SELECT * FROM duckdb_schedule WHERE employee_id = (SELECT employee_id FROM duckdb_employees WHERE employee_name = 'dr. reeves') AND schedule_type = 'outpatient' AND date = 'today';,
a790bd7026f83ac5ff0e68c1,What would the minimum monthly number of patients diagnosed with resistance to other specified antimicrobial drug be in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'resistance to other specified antimicrobial drug' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",SELECT MIN(monthly_number_of_patients) FROM patients WHERE antimicrobial_drug_resistance = 'other' AND year = 2100,
5f2be37c9bd6389d80599c5f,"How many patients were diagnosed with other diseases of bronchus, not elsewhere classified in 2100 after already being diagnosed with unspecified convulsions during the same month?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified convulsions' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_month FROM (SELECT subject_id, diagnosis_date AS diagnosed_month FROM diagnoses WHERE diagnosis = 'other diseases of bronchus, not elsewhere classified') AS t1 JOIN (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'unspecified convulsions') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_month = t2.diagnosis_date AND STRFTIME('%y', t1.diagnosed_month) = '2100'",
425004d751172cad53c3ad6b,Do you know what type of blood patient 1903 has?,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 1903;",
ddcee3c0f498777f0ac3fe7c,Calculate the total volume of patient 10026354's input since 03/22/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-22'",SELECT SUM(volume) FROM intake WHERE patient_id = 10026354 AND date >= '2100-03-22',[{'SUM(inputevents.totalamount)': 7100.0}]
b947843285099f2f901cf7de,How many hours has it been since patient 10018081's last chloride lab test during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result.lab_time)) FROM lab_result WHERE lab_result.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.patient_name = '10018081') AND lab_result.lab_name = 'chloride' AND patient.hospital_location = 'current hospital' ORDER BY lab_result.lab_time DESC LIMIT 1;",[]
c905e6677e0cbf329230ebf2,Is patient 14054 subject to tests to determine if he has covid-19.,,SELECT COUNT(*) > 0 FROM covid_tests WHERE patient_id = 14054,
bcc21d5d3111f89ef9a098f9,What were the top four diagnoses that had the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT diagnosis, 6-month\nmetrics/case FROM (SELECT diagnosis, 6-month\nmetrics/case, percentile_cont(0.25) WITHIN GROUP (ORDER BY 6-month\nmetrics/case) OVER (PARTITION BY diagnosis) AS t4 FROM (SELECT diagnosis, 6-month\nmetrics/case, percentile_cont(0.25) WITHIN GROUP (ORDER BY 6-month\nmetrics/case) OVER (PARTITION BY diagnosis) AS t3 FROM (SELECT diagnosis, 6-month\nmetrics/case FROM (SELECT diagnosis, 6-month\nmetrics/case, percentile_cont(0.25) WITHIN GROUP (ORDER BY 6-month\nmetrics/case) OVER (PARTITION BY diagnosis) AS t2 GROUP BY diagnosis) AS t1) AS t4 JOIN (SELECT diagnosis FROM (SELECT diagnosis, 6-month\nmetrics/case, percentile_cont(0.25) WITHIN GROUP (ORDER BY 6-month\nmetrics",
76898a2087c25f36caa4339c,What was the last output since 06/24/2100 for patient 10016742?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-24' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT LAST_OUTPUT(DD(DATE '2100-06-24')) FROM patients WHERE patient_id = 10016742;,[{'label': 'Foley'}]
b64c62eb05aaad4071af83a7,What is the common method for taking lorazepam?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lorazepam',"SELECT DISTINCT ON(method) method, name FROM drugs WHERE name = 'lorazepam' AND common_method = 'true';","[{'route': 'PO/NG'}, {'route': 'PO'}, {'route': 'TP'}, {'route': 'ORAL'}]"
274367d1fab86c9296ee0ceb,How much is the average total hospital bill when it includes a tobramycin lab test since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(h.c1) AS c1 FROM (SELECT h.c1 FROM (SELECT 1 AS c1 FROM lab_data h WHERE h.lab_name = 'tobramycin') AS t1 JOIN (SELECT p.t1.c1 FROM (SELECT 1 AS c1 FROM patient p WHERE p.age BETWEEN 18 AND 30) AS t2 ON t1.c1 = t2.c1) AS t3 JOIN (SELECT h.c1 FROM (SELECT 1 AS c1 FROM hospital h WHERE h.year BETWEEN 2100 AND 2010) AS t4 ON t3.c1 = t4.c1),
3f49eeea52db301754082dc6,What were the first troponin t results for patient 10007818 in their last hospital encounter?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT MIN(Troponin_T) FROM (SELECT Troponin_T FROM ""troponin_t"" WHERE ""Patient_ID"" = 10007818 AND NOT ""Hospital_Dischtime"" IS NULL ORDER BY ""Hospital_Admittime"" DESC LIMIT 1)",[]
73d71dd48759ebd3e31a1e91,How many patients had been diagnosed with unspecified place in hospital as the place of occurrence of the external cause?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified place in hospital as the place of occurrence of the external cause' ) ),"SELECT COUNT(DISTINCT diagnosis_id) FROM diagnosis WHERE diagnosis_place = ""UNOBTAINABLE/NOT SPECIFIED"" AND external_cause = ""YES""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
fba8a54ba42e25b3a395f35b,"Did patient 10002495 have a irrigation of genitourinary tract using irrigating substance, via natural or artificial opening procedure on the first hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) > 0 FROM irrigation_details WHERE irrigation_details.patient_id = 10002495 AND irrigation_details.irrigation_location = 'genitourinary tract using irrigating substance, via natural or artificial opening procedure'",[{'COUNT(*)>0': 0}]
ad18efa8d9a3881fbc51b4ea,What was the name of the organism found in the first microbiology test conducted on patient 10021487's bronchoalveolar lavage since 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10021487 AND sample_type = 'bronchoalveolar lavage' AND date(date_of_sample) >= '05/2100' ORDER BY date(date_of_sample) NULLS FIRST LIMIT 1,[]
8c021f1784d97cc1eb00efeb,What did patient 10038081 first have as output since 10/04/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime ASC LIMIT 1 )",,[{'label': 'Oral Gastric'}]
9f63970e733b63fae113c2a8,"What are the three commonly given procedures for patients that also received ultrasonography of superior vena cava, guidance previously in the same hospital encounter, this year?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ultrasonography of superior vena cava, guidance' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t1.treatment FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatment = 'Commonly given procedures for patients that also received ultrasonography of superior vena cava, guidance' AND DATETIME(treatment.treatmenttime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatment = 'Commonly given procedures for patients that also received ultrasonography of superior vena cava, guidance' AND DATETIME(treatment.treatmenttime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.treatmenttime",
963d648d770fcb43743e09b4,What are the three most common treatments for patients who are 30s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.treatment, t2.age FROM (SELECT treatment, age, year FROM patients WHERE year >= 2100) AS t1 JOIN patients AS t2 ON t1.patient = t2.patient) AS t3 GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 3",
c89cf055a5d102b539366869,How many hours has it been since the last time patient 10021487 stayed during this hospital encounter in the careunit emergency department?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.hospitalstay.admittime)) FROM patient WHERE patient.uniquepatientid = 10021487 AND patient.hospitalstay.dischtime IS NULL AND patient.careunit.unitname = 'emergency department'",[]
b9bcd099d5f42ea75aca129e,How is readi-cat 2 (barium sulfate 2% suspension) typically taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)',SELECT AVG(read_count) FROM read_table WHERE read_type = 'brackets' AND table_name = 'readi-cat 2 (barium sulfate 2% suspension)',[]
623f6b6f64fea20e0be94ac5,What was the time of patient 10006053's first peritoneal fluid microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(peritoneal_fluid_microbiology_date) FROM microbiology WHERE patient_id = 10006053 AND peritoneal_fluid_microbiology_date >= '2003-02-2100',[]
0f5988ac990c3b052bc99527,Is there any new medication in the prescription of patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT COUNT(*) > 0 FROM prescription WHERE prescription.patient_id = 10039831 AND DATETIME(prescription.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescription.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
a437096bd6ca61f03b95d62a,What was the name of the medicine that was given to patient 10005817 in the same hospital encounter post procedure of extracorporeal circulation auxiliary to open heart surgery since 29 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-29 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-29 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.name FROM (SELECT patient.uniquepid, treatment.treatmentdate, patient.patientname FROM treatment JOIN patient ON treatment.patient = patient.uniquepid WHERE patient.patientname = '10005817' AND treatment.treatmenttype = 'post procedure of extracorporeal circulation auxiliary to open heart surgery' AND DATETIME(treatment.treatmentdate) >= DATETIME(CURRENT_TIME, '-29 month')) AS T1 JOIN (SELECT patient.uniquepid, medication.name FROM medication JOIN patient ON medication.patient = patient.uniquepid WHERE patient.patientname = '10005817' AND DATETIME(medication.medicationdate) >= DATETIME(CURRENT_TIME, '-29 month')) AS T2 ON T1.uniquepid = T2.uniquepid WHERE T1.treatmentdate < T2.medicationdate AND T1.patientname = T2.patientname",
97d26f029a5f2f8e475529e6,What is patient 10026354's difference in respiratory rate from the last value measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10026354 AND NOT icu_visit IS NULL ORDER BY icu_visit DESC LIMIT 1) - (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10026354 AND NOT icu_visit IS NULL ORDER BY icu_visit DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
253143bdf2322f6137ab6d66,Can you confirm what was the first arterial blood pressure mean for patient 10039831 since 01/16/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-01-16' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT AVG(arterial_blood_pressure) FROM blood_pressure WHERE patient_id = 10039831 AND date_since = '2100-01-16',[]
e52d7f0f71c5a96d3ad444d8,How long did it take to get venous cath nec for patient 31854?,,SELECT COUNT(DISTINCT venous_cath_nec) FROM procedures WHERE patient_id = 31854;,
521083ecdc8d7be6649f758c,"What is the hospital's average total cost that involves a procedure called implantation or replacement of carotid sinus stimulation device, total system since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",SELECT AVG(T1.c1) FROM (SELECT SUM(T2.c2) AS c1 FROM (SELECT T3.c2 FROM (SELECT 3 AS c2) AS T3 JOIN (SELECT 1 AS c1 FROM TIMESTAMP '2022-01-01 00:00:00' - INTERVAL '1 year') AS T4 ON T3.c4 = T4.c4) AS T2 JOIN (SELECT 1 AS c1 FROM TIMESTAMP '2022-01-01 00:00:00' - INTERVAL '1 year') AS T5 ON T2.c5 = T5.c5) AS T1,
e12e998b1f9c18fea1f85d8f,How much does it cost to purchase syringe (0.9% sodium chloride)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'syringe (0.9% sodium chloride)' ),"SELECT ""Price (CAD)"" FROM ""Syringe (0.9% Sodium Chloride)""",
19d8f43d4364b3abf853cd5a,When was the last time patient 10023117 had an minimum bicarbonate in the first hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1","SELECT MAX(bicarbonate) FROM ""patient"" WHERE ""patient"" IS NOT NULL AND ""date"" = (SELECT ""date"" FROM ""patient"" WHERE ""patient"" = 10023117 AND NOT ""dischtime"" IS NULL ORDER BY ""date"" NULLS FIRST LIMIT 1)",[]
231d73add777a1a3ca6f2873,How many patients were given methocarbamol since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methocarbamol' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.patient_birth_year >= 2100 AND patient.patient_name = 'Methocarbamol',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ff6ae54dadd27c88cff99254,What are the top four most frequent procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.procedure, COUNT(t4.procedure) FROM (SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, COUNT(t2.procedure) FROM (SELECT t1.procedure, COUNT(t1.procedure) FROM (SELECT 'overall' AS procedure, COUNT(1) AS cnt FROM (SELECT procedure, cnt FROM procedures WHERE procedure = 'overall') AS t1 GROUP BY t1.procedure) AS t2 GROUP BY t2.procedure) AS t3 GROUP BY t3.procedure) AS t4 WHERE t4.cnt >= (SELECT MIN(cnt) FROM (SELECT 'overall' AS procedure, COUNT(1) AS cnt FROM (SELECT procedures.procedure, procedures.cnt FROM procedures WHERE procedures.procedure = 'overall') AS t1 GROUP BY t1.procedure) AS t2 GROUP BY t2.procedure) GROUP BY t4.procedure ORDER BY t4.cnt DESC LIMIT 10",
1e9722d883ec34d867a344f9,How much was the difference in respiratory rate of patient 10004422 measured at 2100-01-25 18:00:00 compared to the value measured at 2100-01-25 17:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 18:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 17:00:00' ),SELECT (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10004422 AND measurement_time = '2100-01-25 18:00:00') - (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10004422 AND measurement_time = '2100-01-25 17:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 18:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 17:00:00' )"": None}]"
1d5c66901760c1bfc6eb5361,"Today compared to yesterday, what new drugs are being prescribed to patient 10039831?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT date_sub('day', CURRENT_TIMESTAMP, TIMESTAMP '2022-01-01 00:00:00') FROM duckdb_prescriptions WHERE patient_id = 10039831;",[]
77f1caca4c8a38d1fe942703,The value of metamyelocytes of patient 10002495 was last measured on the last hospital visit greater than second to last measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10002495 AND lab_data.label = 'metamyelocytes' ORDER BY lab_data.measurement_date DESC LIMIT 1) > (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10002495 AND lab_data.label = 'metamyelocytes' ORDER BY lab_data.measurement_date DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
66e4509cc3f44d918845b252,"On the last ICU visit, did patient 10016742 have any input of gastric meds?",SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM icu_inputs WHERE icu_inputs.patient_id = 10016742 AND icu_inputs.input_type = 'gastric meds' AND DATETIME(icu_inputs.input_date) = DATETIME(SELECT MAX(DATETIME(icu_visits.visit_date)) FROM icu_visits WHERE icu_visits.patient_id = 10016742),[{'COUNT(*)>0': 0}]
fd369ed514a6f2c485af417b,"When was the last time that patient 10018081 had the calcium, total minimum value during this hospital encounter?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1","SELECT MAX(Calcium, Total) FROMBrackets WHERE PatientID = 10018081 AND EncounterID = 1",[]
d5e0cf8341d186a59aa14536,"Tell me the minimum total cost of a hospital that involved chronic ischemic heart disease, unspecified since 2100.","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic ischemic heart disease, unspecified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM chronic_ischemic_heart_disease, hospital WHERE chronic_ischemic_heart_disease.hospital = hospital.hospital_id AND STRFTIME('%y', hospital.hospital_id) >= '2100' GROUP BY hospital.hospital_id) AS t1",
15a0bb3f4f2f12a28f041dd2,Tell me patient 10027602's total gastric meds input amount.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ),SELECT SUM(gastric_meds) FROM patients WHERE patient_id = 10027602,[{'SUM(inputevents.totalamount)': None}]
0814561e80d18ee7b5e8e214,"In 04/2100, when was the last time that patient 10007795 was prescribed medication via the po/ng route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM medication WHERE patient_id = 10007795 AND route = 'po/ng' AND date_prescribed BETWEEN '2004-01-01' AND '2004-12-31',[]
af2c16c562788b5087cb46cf,When was the first time that patient 10016150 has been prescribed acetaminophen and glucagon at the same time in 05/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT COUNT(DISTINCT t1.when) FROM (SELECT patient_id, prescription_start_date FROM prescriptions WHERE prescription_name = 'acetaminophen' AND patient_id = 10016150) AS t1 JOIN (SELECT patient_id, prescription_start_date FROM prescriptions WHERE prescription_name = 'glucagon' AND patient_id = 10016150) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.prescription_start_date < t2.prescription_start_date AND DATETIME(t1.prescription_start_date, 'start of year') = DATETIME(t2.prescription_start_date, 'start of year') AND STRFTIME('%m', t1.prescription_start_date) = '05'",[]
6897e02993c3a8b24377556b,Has patient 9241 ever had any complication when undergoing a blood transfusion?,,"SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 9241 AND diagnoses.complication = ""Blood transfusion""",
e9de88c1ca4e544ff64bd3f9,"What is the total number of days that have passed since patient 10021487's first bilirubin, total, body fluid lab test during this hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, body fluid' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT COUNT(DISTINCT t1.c1) FROM (SELECT date_diff('day', lab.result_date, current_date) AS c1 FROM lab WHERE lab.patient_id = 10021487 AND lab.result_type = 'Bilirubin, Total, Body Fluid') AS t1",[]
fb62db48ad7712c787e1d173,Tell me the dose of the prescribed opioid for patient 90019?,,SELECT SUM(dose) FROM prescriptions WHERE prescriptions.patient = 90019 AND prescriptions.drug = 'opioid',
14e43b77aa10ac246694f9f5,What was the last hospital discharge time for patient 10029484?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10029484 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_dischtime) FROM patient WHERE patient_id = 10029484;,[]
cd6cb8495bf452c344f61955,When was the first time that on their first hospital visit patient 10026255 had the maximum of platelet count?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT MAX(platelet_count) FROM (SELECT platelet_count FROM patient_10026255 WHERE NOT patient_10026255.hospital_dischtime IS NULL ORDER BY patient_10026255.hospital_admittime NULLS FIRST LIMIT 1),[]
b6d5c0f90ce664eba9acb6bf,"Among patients diagnosed with unspecified viral hepatitis c without hepatic coma, what are the top three most common lab tests conducted in the same month in this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c without hepatic coma' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'unspecified viral hepatitis c without hepatic coma' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, lab_test.lab_test, lab_test.lab_test_date FROM lab_test JOIN patient ON lab_test.patient_id = patient.patient_id WHERE DATETIME(lab_test.lab_test_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.lab_",
f9c16377338fec42f126a765,What is patient 10019568's maximum value of magnesium during the first hospital encounter?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ),SELECT MAX(magnesium) FROM patients WHERE patient_id = 10019568 AND NOT patient_hospital_info.current_hospital_number IS NULL ORDER BY patient_hospital_info.hospital_admit_date NULLS FIRST LIMIT 1;,[{'MAX(labevents.valuenum)': None}]
db710bbbad258467ce5d73b8,What was the name of the specimen given to patient 10011398 for the first time in the last hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT specimen_name FROM visit_history WHERE patient_id = 10011398 AND NOT visit_history.hospital_dischtime IS NULL ORDER BY visit_history.hospital_admittime DESC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}]
af98aa24749ee692f69ef110,"Since 1 month ago, what was patient 10021118's last weight measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT patient.weight FROM patient WHERE patient.patient_id = 10021118 AND DATETIME(patient.weight_date) >= DATETIME(CURRENT_TIME, '-1 month') ORDER BY patient.weight_date DESC LIMIT 1",[]
1b93bd516c9f2988ad2965d8,"In total, what was the input amount of packed red blood cells that patient 10008454 received on 12/04/this year?","SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-04'",SELECT SUM(packed_red_blood_cells) FROM input WHERE patient_id = 10008454 AND date = '12/04/2021',[{'SUM(inputevents.totalamount)': None}]
0f0a1891025fdcedc7e8ea0d,Tell me the name of the specimen test that patient 10000032 first received since 07/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT specimen_test, date_received FROM specimen_table WHERE patient_id = 10000032 AND date_received >= '07/2100' ORDER BY date_received NULLS FIRST LIMIT 1",[{'spec_type_desc': 'URINE'}]
b46dbc1a0b8589b45641e9db,What was the first time that patient 10008287 had the maximum value of calculated total co2 since 01/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT MAX(calculated_total_co2) FROM patient_co2 WHERE patient_id = 10008287 AND measurement_date >= '01/2100',[]
f782fdf63ed4c6c75950ea24,What was the name of the drug that was last prescribed to patient 10007818 through the iv bolus route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'iv bolus' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM iv_bolus WHERE patient_id = 10007818,[]
aaa971c7a88d9bf7858d0200,So how many days have passed since patient 10004733's last bacteremia diagnosis in the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = 'bacteremia' AND patient_id = 10004733 AND hospital_dischtime IS NULL",
612351f75cf9c16873706c46,Show me the total amount of patient 10039831's output since 05/30/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-30'",SELECT SUM(output) FROM 'patient10039831' WHERE date >= '2100-05-30';,[{'SUM(outputevents.value)': 6680.0}]
62d9af32c3698f6545567c3e,"During the last year, was patient 10025612 diagnosed with any disease?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,
cb7b80bbdfdc960e82ea8bf3,What precautions should i take after a pros repair atria def-cl procedure?,,"SELECT * FROM procedures WHERE procedure = ""Pros Repair Atria Def-Cl""",
c6af3f026c0e32b6e92878fe,When did patient 10007928 first receive a lab test for urea nitrogen on their first hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT lab.result_date FROM lab WHERE lab.patient_id = 10007928 AND lab.lab_name = 'urea nitrogen' ORDER BY lab.result_date NULLS FIRST LIMIT 1;,[]
ecbc2ee919ccc6a0dea03692,"What are the top four most frequent medications prescribed within 2 months to the patients in their 60 or above after they were diagnosed with alcohol abuse, unspecified?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t4.name FROM (SELECT t3.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'ALCOHOL ABUSE, UNKNOWN') AS t1 JOIN (SELECT patient.name, medication.name, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.patient_id WHERE patient.age >= 60) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t2.medication_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t3.name) AS t4 WHERE t4.c1 <= 4",
f719a14ae6e71d9f9de23e63,When was the first time that patient 10021487 was tested for red blood cells in 12/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.charttime ASC LIMIT 1","SELECT 12 AS _month, 2002 AS _year FROM lab_results WHERE lab_results.patient_id = 10021487 AND lab_results.result_type = 'red blood cells'",[]
4cb5de3e5bd12beac4b15b14,Tell me the total output since 04/03/2100 for patient 10012552.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-03'","SELECT COUNT(*) FROM ""output"" WHERE ""patient_id"" = 10012552 AND ""date"" >= '2100-04-03'",[{'SUM(outputevents.value)': 8408.0}]
4e6dcd007988152470193f41,What was the total number of patients staying in med/surg in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y',transfers.intime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE location = 'med/surg' AND stay_year = 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
085c8ca9cb97ef04b07e9465,Was there a genetic test that patient 76494 received?,,"SELECT COUNT(*) > 0 FROM received_tests WHERE patient_id = 76494 AND test_category = ""genetic""",
53b8eec71a9ed17879d3e723,When was the last time that during their last hospital encounter patient 10037928 had the maximum of eosinophils?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(eosinophils) FROM patient WHERE patient.name = '10037928' AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1;,[]
dc198d4ae3abb990cb9902e1,Name the three most frequently prescribed drugs during the same hospital encounter following a diagnosis of acute and subacute necrosis of liver during this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Acute and subacute necrosis of liver"" AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, drugs.drug, drugs.drug_date FROM drugs JOIN admissions ON drugs.admission_id = admissions.admission_id WHERE DATETIME(drugs.drug_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date",
07c2cabe27d018ef8bc90ed3,How many people got prescriptions for adde since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'adde' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.had_prescriptions = 'true' AND patient.prescriptions_since > 2100 AND patient.prescriptions_since < 2100 + INTERVAL '10 year' AND patient.subject = 'ADDE',[{'COUNT( DISTINCT admissions.subject_id )': 1}]
f9006233824c9919f64e41e9,When was patient 10001217's first maximum l value during their last hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT MIN(l) FROM ""patient"" WHERE patient_id = 10001217 AND NOT patient.hospital_id IS NULL ORDER BY patient.hospital_admission_date DESC LIMIT 1",[]
28bf2891ea69cdd52915b657,"Among patients who took respiratory ventilation, greater than 96 consecutive hours in 2100, what are the top three most frequent diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, treatment.start_time FROM treatment JOIN patient ON treatment.patient_id = patient.subject_id WHERE treatment.treatment_type = 'respiratory ventilation, greater than 96 consecutive hours in 2100') AS t1 JOIN (SELECT patient.subject_id, diagnosis.diagnosis, diagnosis.start_time FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE DATETIME(diagnosis.start_time, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-2 month')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.start_time < t2.start_time AND DATETIME(t2.start_time, 'start of month') BETWEEN DATETIME(t1.start_time, 'start of month') AND DATETIME(t1.start",
11cc0c3c5ddde55f2933b0a4,Calculate patient 10020740's total amount of foley output on their last ICU stay.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ),SELECT SUM(output) FROM (SELECT foley AS output FROM icu WHERE icu.patient_id = 10020740 AND NOT icu.outgoing IS NULL ORDER BY icu.incoming DESC LIMIT 1),[{'SUM(outputevents.value)': None}]
6e78d418898692d8783374c7,Have any lab tests been performed on patient 10026406?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ),SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10026406,[{'COUNT(*)>0': 1}]
5d8d3d9c0e88b7b656bc2f3e,List the top five most common diagnoses in this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses WHERE date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 5",
2ac19b54bada84606ebec21c,How many patients in 2100 were prescribed docusate?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'docusate' AND strftime('%Y',prescriptions.starttime) = '2100' )",SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.prescriptions.docusate IN (2100),[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f08251f8b3dd5a479060e87b,"Since 12/2100, how much did patient 10015931 weigh during the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MAX(patient_weight) FROM patient_weight WHERE patient_id = 10015931 AND measurement_date >= '2012-10-21',[]
de873dcbb588ef6ce9ad305d,What was the name of the insurance used for patient 10000032 in their first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT name FROM insurances WHERE insurance_id = (SELECT insurance_id FROM hospital WHERE patient_id = 10000032 ORDER BY hospital.hospital_date NULLS FIRST LIMIT 1);,[{'insurance': 'Other'}]
a4ca81eaa8eb676b5fdfee3b,When did patient 10021487 first have a maximum mean blood pressure on this month/22?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '22' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT date_trunc('month', CURRENT_DATE) - INTERVAL '22 month' AS month_22_ago, MAX(mean_blood_pressure) FROM patient_10021487 WHERE mean_blood_pressure IS NOT NULL GROUP BY month_22_ago ORDER BY month_22_ago NULLS FIRST LIMIT 1",[]
11e5506de71d3706a53ac1ab,What was the organism found in the first blood culture test of patient 10038999?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT organism FROM blood_culture_findings WHERE patient_id = 10038999 AND NOT organism IS NULL ORDER BY finding_date NULLS FIRST LIMIT 1;,[]
b472d5763672be20763ee562,"During the previous year, was patient 10020187 to an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(*) FROM (SELECT patient_id FROM admit WHERE admitting_date = (SELECT admitting_date FROM admit WHERE patient_id = 10020187) - INTERVAL '1 year') AS previous_year_admissions WHERE admitting_location = 'emergency room admit',[{'COUNT(*)>0': 0}]
4c475fcaf3bf16551e866c3c,"What were the top five most frequent diagnoses since 1 year ago with which patients were diagnosed after receiving extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic during the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' AND DATETIME(treatment.treatmentdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t1.treatmentdate, 'start of month') = DATETIME(t2.diagn",
e50069b13140ebddc5f39a48,What's the monthly average weight of patient 10011398 since 01/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT AVG(weight) FROM patients WHERE patient_id = 10011398 AND measurement_date BETWEEN '01/2100' AND '01/2101' GROUP BY patient_id, measurement_date ORDER BY measurement_date NULLS FIRST",[]
48bc5f792f4ed6f03d3cb9e5,How much sevelamer carbonate was given to patient 10007818 for the first time in 06/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.drug = 'sevelamer carbonate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT 06 / 2100 FROM patients WHERE patient_id = 10007818 ORDER BY date_of_first_dose NULLS FIRST LIMIT 1,[]
d1bf30f1b6904076c39146bb,What's the maximum daily number of patients who were diagnosed with other opiates and related narcotics causing adverse effects in therapeutic use since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other opiates and related narcotics causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT MAX(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis_date) AS c1 FROM diagnoses WHERE diagnosis = 'Other opiates and related narcotics causing adverse effects in therapeutic use' AND STRFTIME('%y', diagnosis_date) >= '2100' GROUP BY diagnosis_date) AS t1",
dc9b13fe2202c498d8511fe7,"Among patients in their 50s since 2100, what were the top five most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.uniquepid WHERE diagnosis.age BETWEEN 50 AND 59 AND STRFTIME('%y', diagnosis.diagnosisdate) >= '2100') AS t1 WHERE t1.c1 <= 5",
3744204f6970ebf11f57c0ba,What was the last time when patient 10019568 received a platelet count lab test during their first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(date) FROM lab WHERE lab.patient_id = 10019568 AND lab.lab_name = 'platelet count' AND NOT lab.date IS NULL;,[]
4daceca1922e2f7b36597c87,Expose the top three most frequent output events in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",SELECT,[]
207eceda0156cdc649f4b078,When was the first time patient 10018081's respiratory rate was less than 22.0 in this ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 22.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(timestamp) FROM (SELECT timestamp FROM respiratory_rate WHERE respiratory_rate < 22.0) WHERE unit = 'ICU visit' AND patient = 10018081,[]
c67d548b3887ca38058fde7e,Has patient 10012853 been admitted to the emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.emergency_room_admission = 'EMERGENCY ROOM ADMITTED',[{'COUNT(*)>0': 0}]
3f82eece23e0481c1ab26586,Tell me the sum of the input volume for patient 10007928 since 03/04/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-04'",SELECT SUM(input_volume) FROM intake WHERE patient_id = 10007928 AND input_date >= '2100-03-04',[{'SUM(inputevents.totalamount)': 22955.0}]
3611ae2dcaeae9a7d87cdf93,What is the ward id where patient 5828 can be admitted?,,SELECT wardid FROM patients WHERE patientid = 5828,
531895a8f6c3cd6a5748843b,How many days have elapsed since patient 10004733 had received a mch lab test for the last time in their current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', mch_lab_date)) FROM mch_lab_table WHERE mch_lab_table.patient_id = 10004733 AND mch_lab_table.hospital_connection = (SELECT current_hospital_connection FROM hsp_connection WHERE hsp_connection.patient_id = 10004733 AND hsp_connection.hospital_is_current = 1)",[]
05ae0033f4e813609ca5d462,"What is the maximum total cost of the hospital, which includes the palmar fascial fibromatosis [dupuytren]?",SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'palmar fascial fibromatosis [dupuytren]' ) ) GROUP BY cost.hadm_id ) AS T1,,
23652e6ecf5fc87dd7d50a98,"How many patients were diagnosed with nicotine dependence, cigarettes, uncomplicated during the same month after they were first diagnosed with long term (current) use of antithrombotics/antiplatelets in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of antithrombotics/antiplatelets' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.month1 FROM (SELECT subject_id, MIN(diagnosis_date) AS month1 FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis_date BETWEEN '2000-01-01' AND '2000-12-31' AND diagnosis = 'nicotine dependence, cigarettes, uncomplicated') GROUP BY subject_id) AS t1 JOIN (SELECT subject_id, MIN(diagnosis_date) AS month1 FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis_date BETWEEN '2000-01-01' AND '2000-12-31' AND diagnosis = 'long term (current) use of antithrombotics/antiplatelets') GROUP BY subject_id) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.month1 = t2.month1",
8970ce40dfe4e0498bf2959e,Show me the top four diagnoses with the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",SELECT TOP 4 DIAGNOSIS WITH HIGHEST 3-MONTH MORTALITY RATE,
5a89407a39c4cd1be3abc4f2,"On this month/23, what was the maximum value of the respiratory rate for patient 10004733?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '23'",SELECT MAX(respiratory_rate) FROM respiratory_rate WHERE patient_id = 10004733 AND measurement_date = CURRENT_DATE - INTERVAL '23 months',[{'MAX(chartevents.valuenum)': None}]
8f0afd39792dda81827e4464,What is patient 10008454's difference in SaO2 from the value measured at 2100-12-07 16:00:00 compared to the value measured at 2100-12-07 15:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 16:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 15:00:00' ),SELECT (SELECT SaO2 FROM patient_10008454 WHERE measurement_time = '2100-12-07 16:00:00') - (SELECT SaO2 FROM patient_10008454 WHERE measurement_time = '2100-12-07 15:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 16:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 15:00:00' )"": None}]"
ce3af199fd7438f9504a0ed5,What was the name of the medication that was first prescribed to patient 10010471 since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT name FROM medication WHERE patient_id = 10010471 AND date >= '12/2100' ORDER BY date NULLS FIRST LIMIT 1,[{'drug': 'Rosuvastatin Calcium'}]
b6cca58570a4d4174cb71b3e,I want to know the reimbursement standard for cerebrovascular mri.,,"SELECT ""reimbursement_standard"" FROM ""procedures"" WHERE ""procedure"" = 'Cerebrovascular MRI'",
97da967a6eec6c3d02e10772,"In 2100, how many dilation of left external iliac vein with intraluminal device, percutaneous approach procedures were there?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.year = 2100 AND procedures.name = 'dilation of left external iliac vein with intraluminal device, percutaneous approach'",
10ed8799a239ae7d1d0f79c9,What is the correct dosage of the prescribed opioid to patient 42829?,,"SELECT ""dosage"" FROM ""prescriptions"" WHERE ""patient_id"" = 42829 AND ""prescription_type"" = 'opioid'",
cb29881e7d27f8f23e3a8502,Give a count of the number of ICU visits of patient 10004720 during their last hospital visit.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(ICU_VISITS) FROM patient WHERE PATIENT_ID = 10004720 AND HOSPITAL_INFORMATION->>'last_hospital_visit' IS NOT NULL;,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
6138410041007bba41d241af,When did patient 10005817 get the glucose lab test in their last hospital encounter for the first time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,,[]
cc583d453844985f8c75964d,Can you tell me how much hydrocodone-acetaminophen (5mg-500mg) costs?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'hydrocodone-acetaminophen (5mg-500mg)' ),SELECT price FROM products WHERE name = 'hydrocodone-acetaminophen (5mg-500mg)',
f617b7296ab248a05c6041c0,What precautions should i take after a closed uterine biopsy procedure?,,"SELECT * FROM procedures WHERE procedure = ""Closed uterine biopsy""",
fa4dfaaf2645d182bd7337d2,What was the minimum value of mean blood pressure for patient 10008454 on 12/02/2100?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-02'",SELECT MIN(mean_blood_pressure) FROM patient_10008454 WHERE date = '12/02/2100',[{'MIN(chartevents.valuenum)': None}]
5a0f11cd2d321ee0bbab6b6c,What was the number of coronary arteriography using two catheters procedures performed since 1 year ago?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.name = 'coronary arteriography using two catheters' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
a5de915902ae68f1b9298fce,When was the last time patient 46528 had a medication which should be taken daily?,,SELECT MAX(date_submitted) FROM medication_usage WHERE patient_id = 46528 AND frequency = 'daily';,
fe9f0b6e8813418d172e1e1c,How many 5% dextrose prescriptions were administered?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = '5% dextrose',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = '5% Dextrose';,[{'COUNT(*)': 0}]
f0d3b6aed52a69df797206eb,What were the five most frequent events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT Event, COUNT(Event) FROM brackets.events WHERE Date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY Event ORDER BY COUNT(Event) DESC LIMIT 5;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
52e1920bba1dc62e51feb58b,Count the number of medicines that have been prescribed to patient 10021487 in 2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10021487 AND STRFTIME('%y', prescriptions.date) = '2100';",[{'COUNT(*)': 0}]
b6207dcfe0579ae33b721201,What was the last time that patient 10040025 had the maximum value of hematocrit in 03/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1","SELECT MAX(Hematocrit) FROM Patient WHERE Patient.ID = 10040025 AND STRFTIME('%y-%m', Hematocrit.MeasurementDate) = '2022-03'",[]
cbe87d3055a29ed5e694a4df,"Compared to yesterday, what new prescriptions were given to patient 10018081 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescriptions FROM prescriptions_table WHERE patient_id = 10018081 AND date = CURRENT_DATE - INTERVAL '1 day' AND prescriptions.date = CURRENT_DATE,[]
0825d95545721aa700cc7fd0,What were the top five most common diagnoses during this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank",
03d470fc8e41f5dd8568f771,What was the first medication that patient 10019385 was prescribed on their first hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,,[{'drug': 'Acetaminophen'}]
c559da124dcc274c8d5b1e61,How many patients were given insulin human regular prescriptions since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'insulin human regular' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patienttype = 'insulin human regular' AND STRFTIME('%y', patient.date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
1653c4779514ff5b7d86cad6,"How many patients in 2100 were diagnosed with cyst and pseudocyst of pancreas during the same month after the first diagnosis with other and unspecified alcohol dependence, in remission?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cyst and pseudocyst of pancreas' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'cyst and pseudocyst of pancreas') AS t1 JOIN (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'other and unspecified alcohol dependence, in remission') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month') GROUP BY t1.subject_id) AS t3",
db2ec5a725e4b2775b055f88,What are the five commonly ordered medications that patients aged 50s were prescribed within 2 months after diagnosed with long-term (current) use of insulin?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'LONG-TERM (CURRENT) USE OF INSULIN') AS t1 JOIN (SELECT admissions.subject_id, medications.name, medications.date FROM medications JOIN admissions ON medications.admission_id = admissions.admission_id WHERE admissions.age BETWEEN 50 AND 59) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.name) AS t3 WHERE t3.c1 <= 5",
b678b8112793dc9ca55c90b3,Calculate the number of patients discharged from the hospital this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient_id) FROM discharge_log WHERE date_discharged >= DATEADD(year, -1, CURRENT_DATE);",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
41bdccec26b0e33321c1ec3f,"What is the diagnosis cost of hemiplegia, unspecified affecting left nondominant side?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) )","SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = ""Hemiplegia, unspecified affecting left nondominant side""",
c395fa8a146f1042784e0d46,How much does patient 10006580's systolic blood pressure differ from the last value measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT systolic_blood_pressure FROM patient_systolic_blood_pressure WHERE patient_id = 10006580 AND icu_visit_number = 1) - (SELECT systolic_blood_pressure FROM patient_systolic_blood_pressure WHERE patient_id = 10006580 AND icu_visit_number = 1 ORDER BY systolic_blood_pressure DESC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
a711973109553fda82475f0b,Tell me the name of the drug which patient 10017492 was prescribed within 2 days after having had a spinal tap procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT patient_id, treatment_date FROM procedures WHERE patient_id = 10017492 AND treatment_name = ""spinal tap"") AS t1 JOIN (SELECT patient_id, name FROM drugs WHERE patient_id = 10017492) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.treatment_date < t2.treatment_date AND DATETIME(t2.treatment_date) BETWEEN DATETIME(t1.treatment_date) AND DATETIME(t1.treatment_date, '+2 day')",
2559181f4a14ba86cf190ad5,I would like to know the top three diagnoses that have the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT t3.diagnosis, t3.monthly_mortality FROM (SELECT t2.diagnosis, t2.monthly_mortality FROM (SELECT * FROM diagnoses WHERE diagnosis = 'ALL') AS t1 JOIN (SELECT * FROM patient_stats WHERE patient_stats.diagnosis = 'ALL') AS t2 ON t1.diagnosis = t2.diagnosis) AS t3 JOIN (SELECT * FROM patient_stats WHERE patient_stats.diagnosis = 'ALL') AS t4 ON t3.diagnosis = t4.diagnosis GROUP BY t3.diagnosis ORDER BY t3.monthly_mortality DESC LIMIT 3;",
e2cf012f4e5832fab8f5409b,What was the name of the drug that was prescribed to patient 10039831 first time through the im route since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriber.drug_name FROM prescriber WHERE prescriber.patient_id = 10039831 AND prescriber.route = 'im' AND STRFTIME('%y-%m', prescriber.date) >= '2100-07' ORDER BY prescriber.date NULLS FIRST LIMIT 1",[]
41d43a2f58e87c8f4d88b801,What are the top four common microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT t.test_name, COUNT(t.test_name) FROM microbiology_tests t WHERE t.date > DATEADD(year, -1, GET_DATE()) GROUP BY t.test_name ORDER BY COUNT(t.test_name) DESC LIMIT 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]"
023f3f0db56f39d9b838b1c0,What is the difference between diastolic blood pressure last measured on the first ICU visit compared to the second to last value measured on the first ICU visit for patient 10012552?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT diastolic_blood_pressure FROM icu_visits WHERE icu_visits.patient_id = 10012552 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.in_time NULLS FIRST LIMIT 1) - (SELECT diastolic_blood_pressure FROM icu_visits WHERE icu_visits.patient_id = 10012552 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.in_time DESC LIMIT 1);,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
c90f896b24cab48d06c88f3d,Tell me the total input for patient 10007818 since 01/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-12'",SELECT COUNT(*) FROM brackets WHERE patient_id = 10007818 AND input_date >= '01/12/2100',[{'SUM(inputevents.totalamount)': 162565.80000305176}]
f0782e76ee1d6e988ec5bb08,What is the cost of the drug named divalproex (extended release)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'divalproex (extended release)' ),"SELECT ""Cost ( US $ )"" FROM ""drug_list"" WHERE ""Drug"" = 'Divalproex (Extended Release)'",
2ecf6ed7b588701c5b61916c,What was the total volume of or urine patient 10035185 had on their first ICU visit?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),SELECT SUM(ICU_VOLUME) FROM ICU_USAGE WHERE ICU_USAGE.PATIENT_ID = 10035185 AND NOT ICU_USAGE.OUTDATE IS NULL ORDER BY ICU_USAGE.INDATE NULLS FIRST LIMIT 1,[{'SUM(outputevents.value)': None}]
eae3d736ea15573510314df8,Please tell me the name of the diagnosis patient 30267 received at the other department.,,SELECT diagnosis FROM diagnoses WHERE diagnoses.patientId = 30267 AND diagnoses.location = 'other department',
733e2d8ccc688ba33154a9ab,What's the minimum total hospital cost that includes a protein lab test?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(hospital_cost) FROM (SELECT SUM(lab_cost) AS hospital_cost FROM lab_results WHERE lab_result = 'protein') AS subquery;,
4c7e73d8e877dda69f26211c,When was the first time that patient 10038081 had the minimum value of immunoglobulin g?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",SELECT MIN(Immunoglobulin G) FROM patients WHERE Patient = 10038081,[]
5780c98a714da7aa7512b363,Was patient 10021666 urea nitrogen tested in their first hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10021666 AND diagnoses.diagnosis = 'Urea Nitrogen' AND NOT diagnoses.hospital_sequence_number IS NULL ORDER BY diagnoses.hospital_sequence_number NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
76b2409a30b5bbbeab3d334b,Has patient 7112 had a family history of a disease?,,"SELECT COUNT(*) > 0 FROM patients WHERE patients.family_history = ""Yes"" AND patients.patient_id = 7112",
9556f5bb39ef85f316ec69f4,I would like to know what dr. dunlow's on today's outpatient schedule.,,SELECT * FROM dr.dunlow WHERE outpatient = 'today';,
167d39516102c791d110d62b,Which are the five most commonly taken lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.Lab_Test, COUNT(t1.Lab_Test) FROM (SELECT Lab_Test FROM lab_tests WHERE year >= 2100 GROUP BY Lab_Test) AS t1 JOIN lab_tests AS t2 ON t1.Lab_Test = t2.Lab_Test GROUP BY t1.Lab_Test ORDER BY COUNT(t1.Lab_Test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
b5aedd087997ec2e10bb6736,Is the glucose value last measured on the first hospital visit in patient 10004235 less than the value from the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT glucose FROM patients WHERE patient_id = 10004235 AND NOT hospital_dischtime IS NULL ORDER BY glucose_date NULLS FIRST LIMIT 1) < (SELECT glucose FROM patients WHERE patient_id = 10004235 AND NOT hospital_dischtime IS NULL ORDER BY glucose_date DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
33d0ec324183f0e65eb1f466,When was the first time patient 10020740 was prescribed drugs via po in 07/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM prescriptions WHERE patient_id = 10020740 AND prescriber_name = 'po' AND date_prescribed >= '2007-01-01',[]
7ea5b7b4bc12cad8a4e74fdc,What was the total dose of insulin human regular prescribed to patient 10019172 during the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'insulin human regular',"SELECT SUM(insulin_dose) FROM prescriptions WHERE prescriptions.patient_id = 10019172 AND prescriptions.drug_name = 'insulin human regular' AND DATETIME(prescriptions.date_prescribed, 'start of hospital visit') = DATETIME(CURRENT_TIME, 'start of hospital visit', '-1 hospital visit')",[{'SUM(prescriptions.dose_val_rx)': None}]
ab86f0ba83c400b1a9f9b6c3,Did patient 10003046 have an input of free water on 12/24/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'",SELECT COUNT(*) FROM input_table WHERE input_table.patient_id = 10003046 AND input_table.input_date < '2012-12-24' AND input_table.input_type = 'free water',[{'COUNT(*)>0': 0}]
3c053c9b8b903c510ca0c818,What was patient 10008454's first tested specimen in 12/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT patient_id, specimen_date FROM microbiology_table WHERE patient_id = 10008454 AND STRFTIME('%y-%m', specimen_date) = '2100-12' ORDER BY specimen_date NULLS FIRST LIMIT 1",[]
499e4f8e7f92658595f68d33,"Has ondansetron, oxycodone liquid, or sodium chloride 0.9% been prescribed to patient 10020740?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug IN ( 'ondansetron', 'oxycodone liquid', 'sodium chloride 0.9%' )","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient = 10020740 AND medication.drug IN ('ondansetron', 'oxycodone liquid', 'sodium chloride 0.9%')",[{'COUNT(*)>0': 0}]
0f1253fab8016b9da9f6e223,When was the first time that patient 10015272 in 06/this year was given a asparate aminotransferase (ast) lab test?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(datetime(ast_date, '06/this year')) FROM asparate_aminotransferase_ast WHERE patient_id = 10015272",[]
efa49770d1b09991933af299,Has patient 10019777 gone to an emergency room throughout this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(*) FROM emergency_room_usage WHERE patient_id = 10019777 AND usage_year = 2016,[{'COUNT(*)>0': 0}]
b02107c6fe9f4494cc14728e,When was the first time of input time of patient 10018081 on this month/29?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '29' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10018081 AND input_time BETWEEN '2022-04-01 00:00:00' AND '2022-04-30 23:59:59',[]
88a7f40a049ecb037fdb2016,What was in 03/this year patient 10004235's minimum alveolar-arterial gradient value?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alveolar-arterial gradient' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'",SELECT MIN(alveolar_arterial_gradient) FROM patient WHERE patient_id = 10004235 AND date = '03/01/2020',[{'MIN(labevents.valuenum)': None}]
034ccc062d441cb484ca8a57,Has patient 10020944 come to the ER since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM call_emergency_room(10020944, CURRENT_TIMESTAMP - INTERVAL '1 year')",[{'COUNT(*)>0': 0}]
a811c24da8966874201c1f03,What was the last time of input of patient 10021487 since 03/20/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-20' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10021487 AND input_time >= '2000-03-20';,[{'starttime': '2117-03-09 14:20:00'}]
48805e4216bd012669a77b8c,What are the top four commonly ordered treatments for patients in their 20s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.treatment, COUNT(t.treatment) FROM customer_treatments t WHERE t.patient_age BETWEEN 20 AND 29 GROUP BY t.treatment ORDER BY COUNT(t.treatment) DESC LIMIT 4",
bc55adec6e2f148eae8ab156,What was the name of the organism found in patient 10021487's first bronchoalveolar lavage microbiological test since 09/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10021487 AND test_type = 'bronchoalveolar lavage' AND date >= '2009-2100-09' ORDER BY date NULLS FIRST LIMIT 1,[]
2ea2811b8f3a6ed89aa46618,"When did last patient 10014729 have the minimum value of albumin, pleural in 03/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, pleural' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1","SELECT strftime(patient.admit_date, '%d/%m/%Y') as admit_date, MIN(patient.albumin, 'pleural') as min_albumin FROM patient WHERE patient.subject_id = 10014729 AND strftime(patient.admit_date, '%y') = '2100' GROUP BY strftime(patient.admit_date, '%d/%m/%Y') ORDER BY admit_date DESC LIMIT 1",[]
07f02f8bb9cf48ec09ba120e,"In 10/2100, when was patient 10018845's last microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT date FROM microbiology WHERE patient_id = 10018845 AND date BETWEEN '2021-10-01' AND '2021-10-31' ORDER BY date DESC LIMIT 1,[]
6088d9d109938b6b36160f41,What was the last value of a asparate aminotransferase (ast) lab test of patient 10021938 last month?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY labevents.charttime DESC LIMIT 1","SELECT MIN(ast) FROM lab WHERE ast.patient = 10021938 AND DATETIME(ast.date, 'start of month') = DATETIME(CURRENT_DATE, 'start of month', '-1 month')",[]
4d0bc94cd3038c80ab777027,What was the last drug prescribed in 02/this year to patient 10020187?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10020187 AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '02' ORDER BY prescriptions.date DESC LIMIT 1;",[]
e83b5e034fb29dbffbbeed14,"What are the charges for a procedure called bypass coronary artery, one artery from right internal mammary with autologous arterial tissue, open approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from right internal mammary with autologous arterial tissue, open approach' ) )","SELECT charges FROM procedures WHERE procedure_name = 'Bypass coronary artery, one artery from right internal mammary with autologous arterial tissue, open approach'",
5fac6ea9a02d544397cb54fe,Has patient 10018845 been given any medication?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ),SELECT COUNT(*) > 0 FROM medication_usage WHERE patient_id = 10018845;,[{'COUNT(*)>0': 1}]
aedb02499fd35b17dcda7ada,What percentile is the creatinine value of 0.6 among patients of the same age as patient 10008454 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.6","SELECT t1.c1 FROM (SELECT lab.c1, PERCENT_RANK() OVER (ORDER BY lab.c1 NULLS FIRST) AS c2 FROM (SELECT lab.c1 FROM lab WHERE lab.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.patient_id = 10008454 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay DESC LIMIT 1))) AS t1 WHERE t1.c2 = 0.6",
232c1cf9aed1b4611fb6d99a,"Since 2100, what are the top five most frequent drugs prescribed to patients within 2 months after the diagnosis of atrial flutter?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial flutter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_time FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'atrial flutter' AND STRFTIME('%y', diagnosis.diagnosis_time) >= '2100') AS t1 JOIN (SELECT patient.id, prescription.drug, prescription.prescription_time FROM prescription JOIN patient ON prescription.patient_id = patient.id WHERE STRFTIME('%y', prescription.prescription_time) >= '2100') AS t2 ON t1.id = t2.id WHERE t1.diagnosis_time < t2.prescription_time AND DATETIME(t2.prescription_time) BETWEEN DATETIME(t1.diagnosis_time) AND DATETIME(t1.diagnosis_time, '+2 month') GROUP BY t2.drug) AS t",
d6ed2ef486b7d554f4160ba6,What was the name of the output that patient 10027445 had last since 06/02/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-02' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT ""output"" FROM ""patients"" WHERE ""patient"" = 10027445 AND ""date"" = '06/02/2100'",[{'label': 'Foley'}]
d4729c0ab6ae0748e9626cab,"In relation to others of the same age, where does a ph value of 7.34 for patient 10026255 rank in percentiles in their first hospital visit?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 7.34","SELECT ph_value, percent_rank FROM (SELECT ph_value, 10026255 AS patient_id FROM patients WHERE age = 25) AS subquery ORDER BY ph_value DESC LIMIT 1",
4afe78a50dbf480375c2d614,What was the name of the organism found in the first bronchoalveolar lavage microbiology test of patient 10021487 in 12/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT organism_name FROM microbiology WHERE patient_id = 10021487 AND sample_type = 'bronchoalveolar lavage' AND date = '12/2100' ORDER BY date NULLS FIRST LIMIT 1,[]
c3fd367fdc390db8d0461dff,When was patient 10007818's mean blood pressure first measured less than 75.0 since 241 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 75.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-241 day') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MAX(BloodPressure) FROM (,[]
59a23b41fa280018e0e17257,Calculate the number of enalapril maleate prescriptions.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'enalapril maleate',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Enalapril Maleate';,[{'COUNT(*)': 7}]
c550bac1aacd2bc72e7e12ab,What was the admission type for patient 10009049's last visit to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10009049 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1","SELECT ""admission_type"" FROM ""visits"" WHERE ""patient_id"" = 10009049 ORDER BY ""admission_date"" DESC LIMIT 1;",[{'admission_type': 'EW EMER.'}]
99e2661e12b6c6e852955ea5,How was patient 10022281 last admitted to the hospital in terms of admission type?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10022281 ORDER BY admissions.admittime DESC LIMIT 1,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10022281 ORDER BY admissions.admission_date DESC LIMIT 1;,[{'admission_type': 'EW EMER.'}]
59d3175a30ad9fe65e39996d,"How many times, since 1 year ago, was a open reduction of fracture with internal fixation, humerus procedure ordered?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_type = ""OPEN REDUCTION OF FRACTURE WITH INTERNAL FIXATION, HUMERUS"" AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
745585ee3b0d6a5e1b414a94,"Count the number of patients who underwent a cholesterol, hdl lab test since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, hdl' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.has_lab_cholesterol_hdl = 1 AND DATETIME(patient.lab_cholesterol_hdl) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
a8572111c6db24cf56d0391e,Is patient 10010471's sodium value last measured on the last hospital visit greater than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.result FROM lab WHERE lab.patient = 10010471 AND lab.label = 'sodium' AND lab.date = (SELECT patient.hospital_stay.end FROM patient WHERE patient.id = 10010471 ORDER BY patient.hospital_stay.end DESC LIMIT 1)) > (SELECT lab.result FROM lab WHERE lab.patient = 10010471 AND lab.label = 'sodium' AND lab.date = (SELECT patient.hospital_stay.end FROM patient WHERE patient.id = 10010471 ORDER BY patient.hospital_stay.end DESC LIMIT 1) OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
9a5ebe2812ee93bc053bbf59,"Since the last time patient 10021487 was diagnosed with alcohol abuse, unspecified on their current hospital visit, how many hours have passed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosed_date)) FROM diagnoses WHERE patient_id = 10021487 AND diagnosis_type = 'alcohol abuse, unspecified' AND current_hospital_visit = 1;",
92672fa0de871a17570f6c7b,Tell me patient 10003046's total gastric meds input amount on 01/16/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-16'",SELECT SUM(gastric_meds) FROM patients WHERE patient_id = 10003046 AND gastric_meds_date >= '2022-01-16' AND gastric_meds_date < '2022-01-16' + INTERVAL '1 month',[{'SUM(inputevents.totalamount)': None}]
2701dd64f96330440b0d5b10,Is a genetic test that patient 95057 has had?,,SELECT COUNT(*) FROM genomic_data WHERE patient_id = 95057,
b70079e92720b4a5b0ac3a9a,Has patient 10004733 had an input of nepro (full) since 12/29/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nepro (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-29'","SELECT COUNT(*) > 0 FROM input WHERE input.patient = 10004733 AND input.type = 'nepro (full)' AND STRFTIME('%y-%m-%d', input.date) >= '2100-12-29'",[{'COUNT(*)>0': 0}]
e7fcf849ac87ce9fbbd3cf84,What was the name of the procedure that was given two or more times to patient 10007795 since 12 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-12 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT procedure FROM procedures WHERE patient = 10007795 AND date >= DATEADD(month, -12, CURRENT_DATE) GROUP BY procedure HAVING COUNT(*) >= 2",
a25bb889984fbcb71773db73,Retrieve the yearly minimum amount of patient 10037975's pre-admission/non-icu intake input.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission/non-icu intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",SELECT MIN(intake_amount) FROM intake WHERE patient_id = 10037975 AND intake_type = 'pre-admission/non-icu intake' GROUP BY year;,[]
0e460c97c84c743bb885aefe,When was the first input time for patient 10022281 since 06/03/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-03' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10022281 AND input_time >= '2100-06-03',[{'starttime': '2125-06-17 05:10:00'}]
23bbac068db32a4e588f2d9e,Please list out the monthly maximum weight of patient 10039997 in the first hospital encounter.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT MAX(weight) FROM patients WHERE patient_id = 10039997 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1,[]
814f6690d0bc9410fa12b9f4,What was the total dose of aspirin patient 10017492 had been prescribed during the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'aspirin',SELECT SUM(aspirin) FROM patients WHERE patient_id = 10017492 AND NOT patients.hospital_info.last_dischtime IS NULL ORDER BY patients.hospital_info.admittime DESC LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
43377e1ef48d695d15424da9,What is the cost for the medicine topiramate (topamax)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'topiramate (topamax)' ),SELECT DISTINCT cost FROM medicines WHERE medicine = 'Topiramate (Topamax)',
3347c7735b3a39f53f492495,Tell me the average overall hospital cost that includes amitriptyline this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",SELECT AVG(Overall) FROM (SELECT SUM(Cost) AS Overall FROM (SELECT 1 AS Cost FROM prescriptions WHERE Name = 'amitriptyline') AS T1 JOIN (SELECT 1 AS Overall FROM diagnoses WHERE Name = 'diabetes with complications') AS T2 ON T1.Name = T2.Name WHERE T1.Year = 2016 GROUP BY T1.Name) AS T3,
bf7b0e75c5c6bf62f8ebec79,Has patient 10014729 received any piggyback in 03/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',inputevents.starttime) = '03'","SELECT COUNT(*) > 0 FROM piggyback WHERE piggyback.patient_id = 10014729 AND DATETIME(piggyback.timestamp, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', piggyback.timestamp) = '03'",[{'COUNT(*)>0': 0}]
906878394c7c53d1c7d622c0,I would like to know all of the prescriptions patient 21003 received at the other department.,,SELECT prescriptions FROM other_department WHERE patient_id = 21003;,
4c853a58d04f9b3b5fb7cf1c,What is the id of the ward where patient 40707 can be admitted?,,SELECT ward_id FROM patient_ward_availability WHERE patient_id = 40707,
32955b67aaf8c2bd57e9ef2b,What was the name of the specimen given to patient 10005817 for the first time since 08/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT specimen_name FROM open_patient_specimens WHERE patient_id = 10005817 AND strftime(specimen_date, '%y-%m') >= '2100-08' ORDER BY specimen_date NULLS FIRST LIMIT 1",[{'spec_type_desc': 'URINE'}]
2760ec29711e48dd4fbb1d5e,"Has patient 10007818 gone through a urea nitrogen, urine test in 10/last year?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'","SELECT COUNT(*) FROM lab_results WHERE lab_results.patient_id = 10007818 AND lab_results.label = 'Urea Nitrogen, Urine' AND DATETIME(lab_results.result_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year') AND STRFTIME('%m', lab_results.result_date) = '10'",[{'COUNT(*)>0': 0}]
bf1ccb5ac4a847d66be6bc96,What was the organism detected in patient 10027602's first mini-bal microbiology test on their first hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT MINI_BAL_ORGANISM(date_of_test) FROM microbiology WHERE MINI_BAL_ORGANISM(date_of_test) IS NOT NULL AND MINI_BAL_ORGANISM(date_of_test) NOT IN (SELECT MINI_BAL_ORGANISM(date_of_test) FROM microbiology WHERE MINI_BAL_ORGANISM(date_of_test) IS NULL) AND MINI_BAL_ORGANISM(date_of_test) IN (SELECT MINI_BAL_ORGANISM(date_of_test) FROM microbiology WHERE MINI_BAL_ORGANISM(date_of_test) IS NOT NULL) AND NOT patient_id IN (SELECT patient_id FROM patient WHERE patient.hospital_dischtime IS NULL) ORDER BY date_of_test NULLS FIRST LIMIT 1;,[]
19c3aaa1bb33be228b47ea7b,What is the yearly maximum sterile water input for patient 10020740?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",SELECT MAX(Sterile_Water_Input) FROM brackets WHERE Patient_ID = 10020740 GROUP BY Year;,[]
837818ce3b6b8d41acc4c4ea,"What was the first lab test result of the cholesterol, total for patient 10014354 in 10/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(lab_result) FROM lab_tests WHERE lab_result_type = 'cholesterol, total' AND patient_id = 10014354 AND lab_date BETWEEN '2010-2100-10' AND '2010-2100-10'",[]
38bb18f4f12bf469e4927756,When did patient 10018845 get an input for the last time since 09/09/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-09' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT input FROM input_table WHERE patient_id = 10018845 AND input_date >= '2100-09-09' ORDER BY input_date DESC LIMIT 1,[{'starttime': '2184-10-09 13:24:00'}]
e965cf8b6399b0933da46e48,Provide a list of the four most common diagnoses that patients were diagnosed with within 2 months after undergoing the enteral infusion of concentrated nutritional substances procedure in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmentdate BETWEEN '2100-01-01' AND '2100-12-31' AND treatment.diagnosis = 'enteral infusion of concentrated nutritional substances') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosisdate BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosisdate) BETWEEN DATETIME(t1",
036dc7fd74fcfcf46d3ee504,What is the daily average input of or ffp intake that patient 10018081 is getting since 12/22/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ffp intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-22' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(input) FROM intake WHERE patient = 10018081 AND intake_date >= '2100-12-22' AND intake_type = 'or ffp' GROUP BY date_part('day', intake_date)",[]
0ae32bee1adc6a16d66b16de,What was patient 10036156's documented weight on the last record since 12 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT log_weight FROM log_patient_weight WHERE patient_id = 10036156 AND log_weight IS NOT NULL AND DATETIME(log_weight_date) >= DATETIME(CURRENT_TIME, '-12 month') ORDER BY log_weight_date DESC LIMIT 1",[]
73f03c4b396e0636de5ad08b,What are the three commonly taken specimens for patients that were diagnosed with family history of ischemic heart disease previously in the same hospital visit?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of ischemic heart disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen FROM (SELECT t2.specimen, COUNT(t2.specimen) AS c2 FROM (SELECT patient.name, diagnosis.date, patient.age FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.diagnosis = 'family history of ischemic heart disease') AS t1 JOIN (SELECT patient.name, specimen, date FROM patient JOIN sample ON patient.name = sample.name) AS t2 ON t1.name = t2.name WHERE t1.date = t2.date GROUP BY t2.specimen) AS t3 WHERE t3.c2 = (SELECT MAX(c2) FROM (SELECT t2.specimen, COUNT(t2.specimen) AS c2 FROM (SELECT patient.name, diagnosis.date, patient.age FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.diagnosis = 'family history of ischemic heart disease') AS t1 JOIN (SELECT patient.name, specimen, date FROM patient JOIN sample ON patient.name = sample.name) AS t2 ON t1.name = t2.",
03cc8765cbc06f1cff174a6c,When did patient 10004733 get an input for the last time on 12/26/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-26' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT input_date FROM input_table WHERE input_table.patient_id = 10004733 AND DATETIME(input_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m-%d', input_date) = '12-26' ORDER BY input_date DESC LIMIT 1;",[]
99ec0658e0c4b37ac1798c46,When was the first discharge of patient 10022880 from the hospital?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022880 ORDER BY admissions.dischtime ASC LIMIT 1,SELECT MIN(dischtime) FROM patient WHERE patient.subject = 10022880,[{'dischtime': '2177-03-19 14:25:00'}]
699d1833d8f298ac738b03d6,How many sodium bicarbonate prescription instances occurred since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Sodium Bicarbonate' AND DATETIME(prescriptions.date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)': 8}]
0de02f3946d72e99a86d60ea,Is there any gene testing that patient 14397 had?,,"SELECT COUNT(*) FROM patients WHERE patients.patient_id = 14397 AND patients.gene_testing = ""testing""",
3fad0b33ee39bfb6e59660eb,What was the last dose of sodium polystyrene sulfonate prescribed to patient 10021487 since 06/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'sodium polystyrene sulfonate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(dateofprescription) FROM prescriptions WHERE prescriptions.patientid = 10021487 AND prescriptions.drug = 'Sodium Polystyrene Sulfonate' AND STRFTIME('%y-%m', prescriptions.dateofprescription) >= '2100-06'",[]
f082ad77c50f76200f9ef93d,"Tell me the maximum total hospital cost that includes extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic in 2100.","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(total_hospital_cost) FROM (SELECT SUM(hospital_cost) FROM (SELECT patient_id FROM patients WHERE patient_name = 'John Doe') AS T1 JOIN procedures AS T2 ON T1.patient_id = T2.patient_id WHERE T2.procedure_name = 'Extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' AND T2.year = 2100 GROUP BY T1.patient_id) AS T3;",
58036fbf344f61c449c588f0,Could you count the number of times patient 10039997 visited the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT visit_date) FROM hospital_visits WHERE patient_id = 10039997 AND DATETIME(visit_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
2977de037421f92addee92ab,What is the total volume of patient 10021487's input on 12/22/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-22'",SELECT SUM(input_volume) FROM input_table WHERE patient_id = 10021487 AND input_date = '2022-12-22';,[{'SUM(inputevents.totalamount)': None}]
44fca1429144bd57023476d8,"When was the first time that patient 10014729 has received a calcium, total lab test in 03/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(lab_date) FROM lab_results WHERE lab_name = 'calcium, total' AND patient_id = 10014729 AND lab_date BETWEEN '2000-03-2100' AND '2000-03-2100'",[]
436811ca71744e404dd509d5,Can you provide me the monthly minimum amount of or cell saver intake that patient 10035185 received?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MIN(intake) FROM intake WHERE intake_type = 'or cell saver' AND patient_id = 10035185 GROUP BY date_submitted;,[]
ddbe991f30c6934480e21599,How many patients were prescribed the drug diltiazem extended-release since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'diltiazem extended-release' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.had_drug AT TIME '2100-01-01' AND patient.drug = 'Diltiazem Extended-Release',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
6c22bec7e47dc38b30e3f2b9,"What was the last instance when the diastolic blood pressure of patient 10026354 was greater than 71.0, since 08/10/2100?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 71.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-10' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT * FROM systolic_blood_pressure WHERE diastolic_blood_pressure > 71.0 AND patient_id = 10026354 AND measurement_date >= '2100-08-10' ORDER BY measurement_date DESC LIMIT 1,[]
819106b66507d6daacc3feba,What's up with the single rooms now?,,SELECT * FROM inventory WHERE room_type = 'single';,
7137bae0cea575cb815bc23e,What drug was prescribed to patient 10004235 within 2 days after the procedure of central venous catheter placement with guidance since 03/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT patient.name, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.id WHERE patient.id = 10004235 AND procedures.name = 'central venous catheter placement with guidance' AND STRFTIME('%y-%m', procedures.date) >= '2100-03') AS t1 JOIN (SELECT patient.name, medications.name FROM medications JOIN patient ON medications.patient = patient.id WHERE patient.id = 10004235 AND STRFTIME('%y-%m', medications.date) >= '2100-03') AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
55a82d52a8bcc98c682b8a78,How long did patient 26286 have to undergo contr cerebr arteriogram?,,SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 26286 AND procedures.procedure_name = 'Contr cerebr arteriogram',
2092bc06715d6d43db8d20c2,Is the mch value of patient 10025612 on the second measurement on the first hospital visit less than the value from the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT mch FROM lab_data WHERE patient_id = 10025612 AND measurement_date =,"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
9206421c128de64e2474230a,What were the top five most frequently prescribed medicines since 1 year ago?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.name FROM (SELECT medication.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM medication WHERE DATETIME(medication.last_prescribed_date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY medication.name) AS t1 WHERE t1.c1 <= 5;","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
b6b5724cdad99c96a0d0a001,When did patient 10024043 get a mrsa screen microbial test for the first time?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT screen_date FROM microbial_tests WHERE patient_id = 10024043 AND test_type = 'mrsa screen microbial' ORDER BY screen_date NULLS FIRST LIMIT 1,[]
9536521393863e42357a143b,What was the maximum phosphate value for patient 10012853 in the first hospital visit?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ),,[{'MAX(labevents.valuenum)': None}]
68312cee150a54cd1fa02383,Provide the daily minimum weight of patient 10007058 throughout this year.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MIN(weight) FROM patients WHERE patient_id = 10007058 AND date BETWEEN '2000-01-01' AND '2000-12-31' GROUP BY date,[]
737c9f23dfb633b9095279c8,What output did patient 10006580 last have since 05/19/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19' ORDER BY outputevents.charttime DESC LIMIT 1 )",,[{'label': 'Foley'}]
a857fe023621b88d5229e66e,What treatment were provided to patient 10021938 two or more times since 07/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT T0.treatment FROM (SELECT treatment, COUNT(treatment) AS c1 FROM patients WHERE patients.id = 10021938 GROUP BY treatment HAVING COUNT(treatment) >= 2) AS T0 JOIN (SELECT date, treatment FROM patients WHERE patients.id = 10021938) AS T1 ON T1.date >= T0.treatment WHERE T1.treatment = T0.treatment",
c7834523cd66eb840495c036,"What are the top four most frequently ordered lab tests for patients within 2 months after being diagnosed with acute edema of lung, unspecified?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute edema of lung, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Acute edema of lung, unspecified') AS t1 JOIN (SELECT patient.id, lab_test.lab_test, lab_test.lab_date FROM lab_test JOIN patient ON lab_test.patient_id = patient.id) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.lab_date AND DATETIME(t2.lab_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.lab_test) AS t3 GROUP BY t3.lab_test ORDER BY COUNT(t3.lab_test) DESC LIMIT 4",
1479c9147e64755116efc852,"In the last hospital visit, how much gemfibrozil has been prescribed to patient 10007795 in total?",SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'gemfibrozil',"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10007795 AND prescriptions.drug_name = ""Gemfibrozil""",[{'SUM(prescriptions.dose_val_rx)': None}]
72a6cc827b8581d7058c56f4,Have any procedures been performed on patient 10019917 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10019917 AND STRFTIME('%y', procedures.date) >= '2100'",
ab0e982e3bb15b1ab0e9c576,What are the four most often performed treatments for patients aged 20s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment FROM (SELECT * FROM patients WHERE my_age BETWEEN 20 AND 29) AS t GROUP BY t.treatment) AS t1 JOIN (SELECT date_part('year', my_date) AS my_year FROM patients WHERE my_age BETWEEN 20 AND 29) AS t2 ON t1.my_year = t2.my_year GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 4",
30bb66210d2f8e9a6b6b709f,"Count the number of patients who received other endoscopy of small intestine within 2 months after being diagnosed with alcohol abuse, unspecified since 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM (SELECT subject_id, DATE '2100-01-01' + INTERVAL '1 month' * d.months AS diagnosed_date FROM (SELECT subject_id, INTERVAL '1 month' * d.months AS months FROM (SELECT subject_id, DATE '1992-03-22' AS diagnosed_date FROM patients WHERE alcohol_abuse = 'unspecified') AS t1 JOIN (SELECT subject_id, DATE '2100-01-01' + INTERVAL '1 month' * d.months AS months FROM patients WHERE endoscopy = 'other') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date < t2.months AND DATETIME(t2.months) BETWEEN DATETIME(t1.diagnosed_date) AND DATETIME(t1.diagnosed_date, '+2 month')",
ca03ac7bbb7eccf0152f825a,How do you proceed with the anticancer drugs?,,SELECT * FROM information WHERE keyword = 'anticancer drugs';,
704f14d72d85257a378afe42,What was the last lab test result of the free calcium for patient 10008287 in 10/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1","SELECT COUNT(*) FROM lab WHERE lab.patient_id = 10008287 AND lab.lab_name = 'free calcium' AND DATETIME(lab.lab_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', lab.lab_date) = '10'",[]
26ca7defafe27bfa854cf965,Calculate the number of ICU visits for patient 10009628 last year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT icu_visits) FROM icu_visits WHERE patient_id = 10009628 AND DATETIME(icu_visits.visit_time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}]
68827b6e5c9eec5eb540e971,"Tell me the top three most frequent procedures that patients were given within 2 months after receiving dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.procedure FROM (SELECT t2.procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.id WHERE treatment.procedure = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic') AS t1 JOIN (SELECT patient.id, treatment.procedure, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.id) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.procedure) AS t3 WHERE t3.c1 <= 3",
090b965f222b18444e2a1020,"What was the first time that the respiratory rate of patient 10021487 was, on their last ICU visit, less than 27.0?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 27.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(respiratory_rate) FROM (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10021487 AND NOT icu_end_date IS NULL ORDER BY icu_start_date DESC LIMIT 1) WHERE respiratory_rate < 27.0,[]
ab353a41c3fc36453bfc931c,What was the name of the diagnosis that patient 10007795 received for the last time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis_name FROM diagnoses WHERE diagnoses.patient_id = 10007795 ORDER BY diagnoses.date DESC LIMIT 1,
a0ba285d46d08d5da3b63d69,Which are the top four most common lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE year >= 2100) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
7b2e4a56a587f857df255484,What percentile is the value of 30.0 in calculated total co2 among patients of the same age as patient 10038999 on their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 30.0","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, SUM(patient.co2) AS c1 FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = 'Tony') GROUP BY patient.age) AS t1 WHERE t1.c1 = 30.0",
3bbc83c195a74b99b51777c9,"Since 08/2100, when was the last time that patient 10001217 was prescribed medication via the pr route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_pr) FROM patient WHERE patient_id = 10001217,[]
61d76023e4eecb1aac307c96,Count the number of hospital visits patient 10026354 had since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(DISTINCT HOSP_VISIT) FROM visits WHERE PATIENT_ID = 10026354 AND STRFTIME('%y', HOSP_VISIT_DATE) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
be30995ff00536a1057c7245,Was any nacl 0.9% medication provided to patient 10027602 on their first ICU stay?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM icu WHERE icu.patient_id = 10027602 AND icu.medication = 'nacl 0.9%',[{'COUNT(*)>0': 0}]
0918bda2bde8b0408f60fc3e,Can you tell me the top five diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t5.diagnosis, t5.months_6_months FROM (SELECT t4.diagnosis, t4.months_6_months FROM (SELECT t3.diagnosis, t3.months_6_months FROM (SELECT t2.diagnosis, t2.months_6_months FROM (SELECT t1.diagnosis, t1.months_6_months FROM (SELECT 'All diagnoses' AS diagnosis, '6-month mortality rate' AS months_6_months) AS t1 GROUP BY t1.diagnosis) AS t2 GROUP BY t2.diagnosis) AS t3) AS t4) AS t5 WHERE t5.months_6_months = (SELECT MAX(months_6_months) FROM (SELECT 'All diagnoses' AS diagnosis, '6-month mortality rate' AS months_6_months) AS t1 GROUP BY t1.diagnosis)",
f07d01a1db0173ba1a3cfff4,"How many people had a test for bilirubin, direct during the previous year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, direct' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.bilirubin, direct >= (SELECT MIN(patient.bilirubin), direct FROM patient WHERE patient.patienttype = 'baseline' AND DATETIME(patient.lasttestdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year'))",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
73cbfeea05bf53b8f480cd6a,What was the last output since 12/19/2100 for patient 10010471?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-19' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT STRFTIME('%m/%d/%Y', '2100-12-19') AS last_output",[{'label': 'Emesis'}]
41e594b8986edc48616272fc,When was patient 10013049's last input on the last ICU stay?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,"SELECT STRFTIME('%y-%m-%d %H:%M:%S', patient.input_time) AS input_time",[{'starttime': '2114-06-21 10:00:00'}]
ecf8d3921fe7ec039f51e46e,What was the total metformin (glucophage) dose that patient 10020306 has been prescribed on the first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'metformin (glucophage)',SELECT SUM(metformin__glucophage_) FROM encounters WHERE patient_id = 10020306 AND NOT encounters.hospital_dischtime IS NULL ORDER BY encounters.hospital_admittime NULLS FIRST LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
ff9d739f6aef4f0e6a4fad34,What are the five most common laboratory tests undertaken by patients in the same month following a diagnosis of personal history of other venous thrombosis and embolism since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other venous thrombosis and embolism' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, t2.date FROM (SELECT patient.name, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'personal history of other venous thrombosis and embolism') AS t1 JOIN (SELECT patient.name, lab_test, date FROM lab_test JOIN patient ON lab_test.patient_id = patient.patient_id) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) >= DATETIME(t1.date, '-1 year')) AS t3 GROUP BY t3.lab_test ORDER BY COUNT(t3.lab_test) DESC LIMIT 5",
a65675d809840dc8d6dda8a4,What percentile is rdw 13.5 among patients of the same age as patient 10020786 on their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.5","SELECT t1.c1 FROM (SELECT lab.result, PERCENT_RANK() OVER (ORDER BY lab.result NULLS FIRST) AS c1 FROM lab WHERE lab.name = 'rdw' AND lab.patient_id = (SELECT patient.id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE id = 10020786 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1))) AS t1 WHERE t1.result = 13.5",
a8dc3b5c9cad1f39f5e216c6,Give me the count of patients who were prescribed gastroview (diatrizoate meglumine & sodium) since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'gastroview (diatrizoate meglumine & sodium)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.id) FROM patient WHERE patient.prescriptions >= (SELECT prescriptions FROM patient WHERE patient.id = 12345) AND DATETIME(patient.prescriptions.start_date) >= DATETIME(CURRENT_TIME, '-1 year') AND prescriptions.drug_name = 'Gastroview (Diatrizoate Meglumine & Sodium)'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
5f2a159055d6adad640855a4,Show me the top four most frequent drugs that patients were prescribed during the same hospital visit after being diagnosed with hemorrhage complicating a procedure in this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage complicating a procedure' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""Hemorrhage complicating a procedure"" AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT admissions.subject_id, prescriptions.drug, prescriptions.prescription_date, admissions.admission_id FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE DATETIME(prescriptions.prescription_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id",
fd65cc9a15899b7d467ba196,Could you list the four diagnoses that had the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT diagnosis FROM (SELECT diagnosis, 3 AS month, '2022-01-01' AS censoring_date, NULL AS event_date FROM (SELECT patient_id, diagnosis FROM (VALUES (1, 'diabetes'), (2, 'hypertension'), (3, 'heart failure'), (4, 'stroke')) AS t(patient_id, diagnosis) GROUP BY diagnosis) AS t WHERE month = 3 ORDER BY month DESC LIMIT 1;",
61d45a73e8a0469f9bf963be,Can you tell me if patient 10020944 is male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944,SELECT gender FROM patients WHERE patient_id = 10020944,[{'gender': 'M'}]
17086641ec84cd4ab9ebe9be,What is the cost of a diagnosis for personal history of antineoplastic chemotherapy?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of antineoplastic chemotherapy' ) ),"SELECT DISTINCT cost FROM diagnosis WHERE personal_history = ""Antineoplastic chemotherapy""",
f46ac5597a933d3aa191df19,Give me the four most frequent procedures performed since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.procedure, COUNT(t1.procedure) FROM procedures AS t1 JOIN procedures_since_2000 AS t2 ON t1.procedure = t2.procedure GROUP BY t1.procedure ORDER BY COUNT(t1.procedure) DESC LIMIT 4",
33b970d4dd11fbe67b989d1c,Can you tell me the total amount of acetaminophen that patient 10007928 has been prescribed since 03/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND prescriptions.drug = 'acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*) FROM acetaminophen WHERE acetaminophen.patient_id = 10007928 AND STRFTIME('%y-%m', acetaminophen.date) >= '2100-03'",[{'SUM(prescriptions.dose_val_rx)': None}]
a3453842fa6d5f908f2e8c6e,What was the medication patient 10010471 was prescribed for the first time via po in 05/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT medication FROM patients WHERE patients.id = 10010471 AND medication.date_prescribed = '2022-05-01' AND medication.route = 'po',[]
f6274c47226150acc9cef0e2,Find out the number of medicines given to patient 10002428.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ),SELECT COUNT(*) FROM inventory WHERE inventory.patient_id = 10002428,[{'COUNT(*)': 320}]
c72069fe9515604ba1be94c3,"During the first hospital encounter, what was the average glucose value for patient 10013049?",SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ),SELECT AVG(glucose) FROM encounters WHERE patient_id = 10013049 AND NOT is_discharged = true ORDER BY encounter_date NULLS FIRST LIMIT 1;,[{'AVG(labevents.valuenum)': None}]
df5a3dc1bac62f8679a50e44,Was patient 10023239's % hemoglobin a1c last measured on the first hospital visit greater than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT % hemoglobin a1c FROM patients WHERE patient_id = 10023239 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime NULLS FIRST LIMIT 1) > (SELECT % hemoglobin a1c FROM patients WHERE patient_id = 10023239 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
c56635619ccd4b7ce64652e4,"Since 09/2100, what amount of fluoxetine was prescribed to patient 10014354?","SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.drug = 'fluoxetine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'",SELECT SUM(Fluoxetine) FROM medication WHERE patient = 10014354 AND date >= '2009-02-10',[{'SUM(prescriptions.dose_val_rx)': None}]
9838b1b25dbb387afc8f07aa,What is the prescription dose of opioid for patient 31306?,,SELECT SUM(prescription_dose) FROM prescriptions WHERE prescriptions.patient_id = 31306 AND prescriptions.drug_name = 'opioid',
d9cc62f7c052734452299128,What is the number of drugs patient 10037861 was prescribed?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ),SELECT COUNT(*) FROM drugs WHERE drugs.patient_id = 10037861,[{'COUNT(*)': 265}]
80804f44b70738e1d5232084,What number of patients were in the neurology during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient.subject) FROM patient WHERE patient.diagnosis = 'NEUROLOGY' AND DATETIME(patient.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
96cf60d6448c822883274a24,When was the first urine microbiology test performed since 03/2100 for patient 10018845?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM microbiology WHERE patient_id = 10018845 AND sample_type = 'urine' AND date >= '2000-03-21',[]
aae494e615785b0b4e7f5bd8,Tell me the insurance plan of patient 10007928 on their first hospital encounter.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT insurance_plan FROM patients WHERE patient_id = 10007928 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1;,[{'insurance': 'Other'}]
1cf9f8c80c784082726a6dde,Has patient 10014078 received any treatment of continuous invasive mechanical ventilation for less than 96 consecutive hours in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",SELECT COUNT(*) FROM treatment WHERE patient_id = 10014078 AND treatment_type = 'continuous invasive mechanical ventilation' AND hours < 96 AND year = 2100,
f34663f44ea8f4f001b5cd92,When did patient 10005909 receive the first duloxetine and levothyroxine sodium prescription at the same time in 11/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'duloxetine' AND admissions.subject_id = 10005909 AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levothyroxine sodium' AND admissions.subject_id = 10005909 AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",SELECT MAX(DATE '11/2100') FROM patients WHERE patients.patient_id = 10005909 AND patients.prescriptions.duloxetine = 1 AND patients.prescriptions.levothyroxine_sodium = 1,[]
c673226d59266c9f24c1559d,Does patient 70206 have a traveling history abroad?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_id = 70206 AND patients.travel_history_abroad = 'Yes',
a4b7670404c595bc4689c577,When was the first time that in 01/2100 patient 10003046 was prescribed a medication via sc?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM medication_usage WHERE patient_id = 10003046 AND sc_date IS NOT NULL AND date_prescribed BETWEEN '2001-01-2100' AND '2001-01-2100',[]
21e6de874970fa7ae9510d18,Does patient 6170 have previous overseas travel?,,,
d4255f4b8d7db34c02b8c1c8,"Throughout this month, when did patient 10008454 receive the last urine microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(collection_date) FROM urine_microbiology WHERE patient_id = 10008454,[]
c9f7a8db98a61fe956ee074c,What was the total amount of mirtazapine prescribed to patient 10020786 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND prescriptions.drug = 'mirtazapine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'",SELECT SUM(Mirtazapine) FROM prescriptions WHERE Patient_ID = 10020786 AND Date = '2007-07-01',[{'SUM(prescriptions.dose_val_rx)': None}]
6fc987dbdba9f552b5be7f44,Could you calculate the total amount of output from patient 10008454 since 192 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-192 day')",SELECT SUM(output) FROM output WHERE patient_id = 10008454 AND date >= CURRENT_DATE - INTERVAL '192' DAY;,[{'SUM(outputevents.value)': 10834.0}]
dbc236ec214beb6e0a9a5ff0,What is the treatment that patient 10016742 was given two or more times since 7 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-7 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t1.treatment FROM (SELECT treatment, COUNT(treatment) AS c1 FROM patient WHERE patient.id = 10016742 AND DATETIME(treatment) >= DATETIME(CURRENT_TIME, '-7 month') GROUP BY treatment) AS t1 WHERE t1.c1 >= 2",
8499e24e138f45443a93fa6d,How much did patient 10002495 weigh when measured for the last time since 12 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT patient.weight FROM patient WHERE patient.patient_id = 10002495 AND DATETIME(patient.weight_date) >= DATETIME(CURRENT_TIME, '-12 month') ORDER BY patient.weight_date DESC LIMIT 1;",[]
88ef45f61812b1ec67818a35,When was the last time that patient 10022017 had the maximum value of respiratory rate since 203 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-203 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT MAX(respiratory_rate) FROM patient WHERE patient.id = 10022017 AND DATETIME(respiratory_rate) >= DATETIME(CURRENT_TIME, '-203 day')",[]
9f9db02efbdc2ea5168b658f,Show the respiratory rate changes of patient 10031757 measured at 2100-10-26 21:00:00 compared to the value measured at 2100-10-26 20:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 20:00:00' ),SELECT (SELECT respiratory_rate FROM respiratory_rate_measurements WHERE patient_id = 10031757 AND measurement_time = '2100-10-26 21:00:00') - (SELECT respiratory_rate FROM respiratory_rate_measurements WHERE patient_id = 10031757 AND measurement_time = '2100-10-26 20:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 20:00:00' )"": None}]"
ae9c55faced4361a10905a51,What were the top five most common procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.name, COUNT(s.name) AS count FROM (SELECT name FROM procedures WHERE id > 2100 ORDER BY id NULLS FIRST LIMIT 5) AS t INNER JOIN procedures s ON t.name = s.name GROUP BY t.name;",
bfd7a42fc2f55f570373a0ef,What was the average value of monocytes for patient 10006053?,SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ),SELECT AVG(Monocytes) FROM lab_data WHERE Patient = 10006053;,[{'AVG(labevents.valuenum)': None}]
8de8d255ebcc53e5933862db,What output did patient 10011398 generate last on this month/26?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '26' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT SUM(output) FROM output WHERE patient = 10011398 AND date_trunc('month', date) = DATE '1992-09-26'",[]
ed782775b12829eac1c6a491,Has there been any organism found in patient 10015860's first swab microbiology test in their first hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'swab' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM organism_mixture WHERE patient_id = 10015860 AND microbiology_type = 'swab' AND organism_mixture_id = (SELECT organism_mixture_id FROM microbiology WHERE patient_id = 10015860 AND microbiology_type = 'swab' ORDER BY microbiology_date NULLS FIRST LIMIT 1);,[{'COUNT(*)>0': 0}]
9bb095b969e981359c08d126,Did patient 10022041 experience any procedure on the first hospital stay?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10022041 AND NOT procedures.hospital_dischtime IS NULL ORDER BY procedures.hospital_admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
ed7775067dbd67782c081e36,Can you inform me of the first macrophage test result for patient 10014078 since 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophage' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(Macrophage) FROM (SELECT Macrophage FROM Macrophage WHERE Patient = 10014078 AND Date >= '03/2100'),[]
934088633430fb5451e8191e,What was the last measured value of heart rate for patient 10018423 since 289 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-289 day') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM sensors WHERE patient_id = 10018423 AND measurement_time >= HEART_RATE_MEASUREMENT_TIME - INTERVAL '289 days',[]
5b28d4b561ee2e25d84025fb,What's the number of patients who were pulmonary congestion and hypostasis diagnosed?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pulmonary congestion and hypostasis' ) ),SELECT COUNT(DISTINCT Id) FROM Postgres_db.diagnoses WHERE diagnosis_name = 'Pulmonary congestion and hypostasis',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
6efcf394736a462c14ad905e,How often was phenytoin sodium prescribed since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Phenytoin Sodium' AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)': 0}]
abae98d91941955983212127,Has patient 10022041 received any d5 1/2ns since 05/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-05'",SELECT COUNT(*) FROM patients WHERE patients.patient_id = 10022041 AND patients.d5_1_2ns >= '05/2100',[{'COUNT(*)>0': 0}]
def1690cfa1cd58ae29ab510,What was the total amount of soln that patient 10014078 has been prescribed in the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'soln',SELECT SUM(Soln) FROM Brackets WHERE PatientID = 10014078 AND NOT LastHospitalVisit IS NULL,[{'SUM(prescriptions.dose_val_rx)': None}]
cfb16f496f6c359ae9e6da4e,"What are the costs of allergic rhinitis, cause unspecified diagnosis?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, cause unspecified' ) )","SELECT cost FROM diagnosis WHERE diagnosis = 'allergic rhinitis, cause unspecified'",
bb8a1fa7460a1e93f7fe94cd,What about the single rooms which are now out there?,,,
eed48c889b928f3ee845e151,How much is the total minimum cost for a hospital that includes a white blood cells lab test throughout this year?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.lab_test = 'white blood cells' GROUP BY cost_table.year) AS t1,
9997157eb5c508f263b4a2b0,Tell me the length of stay of patient 10026354's first ICU stay in days.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT COUNT(DISTINCT ICU_STAY_ID) FROM ICU_STAYS WHERE PATIENT_ID = 10026354 AND NOT ICU_STAY_ID IN (SELECT ICU_STAY_ID FROM ICU_STAYS WHERE PATIENT_ID = 10026354 AND STATION = 'home'),"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.3870138889178634}]"
53645af951b7d3f45781e59f,"In relation to others of the same age, where does a urea nitrogen value of 11.0 for patient 10023117 rank in percentiles on their last hospital encounter?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.0","SELECT DISTINCT t1.c1 FROM (SELECT lab.result, PERCENT_RANK() OVER (ORDER BY lab.result NULLS FIRST) AS c1 FROM lab WHERE lab.labname = 'urea nitrogen' AND lab.patientid IN (SELECT patient.patientid FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = 'Jane Doe' AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1))) AS t1 WHERE t1.result = 11.0",
d57dc0bf4122ea92cbe3fbbf,When was the last time patient 10007818 was prescribed medication via the replace route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'replace' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10007818 AND route = 'REPLACE',[]
aa866c43eb90dfddc649fe35,"How many instances of the dilation of left common iliac vein with intraluminal device, percutaneous approach procedure were there during the previous year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.long_description = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
2ad19063a657310f5f20de33,What was the first time patient 10014354 input time since 03/19/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_data WHERE patient_id = 10014354 AND input_time >= '2100-03-19',[{'starttime': '2146-10-09 01:41:00'}]
1c2352529be1c26de9ae73e4,What is patient 10031757's rdw change last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab_value FROM lab_measurements WHERE lab_measurements.patient_id = 10031757 AND lab_measurements.measurement_type = 'rdw' ORDER BY lab_measurements.measurement_date DESC LIMIT 1) - (SELECT lab_value FROM lab_measurements WHERE lab_measurements.patient_id = 10031757 AND lab_measurements.measurement_type = 'rdw' ORDER BY lab_measurements.measurement_date DESC LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
d3d61d08b329e1aaf3de1a85,What is the price of a drug named fentanyl citrate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl citrate' ),,
402ffae6336ceeb14052f50e,Was patient 10018328 diagnosed with anything in the first hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10018328 AND NOT diagnoses.hospital_id IS NULL ORDER BY diagnoses.hospital_admission_date NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
aa8a3e6c3b2e1ac22610e5df,Retrieve the top three most frequent lab tests since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT lab_test, COUNT(lab_test) FROM lab_tests WHERE date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 3;","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
b8e9b90e80a785175600b2ff,What was the last dose of tobramycin sulfate that patient 10007818 was prescribed during the first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'tobramycin sulfate' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(dose) FROM prescriptions WHERE patient_id = 10007818 AND prescriptions.drug_name = 'Tobramycin Sulfate',[]
21f3520f8db52d400b139521,How many hours have passed since the last time patient 10004733 has received a anticardiolipin antibody igg-lab test on the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igg' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', anticardiolipin_antibody_igg_lab.last_test_date)) FROM anticardiolipin_antibody_igg_lab WHERE anticardiolipin_antibody_igg_lab.patient_id = 10004733 AND anticardiolipin_antibody_igg_lab.last_test_date IS NOT NULL;",[]
4d2e6a2bf7e989ac0488030c,Tell me the average total hospital cost that includes dissection of abdominal aorta.,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of abdominal aorta' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.c) FROM (SELECT SUM(T2.c) AS c FROM (SELECT 1 AS c FROM procedures WHERE p_name = 'dissection of abdominal aorta') AS T1 JOIN (SELECT 1 AS c FROM procedures WHERE p_name = 'dissection of abdominal aorta') AS T2 ON T1.p_name = T2.p_name GROUP BY T1.p_name) AS T3,
894403f12b36b4f785b9894d,What were the total number of patients discharged from the hospital in the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT patient_id) FROM admissions WHERE NOT dismissed_date IS NULL AND DATETIME(discharged_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c642922a8ac294d31682581d,Count the number of hospital visits for patient 10011398.,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10011398,SELECT COUNT(visit_id) FROM visit_table WHERE patient_id = 10011398;,[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
b6556ac9fb3dd561d02e99a5,Which are the top five most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT OUTPUT_EVENT, COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME = 'OUTPUT_EVENT' AND TIMESTAMP_ column >= (CURRENT_TIMESTAMP - INTERVAL '1 year') GROUP BY OUTPUT_EVENT ORDER BY COUNT(*) DESC LIMIT 5;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
eefb36fdfc2d06211f4348ec,Has patient 10038999 been given any magnesium sulfate (bolus) medication in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10038999 AND medication.dose = 'magnesium sulfate (bolus)' AND DATETIME(medication.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year') AND STRFTIME('%m', medication.date) = '12'",[{'COUNT(*)>0': 0}]
f0792acd794b3cf007d78f92,Could you tell me the maximum total cost for the hospital visits where potassium chl 20 meq / 1000 ml ns is used during this year?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml ns' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.total_cost) FROM (SELECT SUM(cost) AS total_cost FROM cost_table WHERE cost_table.product_name = 'potassium chl 20 meq / 1000 ml ns' AND DATETIME(cost_table.visit_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY cost_table.visit_date) AS t1",
6bac631eb4407c64590d6679,What was the name of the first medication that was prescribed to patient 10004720 since 02/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT medication_name FROM prescriptions WHERE patient_id = 10004720 AND date_prescribed >= '2002-02-2100' ORDER BY date_prescribed NULLS FIRST LIMIT 1,[{'drug': 'Heparin'}]
909212b3de8ea34ca2c96475,Is the value of arterial blood pressure diastolic of patient 10004235 second measured on the last ICU visit greater than the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT arterial_blood_pressure_diastolic FROM icu_visits WHERE icu_visits.patient_id = 10004235 AND NOT icu_visits.department = 'diagnostic' ORDER BY icu_visits.admittime DESC LIMIT 1) > (SELECT arterial_blood_pressure_diastolic FROM icu_visits WHERE icu_visits.patient_id = 10004235 AND NOT icu_visits.department = 'diagnostic' ORDER BY icu_visits.admittime DESC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
a5245904049b7aae3a154666,"Was hydrochlorothiazide, vial, or atenolol ordered in their last hospital encounter for patient 10016810?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'hydrochlorothiazide', 'vial', 'atenolol' )","SELECT COUNT(DISTINCT t4.c1) FROM (SELECT t2.c1 FROM (SELECT t1.c1 FROM (SELECT '10016810' AS c1) AS t1 JOIN (SELECT '2022-01-01' AS c2) AS t2 ON t1.c1 = t2.c1) AS t3 JOIN (SELECT 'hydrochlorothiazide, vial, or atenolol' AS c1 FROM (SELECT '2022-01-01' AS c2) AS t4 ON t3.c1 = t4.c1) AS t5;",[{'COUNT(*)>0': 0}]
9b56d431c0b4eac3cf5171d7,What percentile is mchc 32.2 among patients of the same age as patient 10027602 during their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.2","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, MCHC.mchc FROM MCHC JOIN patient ON MCHC.patient = patient.subject WHERE MCHC.mchc = 32.2 AND patient.age = (SELECT patient.age FROM patient WHERE patient.subject = '10027602')) AS t1 JOIN (SELECT patient.age, MCHC.mchc FROM MCHC JOIN patient ON MCHC.patient = patient.subject WHERE MCHC.mchc = 20.5 AND patient.age = (SELECT patient.age FROM patient WHERE patient.subject = '10027602')) AS t2 ON t1.age = t2.age WHERE t1.c1 = 0 AND t2.c1 = 1",
304190e81318d73ef0c5f885,What is today's outpatient schedule for dr. knight?,,SELECT SUM(outpatient_schedule) FROM employees WHERE employee_name = 'Dr. Knight';,
decc4b6118addbb54d49b4ee,Can you show me the top four frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT FROM duckdb_events WHERE date > '1 year ago' AND event_type = 'output' ORDER BY COUNT DESC LIMIT 4;,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
2733bc74cdbe99ae5365284d,When was the last time patient 10018081 was measured with a heart rate greater than 62.0 on their current ICU encounter?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 62.0 ORDER BY chartevents.charttime DESC LIMIT 1,"SELECT MAX(string_to_timestamp(heart_rate, 'brackets')) FROM patient WHERE patient_id = 10018081 AND heart_rate > 62.0",[]
de0f8a295e6a5cf79b31633d,Could you show me the top five most common microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.name, COUNT(t.name) FROM (SELECT microbiology_tests.name FROM microbiology_tests WHERE microbiology_tests.timestamp > DATEADD(year, -1, CURRENT_TIMESTAMP)) AS t GROUP BY t.name ORDER BY COUNT(t.name) DESC LIMIT 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
e55eee58f7de7acb4afa8764,How many times was patient 10022880 in the hospital throughout this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022880 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM hdb.patients WHERE patient_id = 10022880 AND DATETIME(hdb.patients.admittime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
5fb21a95a15d64c85db2fed8,Count the number of drugs prescribed since 08/2100 for patient 10038081.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10038081 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-08'",[{'COUNT(*)': 99}]
9d4a3fe390f0fef8dc0d86b3,"What are the four frequently prescribed medications for patients diagnosed with bipolar disorder, unspecified previously in the same hospital encounter?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bipolar disorder, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t1.name FROM (SELECT COUNT(DISTINCT diagnosis_id) AS c1 FROM (SELECT diagnosis_id FROM diagnoses WHERE diagnosis = 'bipolar disorder, unspecified') AS t1 JOIN (SELECT diagnosis_id FROM diagnoses WHERE diagnosis = 'bipolar disorder, unspecified') AS t2 ON t1.diagnosis_id = t2.diagnosis_id WHERE t1.diagnosis_id = t2.diagnosis_id GROUP BY diagnosis_id) AS t3 JOIN (SELECT medicine_id, name FROM medications) AS t4 ON t3.c1 = t4.medicine_id",
51c4e6f08f5029501e961a4a,When did patient 10009628 receive an input for the first time on 10/02/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '10-02' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_date) FROM input_table WHERE patient_id = 10009628 AND input_date >= '2022-10-02',[]
7cee0315da660d7678b612e3,When on the last hospital stay did patient 10038992 receive the basophils test for the last time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(BracketStrips.Strips) FROM (SELECT Brackets.Strips FROM (SELECT Patient.Strips FROM Patient WHERE Patient.Strips = '10038992') AS Patient JOIN Brackets ON Patient.Strips = Brackets.Strips) AS BracketStrips WHERE BracketStrips.Strips LIKE '%basophils%',[]
4d9bd3d3dbfcb23cf47cb0c6,"In 2100, what are the top five most common specimens tested for patients previously diagnosed with personal history of self-harm within the same month?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of self-harm' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t1.specimen, COUNT(t1.specimen) FROM (SELECT t1.subject_id, t2.specimen FROM (SELECT subject_id, specimen FROM (SELECT 1 AS subject_id, 'specimen1' AS specimen FROM patients WHERE personal_history = 'self-harm') AS t1 JOIN (SELECT 1 AS subject_id, 'specimen2' AS specimen FROM patients WHERE personal_history = 'self-harm') AS t2 ON t1.subject_id = t2.subject_id WHERE NOT t1.subject_id IS NULL AND NOT t2.subject_id IS NULL AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month') GROUP BY t1.subject_id, t2.specimen) AS t1 JOIN patients AS t2 ON t1.subject_id = t2.subject_id WHERE t2.diagnosis_date = DATETIME(t1.diagnosis_date, 'start of month') GROUP BY t1.specimen ORDER BY COUNT(t1.",
eba0b6f7c2c449d19740a2ca,What was the name of the drug that was prescribed to patient 10004235 during the same hospital visit after having had a hemodialysis procedure since 11 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.uniquecarrier, treatment.startdate, patient.patientid FROM treatment JOIN patient ON treatment.patientid = patient.patientid WHERE patient.patientid = 10004235 AND treatment.treatmenttype = 'hemodialysis' AND DATETIME(treatment.startdate) >= DATETIME(CURRENT_TIME, '-11 month')) AS t1 JOIN (SELECT patient.uniquecarrier, prescription.drug, prescription.startdate, patient.patientid FROM prescription JOIN patient ON prescription.patientid = patient.patientid WHERE patient.patientid = 10004235 AND DATETIME(prescription.startdate) >= DATETIME(CURRENT_TIME, '-11 month')) AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.startdate < t2.startdate AND t1.patientid = t2.patientid",
97618f1a942f1a7582d5b1a9,What are the new medications prescribed to patient 10039831 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT SUM(new.quantity) FROM (SELECT patient.id, medication.quantity, date_sub('day', date_trunc('day', current_timestamp), date_trunc('day', current_timestamp - INTERVAL '1 day')) as age FROM patient JOIN medication ON patient.id = medication.patient WHERE patient.id = 10039831) as new WHERE new.age >= 0",[]
4aec6b15c63a023c98af9fbd,When did patient 10018423 have the minimum mean blood pressure the last time on their first ICU visit?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1","SELECT MIN(mean_blood_pressure) FROM (SELECT mean_blood_pressure FROM (SELECT patient_id, mean_blood_pressure FROM (SELECT patient_id, blood_pressure FROM (SELECT patient_id, blood_pressure FROM patients WHERE patient_id = 10018423) AS t1 JOIN icu_visits AS t2 ON t1.patient_id = t2.patient_id) AS t3 JOIN patient_summary AS t4 ON t3.patient_id = t4.patient_id WHERE t4.icu_visit_number = 1)",[]
2021b8d65fd7fd080d685ca4,Was patient 10029484 tested in the 25-oh vitamin d lab in the last month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*) FROM lab_results WHERE lab_results.patient_id = 10029484 AND lab_results.lab_name = '25-oh vitamin d' AND DATETIME(lab_results.result_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month')",[{'COUNT(*)>0': 0}]
a9fa2caa73b48c01d20c7f01,What was the name of the medication that patient 10012552 was prescribed in the same hospital encounter after receiving a single internal mammary-coronary artery bypass procedure in 04/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.name FROM (SELECT patient.id, treatment.hospital_ encounter_id FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10012552 AND treatment.treatment_type = 'single internal mammary-coronary artery bypass' AND DATETIME(treatment.treatment_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', treatment.treatment_date) = '04') AS t1 JOIN (SELECT patient.id, medication.name FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.id = 10012552 AND DATETIME(medication.dispense_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', medication.dispense_date) = '04') AS t2 ON t1.id = t2.id WHERE t1.",
7e79e5876cb4505b0d14e7f2,Could you tell me the average total cost in a hospital where methylprednisolone sodium succ is used in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylprednisolone sodium succ' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(T1.c1) FROM (SELECT SUM(T1.c1) AS c1 FROM (SELECT T2.c1 FROM (SELECT DISTINCT YEAR(date) AS c1 FROM medication WHERE medication.drug = 'methylprednisolone sodium succ') AS T1 JOIN patient ON T1.patient_id = patient.patient_id WHERE T1.date = 2100 GROUP BY T1.patient_id) AS T2),
dba558e5efd6207a1ad84c29,"Is patient 10031757's chloride, whole blood last measured on the first hospital visit greater than the first value measured on the first hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT (SELECT Chloride, Whole Blood FROM lab_data WHERE Patient ID = 10031757 AND NOT Hospital Dischtime IS NULL ORDER BY Hospital Admittime NULLS FIRST LIMIT 1) > (SELECT Chloride, Whole Blood FROM lab_data WHERE Patient ID = 10031757 AND NOT Hospital Dischtime IS NULL ORDER BY Hospital Admittime NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
42ba16664bb27443701345aa,"Among patients who underwent ileostomy, not otherwise specified since 2100, what were the top four most common procedures that followed within the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.ileostomy, t2.top4 FROM (SELECT t1.ileostomy, t2.top4 FROM (SELECT ileostomy.ileostomy, 0 AS top4 FROM ileostomy WHERE ileostomy.year >= 2100 GROUP BY ileostomy.ileostomy) AS t1 JOIN (SELECT ileostomy.ileostomy, 1 AS top4 FROM ileostomy WHERE ileostomy.year >= 2100 GROUP BY ileostomy.ileostomy) AS t2 ON t1.ileostomy = t2.ileostomy WHERE DATE_DIFF('month', t1.ileostomy, t2.top4) <= 1) AS t3 JOIN (SELECT top4.top4, 0 AS ileostomy FROM (SELECT top4.top4, 0 AS ileostomy FROM (SELECT 0 AS top4) AS top4 JOIN (SELECT 1 AS ileostomy FROM ileostomy WHERE ileostomy.year >= 2100 GROUP BY ileostomy.ileostomy) AS top4 ON top",
bb21fc57075b8a90bdec2466,What is the standard of reimbursement for chromosome and genetic tests?,,"SELECT STD_REIMBURSEMENT FROM (SELECT DISTINCT ON (chromosome, genetic_test) chromosome, genetic_test, std_reimbursement FROM brackets_schema) AS subquery;",
bbcd893acd5b02637bedbb4d,"Throughout this month, when did patient 10021118 last receive a absolute basophil count test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY labevents.charttime DESC LIMIT 1",SELECT MAX(absolut_basophil_count) FROM lab_data WHERE lab_data.patient_id = 10021118 AND lab_data.test_name = 'absolute basophil count',[]
74f00dc121afbe12df42ad01,Provide the total input volume for patient 10023239 since 184 days ago.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-184 day')",SELECT SUM(input_volume) FROM intake_table WHERE patient_id = 10023239 AND input_date >= CURRENT_DATE - INTERVAL '184' DAY;,[{'SUM(inputevents.totalamount)': 34120.0}]
1794f31aaf8abd01fe9c8e47,Can you tell me the five most frequent microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t1.tag, COUNT(t1.tag) FROM microbiology AS t1 JOIN postgres_db.microbiology_tags AS t2 ON t1.tag = t2.tag WHERE t1.date > '1 year ago' GROUP BY t1.tag ORDER BY COUNT(t1.tag) DESC LIMIT 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
f099406d471ff52b20ae8441,Has patient 10020944 had any diagnoses?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10020944,[{'COUNT(*)>0': 1}]
82922424bd771f502216cfe8,When was the first time patient 10020187 was measured mean blood pressure less than 91.0 on 02/03/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 91.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-03' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime(measured_mean_blood_pressure(10020187), '%d/%m/%Y') FROM measured_mean_blood_pressure WHERE measured_mean_blood_pressure < 91.0 AND strftime(measured_mean_blood_pressure(10020187), '%Y') = strftime(CURRENT_DATE, '%Y') AND strftime(measured_mean_blood_pressure(10020187), '%m') = strftime(CURRENT_DATE, '%m') AND strftime(measured_mean_blood_pressure(10020187), '%d') = strftime(CURRENT_DATE, '%d') ORDER BY measured_mean_blood_pressure(10020187) NULLS FIRST LIMIT 1",[]
fde6441b3751a0976d557a92,What are the five most common treatments for patients who are 30s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment FROM (SELECT '30s' AS treatment) AS t GROUP BY t.treatment) AS t1 GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 5",
3f0035e87fa9e0e54608b6e8,What were the name of the treatment received by patient 10029291 two or more times during the last hospital visit?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t1.treatment_name FROM (SELECT treatment_name, COUNT(treatment_name) AS c1 FROM patient WHERE patient.patient_id = 10029291 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1) AS t1 WHERE t1.c1 >= 2",
2e2da95ca5d2a04c74e036f7,When was the first time the systolic blood pressure of patient 10018081 was measured on this ICU encounter at less than 100.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 100.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(systolic_blood_pressure) FROM intake_output WHERE patient_id = 10018081 AND icu_dischtime IS NULL AND systolic_blood_pressure < 100.0,[]
06b6972a43b2dba9856ec0bd,"In 2100, what are the top four most frequently tested specimens for patients during the same month after receiving introduction of other therapeutic substance into heart, open approach?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT patient.specimen, COUNT(patient.specimen) FROM patient WHERE patient.patient_id IN (SELECT treatment.patient_id FROM treatment WHERE treatment.treatment_type = 'introduction of other therapeutic substance into heart, open approach') GROUP BY patient.specimen) AS t1 JOIN (SELECT patient.specimen, COUNT(patient.specimen) FROM patient WHERE patient.patient_id IN (SELECT treatment.patient_id FROM treatment WHERE treatment.treatment_type = 'introduction of other therapeutic substance into heart, open approach') GROUP BY patient.specimen) AS t2 ON t1.specimen = t2.specimen JOIN (SELECT patient.specimen, COUNT(patient.specimen) FROM patient WHERE patient.patient_id IN (SELECT treatment.patient_id FROM treatment WHERE treatment.treatment_type = 'introduction of other therapeutic substance into heart, open approach') AND DATET",
1e60f35bb520bb22a0d6dcf1,When was patient 10018423 prescribed for the first time in 05/2100 a medication via sc route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM medication WHERE medication_route = 'sc' AND patient_id = 10018423 AND date_prescribed BETWEEN '2000-05-2100' AND '2000-05-2101',[]
a693683961d00b054d159be0,What was patient 10019385's total input amount of nacl 0.9% on 03/12/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-12'",SELECT SUM(input_amount) FROM input_table WHERE patient_id = 10019385 AND input_date = '2100-03-12' AND input_type = 'nacl 0.9%',[{'SUM(inputevents.totalamount)': None}]
e054b776ce8b992288d3a151,What is the outpatient schedule of dr. swain today?,,SELECT COUNT(DISTINCT patient_id) FROM appointment WHERE appointment_type = 'outpatient' AND doctor_id = (SELECT doctor_id FROM staff WHERE staff_name = 'dr. swain') AND appointment_date = CURRENT_DATE,
fb95177b2a968ec680128db1,How many days is it since patient 10004733 first stayed in the careunit medicine during the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1",SELECT COUNT(*) FROM careunit_medicine WHERE patient_id = 10004733 AND date_started = (SELECT MIN(date_started) FROM careunit_medicine WHERE patient_id = 10004733 AND location = 'medicine'),[]
f531d0fed3a37f3e379fb328,Did patient 10022041 visit an emergency room in their first hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*) > 0 FROM visit_history WHERE visit_history.patient_id = 10022041 AND visit_history.location = 'emergency room admit' AND NOT visit_history.dischtime IS NULL ORDER BY visit_history.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
b631a1615445ca9ec8e26a42,What procedure was given to patient 10019777 two times since 21 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10019777 AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-21 month') GROUP BY procedures.date HAVING COUNT(*) = 2",
4d21ff0e9b82a46ea21db1c1,Has patient 10005817 had platelet count tests in this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10005817 AND lab_results.test_name = 'platelet count' AND DATETIME(lab_results.result_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')",[{'COUNT(*)>0': 0}]
1e7fca2277094f23cec3aa76,What was the total number of patients staying in medical intensive care unit (micu) in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, MICU_USAGE.micu_start_date FROM admissions JOIN MICU_USAGE ON admissions.subject_id = MICU_USAGE.subject_id WHERE MICU_USAGE.micu_start_date BETWEEN '2100-01-01' AND '2100-12-31') AS t1 JOIN (SELECT admissions.subject_id, MICU_USAGE.micu_start_date FROM admissions JOIN MICU_USAGE ON admissions.subject_id = MICU_USAGE.subject_id WHERE MICU_USAGE.micu_start_date BETWEEN '2100-01-01' AND '2100-12-31' AND MICU_USAGE.micu_duration > 1) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.micu_start_date = t2.micu_start_",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c0a87bdad4a3ac34d3210642,"For patient 10022041, what was the first vitamin b12 reading?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT MIN(vitamin_b12) FROM patient_vitals WHERE patient_id = 10022041,[]
c9d4464b66be176cf11f8d68,"How much will it cost me to get introduction of nutritional substance into central vein, percutaneous approach done?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure = 'Introduction of nutritional substance into central vein, percutaneous approach';",
f8e70aaaef039854b3b29401,What drugs have been added to patient 10018081's prescription today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescription_today FROM prescriptions WHERE patient_id = 10018081,[]
0d93e83a24f730a575941764,"Was there any lisinopril, 0.45% sodium chloride, or levothyroxine sodium ordered for patient 10002428 during their first hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', '0.45% sodium chloride', 'levothyroxine sodium' )","SELECT COUNT(*) > 0 FROM orders WHERE patient_id = 10002428 AND order_date = MIN(date_admitted) AND medication IN ('lisinopril', '0.45% sodium chloride', 'levothyroxine sodium')",[{'COUNT(*)>0': 0}]
8bce38cc6e677156d2b90712,When did patient 10038999 receive the first sputum microbiology test in their first hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT MIN(microbiology_date) FROM microbiology WHERE microbiology.patient_id = 10038999 AND microbiology.type = 'sputum',[]
644f9d16a15d38b492e0d147,"Has since 2100 levothyroxine sodium, acetaminophen, or polyethylene glycol been prescribed to patient 10005909?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.drug IN ( 'levothyroxine sodium', 'acetaminophen', 'polyethylene glycol' ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10005909 AND prescriptions.drug IN ('2100 levothyroxine sodium', 'acetaminophen', 'polyethylene glycol')",[{'COUNT(*)>0': 0}]
8fe130affd01259653e65799,Can you show me the four most frequently taken lab test?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT lab_test, COUNT(lab_test) FROM lab_group GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
f8da84426c2c001652c1ea5f,When did patient 10021487 last have a maximum value of diastolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(diastolic_blood_pressure) FROM patient_10021487;,[]
25c653da4cccc0b0dec24e49,What are the new drugs for patient 10018081 today compared to the earlier ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM drugs WHERE patient_id = 10018081 AND date = '2022-10-08' - INTERVAL '1 day' AND date_yesterday = '2022-10-08' - INTERVAL '1 day' ORDER BY date DESC,[]
3756db86af40c5904040408f,What was patient 10021666's minimum SaO2 reading?,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ),"SELECT MIN(SaO2) FROM ""patient10021666""",[{'MIN(chartevents.valuenum)': None}]
6ec5c2c1bd1fc8781c4fea87,"How many instances of dilation of left external iliac vein with intraluminal device, percutaneous approach procedures have been completed since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.description = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' AND STRFTIME('%y', procedures.date) >= '2100'",
d4d740fa5b9015e952111b32,When patient 10027445 was prescribed for the first time in 09/this year docusate sodium and furosemide at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'docusate sodium' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT COUNT(DISTINCT t1.start_date) FROM (SELECT patient.prescription_start_date, patient.patient_name FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE prescription.drug_name = 'docusate sodium' AND patient.patient_id = 10027445 AND DATETIME(prescription.start_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescription.start_date) = '09') AS t1 JOIN (SELECT patient.prescription_start_date, patient.patient_name FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE prescription.drug_name = 'furosemide' AND patient.patient_id = 10027445 AND DATETIME(prescription.start_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m",[]
501d7e20f28d6572b7ea2104,When did patient 10021118 have the last minimum creatine kinase (ck) value on their first hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MIN(Creatine Kinase (CK)) FROM patient WHERE patient.hospital_number = 1 AND patient.patient_name = '10021118',[]
bb8bc2404e614f44d69a488c,Can you tell me the top four most common lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.lab_test, COUNT(t4.lab_test) FROM (SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT t1.subject_id, t1.date_of_test FROM (SELECT SUM(t1.subject_id) AS subject_id, t1.date_of_test FROM t1 WHERE t1.date_of_test >= '2100-01-01' GROUP BY t1.date_of_test) AS t2 JOIN (SELECT t1.subject_id, t1.lab_test FROM t1 WHERE t1.date_of_test >= '2100-01-01') AS t3 ON t2.subject_id = t3.subject_id GROUP BY t2.lab_test) AS t4 GROUP BY t4.lab_test ORDER BY COUNT(t4.lab_test) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
00f2bfbc43dcc4875ed114f9,What is the maximum total cost at a hospital including a albumin laboratory test in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE year = 2100 AND cost > 0 GROUP BY patient_id) AS t1 JOIN patient ON t1.patient_id = patient.patient_id JOIN lab ON t1.patient_id = lab.patient_id WHERE lab.lab_name = 'albumin',
196b4c9d5405c65e47b0c14d,What was the organism found in the last microbiology test done on the patient 10007795's foreign body in 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'foreign body' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism FROM microbiology WHERE patient_id = 10007795 AND sample_type = 'foreign body' AND date = '2100-05-2100' ORDER BY date DESC LIMIT 1,[]
42e82e626162ecd5abe81360,Can you tell me when patient 10016742 had their first rapid respiratory viral screen & culture microbiology test in 08/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT MAX(date) FROM microbiology WHERE microbiology.patient_id = 10016742 AND microbiology.test_name = 'rapid respiratory viral screen & culture' AND DATETIME(microbiology.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', microbiology.date) = '08'",[]
cf8596ed1cee62a5ad2886d8,What is the price for felodipine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'felodipine' ),SELECT price FROM products WHERE product = 'felodipine',
c1dfd71e56e3403bac064d97,Can you tell me the top three most common lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date > (CURRENT_DATE - INTERVAL '1 year')) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
a5681c4eead8c8b2e1968ab1,How much furosemide has been prescribed to patient 10027445 in 08/this year in total?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'furosemide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08'","SELECT SUM(Furosemide) FROM prescriptions WHERE prescriptions.patient_id = 10027445 AND DATETIME(prescriptions.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date_prescribed) = '08'",[{'SUM(prescriptions.dose_val_rx)': None}]
e3732452c0c7cbd80082d35c,Could you tell me the gender of patient 10023239?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10023239,SELECTgender FROM patients WHERE patient_id = 10023239,[{'gender': 'F'}]
b48e7a50e9e73818c7619a51,How much is the average total hospital cost with personal history of malignant neoplasm of tongue in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of tongue' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(si.cost) AS c1 FROM (SELECT s.cost FROM (SELECT 1 AS cost FROM diagnoses WHERE diagnosis = 'MALIGNEOPLASM OF TONGUE') AS s JOIN patient p ON s.patient_id = p.patient_id WHERE s.year = 2100 GROUP BY p.patient_id) AS t1 JOIN patient p ON t1.patient_id = p.patient_id WHERE p.diagnosis = 'MALIGNEOPLASM OF TONGUE',
9d564188b506bcd7d94a1018,Tell me the top four most frequent procedures that patients received in the same hospital visit after being diagnosed with accidents occurring in other specified places since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in other specified places' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.treatment, COUNT(t4.treatment) FROM (SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, COUNT(t2.treatment) FROM (SELECT t1.treatment, COUNT(t1.treatment) FROM diagnoses AS t1 JOIN accidents AS t2 ON t1.diagnosis_id = t2.diagnosis_id WHERE t1.date_of_diagnosis >= '2100-01-01' AND t2.date_of_accident >= '2100-01-01' AND t1.diagnosis_type = 'ACCIDENTS OCCURRING IN OTHER SPECIFIED PLACES') AS t2 JOIN (SELECT t1.treatment, COUNT(t1.treatment) FROM procedures AS t1 JOIN accidents AS t2 ON t1.accident_id = t2.accident_id WHERE t2.date_of_accident >= '2100-01-01",
ff7c3e66b7fe93c4c036fe1e,What is patient 10017492's difference in rbc from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab_result FROM lab_measurements WHERE lab_measurements.patient_id = 10017492 AND lab_measurements.label = 'rbc' ORDER BY lab_measurements.measurement_time NULLS FIRST LIMIT 1) - (SELECT lab_result FROM lab_measurements WHERE lab_measurements.patient_id = 10017492 AND lab_measurements.label = 'rbc' ORDER BY lab_measurements.measurement_time NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
f2b643094d07ac4dcac036f6,"What is the total count of drainage of pericardial cavity with drainage device, percutaneous approach procedures that were done?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' )",SELECT COUNT(*) FROM procedures WHERE procedures.drainage_device = 'percutaneous approach' AND procedures.discharge_location = 'pericardial cavity',[{'COUNT(*)': 0}]
26ea9369abea20ebb7ca20ae,What was the last value of the o2 saturation pulseoxymetry for patient 10038999 since 06/03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-03' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(O2_SATURATION_PULSEOXIM) FROM pulseoxymetry WHERE PATIENT_ID = 10038999 AND START_TIME >= '2100-06-03',[]
4f3f80819d74ba44d60716b2,Retrieve the top three most frequent medications that patients were prescribed in the same month after being diagnosed with cerebral edema.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral edema' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.ID, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_ID = patient.ID WHERE diagnosis.diagnosis = 'Cerebral edema') AS t1 JOIN (SELECT patient.ID, medication.medication, medication.medication_date FROM medication JOIN patient ON medication.patient_ID = patient.ID) AS t2 ON t1.ID = t2.ID WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_date, 'start of month') GROUP BY t2.medication) AS t3 WHERE t3.c1 <= 3",
c1a9f03dd5bb3142dac26180,List the top three most occurring events.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT Event, COUNT(*) FROM log GROUP BY Event ORDER BY COUNT(*) DESC LIMIT 3;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
b53daa3c6e0af875928b6bd7,"How many days have passed since the last time patient 10021487 received a lab test of calcium, urine during the current hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result.lab_date)) FROM lab_result WHERE lab_result.patient_id = 10021487 AND lab_result.lab_name = 'Calcium, Urine' AND lab_result.hospital_id = (SELECT lab_result.hospital_id FROM lab_result WHERE lab_result.patient_id = 10021487 AND lab_result.lab_name = 'Calcium, Urine' ORDER BY lab_result.lab_date DESC LIMIT 1);",[]
7c81288ded12d53cddc28dea,"In 2100, which are the three most frequent lab tests given to patients in the same month after they are diagnosed with atherosclerotic heart disease of native coronary artery without angina pectoris?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery without angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'Atherosclerotic heart disease of native coronary artery without angina pectoris' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.uniquepid, lab_test, lab_date FROM lab WHERE STRFTIME('%y', lab_date) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.lab_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_date, 'start of month') GROUP BY t2.lab_test) AS t3 WHERE t3.c1 <= 3",
3f7e59eb07f66f58689fdf28,Calculate how many drugs patient 10009049 was prescribed.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ),SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10009049,[{'COUNT(*)': 41}]
fdc15c3b4760871eec9eb7f4,"Show the number of patients who underwent respiratory ventilation, greater than 96 consecutive hours.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )",SELECT COUNT(DISTINCT Patient_ID) FROM RespiratoryVentilation WHERE RespiratoryVentilation > 96,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
1adba3ceaf529ef2a8dda81a,Was the phosphate reading for patient 10020187 measured at 2100-02-10 05:25:00 less than the value measured at 2100-02-09 05:00:00?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-10 05:25:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-09 05:00:00' ),SELECT (SELECT phosphate FROM lab_data WHERE patient_id = 10020187 AND measurement_time = '2100-02-10 05:25:00') < (SELECT phosphate FROM lab_data WHERE patient_id = 10020187 AND measurement_time = '2100-02-09 05:00:00'),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-10 05:25:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-09 05:00:00' )"": None}]"
1d509edaa223f304f5ee3b9f,What drug was first prescribed to patient 10007058 since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(drug_name) FROM prescriptions WHERE patient_id = 10007058 AND prescriptions.date >= '2009-09-2100',[{'drug': '5% Dextrose'}]
0ad0dc8594dbfe64d10295e8,"For patients who received other electroshock therapy since 2100, what are the top four most frequent diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d.diagnosis, COUNT(d.diagnosis) FROM diagnoses d INNER JOIN treatment_electroshock t ON d.treatment_id = t.treatment_id WHERE t.electroshock_type = 'Other' AND STRFTIME('%y', t.date) >= '2100' GROUP BY d.diagnosis ORDER BY COUNT(d.diagnosis) DESC LIMIT 4",
5a36e2b8accac68f5996e75c,"What is the minimum total hospital cost that includes a procedure named excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedures.name = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' GROUP BY procedures.id) AS t1",
4a9da1e78cc48ca85038714a,What is the value of patient 10039831's yearly average or packed rbc intake input since 12/08/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or packed rbc intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-08' GROUP BY strftime('%Y',inputevents.starttime)","SELECT AVG(Intake.RBC) FROM intake WHERE intake.patient = 10039831 AND intake.date >= '2100-12-08' AND intake.type = 'packed rbc' GROUP BY STRFTIME('%y', intake.date)",[]
c41797e8b4af4e6ab554fdc5,What is the name of the treatment given to patient 10007795 two or more times since 28 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-28 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t1.treatment_name FROM (SELECT treatment_name, COUNT(date) AS c1 FROM treatments WHERE patient_id = 10007795 AND date >= CURRENT_DATE - INTERVAL '28 month' GROUP BY treatment_name) AS t1 WHERE t1.c1 >= 2",
040ab0b8bd0cecfc6dbb03df,When patient 10009628 was prescribed for the last time in 10/this year glucagon and warfarin at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10009628 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'warfarin' AND admissions.subject_id = 10009628 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(T1.date) FROM (SELECT patient.date FROM patient WHERE patient.patient_name = '10009628') AS T1 JOIN (SELECT patient.date FROM patient WHERE patient.patient_name = '10009628') AS T2 ON T1.date = T2.date WHERE T1.drug = 'glucagon' AND T2.drug = 'warfarin',[]
7c1e5985e0e94a843e2c335a,What specimen test was given since 08/2100 to patient 10007795 for the last time?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_test FROM results WHERE patient_id = 10007795 AND date_since = '2008-2100-08' ORDER BY date_since DESC LIMIT 1,[{'spec_type_desc': 'BLOOD CULTURE'}]
b7829190559539b14c91b592,Has patient 10037928 had a mch test done since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10037928 AND lab_results.test_name = 'mch' AND STRFTIME('%y-%m', lab_results.result_date) >= '2100-04'",[{'COUNT(*)>0': 0}]
3c1f961554b4f7004f28ef81,What was the maximum value of heart rate for patient 10003046 in the last ICU visit?,SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ),SELECT MAX(heart_rate) FROM (SELECT heart_rate FROM icu_heart_rate WHERE icu_heart_rate.patient_id = 10003046 AND NOT icu_heart_rate.outcome = 'expired') AS heart_rates;,[{'MAX(chartevents.valuenum)': None}]
b457b0375ed13ba271e11902,When was the first time of input for patient 10038999 on 06/05/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '06-05' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(date_input) FROM input_table WHERE patient_id = 10038999 AND date_input LIKE '%06/%05/%' AND date_input BETWEEN '2022-01-01' AND '2022-12-31',[]
79356e6c9fbb5a33aa5bf030,Give me patient 10010471's total output on this month/16.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'",SELECT SUM(output) FROM my_table WHERE patient_id = 10010471 AND month = 4 AND day = 16,[{'SUM(outputevents.value)': None}]
4f618d2298a9d6c65fb3663a,Give me the length of stay in days for patient 10013049 during their first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', ICU.STAY_LENGTH) as LENGTH_OF_STAY","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.1769212959334254}]"
d6325d5bf0c0e255155bb97d,Count the total number of hospital visits made by patient 10025463 since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10025463 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",SELECT COUNT(DISTINCT patient_id) FROM visit_table WHERE patient_id = 10025463 AND visit_date >= CURRENT_DATE - INTERVAL '1 year',[{'COUNT( DISTINCT admissions.hadm_id )': 2}]
9fba75551c882938367916bc,Can you tell me how old patient 10029291 was on their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patient WHERE patient.id = 10029291 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1,
33c5bee6d20b4effb2ff92c1,How much is the drug morphine sr (ms contin)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'morphine sr (ms contin)' ),SELECT COUNT(*) FROM drugs WHERE drug_name = 'Morphine SR (MS Contin)',
beb64497e8a5dd3747e96f78,What is the percentile of 38.1 in the laboratory test with hematocrit at the same age of patient 10019568 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 38.1","SELECT t1.c1 FROM (SELECT lab_data.hematocrit AS c1, PERCENT_RANK() OVER (ORDER BY lab_data.hematocrit NULLS FIRST) AS c2 FROM lab_data WHERE lab_data.age = (SELECT patient.age FROM patient WHERE patient.name = 'John Doe' AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay DESC LIMIT 1) AND lab_data.hematocrit IS NOT NULL) AS t1 WHERE t1.c2 = 38.1",
146e130f4ab60443b1facefb,"For patient 10016150, what were the first lymphocytes lab results?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT lab.value FROM lab WHERE lab.patient = 10016150 AND lab.label = 'lymphocytes' ORDER BY lab.date NULLS FIRST LIMIT 1,[]
f4222a52ce7d21c3c9d3c000,What are the precautions that are incurred after undergoing a oth transureth prostatec procedure?,,"SELECT ""Precautions"" FROM ""Oth transureth prostatec"" WHERE ""Transureth prostatec"" = 'Undergoing a oth transureth prostatec'",
a1218eb18f008a05c5c527e8,When was the first time that patient 10038933 has been prescribed medication via the tp route on their first hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'tp' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(tp_date) FROM (SELECT tp_date FROM patient_medication WHERE patient_id = 10038933 AND route = 'tp'),[]
b3017b420fe13c0d01fb5e63,Has patient 10038081 had platelet count tests in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10038081 AND lab_results.result_type = 'platelet count' AND STRFTIME('%y', lab_results.result_date) = '2100'",[{'COUNT(*)>0': 0}]
2aeb48ba6aa5bb661580a085,Can you tell me the first time patient 10027602 had a heart rate that was less than 97.0 on 12/02/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 97.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-02' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(heart_rate) FROM patient WHERE patient.id = 10027602 AND heart_rate < 97.0 AND DATETIME(CURRENT_TIME, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND DATETIME(CURRENT_TIME, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[]
949c6b3479c7ce4f2acd3003,"Since 2100, what are the top three most common microbiology tests that patients were diagnosed with after the diagnosis of esophageal varices in diseases classified elsewhere, with bleeding within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal varices in diseases classified elsewhere, with bleeding' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis_name = 'Esophageal varices in diseases classified elsewhere' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.id, microbiology.test_name, microbiology.diagnosis_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.id WHERE STRFTIME('%y', microbiology.diagnosis_date) >= '2100') AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1",
3dfc1e7e0bb1375c1771ec03,How often was bisacodyl prescribed in the previous year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'bisacodyl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM patients WHERE prescriptions.drug = 'bisacodyl' AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT(*)': 0}]
d2d5d1df9320768cf72754db,Has patient 10014078 undergone a central venous catheter placement with guidance procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ),"SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10014078 AND procedures.procedure_name = ""Central venous catheter placement with guidance""",[{'COUNT(*)>0': 0}]
25766b07f551c549f6e3c32f,Tell me the maximum total cost of a hospital that contains anemia in chronic kidney disease?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in chronic kidney disease' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(total_cost) FROM (SELECT SUM(cost) AS total_cost FROM diagnosis WHERE diagnosis = 'anemia in chronic kidney disease' GROUP BY cost),
645012622fad2129a6fe1db6,"Since 1 year ago, what was the top three most frequent diagnoses patients were diagnosed with during the same month after receiving extracorporeal circulation auxiliary to open heart surgery?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'extracorporeal circulation auxiliary to open heart surgery' AND DATETIME(treatment.treatmenttime) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosistime FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE DATETIME(diagnosis.diagnosistime) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.diagnosistime AND DATETIME(t1.treatmenttime, 'start of month') = DATETIME(t2.diagnosistime, 'start",
116aad46ae0fef5a747954b1,"For patients diagnosed with iatrogenic pneumothorax since 1 year ago, what are the top five most recurrent treatments during the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'iatrogenic pneumothorax' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.patientid WHERE diagnosis.diagnosis = 'iatrogenic pneumothorax' AND DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.patientid WHERE DATETIME(treatment.treatmentdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.treatmentdate AND t1.uniquepid = t2.uniquepid GROUP BY t2.treatment) AS t3 WHERE t3.c1 <= 5",
908c6c72c2f860ac928fbaf3,Can you tell me the first time in the last ICU stay patient 10009628 had a minimum diastolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(diastolic_blood_pressure) FROM (SELECT diastolic_blood_pressure FROM icu_diagnoses WHERE icu_diagnoses.patient_id = 10009628 ORDER BY icu_diagnoses.admission_date DESC LIMIT 1),[]
3c1cd712d2ed352c132bd2ce,Show me the length of time in days patient 10016742 was in the ICU during the first visit.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', TIMESTAMP '2022-01-01 10:30:00') - STRFTIME('%j', TIMESTIME '2022-01-01 00:00:00') AS length_of_stay_days","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.9095370369032025}]"
51b0ff1fc9bfcd9831928425,What was the name of the specimen test that patient 10002428 had for the last time in 07/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_type FROM specimen_table WHERE patient_id = 10002428 AND date_collected BETWEEN '2007-01-01' AND '2007-12-31' ORDER BY date_collected DESC LIMIT 1,[]
887f1892fedc575d080e8217,What's the heart rate difference of patient 10013049's body measured at 2100-06-24 12:00:00 compared to the value measured at 2100-06-24 11:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 12:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 11:00:00' ),SELECT (SELECT heart_rate FROM patient_health_data WHERE patient_id = 10013049 AND measurement_time = '2100-06-24 12:00:00') - (SELECT heart_rate FROM patient_health_data WHERE patient_id = 10013049 AND measurement_time = '2100-06-24 11:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 12:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 11:00:00' )"": None}]"
581c5fbb07539eb5493641eb,"Among patients who underwent introduction of nutritional substance into lower gi, via natural or artificial opening in 2100, what were the top four most common procedures that followed during the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.Name FROM (SELECT t2.Name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.Name, treatment.StartTime, patient.PatientId FROM treatment JOIN patient ON treatment.PatientId = patient.PatientId WHERE treatment.StartTime >= '2100-01-01 00:00:00' AND treatment.StartTime < '2101-01-01 00:00:00') AS t1 JOIN (SELECT patient.Name, treatment.StartTime, patient.PatientId FROM treatment JOIN patient ON treatment.PatientId = patient.PatientId WHERE treatment.StartTime >= '2100-01-01 00:00:00' AND treatment.StartTime < '2101-01-01 00:00:00') AS t2 ON t1.Name = t2.Name WHERE t1.StartTime < t2.StartTime AND t1.PatientId = t2.PatientId GROUP BY t2.Name)",
a9a9222a8d37bab9e6d5a6a2,How many instances of the anastomosis of hepatic duct to gastrointestinal tract procedure were there?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ),SELECT COUNT(*) FROM duckdb_procedures WHERE procedure_name = 'anastomosis of hepatic duct to gastrointestinal tract';,[{'COUNT(*)': 0}]
ab35055cb752554bf2ab3c26,When was the last time since 10/2100 that patient 10038992 was prescribed with vitamin d and felodipine at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'felodipine' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10038992 AND prescription_name = 'vitamin d' INTERSECT SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10038992 AND prescription_name = 'felodipine',[]
9baa4740ed5e93a3f8178055,Tell me the average total cost of a hospital visit involving esophageal reflux in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost_type = 'esophageal reflux' AND year = 2100 GROUP BY patient_id) AS t1,
d80871d283fcf3c937bc3387,Can you tell me how many fluoroscopy of multiple coronary arteries using low osmolar contrast procedures were done since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.low_osmolar_contrast = 'fluoroscopy of multiple coronary arteries' AND STRFTIME('%y', procedures.date) >= '2100'",
2706ea1872fb85222790f131,What are the four most frequent diagnoses that patients were diagnosed within 2 months after having received a simple excision of other lymphatic structure procedure since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'simple excision of other lymphatic structure' AND DATETIME(treatment.treatmentdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosisdate) BETWEEN DATETIME(t1.treatmentdate) AND DATETIME(t1.treatmentdate",
750b75263b3b402e66549596,Which are the four most frequent lab tests given to patients in the same month after they are diagnosed with anticoagulants causing adverse effects in therapeutic use?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anticoagulants causing adverse effects in therapeutic use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.LabTest, COUNT(t3.LabTest) FROM (SELECT t2.LabTest, t1.date FROM (SELECT patient.date, diagnoses.LabTest FROM diagnoses JOIN patient ON diagnoses.patient = patient.patient WHERE diagnoses.diagnosis = ""Anticoagulants causing adverse effects in therapeutic use"") AS t1 JOIN (SELECT patient.date, lab_tests.LabTest FROM lab_tests JOIN patient ON lab_tests.patient = patient.patient) AS t2 ON t1.date LIKE t2.date IN (SELECT date FROM calendar WHERE month = t1.month AND year = t1.year) GROUP BY t2.LabTest) AS t3 GROUP BY t3.LabTest ORDER BY COUNT(t3.LabTest) DESC LIMIT 4",
506c80f153411922f7967305,How much did patient 10008287 weigh during their last measurement since 14 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT weight FROM patients WHERE patient_id = 10008287 AND measurement_time >= DATEADD(month, -14, CURRENT_TIMESTAMP) ORDER BY measurement_time DESC LIMIT 1;",[]
67a35d73e846d6a5995d2dd4,What percentile is the value of the free calcium of 1.06 among patients of the same age as patient 10026255 in the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.06","SELECT t1.c1 FROM (SELECT patient.age, patient.weight, patient.height, patient.days_at_hospital, patient.days_at_hospital - date_diff('day', patient.admittime, current_time) AS c1 FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = 'T20101') AND NOT patient.days_at_hospital IS NULL ORDER BY patient.age) AS t1 WHERE t1.weight = 1.06",
984b06bd38c5e69abd10d736,Tell me the top three most common specimens tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen FROM (SELECT specimen, COUNT(specimen) AS count FROM brackets_mito WHERE year >= 2100 GROUP BY specimen) AS subquery ORDER BY count DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
5fa52b07870c541ddad80fd4,What is the dose of the opioid prescribed for patient 19059?,,SELECT SUM(opioid_dose) FROM prescriptions WHERE prescriptions.patient_id = 19059,
baddc58b8aca169735d88f8d,What were the total number of patients discharged from the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT SUM(discharge_count) FROM (SELECT COUNT(*) AS discharge_count FROM patients WHERE NOT hospital_discharge_date IS NULL GROUP BY patient_id),[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
6e32e4314cb1b08ef73c4739,What was the last diagnosis for patient 10040025 since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",SELECT diagnosis FROM diagnoses WHERE patient_id = 10040025 AND date >= (CURRENT_DATE - INTERVAL '1 year') ORDER BY date DESC LIMIT 1,
0f36a6421cf0404aebb87507,What were the five most common lab tests given since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date > CURRENT_DATE - INTERVAL '1 year') AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
e8e6ee69e045e5606f6c0aa9,When did patient 10035185 get inputs for the last time since 04/14/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-14' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT inputs.input_date FROM inputs WHERE inputs.patient_id = 10035185 AND STRFTIME('%y-%m-%d', inputs.input_date) >= '2100-04-14' ORDER BY inputs.input_date DESC LIMIT 1",[{'starttime': '2120-05-14 15:00:00'}]
2cbebf97accbbf3a5041776c,What is the outpatient schedule today for dr. leigh?,,"SELECT T1.date, T1.patient_id, T2.name FROM (SELECT date, patient_id FROM appointments WHERE schedule_type = 'outpatient' AND dr_name = 'leigh') AS T1 JOIN patients AS T2 ON T1.patient_id = T2.id;",
21e946effbb48dafa5e842d3,What are the various ways to consume atenolol?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'atenolol',SELECT DISTINCT T1.product FROM products AS T1 JOIN product_consumers AS T2 ON T1.product_id = T2.product_id WHERE T1.product = 'atenolol',"[{'route': 'PO/NG'}, {'route': 'PO'}, {'route': 'ORAL'}]"
fd67ddabf75b779af8cfe4ac,Please provide the four most common tests performed on specimens this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT t.test_name, COUNT(t.test_name) FROM",[]
6ecbe5131fa2235952ed05b9,When was the last time patient 10029291 had a respiratory rate that was greater than 23.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 23.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(timestamp) FROM respiratory_rate WHERE patient_id = 10029291 AND respiratory_rate > 23.0,[]
4278528d67400edefc633789,How often was the last time patient 20801 had a medication that should be regularly taken?,,SELECT COUNT(*) FROM medication_usage WHERE medication_usage.patient_id = 20801 AND medication_usage.frequency = 'regular',
d8ce0d4331097090b007f237,"How many patients were diagnosed with migraine with aura, without mention of intractable migraine without mention of status migrainosus during the same hospital visit after they were first diagnosed with street and highway accidents since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'street and highway accidents' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'migraine with aura, without mention of intractable migraine without mention of status migrainosus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date, t2.diagnosis FROM (SELECT subject_id, diagnosis_date FROM (SELECT subject_id, CAST(diagnosis AS VARCHAR) AS diagnosis FROM (SELECT subject_id, CAST(status AS VARCHAR) AS status FROM (SELECT subject_id FROM accidents WHERE date BETWEEN '2100-01-01' AND '2100-12-31' AND location = 'highway') AS t1 JOIN (SELECT subject_id, diagnosis_date, diagnosis FROM diagnoses WHERE diagnosis BETWEEN 'migraine with aura, without mention of intractable migraine without mention of status migrainosus') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND t1.subject_id = t2.subject_id) AS t1 JOIN (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis BETWE",
819c7fee312e5058c9f3296f,What was the first drug that patient 10037861 had been prescribed via the neb route in 10/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.route = 'neb' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(drug_date) FROM patient_drugs WHERE patient_id = 10037861 AND route = 'neb' AND drug_date BETWEEN '2010-01-01' AND '2010-12-31',[]
38b7e8d3f95badf4596cd29a,Whas the earliest patient 9038 goes to the hospital?,,SELECT MIN(HoursToAdmit) FROM patient WHERE PatientID = 9038,
d6be51fd1c5f29f5d9719bec,How much is the difference of heart rate of patient 10018501 last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT heart_rate FROM icu_visits WHERE icu_visits.patient_id = 10018501 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.in_time DESC LIMIT 1) - (SELECT heart_rate FROM icu_visits WHERE icu_visits.patient_id = 10018501 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.in_time DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
bbe074710272a9a159c13d10,"Since the last time patient 10021487 was diagnosed with injury to liver without mention of open wound into cavity laceration, unspecified in the current hospital encounter, how many days have passed?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity laceration, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnoses.patient_id = 10021487 AND diagnoses.diagnosis = 'injury to liver without mention of open wound into cavity laceration, unspecified' AND diagnoses.dischtime IS NULL;",
645da0fe1582ef9cccf3adb7,Is the type of blood of patient 12775?,,,
d653fc27e70a4eedd39bd936,What was the total amount of bisacodyl that patient 10001217 has been prescribed in 12/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'bisacodyl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12'",SELECT SUM(bisacodyl) FROM prescriptions WHERE prescriptions.patient_id = 10001217 AND prescriptions.start_date BETWEEN '2012-12-01' AND '2012-12-31',[{'SUM(prescriptions.dose_val_rx)': None}]
953f77740c16c1a9a435f427,"Since 2100, what are the top three most frequently taken specimens for patients within 2 months after receiving percutaneous [endoscopic] gastrostomy [peg]?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,
ecaacdc4fbb0dd2635df78f1,Tell me the total foley output of patient 10018081 on this month/30.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '30'",SELECT COUNT(FOLEY) FROM output WHERE patient = 10018081 AND date = CURRENT_DATE - INTERVAL '30 months',[{'SUM(outputevents.value)': None}]
e28ceb0ac6e10e4e5f14b4dd,What are the methods for taking ferrous sulfate (liquid)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)',SELECT * FROM duckdb_methods WHERE method_name = 'taking ferrous sulfate (liquid)';,[]
84864ac527ad8527348ec48a,What was the name of the organism in the last pleural fluid microbiology test of patient 10014729?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM microbiology WHERE patient_id = 10014729 AND microbiology_type = 'pleural fluid' ORDER BY microbiology_date DESC LIMIT 1;,[]
9298a838a1b1fa2910b4a9eb,What are the consumption methods of potassium chl 40 meq / 1000 ml d5ns?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'potassium chl 40 meq / 1000 ml d5ns',"SELECT DISTINCT ""Consumption method"" FROM ""Potassium Chl 40 mEq / 1000 mL D5NS""",[]
bad209f7f1a2e0361719a243,Was there a procedure that patient 10031757 had in the last year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10031757 AND DATETIME(procedures.date) BETWEEN DATETIME(CURRENT_TIME, '-1 year') AND DATETIME(CURRENT_TIME, '-1 year')",
0b9e4acffe9d8f86bd9be2bf,Will patient 97121 get any additional stool (received in transport system) test?,,SELECT COUNT(*) FROM additional_stool_test WHERE patient_id = 97121,
99316caca8e75d93f18ba12c,When for the first time since 09/2100 was patient 10021487 prescribed 5% dextrose and sodium bicarbonate at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",SELECT COUNT(*) FROM (SELECT PATIENT_ID FROM prescriptions WHERE prescriptions.drug = '5% dextrose' AND prescriptions.start_date BETWEEN '2009-01-21' AND '2009-12-31') AS t1 JOIN (SELECT PATIENT_ID FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate' AND prescriptions.start_date BETWEEN '2009-01-21' AND '2009-12-31') AS t2 ON t1.patient_id = t2.patient_id WHERE DATETIME(t1.start_date) = DATETIME(t2.start_date) ORDER BY t1.start_date NULLS FIRST LIMIT 1,[]
1d085776a9f4303e625f4125,How many hours have passed since patient 10039831's first platelet count laboratory test on the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab.date)) FROM lab WHERE lab.patient = 10039831 AND lab.type = 'platelet count' AND lab.date BETWEEN SELECT date FROM lab WHERE lab.patient = 10039831 AND lab.type = 'platelet count' ORDER BY lab.date NULLS FIRST LIMIT 1;",[]
0cd11d35e8ac3515e3c55d6c,Reveal the drug name that was first prescribed to patient 10014354 via the iv route in 10/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT drugs.drug_name FROM drugs WHERE drugs.patient_id = 10014354 AND drugs.route = 'iv' AND DATETIME(drugs.date_prescribed, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', drugs.date_prescribed) = '10' ORDER BY drugs.date_prescribed NULLS FIRST LIMIT 1",[]
5b0182b6de80a169f35424ab,What is the name of the drug which should not be administered during the insert intercostal cath procedure?,,SELECT name FROM drugs WHERE interaction = 'should not be administered during the insert intercostal cath procedure',
bdbd2999610d99f0cde120c1,"When was the first time in 08/this year when patient 10016742 had the minimum value of iron binding capacity, total?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'iron binding capacity, total' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '08' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT MIN(Iron Binding Capacity, Total) FROM ""Patient 10016742"" WHERE ""Date"" = '2008-01-01'",[]
e9f3ecc3ec11c4b3396e2825,"Has patient 10004720 received the procedure of a introduction of nutritional substance into upper gi, via natural or artificial opening since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10004720 AND procedures.procedure_name = 'introduction of nutritional substance into upper gi, via natural or artificial opening' AND STRFTIME('%y', procedures.procedure_date) >= '2100'",
20e39fab12a387f9a7fcce7e,List the top five diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t.diagnosis, t.c1, t.c2, t.c3 FROM (SELECT diagnosis, 3 AS c1, 3 AS c2, 3 AS c3 FROM (SELECT diagnosis, 1000000 AS c1, 500000 AS c2, 300000 AS c3 FROM diagnoses GROUP BY diagnosis) AS t ORDER BY t.c1 DESC LIMIT 5) AS t;",
d8cceb3ec5f0418b29f0a459,Do you think patient 31615 has an appointment in another department?,,SELECT * FROM appointment WHERE appointment.patient = 31615 AND appointment.department <> (SELECT department FROM patient WHERE patient.id = 31615),
3897e55dfcc80af6c9948c75,Has patient 10015860 had a lab test done since 1 year ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10015860 AND DATETIME(lab_tests.test_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)>0': 1}]
bc084c489813e1e8df25c4c3,What was the name of the output the last time patient 10005817 had since 12/03/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-03' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT output FROMpatient_output WHERE patient_id = 10005817 AND date_since = '12/03/2100' ORDER BY date_since DESC LIMIT 1,[{'label': 'Foley'}]
87a3ea2e67ade278c0c2e7e5,How many times was patient 10014354 in the hospital in the last year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT patient_id) FROM patient_hospital_stay WHERE patient_id = 10014354 AND DATETIME(hospital_stay_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
47e52d08523b3df6810e4e7b,Tell me the top three most common specimens tested.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(specimen) FROM brackets GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
150069fefa392b944fd23073,What were the top five most commonly tested specimens?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(*) FROM (SELECT specimen FROM strings WHERE specimen <> 'null') GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
ec4e31f512d6319b08a78d92,What was the total amount of the output patient 10006053 had since 06/06/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06'","SELECT SUM(T1.quantity) FROM (SELECT patient_id, quantity FROM output WHERE patient_id = 10006053 AND date_output >= '2100-06-06') AS T1",[{'SUM(outputevents.value)': 7045.0}]
ecbcf154c6dfea64fea97371,When was patient 10027445 last prescribed the medication via the sc route during their last hospital visit?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM medication WHERE medication.patient_id = 10027445 AND medication.route = 'sc' AND NOT medication.date_prescribed IS NULL AND patient.hospital_stay.start_date = (SELECT MIN(start_date) FROM patient WHERE patient.id = 10027445 AND NOT patient.hospital_stay.end_date IS NULL ORDER BY patient.hospital_stay.start_date DESC LIMIT 1),[]
2f5d42ba584507b3ec8786a4,Show me patient 10038081's total tap output since 10/06/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tap' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-06'",SELECT SUM(tap_output) FROM tap_table WHERE patient_id = 10038081 AND start_date >= '2100-10-06',[{'SUM(outputevents.value)': None}]
857cc6b19c502ce2ba6b66df,When did patient 10020740 have the minimum lipase value for the first time?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",,[]
03597122b60940059ca941bd,Retrieve the top three most common diagnoses?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT diagnosis, COUNT(*) FROM diagnoses GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 3;","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]"
661a2833119e979de4228585,"Has patient 10029291 been prescribed with the medication perphenazine, furosemide, or neomycin-polymyxin-bacitracin since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.drug IN ( 'perphenazine', 'furosemide', 'neomycin-polymyxin-bacitracin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10029291 AND medication.drug_name IN ('perphenazine', 'furosemide', 'neomycin-polymyxin-bacitracin') AND STRFTIME('%y', medication.date) >= '2100'",[{'COUNT(*)>0': 0}]
44fdec17266371ad7f7871d7,Is patient 85169 to have had a travel history overseas?,,SELECT COUNT(*) > 0 FROM travel_history WHERE patient_id = 85169 AND overseas = 'true',
8d6edf1fda9d534cd9ec0c9f,What was the number of patients who were prescribed prochlorperazine throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prochlorperazine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date_prescribed FROM (SELECT subject_id, MIN(date_of_discharge) AS date_prescribed FROM (SELECT subject_id, date_of_discharge FROM (SELECT subject_id, diagnosis_date FROM (SELECT subject_id, DATE '2022-01-01' AS diagnosis_date FROM crimes JOIN victims ON crimes.subject_id = victims.subject_id WHERE crimes.discharge_type = 'KILLING') GROUP BY subject_id) AS t1 JOIN (SELECT subject_id, date_prescribed FROM (SELECT subject_id, MIN(date_of_discharge) AS date_prescribed FROM (SELECT subject_id, date_of_discharge FROM (SELECT subject_id, diagnosis_date FROM (SELECT subject_id, DATE '2022-01-01' AS diagnosis_date FROM crimes JOIN victims ON crimes.subject_id = victims.subject_id",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
127846a633997fbb95a316a9,"What are the five most commonly prescribed medications for patients who were previously diagnosed with personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits during the same hospital visit, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.admission_location FROM diagnoses INNER JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""TRANSIENT ISCHEMIC ATTACK (TIA)"" AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT admissions.subject_id, medications.name, medications.date_prescribed FROM medications INNER JOIN admissions ON medications.admission_id = admissions.admission_id WHERE DATETIME(medications.date_prescribed) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.date_prescribed AND t1.admission_location = t2.",
5e42606ba946ba548d180e31,List the top four most frequent lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE year >= 2100) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 4;","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
77a561b95489d211e0dec613,How many times was other electroshock therapy carried out throughout this year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM procedures WHERE procedures.therapy_type = 'other electroshock therapy' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
0e2ed5b1977c59f79cff3b72,"How many patients with long-term (current) use of anticoagulants were diagnosed in the same hospital visit after previously being diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT admissions.subject_id, diagnoses.diagnosis_time FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""LONG TERM (CURRENT) USE OF ANTICOAGULANTS"" AND STRFTIME('%y', diagnoses.diagnosis_time) >= '2100') AS t1 JOIN (SELECT admissions.subject_id, diagnoses.diagnosis_time FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = ""HYPERTENSIVE CHRONIC KIDNEY DISEASE, UNSPECIFIED WITH CHRONIC KIDNEY DISEASE STAGE I"" AND STRFTIME('%y', diagnoses.diagnosis_time) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_time < t2.di",
63d12a773f7455c04714cb1e,What is patient 10005909's sex?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10005909,SELECT patients.sex FROM patients WHERE patients.id = 10005909,[{'gender': 'F'}]
0d22f4703425e474ebd63580,"Compared to measured at 2100-03-10 23:00:00 , is the heart rate value of patient 10019777 greater than measured at 2100-03-10 22:00:00?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 22:00:00' ),SELECT (SELECT heart_rate FROM patient_heart_rate WHERE patient_id = 10019777 AND measurement_time = '2022-03-10 23:00:00') > (SELECT heart_rate FROM patient_heart_rate WHERE patient_id = 10019777 AND measurement_time = '2022-03-10 22:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 22:00:00' )"": None}]"
950bba952500eb9d19279afe,Show me the top five most common diagnoses of patients aged 50s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.diagnosis, COUNT(d.diagnosis) FROM diagnoses d WHERE d.patient_id IN (SELECT patient_id FROM patients WHERE age BETWEEN 50 AND 59) AND DATETIME(d.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY d.diagnosis ORDER BY COUNT(d.diagnosis) DESC LIMIT 5",
e253c035e9ea72b0f867ad77,"What new medications are there for patient 10039831 today, compared to the prescriptions given yesterday?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.name FROM prescriptions WHERE prescriptions.patient_id = 10039831 AND DATETIME(prescriptions.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescriptions.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
ffa10298ec3846d375cbd553,Let me know the total quantity of input patient 10027602 received since 09/23/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-23'","SELECT SUM(t1.quantity) FROM (SELECT patient_id, quantity FROM input_patient_10027602 WHERE date_received >= '2100-09-23') AS t1 JOIN patient_10027602 ON t1.patient_id = patient_10027602.patient_id WHERE patient_10027602.patient_id = 10027602",[{'SUM(inputevents.totalamount)': 81320.0}]
7b93007f63a2214c1ddc33f7,Has patient 10019385 been given any medication since 10 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-10 month')","SELECT COUNT(*) > 0 FROM medication_usage WHERE patient_id = 10019385 AND date_sub('month', CURRENT_DATE, date_administered) < 10;",[{'COUNT(*)>0': 1}]
c921eab7b5888cd147156703,When was the first time in which patient 10018081 had the maximum mean blood pressure in the current ICU encounter?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",SELECT MAX(mean_blood_pressure) FROM (SELECT mean_blood_pressure FROM icu WHERE icu.patient_id = 10018081 AND icu.dischtime IS NULL),[]
df30afea60a71f1c1b64dfef,How many hours have passed since last time that patient 10018081 stayed in careunit trauma sicu (tsicu) during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.laststaydate)) FROM patient WHERE patient.staydate IS NOT NULL AND patient.subject = '10018081' AND patient.laststaydate IS NOT NULL AND patient.laststaydate <> patient.staydate AND patient.dischtime IS NULL",[]
9b5ab2bf426064b58719cc29,How many hours have passed since patient 10021487 last visited the careunit trauma sicu (tsicu) in the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.last_visited)) FROM patient WHERE patient.id = 10021487 AND patient.current_hospital_unit = 'careunit trauma sicu (tsicu)'",[]
7fb6c6e5361721f050111d9f,What was the total volume of foley patient 10022880 had?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ),SELECT SUM(volume) AS total_volume FROM foley WHERE patient = 10022880,[{'SUM(outputevents.value)': None}]
0156bbc7fa6f2c54a9587d76,How much does patient 10020187's weight differ from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patient_weight WHERE patient_id = 10020187 AND NOT patient_weight.date IS NULL ORDER BY patient_weight.date NULLS FIRST LIMIT 1) - (SELECT weight FROM patient_weight WHERE patient_id = 10020187 AND NOT patient_weight.date IS NULL ORDER BY patient_weight.date NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
a39d417e2b49ba956a7d03a7,What diagnosis did patient 10014078 have last in their first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10014078 AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.admittime NULLS FIRST LIMIT 1,
ea34c337ef08f5bb39bce43e,How much is the difference of patient 10020944's weight last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patients WHERE patient_id = 10020944 AND NOT patients.hospital_id IS NULL ORDER BY patients.hospital_visit_date DESC LIMIT 1) - (SELECT weight FROM patients WHERE patient_id = 10020944 AND NOT patients.hospital_id IS NULL ORDER BY patients.hospital_visit_date NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
fce59dd5045419545d12fe57,Can you give me patient 10004235's monthly minimum platelets input in the first hospital visit?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'platelets' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MIN(platelets) FROM patients WHERE patient_id = 10004235 AND NOT visit_description LIKE '%hospital%' ORDER BY visit_date NULLS FIRST LIMIT 1;,[]
0a966abcccedcc3a0964e05e,Has patient 10038992 had a lab test?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ),SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10038992,[{'COUNT(*)>0': 1}]
9c7279514181f0cd64efe035,"What is the cost of a altered mental status, unspecified diagnosis?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) )","SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = 'ALTERED MENTAL STATUS, UNSPECIFIED'",
0fcf3657ba17464a0f38afe8,What's the cost for cardiac mapping?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure = 'cardiac mapping';,
c00a358c2d55cd8c5497fc99,"What is the maximum total cost of the hospital, which includes the blood in stool?",SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) ) GROUP BY cost.hadm_id ) AS T1,"SELECT MAX(t1.c1) FROM (SELECT SUM(h.c1) AS c1 FROM hospital h JOIN (SELECT b.b1, b.b2 FROM (SELECT '1' AS b1, '10' AS b2) AS b) AS t1",
b47161883d5f7a57232f66b9,Was patient 10037928 given a hematocrit lab test in the last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10037928 AND lab_results.hematocrit IS NOT NULL AND DATETIME(lab_results.lab_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT(*)>0': 0}]
090c2ad4771d1fc8adaea4ae,Has patient 10014078 been prescribed a specific drug in 09/this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10014078 AND prescriptions.drug_name = 'Ibuprofen' AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '09'",[{'COUNT(*)>0': 0}]
2c1b4a7fbad74a8a44675a71,What were the top four most frequent diagnoses that followed within 2 months for those patients who received percutaneous abdominal drainage?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'percutaneous abdominal drainage') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosisdate) BETWEEN DATETIME(t1.treatmentdate) AND DATETIME(t1.treatmentdate, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 4",
f0106cb7094a1c199a9c6565,Retrieve the top four most common diagnoses in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM diagnoses WHERE STRFTIME('%y', date) = '2100' GROUP BY diagnosis) WHERE rank <= 4;",
e4b74a53ea1be8cc09b170cb,What are the steps after the cystoscopy nec?,,SELECT * FROM procedures WHERE procedures.name = 'Cystoscopy NEC';,
8c465916ae512fb241ab372c,"In 2100, what are the top four most frequent procedures that patients received within 2 months after being diagnosed with subdural hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'subdural hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.Name, COUNT(t3.Name) FROM (SELECT t2.Name, COUNT(t2.Name) FROM (SELECT patient.ID, diagnosis.Date FROM diagnosis JOIN patient ON diagnosis.Patient = patient.ID WHERE diagnosis.Name = 'subdural hemorrhage following injury without mention of open intracranial wound') AS t1 JOIN (SELECT patient.ID, procedure.Name, procedure.Date FROM procedure JOIN patient ON procedure.Patient = patient.ID WHERE patient.Consciousness = 1) AS t2 ON t1.ID = t2.ID WHERE t1.Date < t2.Date AND DATETIME(t2.Date) BETWEEN DATETIME(t1.Date) AND DATETIME(t1.Date, '+2 month') GROUP BY t2.Name) AS t3 WHERE COUNT(t3.Name) > 4",
c4cdd9f12bc74981468685d3,How many times did the percutaneous [endoscopic] gastrostomy [peg] procedure take place throughout this year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,
09c12062e2d66d05c75bba9f,So how many days have passed since patient 10018081's last other and unspecified hyperlipidemia diagnosis on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",SELECT COUNT(DISTINCT diagnosis_date) FROM diagnoses WHERE diagnosis_type = 'other and unspecified hyperlipidemia' AND patient_id = 10018081 AND current_hospital_location = 'current hospital',
d3b9aefc8549a18cee8f540a,How much does a hospital typically spend average on a drug named fentanyl patch since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl patch' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(drug_cost) FROM drugs WHERE drug_name = 'fentanyl patch' AND year >= 2100,
d58380e3bc5d293e5d7d4718,What are the three diagnoses with the lowest 6-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",SELECT,
548efe4af132f8b95bf61624,Is the respiratory rate level of patient 10021118 last measured on the first ICU visit less than second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT respiratory_rate FROM (SELECT patient_respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10021118 AND NOT icu_visit IS NULL ORDER BY icu_visit NULLS FIRST LIMIT 1) AS respiratory_rate_1 GROUP BY patient_id) < (SELECT respiratory_rate FROM (SELECT patient_respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10021118 AND NOT icu_visit IS NULL ORDER BY icu_visit NULLS FIRST LIMIT 1) AS respiratory_rate_1 GROUP BY patient_id ORDER BY icu_visit DESC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
1a0886c3a3d7dd6afb64dabb,"Tell me the minimum total cost of a hospital visit involving respiratory failure, unspecified with hypoxia since 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified with hypoxia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM respiratory_failure, unspecified WHERE hypoxia = 'true' AND STRFTIME('%y', cost.date) >= '2100' GROUP BY cost.patient_id) AS t1",
61b15d7e2318959ccf6194ba,How much did patient 10037975 weigh the first time it was measured since 22 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(weight) FROM patients WHERE patient_id = 10037975 AND measurement_date >= DATEADD(month, -22, CURRENT_DATE)",[]
e3c9d792118d17e382f1eb65,What are the top four common diagnoses since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.diagnosis, COUNT(t4.diagnosis) FROM (SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, COUNT(t2.diagnosis) FROM (SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT '2100-01-01'::DATE AS diagnosis_date) AS t1 GROUP BY t1.diagnosis) AS t2 GROUP BY t2.diagnosis) AS t3 GROUP BY t3.diagnosis) AS t4 GROUP BY t4.diagnosis ORDER BY COUNT(t4.diagnosis) DESC LIMIT 10",
4a42f97a1663ba9024599519,"In 2100, what are the top four most frequently taken specimens for patients within 2 months after receiving bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT 'Aorta' AS specimen, COUNT('Aorta') AS num FROM patients WHERE bypass_coronary_artery_3_arteries = '1') AS t1 JOIN (SELECT 'Aorta' AS specimen, COUNT('Aorta') AS num FROM patients WHERE bypass_coronary_artery_3_arteries = '1') AS t2 ON t1.specimen = t2.specimen GROUP BY t2.specimen) AS t3 JOIN (SELECT 'Aorta' AS specimen, COUNT('Aorta') AS num FROM patients WHERE bypass_coronary_artery_3_arteries = '1') AS t4 ON t3.specimen = t4.specimen WHERE t3.num BETWEEN t4.num - 2 AND t4.num + 2 GROUP BY t4.specimen ORDER BY COUNT(t4.specimen",
446ee7d9f8e891fa807c4f29,How much of a difference is there in patient 10004720's weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT weight FROM patient_weight WHERE patient_id = 10004720 AND NOT patient_weight.date IS NULL ORDER BY patient_weight.date NULLS FIRST LIMIT 1) - (SELECT weight FROM patient_weight WHERE patient_id = 10004720 AND NOT patient_weight.date IS NULL ORDER BY patient_weight.date DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
cb78a1c0f1fe2f58edc2d283,Was the value of patient 10020786's white blood cells second measured on the first hospital visit greater than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.white_blood_cells FROM (SELECT patient.white_blood_cells FROM patient WHERE patient.patient_id = 10020786 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1) AS lab WHERE lab.measurement_time = 2) > (SELECT lab.white_blood_cells FROM (SELECT patient.white_blood_cells FROM patient WHERE patient.patient_id = 10020786 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1) AS lab WHERE lab.measurement_time = 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
84ee48b9c8a46dca91210f99,List the top five most frequent microbiology tests that were given to patients after they were diagnosed with postprocedural hemorrhage of a circulatory system organ or structure following other circulatory system procedure in the same hospital visit.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural hemorrhage of a circulatory system organ or structure following other circulatory system procedure' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.Microbiology, COUNT(t3.Microbiology) FROM (SELECT t2.Microbiology, COUNT(t2.Microbiology) FROM (SELECT patient.ID, diagnosis.Diagnosis_Date, patient.Hospital_ID FROM diagnosis JOIN patient ON diagnosis.Patient_ID = patient.ID WHERE diagnosis.Diagnosis = 'POSTPROCEDURAL HEMORRHAGE OF CIRCULATORY SYSTEM OR STRUCTURE FOLLOWING OTHER CIRCULATORY SYSTEM PROCEDURE') AS t1 JOIN (SELECT patient.ID, microbiology.Microbiology, microbiology.Diagnosis_Date, patient.Hospital_ID FROM microbiology JOIN patient ON microbiology.Patient_ID = patient.ID) AS t2 ON t1.ID = t2.ID WHERE t1.Diagnosis_Date < t2.Diagnosis_Date AND t1.Hospital_ID = t2.Hospital_ID GROUP BY t2.Microbiology) AS t3 ON TRUE GROUP BY t",
8e181485cf1adc897c3a3e28,Are patient 10009049's protein levels second measured on the last hospital visit greater than the levels first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM patient WHERE patient.patient_id = 10009049 AND NOT patient.hospital_info.last_hospital_visit IS NULL AND patient.protein_levels.second_measurement > patient.protein_levels.first_measurement,"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
9dfacc2c7888378be3ee3aac,Give me the five most common microbiology tests in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t1.Microbiology, COUNT(t1.Microbiology) FROM (SELECT Microbiology FROM t1 WHERE t1.Year = 2100) AS t2 GROUP BY t2.Microbiology ORDER BY COUNT(t2.Microbiology) DESC LIMIT 5",[]
4287b3790b3f4f5109f1ee57,"Compared to yesterday, what new drugs are present in the prescription of patient 10018081 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescription FROM patients WHERE patient_id = 10018081 WHERE date_prescription = '2022-12-31' EXCEPT SELECT prescription FROM patients WHERE patient_id = 10018081 WHERE date_prescription = '2022-12-30',[]
133e29afd664c35e8accca09,"What is patient 10018328's minimum value of urea nitrogen, urine during the first hospital visit?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' )","SELECT MIN(urea_nitrogen, urine) FROM patients WHERE patient_id = 10018328 AND NOT patient_id IS NULL ORDER BY patient_hospital_info.hospital_visits.visit_date NULLS FIRST LIMIT 1",[{'MIN(labevents.valuenum)': None}]
2374026e2104232fe78b6141,Did patient 10037975 have a enteral infusion of concentrated nutritional substances during their last hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM intake WHERE intake.patient_id = 10037975 AND intake.type = 'enteral infusion of concentrated nutritional substances' AND intake.time >= (SELECT MIN(time) FROM intake WHERE intake.patient_id = 10037975 AND intake.type = 'hospital visit') AND intake.time <= (SELECT MAX(time) FROM intake WHERE intake.patient_id = 10037975 AND intake.type = 'hospital visit'),[{'COUNT(*)>0': 0}]
d96399e5245e5a0e11dcf0ff,What was diagnosed for patient 10003400 the first time on the last hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),"SELECT diagnosis FROM (SELECT patient.age, patient.weight, patient.height, patient.diagnosis, patient.admit_date, patient.disch_date, patient.disch_date - INTERVAL '1 day' * row_number() OVER (ORDER BY patient.admit_date DESC) AS day_diff FROM (SELECT patient.age, patient.weight, patient.height, patient.diagnosis, patient.admit_date, patient.disch_date FROM patient WHERE patient.disch_date IS NULL AND NOT patient.admit_date IS NULL AND patient.age BETWEEN 18 AND 120) AS patient) WHERE day_diff >= 1 ORDER BY patient.admit_date DESC LIMIT 1",
d1018384915acc94c4043e76,What medication was prescribed for the first time on the last hospital visit to patient 10036156?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT medication FROM visit_history WHERE patient_id = 10036156 AND NOT visit_history.dischtime IS NULL ORDER BY visit_history.admittime DESC LIMIT 1;,[{'drug': 'Senna'}]
1b28343aacf8cb3fdf1051df,What were the top five frequent laboratory tests that patients had after they were diagnosed with other abnormal blood chemistry during the same hospital encounter since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal blood chemistry' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rank FROM (SELECT t1.subject_id, t1.diagnosis_date, t2.lab_test, t2.date_result FROM (SELECT patient.subject_id, diagnosis.diagnosis_date, lab_test.lab_test FROM diagnosis JOIN lab_test ON diagnosis.lab_test = lab_test.lab_test JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Other abnormal blood chemistry' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.subject_id, lab_test.lab_test, date_result.date_result FROM lab_test JOIN patient ON lab_test.patient_id = patient.patient_id WHERE DATETIME(lab_test.date_result) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.subject_id = t",
752822475ba10bd4a7205d6d,What drug was patient 10014729 prescribed for within the same hospital visit after undergoing insertion of catheter into spinal canal for infusion of therapeutic or palliative substances in 03/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.name, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.ssn WHERE patient.name = 'John Doe' AND procedures.date = '03/2022') AS t1 JOIN (SELECT patient.name, prescriptions.drug FROM prescriptions JOIN patient ON prescriptions.patient = patient.ssn WHERE patient.name = 'John Doe') AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day')",
804ed378cfb82e9aa6f496dd,Has there been a procedure that patient 10038933 had in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10038933 AND STRFTIME('%y', procedures.date) = '2100'",
6b4f7abe50c5cf5f9fe5385a,Tell me the top four most frequent lab tests that patients were given within 2 months after being diagnosed with encounter for immunization since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.lab_test FROM (SELECT t3.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'encounter for immunization' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, lab_test, lab_test_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.patient_id WHERE DATETIME(lab_test_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.lab_test_date AND DATETIME(t2.lab_test_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1",
0c0b7b1acba7c1472c2ffd97,"How many patients were diagnosed with abdominal pain, other specified site in 2100 after previously being diagnosed with unspecified essential hypertension within 2 months?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, other specified site' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_site FROM (SELECT subject_id, diagnosed_site FROM (SELECT * FROM diagnoses WHERE diagnosis_type = 'abdominal pain, other specified site') AS t1 JOIN (SELECT * FROM diagnoses WHERE diagnosis_type = 'unspecified essential hypertension') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date BETWEEN '' AND '' GROUP BY t1.subject_id) AS t3 JOIN (SELECT subject_id, diagnosed_site FROM (SELECT * FROM diagnoses WHERE diagnosis_type = 'abdominal pain, other specified site') AS t1 JOIN (SELECT * FROM diagnoses WHERE diagnosis_type = 'unspecified essential hypertension') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date BETWEEN '' AND '' GROUP BY t1.subject_id) AS t4 ON t3.subject_id = t4.subject_id WHERE t3.diagnosis_date B",
047259e83745142834b50838,"Was milk of magnesia, furosemide, or metoprolol tartrate ordered on their last hospital encounter for patient 10012552?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'milk of magnesia', 'furosemide', 'metoprolol tartrate' )","SELECT COUNT(*) FROM orders WHERE patient_id = 10012552 AND order_date = (SELECT MAX(order_date) FROM orders WHERE patient_id = 10012552 AND medication = 'milk of magnesia, furosemide, or metoprolol tartrate')",[{'COUNT(*)>0': 0}]
db32ddeefc60ef2e085d547a,What is the common method for taking nystatin cream?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin cream',"SELECT DISTINCT ON(method) method, amount FROM ingredients WHERE ingredient = 'nystatin cream' ORDER BY method;",[]
af95f1ae9259d68f2fe0a56f,List the top five most frequent events occurring.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT Event, COUNT(*) FROM Log GROUP BY Event ORDER BY COUNT(*) DESC LIMIT 5;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
75d97d3e27240d4fbce0b019,How much is the average total hospital cost with personal history of malignant neoplasm of other gastrointestinal tract?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of other gastrointestinal tract' ) ) GROUP BY cost.hadm_id ) AS T1,"SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table JOIN patient_table ON cost_table.patient_id = patient_table.patient_id WHERE patient_table.personal_history = ""malignant neoplasm of other gastrointestinal tract"" GROUP BY cost_table.patient_id) AS t1",
f515f06bef679a5069bf1b69,When was the last time patient 10021312 was prescribed medication via the ih route in 08/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10021312 AND route = 'ih' AND date_prescribed BETWEEN '2000-08-01' AND '2000-08-21',[]
d97ce57b0238741d318dd305,What is the number of patients who were prescribed phenytoin infatab since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT id) FROM patients WHERE prescriptions = 'phenytoin infatab' AND DATETIME(prescriptions) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
062e5671bf6a5d7df2d8f9ef,When did patient 10039831 receive the last 5% dextrose and pantoprazole prescription at the same time throughout this month?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10039831 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10039831 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MIN(Date) FROM (SELECT patient.dateofpresence FROM patient WHERE patient.patienthealthid = (SELECT patient.patienthealthid FROM patient WHERE patient.name = '10039831')) WHERE patient.dateofpresence LIKE '%2004-04-%' AND patient.dateofpresence LIKE '%15:%' GROUP BY patient.dateofpresence HAVING COUNT(DISTINCT patient.dateofpresence) = 2,[]
d49a169b25722c624294da5c,"On the first hospital visit, what was the diagnosis for patient 10002495 the first time?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10002495 ORDER BY diagnoses.diagnosis_date NULLS FIRST LIMIT 1,
af65283ac3452f4ee5fa0142,Has patient 10022041 been admitted into an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM admit_data WHERE patient_id = 10022041 AND emergency_room = 'EMERGENCY ROOM ADMIT',[{'COUNT(*)>0': 0}]
06c9202911fa52427beba085,"What was the minimum value of patient 10001217's calcium, total in 12/2100?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'","SELECT MIN(calcium, total) FROM patients WHERE patient_id = 10001217 AND measurement_date BETWEEN '12/2100' AND '12/2100'",[{'MIN(labevents.valuenum)': None}]
e257942d050e74a2e2aef5b3,"What are the five commonly ordered medications for patients who were diagnosed with unspecified disorder of kidney and ureter previously in the same month, since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'Unspecified disorder of kidney and ureter' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.start_date FROM medication JOIN patient ON medication.patient_id = patient.uniquepid WHERE STRFTIME('%y', medication.start_date) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.start_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.start_date, 'start of month') GROUP BY t2.name) AS t3 WHERE t3.",
cb5415c33f751a6b441a1cd4,"What are the top five most common microbiology tests for people who were diagnosed with rheumatic disorders of both mitral and aortic valves earlier in the same hospital encounter, in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t5.Microbiology_Test, COUNT(t5.Microbiology_Test) FROM (SELECT t4.Microbiology_Test, COUNT(t4.Microbiology_Test) FROM (SELECT t3.Microbiology_Test, COUNT(t3.Microbiology_Test) FROM (SELECT t2.Microbiology_Test, COUNT(t2.Microbiology_Test) FROM (SELECT t1.Microbiology_Test, COUNT(t1.Microbiology_Test) FROM (SELECT PATIENT.Microbiology_Test, COUNT(PATIENT.Microbiology_Test) FROM PATIENT WHERE PATIENT.Hospital_Stay_ID IN (SELECT MIN(HOSP_TIME) FROM (SELECT PATIENT.Hospital_Stay_ID FROM PATIENT WHERE PATIENT.DIAGNOSIS = 'RHEUMATIC DISORDERS OF BOTH MITRAL AND AORTIC VALVES') AS T1 GROUP BY t1.Microbiology_Test) AS t",
093bd4e875cc23f9739cdd09,What was the output of patient 10020740 for the last time on 06/15/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '06-15' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT output FROM patients WHERE patient_id = 10020740 AND date_of_output = '06/15/2020' ORDER BY output DESC LIMIT 1,[]
c9bd206b23c8ece065ccbc5f,Retrieve the top four most frequent lab tests during this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t.lab_test, COUNT(t.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date_sub('year', CURRENT_DATE, lab_test_date) = 0) AS t GROUP BY t.lab_test ORDER BY COUNT(t.lab_test) DESC LIMIT 4;",[]
8ef6fa9dfc5f788fb73b69e8,Can you show me the top three most common procedures conducted in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.procedure_name, COUNT(t1.procedure_name) FROM procedures AS t1 JOIN procedures_2000 AS t2 ON t1.procedure_name = t2.procedure_name WHERE t2.year = 2100 GROUP BY t1.procedure_name ORDER BY COUNT(t1.procedure_name) DESC LIMIT 3",
9cfc6425bde940cf398a73dc,"What's the average monthly number of patients who had multiple fractures of ribs, bilateral, initial encounter for closed fracture in 2100?","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'multiple fractures of ribs, bilateral, initial encounter for closed fracture' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT AVG(t1.RIB_FRACTURES) FROM (SELECT COUNT(DISTINCT ROLLOUT_DATE) AS RIB_FRACTURES FROM PATIENTS WHERE PATIENT_ID IN (SELECT PATIENT_ID FROM INITIAL_ENCOUNTER WHERE FRACTURE_TYPE = 'MULTIPLE FRACTURES OF RIBS, BILATERAL' AND CLOSED_FRACTURE = 'true' AND ROLLOUT_DATE BETWEEN '2000-01-01' AND '2000-12-31') GROUP BY PATIENT_ID) AS t1",
04c9a043e311b54b777c1b7d,Can you tell the five most frequent lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT lab_test, COUNT(lab_test) FROM lab_results GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 5;","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
785d76bc0b177869d3d36d87,How many operating rooms is there now,,SELECT COUNT(*) FROM inventory WHERE item = 'operating room',
7f904e1c55c930388a753052,How many patients required alteplase (catheter clearance)?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'alteplase (catheter clearance)' ),SELECT COUNT(DISTINCT patient_id) FROM requirement_table WHERE product_name = 'Alteplase (Catheter Clearance)',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
398d1c05773ae55b7220d406,What was the medication patient 10022017 was prescribed for the last time since 04/2100 via the sc route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM medication WHERE patient_id = 10022017 AND route = 'sc' AND date_prescribed >= '2000-04-2100',[]
d4f9d7cf2cdd1caea918a666,What are the costs of other psoriasis diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other psoriasis' ) ),SELECT cost FROM diagnoses WHERE diagnosis = 'other psoriasis',
cd9b4dacacdde7494c082761,Gather the total number of times patient 10023239 visited the hospital during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient.id) FROM patient WHERE patient.id = 10023239 AND DATETIME(patient.hospital_admittime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
df115de912364769eda352c1,Show me patient 10007058's total amount of cath lab intake input since 07/17/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cath lab intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-17'",SELECT SUM(CathLabIntakeInput) FROM intake WHERE PatientID = 10007058 AND Date >= '2000-07-17',[{'SUM(inputevents.totalamount)': None}]
ea3505754407fd4d8ea5fdd8,How much difference is there in pco2 levels among patient 10009035 last measured on the first hospital visit compared to the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT pCO2 FROM patient_10009035 WHERE hospital_visit_number = 1 ORDER BY measurement_time DESC LIMIT 1) - (SELECT pCO2 FROM patient_10009035 WHERE hospital_visit_number = 1 ORDER BY measurement_time NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
27b1f84153a5a461120468de,Has patient 10005817 undergone laboratory tests since 4 months ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(labevents.charttime) >= datetime(current_time,'-4 month')","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10005817 AND DATETIME(lab_tests.test_date) >= DATETIME(CURRENT_TIME, '-4 month')",[{'COUNT(*)>0': 1}]
ead0a72fbee21b877251d88f,How much does malignant neoplasm of central portion of female breast cost to get diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of central portion of female breast' ) ),SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = 'malignant neoplasm of central portion of female breast',
2b73e239d32f4e598b39620c,Can you tell me the last value of the free calcium test for patient 10023239?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT last(free_calcium) FROM lab_results WHERE patient_id = 10023239;,[]
5af27171b0a97add7aee4ea6,What was the amount of acetaminophen that patient 10023239 were prescribed in total in 06/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND prescriptions.drug = 'acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06'","SELECT SUM(acetaminophen) FROM patients WHERE patient_id = 10023239 AND STRFTIME('%y-%m', medication.date) = '2100-06'",[{'SUM(prescriptions.dose_val_rx)': None}]
342ee94f22cb4edb3916fb14,What was patient 10005909's first input time since 04/03/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10005909 AND input_time >= '2100-04-03',[{'starttime': '2144-10-29 23:15:00'}]
55c7172525f47f43ab6b752a,What percentile does a alanine aminotransferase (alt) value of 55.0 for patient 10007818 place in today in the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 55.0","SELECT percent_rank() OVER (ORDER BY 55.0) FROM (SELECT 55.0 FROM (SELECT alt FROM (SELECT 10007818 AS patient_id, 55.0 AS alt) AS alt_value) AS today_alt) AS today_percentile;",
3a11d55ef59b984180bf191b,What was an insurance plan for patient 10001217 during their first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,"SELECT json_extract(insurance_plan, '$.coverage_during_hospitalization') FROM patients WHERE patient_id = 10001217 AND NOT patients.dischtime IS NULL ORDER BY patients.hospital_stay_length LIMIT 1;",[{'insurance': 'Other'}]
f39b6fca5e6f640b836a9c9c,Get me the top three most frequent procedures that patients received within 2 months after receiving diagnostic ultrasound of heart.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of heart' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, COUNT(t2.procedure) FROM (SELECT patient.name, diagnostic_ultrasound_heart.diagnosis_date FROM diagnostic_ultrasound_heart JOIN patient ON diagnostic_ultrasound_heart.patient_id = patient.patient_id WHERE diagnostic_ultrasound_heart.diagnosis_date IS NOT NULL) AS t1 JOIN (SELECT patient.name, procedures.procedure, procedures.procedure_date FROM procedures JOIN patient ON procedures.patient_id = patient.patient_id WHERE procedures.procedure_date IS NOT NULL) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.procedure_date AND DATETIME(t2.procedure_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.procedure) AS t3 GROUP BY t3.procedure ORDER BY COUNT(t",
26d017535d48be13b43f72f2,What were the top five most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.MicrobiologyTest, COUNT(t.MicrobiologyTest) FROM (SELECT MicrobiologyTest FROM (SELECT * FROM (SELECT ""Staphylococcus_species"" AS MicrobiologyTest FROM __data WHERE NOT MicrobiologyTest IS NULL GROUP BY MicrobiologyTest ORDER BY COUNT(*) DESC LIMIT 5) AS t) AS t GROUP BY t.MicrobiologyTest;","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
44976b84ff1c95d71e982f32,What immunocancer drugs have been used for the last five years?,,SELECT Drugs FROM bracket_exercise WHERE Year = (SELECT MAX(Year) FROM bracket_exercise) - 5 AND Drug_Type = 'immunocancer';,
c4e464a5e3c26b34a598c2d4,"What are the three most commonly prescribed medications for patients diagnosed with other and unspecified hyperlipidemia previously within the same hospital visit, throughout this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t1.subject_id, t1.diagnosis, t1.date FROM (SELECT SUM(DATEDIFF('day', diagnosis, DATE '1970-01-01')) OVER (PARTITION BY subject_id) AS days FROM (SELECT subject_id, diagnosis, DATE '1970-01-01' + INTERVAL days DAY AS date FROM (SELECT subject_id, diagnosis FROM (VALUES (1, 'other and unspecified hyperlipidemia'), (2, 'other and unspecified hyperlipidemia')) AS t1(subject_id, diagnosis)) AS t2 JOIN (SELECT t1.subject_id, t1.medication, t1.date FROM (SELECT SUM(DATEDIFF('day', medication, DATE '1970-01-01')) OVER (PARTITION BY subject_id) AS days FROM (SELECT subject_id, medication,",
e138f038c01ab7ff83cbbb98,What is the price of a procedure named arteriography of other specified sites?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other specified sites' ) ),"SELECT ARTERIOGRAM_OTHER_SPECIFIED_SITES FROM procedures WHERE PROCEDURE_NAME = ""Arteriography of other specified sites""",
a178876b3ab67646062e1b51,How many hours has it been since patient 10021487 stayed in the careunit emergency department in this hospital encounter for the last time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', Careunit.StayDate)) FROM Careunit WHERE Careunit.Patient = 10021487 AND Careunit.Location = 'emergency room admit' AND DATETIME(CURRENT_TIME, 'start of transaction') = DATETIME(Careunit.StayDate, 'start of transaction') ORDER BY Careunit.StayDate DESC LIMIT 1;",[]
027706ca26ae55a15b9f1d91,"Among the patients of age 40s in 2100, what are the top three most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.ID, diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.ID WHERE diagnosis.year = 2100 AND patient.age BETWEEN 40 AND 49) AS t1 WHERE t1.c1 <= 3)",
024dcd124ec3d33f8ac7d1e6,Show me the four most common specimens tested during this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT specimen, COUNT(specimen) FROM inventory WHERE date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 4",[]
4e1f8471625f8559d0c64629,Count the number of times that arteriography of renal arteries was performed since 1 year ago.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of renal arteries' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.name = 'arteriography of renal arteries' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
7f969459fa4b9cddf822c495,"What are the four frequently prescribed medications for patients diagnosed with septicemia due to escherichia coli [e. coli] previously in the same hospital visit, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'septicemia due to escherichia coli [e. coli]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,
1ed08f1aa0fe257e5b029f58,When was the last time patient 10021118 had an minimum absolute basophil count in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MIN(absolute_basophil_count) FROM this_year WHERE patient_id = 10021118 AND measurement_date BETWEEN '12/01/2002' AND '12/31/2002',[]
8281e9dde4a495faf9a70ae4,When was the first time on this month/29 patient 10018081's heart rate was greater than 72.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 72.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime(patient.heart_rate > 72.0, '%Y-%m-%d %H:%M:%S') AS first_time_heart_rate_gt_72",[]
145ae721e90f0d4889236e9b,Tell me the percentile for pt of 12.9 among patients in the same age as patient 10001217 in their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 12.9",SELECT pt FROM (SELECT * FROM patients WHERE age = (SELECT age FROM patients WHERE id = 10001217 AND NOT first_hospital_visit IS NULL ORDER BY first_hospital_visit NULLS FIRST LIMIT 1) AND NOT pt IS NULL) AS subquery WHERE pt = 12.9,
523b2264acf6a8ceaf29d220,What was patient 10004733's last serology/blood's microbiology test time in 12/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND microbiologyevents.spec_type_desc = 'serology/blood' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(Microbiology_Test_Time) FROM Serology_Blood WHERE Patient_ID = 10004733 AND Microbiology_Test_Type = 'Serology/Blood' AND DATETIME(Microbiology_Test_Time, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', Microbiology_Test_Time) = '12'",[]
cd5de61128bf4493b8a116a3,Did patient 10018423 undergo a alkaline phosphatase test in 05/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05'","SELECT COUNT(*) > 0 FROM lab WHERE lab.patient_id = 10018423 AND lab.test_name = 'alkaline phosphatase' AND STRFTIME('%y-%m', lab.date) = '2100-05'",[{'COUNT(*)>0': 0}]
bddff1513f83253443df0ee2,"Count the number of people who received drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic within 2 months after having been diagnosed with other cirrhosis of liver in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM (SELECT subject_id, date_trunc('month', diagnosis_date) AS diagnosed_date FROM (SELECT subject_id, diagnosis_date FROM diagnoses WHERE diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND diagnosis_type = 'other cirrhosis of liver')) AS t1 JOIN (SELECT subject_id, diagnosed_date FROM (SELECT subject_id, date_trunc('month', diagnosis_date) AS diagnosed_date FROM diagnoses WHERE diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND diagnosis_type = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date < t2.diagnosed_date AND DATET",
802527c0be8a9149dbd4a8eb,What was the name of the organism that was found during the last urine test of patient 10008454 in 12/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM urine_log WHERE patient_id = 10008454 AND urine_date = '12/2100' ORDER BY urine_date DESC LIMIT 1,[]
8f6f18c72c81b1627f391252,Has patient 23070 ever experienced any side effects while receiving a blood transfusion?,,"SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 23070 AND diagnoses.side_effects = ""side effects"" AND diagnoses.treatment = ""blood transfusion""",
e7b0a2fb743b8d418360896e,Calculate the total amount of foley of patient 10006580 in the first ICU visit.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ),SELECT SUM(foley) FROM icu_data WHERE patient_id = 10006580 AND NOT icu_order IS NULL ORDER BY icu_order NULLS FIRST LIMIT 1;,[{'SUM(outputevents.value)': None}]
8189f1610cb803102103466a,Has any medication been prescribed to patient 10015931 since 12/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'","SELECT COUNT(*) > 0 FROM medication_prescriptions WHERE medication_prescriptions.patient_id = 10015931 AND STRFTIME('%y-%m', medication_prescriptions.date) >= '2100-12'",[{'COUNT(*)>0': 1}]
8ff3fa3aa1d227c7f0860781,What are the four most frequent procedures for patients who are in their 20s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.Procedure, COUNT(t1.Procedure) FROM procedures AS t1 JOIN patients AS t2 ON t1.patient_id = t2.patient_id WHERE t2.age BETWEEN 20 AND 29 GROUP BY t1.Procedure ORDER BY COUNT(t1.Procedure) DESC LIMIT 4",
6b9aea1e113e3ec6de66929b,"What were the five most commonly performed lab tests for patients who were previously diagnosed with cholangitis in the same hospital visit, in this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cholangitis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.name, diagnosis.diagnosis_date, patient.patient_id FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'cholangitis' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.name, lab_test, lab_date, patient.patient_id FROM lab JOIN patient ON lab.patient_id = patient.patient_id WHERE DATETIME(lab.lab_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.lab_date AND t1.patient_id = t2.patient_id GROUP BY t",
b49883cb372deacf8d0d0392,What was the total amount of input for patient 10018081 since 09/25/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-25'",SELECT SUM(input) FROM input WHERE patient = 10018081 AND date >= '2000-09-25',[{'SUM(inputevents.totalamount)': 171300.0}]
a0cdae836281b14960231c43,What is the list of things to do before you go through the endo polpectomy lrge int procedure?,,SELECT * FROM endo_polpectomy_lrge_int;,
7a5650e936855a3fa424dc59,Find out the number of hospital visits patient 10014078 had in the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014078 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT visit_date) FROM hospital_visits WHERE patient_id = 10014078 AND DATETIME(visit_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
2c4de5ffe5ea946437ba33a6,"During the last hospital encounter, how old was patient 10019172?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT MAX(CURRENT_DATE) - MIN(CURRENT_DATE) FROM patient WHERE patient.age IN (SELECT patient.age FROM patient WHERE patient.id = 10019172 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1),
b7b81b39be99bf34446ee242,Has there been any organism found in the last microbiological mrsa screen test of patient 10039997?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT COUNT(*) FROM Microbiological_Screen_MRSA WHERE Patient_ID = 10039997 AND Microbiological_Screen_MRSA.date = (SELECT MAX(Microbiological_Screen_MRSA.date) FROM Microbiological_Screen_MRSA WHERE Patient_ID = 10039997),[{'COUNT(*)>0': 0}]
4d64d12fe14c8c3ed4e3f73f,Has patient 10039831 got a lab test since 05/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-05'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10039831 AND STRFTIME('%y-%m', lab_results.result_date) >= '2100-05'",[{'COUNT(*)>0': 1}]
4e9096d82b904f68fcb8006c,What is the average value of creatinine on patient 10023117?,SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ),"SELECT AVG(Creatinine) FROM ""patients"" WHERE ""patient_id"" = 10023117",[{'AVG(labevents.valuenum)': None}]
1e3f74247a6a94fae1151382,How much was the difference in weight of patient 10038081 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patients WHERE patient_id = 10038081 AND NOT last_hospital_visit IS NULL ORDER BY last_hospital_visit DESC LIMIT 1) - (SELECT weight FROM patients WHERE patient_id = 10038081 AND NOT last_hospital_visit IS NULL ORDER BY last_hospital_visit NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
9c3e936bd95a10b43339da38,When did patient 10007818 receive a mrsa screen microbiology test first in 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiology.date FROM microbiology WHERE microbiology.patient_id = 10007818 AND microbiology.test_type = 'mrsa screen microbiology' AND STRFTIME('%y-%m', microbiology.date) = '2100-07' ORDER BY microbiology.date NULLS FIRST LIMIT 1",[]
16daefeea8782307bdc2f5f7,Provide the daily maximum weight of patient 10031757 since 12 months ago.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT MAX(weight) FROM patients WHERE patient_id = 10031757 AND measurement_date >= DATEADD(month, -12, CURRENT_DATE) GROUP BY date;",[]
6403ade93013ea7eb291be96,What are patient 10025612's changes in SaO2 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT SAO2 FROM icu_data WHERE icu_data.patient_id = 10025612 AND NOT icu_data.outcome IS NULL ORDER BY icu_data.entry_time NULLS FIRST LIMIT 1) - (SELECT SAO2 FROM icu_data WHERE icu_data.patient_id = 10025612 AND NOT icu_data.outcome IS NULL ORDER BY icu_data.entry_time NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
e63b87cee280daecb46a2af6,"So, the first asparate aminotransferase (ast) test result for the patient 10019172 was?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT MIN(asparate_aminotransferase__ast_) FROM ""tests"" WHERE ""patient_id"" = 10019172",[]
ca889d0ba7397111451ebf74,Count the number of patients who underwent a d-dimer lab test since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'd-dimer' ) AND strftime('%Y',labevents.charttime) >= '2100' )","SELECT COUNT(DISTINCT t.subject_id) FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t.subject_id, t.d_dimer FROM (SELECT t",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4a7d4830011d65962d460041,What is the maximum cost to the hospital that involves nonalcoholic steatohepatitis (nash) since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nonalcoholic steatohepatitis (nash)' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost_type = 'nonalcoholic steatohepatitis (nash)' AND STRFTIME('%y', cost_date) >= '2100' GROUP BY patient_id) AS t1",
388d3f6a45be242b02005c5c,How many hours have passed since patient 10018081 got her last diagnosis of other and unspecified hyperlipidemia on their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = 'Other and unspecified hyperlipidemia' AND patient_id = 10018081 AND hospital_connection = 1;",
5acdc780ba8984cef61073b2,Show me the top five most frequent diagnoses since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT diagnosis, COUNT(*) FROM diagnoses WHERE date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 5;",
3e877dc92daa5d8f28115762,"What is the total count of performance of cardiac output, continuous procedures that were done since 1 year ago?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.performance = 'cardiac output, continuous' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
47fa8b1ea8f2a4b9b4e04657,When did patient 10006053 have the minimum value of polys last on the first hospital stay?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MIN(polys) FROM (SELECT polys FROM admissions WHERE admissions.subject_id = 10006053 AND NOT admissions.dischtime IS NULL ORDER BY admissions.admittime NULLS FIRST LIMIT 1),[]
9b039ee786a20e3b239037e0,How many patients were staying in med/surg/trauma in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/trauma' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, ward FROM med_surg_trauma WHERE year = 2100) AS t1 JOIN (SELECT subject_id, ward FROM med_surg_trauma WHERE year = 2010) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.ward = t2.ward AND med_surg_trauma.location = 'med/surg/trauma'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
80343317e0783f2a96a603d5,Does patient 59275 have a travel history to another country?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_id = 59275 AND patients.travel_history = 'Yes' AND patients.country = 'Other Country',
95315cf3377aff338fc6744d,"What are the top four most common microbiology tests for people who were diagnosed with unspecified deficiency anemia earlier during the same month, in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified deficiency anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t4.Microbiology_Test, COUNT(t4.Microbiology_Test) FROM (SELECT t3.Microbiology_Test, COUNT(t3.Microbiology_Test) FROM (SELECT t2.Microbiology_Test, COUNT(t2.Microbiology_Test) FROM (SELECT DATEADD(month, DATE_DIFF('CREATIONDATE', 0, month), 0) AS Microbiology_Test, FROM (SELECT p.partid, p.firstname, p.lastname, m.microbiology_test FROM patients p JOIN microbiology m ON p.partid = m.partid WHERE p.diagnosis = 'UNOBTAINABLE DEFICIENCY ANEMIA' AND STRFTIME('%y', m.creationdate) = '2100') AS t1 JOIN (SELECT Microbiology_Test, COUNT(Microbiology_Test) FROM microbiology GROUP BY Microbiology_Test) AS t2 ON t1.Microbiology_Test = t2.Microbiology_Test) AS t3 JOIN",
0e962cda70b80f5930bde5ac,What percentile of the po2 value is 127.0 among patients of the same age as patient 10021487 on this hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 127.0",SELECT 100 * FROM (SELECT * FROM patient_po2 WHERE patient_id = 10021487 AND hospital_dischtime IS NULL) WHERE po2_value = 127.0,
e6c6113c42e3afffa9a446d8,"Since 2100, what are the top five most common lab tests ordered for patients in the same month after acute respiratory failure with hypoxia?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute respiratory failure with hypoxia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, DATETIME(t2.date_order, 'start of month') AS date_truncated FROM (SELECT patient.name, diagnosis.date_order FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Acute respiratory failure with hypoxia') AS t1 JOIN (SELECT patient.name, lab_test.lab_test, lab_test.date_order FROM lab_test JOIN patient ON lab_test.patient_id = patient.patient_id WHERE DATETIME(lab_test.date_order, 'start of month') >= DATETIME('2100-01-01', 'start of month')) AS t2 ON t1.name = t2.name WHERE DATETIME(t1.date_order, 'start of month') = DATETIME(t2.date_order, 'start of month') GROUP BY t2.lab_test) AS t3 GROUP BY t3.lab_test",
7cfaf497121871d021a26099,Count up how many times patient 10000032 was admitted to the ICU since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT patient_id) FROM icu_admissions WHERE patient_id = 10000032 AND DATETIME(admission_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}]
d4efc7e55f28c5602d3467ae,Could you inform me of the minimum alkaline phosphatase value for patient 10018081 since 12/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12'",SELECT MIN(Alkaline Phosphatase) FROM alkaline_phosphatase WHERE Patient = 10018081 AND Date >= '12/2100',[{'MIN(labevents.valuenum)': None}]
232ebd5bf14d5819bef84afc,"Has furosemide, lidocaine jelly 2% (urojet), or acetaminophen iv been prescribed in 04/last year for patient 10038992?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.drug IN ( 'furosemide', 'lidocaine jelly 2% (urojet)', 'acetaminophen iv' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10038992 AND medication.date BETWEEN '2004-01-01' AND '2004-12-31' AND medication.drug IN ('Furosemide', 'Lidocaine Jelly 2% (Urojet)', 'Acetaminophen IV')",[{'COUNT(*)>0': 0}]
bd5f6fd5ab13ce62634ea939,What was patient 10039997's daily average weight since 4 months ago?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-4 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10039997 AND date >= current_date - INTERVAL '4 month' GROUP BY date,[]
02960e704986efbe2e56a892,What's the weight difference of patient 10038081's body second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
d9a1e858931b19e914db92c6,Calculate patient 10007818's total input amount of fresh frozen plasma on 07/03/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fresh frozen plasma' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-03'",SELECT SUM(inputamount) FROM inputtable WHERE patientid = 10007818 AND inputdate BETWEEN '2022-07-03' AND '2022-07-03' AND inputtype = 'fresh frozen plasma',[{'SUM(inputevents.totalamount)': None}]
48ee3c32b16e889f8868868d,"Tell me the name of the drug patient 10002495 was prescribed within 2 days after having received a dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach procedure in 06/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT t1.patient_id, t1.date FROM (SELECT patient_id, DATE '2006-01-01' FROM patient WHERE patient_id = 10002495) AS t1 JOIN (SELECT patient_id, DATE '2006-01-01' FROM patient WHERE patient_id = 10002495) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.date < DATE '2006-01-01' + INTERVAL 2 DAY AND t1.date > DATE '2006-01-01' - INTERVAL 2 DAY) AS t3 JOIN (SELECT patient_id, name FROM prescriptions WHERE prescriptions.patient_id = 10002495) AS t4 ON t3.patient_id = t4.patient_id",
1aa68945724425b2f49cb5f1,What output did patient 10015860 generate first since 10/04/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT STRFTIME('%d/%m/%Y', CURRENT_TIMESTAMP) FROM patients WHERE patient_id = 10015860 AND CURRENT_TIMESTAMP >= '2100-10-04' ORDER BY current_timestamp NULLS FIRST LIMIT 1;",[{'label': 'Void'}]
1532ba3736ece73151250484,When were the drugs sodium chloride 0.9% and pantoprazole prescribed to patient 10036156 for the last time at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium chloride 0.9%' AND admissions.subject_id = 10036156 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10036156 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(t1.drug_start_time) FROM (SELECT patient_id, prescription_start_time AS drug_start_time FROM prescriptions WHERE prescription_type = 'sodium chloride 0.9%' AND patient_id = 10036156 UNION ALL SELECT patient_id, prescription_start_time AS drug_start_time FROM prescriptions WHERE prescription_type = 'pantoprazole' AND patient_id = 10036156) AS t1",[]
8ba70176af381d80ec259c94,What is the treatment that patient 10020740 was given two times since 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT T1.treatment FROM (SELECT patient_id, treatment_date FROM diagnosis WHERE patient_id = 10020740 AND treatment_date >= '05/2100') AS T1 JOIN (SELECT patient_id, treatment_date FROM diagnosis WHERE patient_id = 10020740 AND treatment_date >= '05/2100') AS T2 ON T1.patient_id = T2.patient_id GROUP BY T1.patient_id HAVING COUNT(DISTINCT T1.treatment_date) = 2",
feaaef960a419d81d79e5cfb,Tell me the total acetaminophen dose that patient 10037975 has been prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND prescriptions.drug = 'acetaminophen',SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10037975 AND medication.drug_name = 'acetaminophen',[{'SUM(prescriptions.dose_val_rx)': None}]
a739dee00e50021190bd7f13,When did patient 10014078 have his first microbiology test on the first hospital stay?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,,[{'charttime': '2166-08-22 02:04:00'}]
d2c264c9a4496523fd9581ea,"On 10/13/2100, when did patient 10038081 have his first input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-10-13' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT input_date FROM input_table WHERE patient_id = 10038081 AND input_date BETWEEN '2100-10-13' AND '2100-10-13' ORDER BY input_date NULLS FIRST LIMIT 1,[]
cd3f347fafd6a0b53706f949,Can you tell me the maximum total hospital cost that involved propranolol since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'propranolol' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(T1.c1) FROM (SELECT SUM(T2.c2) AS c1 FROM (SELECT T3.c2 FROM T3 WHERE T3.d = 'propranolol') AS T2 JOIN (SELECT T1.c1 FROM T1 WHERE T1.d = '2100') AS T1 ON T2.c2 = T1.c1 GROUP BY T2.c2) AS T2 JOIN (SELECT T3.c2 FROM T3 WHERE T3.d = 'propranolol') AS T3 ON T2.c2 = T3.c2 GROUP BY T2.c2,
31cdceeb50d5b9593b6c8055,Find out the number of medicines given to patient 10021938 since 03/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10021938 AND STRFTIME('%y-%m', medications.date) >= '2100-03'",[{'COUNT(*)': 48}]
14db1e998fac387f2026f225,When was the last time patient 10021487 measured its mean blood pressure less than 63.0 since 339 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 63.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-339 day') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(blood_pressure) FROM (,[]
5137f76e33516dfdead9f682,Has patient 10004733 been given any gastric meds medication since 12/19/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19'","SELECT COUNT(*) > 0 FROM gastric_meds WHERE gastric_meds.patient_id = 10004733 AND STRFTIME('%y-%m-%d', gastric_meds.date) >= '2100-12-19'",[{'COUNT(*)>0': 0}]
436b1fadeae03c1681161469,Was patient 10016150 through any surgery during the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10016150 AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
493b74ce7611de520a722436,What was the name of the output patient 10007058 last had since 05/10/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-10' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT name FROM patients WHERE patient_id = 10007058 AND birthdate < '2100-05-10' ORDER BY birthdate DESC LIMIT 1,[{'label': 'Void'}]
b6c95050bdc4cd4c317d476e,"Tell me the four most common microbiology tests for patients who were previously diagnosed with fall on same level, unspecified, initial encounter during the same month since 2100.","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fall on same level, unspecified, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t3.Microbiology, COUNT(t3.Microbiology) FROM (SELECT t2.Microbiology, t1.FallOnSameLevel, t1.FallOnSameLevel FROM (SELECT SUM(CASE WHEN FallOnSameLevel = ""1"" THEN 1 ELSE 0 END) AS FallOnSameLevel, Microbiology FROM t2 JOIN t1 ON t2.Microbiology = t1.Microbiology WHERE t2.FallOnSameLevel = ""1"" GROUP BY t2.Microbiology) AS t3 JOIN (SELECT Microbiology, DATE_TRUNC('month', Date) AS Month FROM t2 JOIN t1 ON t2.Microbiology = t1.Microbiology WHERE t2.FallOnSameLevel = ""1"" GROUP BY Microbiology) AS t4 ON t3.Microbiology = t4.Microbiology WHERE t3.Month = t4.Month AND STRFTIME('%y', t3.Month) >= '2100' GROUP BY t3.Microbiology ORDER BY COUNT(t",
7a87b3514162ac542fd54a50,"When did patient 10014354 get the creatine kinase, mb isoenzyme lab test in their last hospital visit for the first time?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT lab.date FROM lab WHERE lab.patient_id = 10014354 AND lab.test = 'Creatine Kinase, MB Isoenzyme' ORDER BY lab.date DESC LIMIT 1;",[]
297493c491ff8db9a6d2fc45,Has there been a mch lab test performed on patient 10022281 since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y',labevents.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM lab_tests WHERE lab_tests.patient_id = 10022281 AND lab_tests.test_name = 'mch' AND STRFTIME('%y', lab_tests.test_date) >= '2100'",[{'COUNT(*)>0': 0}]
2c475b369cef5f55de67b63f,When was the last hospital discharge of patient 10009049?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10009049 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(hospital_discharge_date) FROM hospital WHERE hospital_id IN (SELECT hospital_id FROM admissions WHERE admissions.subject_id = 10009049);,[]
33dd2e95b6eaf89b0361b109,What are the top four most common microbiology tests that patients had after the diagnosis of metabolic encephalopathy in the same month?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'metabolic encephalopathy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t4.test_name, COUNT(t4.test_name) FROM (SELECT t3.test_name, DATE_TRUNC('month', t3.date) AS month FROM (SELECT t2.test_name, DATE_TRUNC('month', t2.date) AS month FROM (SELECT patient.number, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.number WHERE diagnosis.diagnosis = 'Metabolic encephalopathy') AS t2 JOIN (SELECT patient.number, microbiology.test_name, microbiology.date FROM microbiology JOIN patient ON microbiology.patient_id = patient.number) AS t3 ON t2.number = t3.number WHERE t2.date < t3.date AND DATETIME(t2.date, 'start of month') = DATETIME(t3.date, 'start of month') GROUP BY t4.test_name ORDER BY COUNT(t4.test_name) DESC LIMIT 4",
17fee8730ce67c5cb81363da,Tell me the name of the diagnosis that patient 10019172 received the last time on the last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 10019172 AND NOT diagnoses.hospital_id IS NULL ORDER BY diagnoses.date DESC LIMIT 1,
1bf033967053a3e88b60ffec,How many current patients are there?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE current_patient = true;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
7b572da72e10a69e40094361,Tell me the blood type of patient 28443?,,"SELECT ""blood_type"" FROM ""patients"" WHERE ""patient_id"" = 28443",
d33831f0ec31a6a9c49b16ff,"On 06/23/2100, what was the first value of arterial blood pressure mean of patient 10013049?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-06-23' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(arterial_blood_pressure_mean) FROM pulses WHERE patient_id = 10013049 AND measurement_date = '2100-06-23',[]
131ea45cf61be3a504988801,"In total, how many patients were prescribed vancomycin since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' AND strftime('%Y',prescriptions.starttime) >= '2100' )",,[{'COUNT( DISTINCT admissions.subject_id )': 136}]
b6d7a34bc707d9209a3f1b63,How many hours has elapsed since the last time in this hospital visit patient 10021487 had received a wbc lab test?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', wbc_date)) FROM wbc_table WHERE wbc_patient_id = 10021487 AND wbc_date IS NOT NULL ORDER BY wbc_date DESC LIMIT 1;",[]
d0236a73c2938bd7a69aac21,Was any tpn without lipids medication provided to patient 10020740 on 03/26/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn without lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-26'",SELECT COUNT(*) FROM orders WHERE patient_id = 10020740 AND order_date = '2000-03-26' AND medication_id = (SELECT medication_id FROM medications WHERE medication_name = 'tpn without lipids'),[{'COUNT(*)>0': 0}]
f65f6f053430f63b922aef1d,How many days has it been since the first time that patient 10004733 was diagnosed with other iatrogenic hypotension on the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",SELECT COUNT(DISTINCT diagnosis_date) FROM diagnoses WHERE patient_id = 10004733 AND diagnosis_type = 'other iatrogenic hypotension' AND hospital_oid = (SELECT oid FROM main.hospital WHERE patient_id = 10004733 AND is_current = true),
d84c6c7fe6daa03fe7f81c8b,"In 2100, how many patients underwent insertion of endotracheal tube during the same month after the diagnosis of acute kidney failure, unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis_date FROM (SELECT subject_id, DATE(diagnosis_date) AS diagnosis_date FROM acute_kidney_failure WHERE acute_kidney_failure = 'acute kidney failure, unspecified') AS t1 JOIN (SELECT subject_id, treatment_date FROM endotracheal_tube WHERE endotracheal_tube = 'insertion of endotracheal tube') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.treatment_date, 'start of month') WHERE DATETIME(t1.diagnosis_date, 'start of year') = DATETIME(t2.treatment_date, 'start of year') AND t1.diagnosis_date NOT DISTINCT FROM t2.treatment_date",
0a32f1c36ff8b32b47e43478,"Tell me, was packed red blood cells given to patient 10007818 on 07/04/this year?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-04'",SELECT SUM(packed_red_blood_cells) FROM patient WHERE patient_id = 10007818 AND date_packed = '07/04/this year',[{'COUNT(*)>0': 0}]
06e428e5b1ed6505097a25ad,Tell me the total number of patients in pacu since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND strftime('%Y',transfers.intime) >= '2100' )",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE location = 'pacu' AND year >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f3303ed15c820c9b329af410,What are the top four most common diagnoses that patients were diagnosed with within 2 months after receiving partial hepatectomy's this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t1.diagnosis, t2.healing_date FROM (SELECT diagnosis, MIN(hearing_date) AS healing_date FROM diagnoses GROUP BY diagnosis) AS t1 JOIN (SELECT healing_date, diagnosis FROM diagnoses GROUP BY diagnosis) AS t2 ON t1.diagnosis = t2.diagnosis AND t1.healing_date < t2.healing_date AND DATETIME(t2.healing_date) BETWEEN DATETIME(t1.hearing_date) AND DATETIME(t1.hearing_date, '+2 month') WHERE t1.healing_date >= DATETIME(CURRENT_TIME, '-0 year') AND t1.healing_date < DATETIME(CURRENT_TIME, '+0 year')) AS t3 GROUP BY t3.diagnosis ORDER BY c1 NULLS FIRST",
1b4e7ac4a337c583b0d77b04,The name of the diagnosis received by patient 65582 at the other department.,,SELECT diagnosis_name FROM diagnoses WHERE diagnoses.patient_id = 65582 AND diagnoses.department_id <> (SELECT DISTINCT department_id FROM patients WHERE patient_name = 'John Doe'),
37c0bde96e8c70d1dcfce0ca,"What is the average daily number of patients suffering from constipation, unspecified?","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT AVG(daily_number) FROM diagnoses WHERE diagnosis = 'constipation, unspecified'",
98eb6c243d1dff5092eb4c38,What's the best way to disinfect a quarantine room?,,SELECT * FROM sanitizer WHERE function = 'quarantine';,
46024bc03077cc1765abf676,"In 04/last year has insulin, metronidazole (flagyl), or bisacodyl been prescribed for patient 10021487?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug IN ( 'insulin', 'metronidazole (flagyl)', 'bisacodyl' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10021487 AND medication.dosage IN ('insulin', 'metronidazole (flagyl)', 'bisacodyl') AND DATETIME(medication.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year') AND STRFTIME('%m', medication.date) = '04'",[{'COUNT(*)>0': 0}]
1844c94cefe167cfc46bbbc8,When did patient 10007818 first have their minimum heart rate on 07/03/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-07-03' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(heart_rate) FROM patient WHERE patient_id = 10007818 AND date = '07/03/2100',[]
6b93b67bb974684b413b3c6a,Can I know the total output amount for patient 10018081 since 11/27/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-27'",SELECT SUM(output_amount) FROM output WHERE patient_id = 10018081 AND output_date >= '2100-11-27',[{'SUM(outputevents.value)': 66945.0}]
b08e604b0e398d9225a7e1f0,When did the last time patient 10027602 had the minimum value of heart rate since 10/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-06' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT MIN(heart_rate) FROM vital_signs WHERE patient_id = 10027602 AND measurement_date >= '2010-10-06',[]
8112593e7e23d761e0584c76,Give me patient 10001725's length of stay for the first ICU stay in days.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.338587962090969}]"
61f59af2792e3a760c51ddd9,When was patient 10011398's first input since 04/16/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-16' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT MIN(input_date) FROM input_table WHERE input_table.patient_id = 10011398 AND STRFTIME('%m/%d/%Y', input_date) >= '04/16/2100'",[{'starttime': '2146-12-15 12:30:00'}]
79257401a1158ff7232db9fd,Show me the top four most frequent diagnoses that patients were diagnosed with within 2 months after receiving other electroshock therapy since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.month FROM (SELECT patient.id, diagnosis.month FROM diagnosis JOIN patient ON diagnosis.patient = patient.id WHERE diagnosis.month BETWEEN 1 AND 24 AND STRFTIME('%y', diagnosis.month) >= '2100') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.month FROM diagnosis JOIN patient ON diagnosis.patient = patient.id WHERE diagnosis.month BETWEEN 1 AND 24 AND STRFTIME('%y', diagnosis.month) >= '2100') AS t2 ON t1.id = t2.id WHERE t1.month BETWEEN t2.month - 2 AND t2.month + 2 GROUP BY t3.diagnosis) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 4",
5b1d543d54897c267c07f555,What were the top three most frequent diagnoses in 2100 with which patients were diagnosed after receiving hemodialysis within 2 months?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.subject_id WHERE treatment.treatment_date BETWEEN '2100-01-01' AND '2100-12-31' AND treatment.hemodialysis = 'within 2 months') AS t1 JOIN (SELECT patient.subject_id, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.treatment_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) B",
6b06f9b397dbfbab8b85f6e1,Tell me the percentile of the ptt value of 30.0 among patients of the same age as patient 10038999 during the last hospital visit.,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 30.0","SELECT 10038999.age, 10038999.age * 10038999.age AS percentile",
01fe648fde411db8cc5023ce,What is the maximum total hospital cost for a drug named vancomycin during this year?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.drug_name = 'vancomycin' AND DATETIME(cost_table.date_of_cost, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY cost_table.drug_name) AS t1;",
acc3a9c211f42e9d6d154a20,What are the top five diagnoses associated with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t.diagnosis, t.c1, t.c2, t.c3 FROM (SELECT d.diagnosis, 3 * (COUNT(d.diagnosis) / 5) AS c1, 3 * (COUNT(d.diagnosis) / 5) AS c2, 3 * (COUNT(d.diagnosis) / 5) AS c3 FROM (SELECT diagnosis FROM diagnoses GROUP BY diagnosis) AS d JOIN (SELECT t.diagnosis, 3 * (COUNT(t.diagnosis) / 5) AS c1, 3 * (COUNT(t.diagnosis) / 5) AS c2, 3 * (COUNT(t.diagnosis) / 5) AS c3 FROM (SELECT diagnosis FROM diagnoses GROUP BY diagnosis) AS t JOIN (SELECT survival_time, diagnosis FROM patients WHERE survival_time = 3 MONTH) AS s ON t.diagnosis = s.diagnosis GROUP BY t.diagnosis) AS t GROUP BY t.diagnosis ORDER BY t.c1 DESC LIMIT 5",
80583d948d18de33fb6987b2,Could you inform me about patient 10006053's first heart rate on 11/17/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '11-17' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(heart_rate) FROM patient WHERE patient.id = 10006053 AND MIN(heart_rate) = (SELECT MIN(heart_rate) FROM patient WHERE patient.id = 10006053 AND date = '11/17/2002'),[]
b3c8c99b83e01986b79456be,What drugs are being added to the prescription of patient 10039831 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescription FROM drugs WHERE patient_id = 10039831 AND date = '2022-01-01',[]
8f44537ed71e3c69bfd87f37,Was patient 10004422 given any procedure in the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10004422 AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
d8f6cf3bc53a60de0a9fc811,When patient 10006053 last had a mrsa screen microbiology test in the previous month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(date_requested) FROM microbiology WHERE patient_id = 10006053 AND test_type = 'mrsa screen microbiology' AND date_requested >= (SELECT MAX(date_requested) FROM microbiology WHERE patient_id = 10006053 AND test_type = 'mrsa screen microbiology' AND date_requested >= (SELECT DATEADD(month, -1, CURRENT_DATE)))",[]
659e84dd2728a7624246c318,What was the amount of potassium chl 20 meq / 1000 ml ns dose prescribed to patient 10015860 on their first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'potassium chl 20 meq / 1000 ml ns',SELECT SUM(potassium_chl) FROM prescriptions WHERE prescriptions.patient_id = 10015860 AND NOT prescriptions.dischtime IS NULL ORDER BY prescriptions.startdate NULLS FIRST LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
7ebc983b2a055bd196b0257b,Tell me the average total hospital cost that involves hydrocerin in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'hydrocerin' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(T1.c1) FROM (SELECT SUM(T2.c2) AS c1 FROM (SELECT 1 AS c2 FROM hydrocerin WHERE TIMESTAMP = '2100-01-01 00:00:00') AS T1 JOIN (SELECT 1 AS c2 FROM hydrocerin WHERE TIMESTAMP = '2100-01-01 00:00:00') AS T2 ON T1.c1 = T2.c1 GROUP BY T1.c1),
5a217759e9fc00e289c1d8c9,What are the newly prescribed medicines for patient 10018081 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT today.medicine FROM (SELECT patient.id, medicine.name, DATE('now') AS current_date FROM patient JOIN medicine ON patient.id = medicine.patient_id WHERE patient.id = 10018081) AS today LEFT JOIN (SELECT patient.id, medicine.name, DATE('now', '-1 day') AS current_date FROM patient JOIN medicine ON patient.id = medicine.patient_id WHERE patient.id = 10018081) AS yesterday ON today.id = yesterday.id WHERE today.current_date = yesterday.current_date",[]
3eaf001189831be5d9a41258,"Give me the top five most frequent treatments patients received within 2 months after being diagnosed with dissection of aorta, abdominal in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'Dissection of aorta, abdominal' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.uniquepid WHERE STRFTIME('%y', treatment.treatment_date) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t2.treatment_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date,",
17e15ae68d3705f96b36cfb4,What is the patient count in the hospital currently?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(DISTINCT patient_id) FROM currently_hospitalized_patients;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
563335adf3dce85aa6c280d0,What were the top four diagnoses of patients with age 30s since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis FROM (SELECT t1.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.age IN (30, 31, 32, 33) AND DATETIME(diagnosis.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 GROUP BY t1.diagnosis) AS t2 WHERE t2.c1 <= 4",
c7841b68bdb2089ac264a977,List the top five most common events in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t.event FROM (SELECT e.event, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS rn FROM events e WHERE e.year = 2100 GROUP BY e.event) t WHERE t.rn <= 5;",[]
05c7819c63aa7a68dc9545c3,How many people were given prescriptions for heparin flush (100 units/ml) since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin flush (100 units/ml)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.patienttype = 'prescriber' AND patient.prescriptions LIKE '%heparin flush (100 units/ml)' AND DATETIME(patient.prescriptiondate) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
28fb3dd077aebb1daf3e9fe4,Where can i find a reimbursement standard for cerebrovascular mri?,,"SELECT ""reimbursement_standard"" FROM ""questions"" WHERE ""question_type"" = 'cerebrovascular mri'",
39d4a4bdf91208fe3d0468a5,"What are the four most common diagnoses for patients who previously had the performance of cardiac output, continuous procedure within 2 months since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.id WHERE treatment.procedure = 'performance of cardiac output, continuous' AND STRFTIME('%y', treatment.date) >= '2100') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.id WHERE STRFTIME('%y', diagnosis.date) >= '2100') AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 4",
d711ad001701aaf7a999ff6f,"How many patients had extirpation of matter from left femoral vein, percutaneous approach done during this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, procedures.date FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.description = 'extirpation of matter from left femoral vein, percutaneous approach' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.subject_id, diagnoses.date FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE diagnoses.description = 'extirpation of matter from left femoral vein' AND DATETIME(diagnoses.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date = t2.date",
5c94acc60a698d8e066b2346,Show me the top four most frequent lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT lab_test, COUNT(lab_test) FROM lab_results GROUP BY lab_test ORDER BY COUNT(lab_test) DESC LIMIT 4;","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
68002865c7084ae451a8b103,Has patient 10026406 gone to an emergency room since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(*) FROM diagnoses WHERE diagnoses.patient_id = 10026406 AND diagnoses.emergency_room_admission = 2100,[{'COUNT(*)>0': 0}]
79028656244bb2aab8bd8d5d,"On the first hospital stay, what was the insurance plan of patient 10006580?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,"SELECT 10006580, ""insurance_plan"" FROM ""hospital_stay"" WHERE ""hospital_stay"" = (SELECT MIN(""hospital_stay"") FROM ""hospital_stay"" WHERE ""patient_id"" = 10006580)",[{'insurance': 'Medicaid'}]
e382d74ae3fcbc0d1ca3a625,When did patient 10007928 first get blood culture ( myco/f lytic bottle)'s microbiology test since 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT date FROM microbiology WHERE microbiology.patient_id = 10007928 AND microbiology.blood_culture_date BETWEEN '2000-02-21' AND '2000-02-21' AND microbiology.blood_culture_type = 'blood culture ( myco/f lytic bottle)',[]
3afe51cbe0baae4f9809635a,Has patient 10007818 taken a vital high protein (full) drug since 07/07/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-07'",SELECT COUNT(*) > 0 FROM vital_high_protein_full WHERE patient_id = 10007818 AND date_start >= '2100-07-07',[{'COUNT(*)>0': 0}]
074c7225bee20e2006c6db58,When did patient 10026255 have the minimum hematocrit value the last time in 10/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MIN(Hematocrit) FROM Hematocrit WHERE PatientID = 10026255 AND Date BETWEEN '2010-01-01' AND '2010-12-31',[]
e567aa9d37acea95bac0a52f,"What is the maximum total cost of the hospital visits, which include medicines called acetaminophen-caff-butalbital since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetaminophen-caff-butalbital' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(ci) AS c1 FROM (SELECT 1 AS ci FROM medicines WHERE name = 'acetaminophen-caff-butalbital') AS t1 JOIN patient ON t1.patient_id = patient.id WHERE t1.year >= 2100 GROUP BY t1.patient_id) AS t2,
bf885e40699431f501098369,How does one disinfect a quarantine room?,,"SELECT * FROM ""brackets"".""questions"" WHERE ""question_id"" = 456;",
b857d922261f995e3a1265ac,What is the price of a procedure named insertion or replacement of external ventricular drain [evd]?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) ),,
5f932af6bf46cd7718dfafc4,Can you tell me what patient 10001217's last respiratory rate was on 12/05/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-05' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT patient.10001217.respiratory_rate FROM patient WHERE patient.10001217.date_of_last_respiratory_rate = '12/05/2100',[]
51825ade8dabf4e61477d4d8,"Since 10/2100, has patient 10039708 undergone a lab test?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'","SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10039708 AND STRFTIME('%y-%m', lab_tests.date) >= '2100-10'",[{'COUNT(*)>0': 1}]
955058f5985e47dd049eded6,Provide the four most common medications in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.Medication, COUNT(t1.Medication) FROM (SELECT UNNEST(MEDICATIONS) AS Medication FROM patients WHERE STRFTIME('%y', MEDICATION_DATE) = '2100') AS t1 GROUP BY t1.Medication ORDER BY COUNT(t1.Medication) DESC LIMIT 4;",[]
e95fcfa72f1c014d79280732,What was the first dose of metoclopramide that on the first hospital stay was prescribed to patient 10019385?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'metoclopramide' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(dose) FROM prescriptions WHERE prescriptions.patient_id = 10019385 AND prescriptions.drug_name = 'Metoclopramide',[]
eaa2bc139459a0e6de3f0a33,Calculate the number of hospital visits made by patient 10022017 in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(DISTINCT HOSP_VISIT) FROM visit_table WHERE PATIENT_ID = 10022017 AND STRFTIME('%y', HOSP_VISIT_DATE) = '2100';",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
6841f0afef30c9eaf743f781,Tell me the top four most common lab tests during this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.lab_test, COUNT(t1.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date = '2015-01-01') AS t1 JOIN lab_tests AS t2 ON t1.lab_test = t2.lab_test GROUP BY t1.lab_test ORDER BY COUNT(t1.lab_test) DESC LIMIT 4",[]
17de3ba481cc927f60d16233,What were the top five diagnoses that had the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT diagnosis FROM (SELECT diagnosis, 6 AS month, 100 AS rate FROM diagnosis WHERE 6 IS NOT NULL) AS high_mortality_diagnoses ORDER BY rate DESC LIMIT 10;",
4f390ab9331393d06d9b9595,What was the change in rbc in patient 10018845 last measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT rbc FROM 10018845 WHERE hospital_visit = 1 ORDER BY measurement_date DESC LIMIT 1) - (SELECT rbc FROM 10018845 WHERE hospital_visit = 1 ORDER BY measurement_date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
aef5e5dbf6c5848167e2f641,When was patient 10004720 prescribed a medication via the oral route the last time in this month?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'oral' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM patient_medications WHERE patient_id = 10004720 AND medication_route = 'ORAL' AND date_trunc('month', date_prescribed) = date_trunc('month', CURRENT_DATE)",[]
b69ed3edc52cb224ecb174eb,What is the percentile phosphate value of 3.3 among patients of the same age as patient 10024043 during their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 3.3","SELECT DISTINCT t1.c1 FROM (SELECT lab.result, PERCENT_RANK() OVER (ORDER BY lab.result NULLS FIRST) AS c1 FROM LAB JOIN (SELECT patient.age FROM patient WHERE patient.id = 10024043 AND NOT patient.dischtime IS NULL ORDER BY patient.age DESC LIMIT 1) AS t1 ON lab.patient_id = t1.patient_id WHERE lab.lab_name = 'phosphate') AS t2 WHERE t2.result = 3.3",
c26f64ab0e5b645c25c3281c,"What are the total minimum expenses for a hospital involving a laboratory test for potassium, whole blood in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(Expenses.Potassium) FROM Expenses WHERE Expenses.WholeBlood = 2100,
1a33ef0177e3bdc49dafbced,How many operating rooms are in operation now?,,SELECT COUNT(*) FROM equipment WHERE status = 'operating',
103e589c49e80280c9f04475,When was the time of patient 10022017's first hospital discharge?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 ORDER BY admissions.dischtime ASC LIMIT 1,SELECT patient.hospital_discharge_time FROM patient WHERE patient.patient_id = 10022017 ORDER BY patient.hospital_discharge_time NULLS FIRST LIMIT 1,[{'dischtime': '2189-09-16 15:00:00'}]
ea31f61daec8ba1d5d9fb9f8,What is the monthly average value of patient 10007928's weight in 2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)",SELECT AVG(weight) FROM patients WHERE patient_id = 10007928 AND measurement_date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY month,[]
be8cee5520084fc21550d8bb,Has patient 10031404 visited the hospital since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10031404 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(*) > 0 FROM visit_table WHERE patient_id = 10031404 AND STRFTIME('%y', visit_date) >= '2100'",[{'COUNT(*)>0': 1}]
4d8620a9b634b4449be0b4bd,What exactly was the last drug that patient 10021118 was prescribed since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT patient.name, drug.name FROM patient WHERE patient.id = 10021118 AND STRFTIME('%y-%m', drug.date) >= '2100-12' ORDER BY drug.date DESC LIMIT 1;",[{'drug': 'Furosemide'}]
f3e83011de5accbea5625903,"What are the three commonly taken specimens for patients that received excision of right saphenous vein, percutaneous endoscopic approach previously in the same hospital visit since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right saphenous vein, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.date, t1.event, t1.date FROM (SELECT patient.subject, procedure.date, 'excision of right saphenous vein, percutaneous endoscopic approach' AS event FROM procedures JOIN patients ON procedures.patient = patients.subject WHERE procedures.date >= '2100-01-01') AS t1 JOIN (SELECT patient.subject, specimen, date FROM biopsies JOIN patients ON biopsies.patient = patients.subject WHERE biopsies.date >= '2100-01-01') AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND t1.event = t2.event) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC",
0de9102ca9d14d7b275ec8b7,Tell me the cost of a procedure known as colonoscopy.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'colonoscopy' ) ),SELECT DISTINCT cost FROM procedures WHERE name = 'colonoscopy';,
c66b8f121c0ec0bc328c5dad,How many medications were prescribed in 2100 to patient 10021118?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10021118 AND STRFTIME('%y', medications.date) = '2100';",[{'COUNT(*)': 0}]
972b49483131cf603f6639f5,Can you tell the daily average dose of nacl 0.9% that patient 10014354 received since 03/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT AVG(daily) FROM input WHERE patient = 10014354 AND product = 'nacl 0.9%' AND date >= '03/2100',[]
2f74275a2c13953fc65e324f,Count the number of medicines that have been prescribed to patient 10007928 since 03/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*) FROM medicines WHERE medicines.patient_id = 10007928 AND STRFTIME('%y-%m', medicines.date_prescribed) >= '2100-03';",[{'COUNT(*)': 69}]
72c22160d0226e69dd0c8407,Did patient 10035185 receive any diagnoses during the last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10035185 AND diagnoses.hospital_visit = (SELECT MAX(hospital_visit) FROM diagnoses WHERE diagnoses.patient_id = 10035185),[{'COUNT(*)>0': 1}]
ba8da70ae7c876cdadf6d50e,What are the top three most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t.test_name, COUNT(t.test_name) FROM (SELECT microbiology_tests.test_name FROM microbiology_tests GROUP BY microbiology_tests.test_name ORDER BY COUNT(*) DESC LIMIT 3) t GROUP BY t.test_name;","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
8683f07aa65fa12c04532cd7,What were the top five most common procedures that occurred within the same month for patients who had central venous catheter placement with guidance before in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, t2.date FROM (SELECT patient.uniquepid, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.uniquepid WHERE procedures.procedure = 'central venous catheter placement with guidance') AS t1 JOIN (SELECT patient.uniquepid, procedures.procedure, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.uniquepid WHERE procedures.date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t3.procedure) AS t3 JOIN (SELECT procedure, COUNT(procedure) FROM procedures GROUP BY procedure) AS t4 ON t3.procedure = t4.procedure ORDER BY COUNT(t3.procedure) DESC LIMIT 5",
5e2dc38de1c3863efdd5f7b6,"So, what was the last o2 saturation pulseoxymetry of patient 10004733 since 12/30/2100?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-30' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MIN(O2_SATURATION_PULSEXTRM) FROM pulse_oxymetry WHERE patient_id = 10004733 AND measurement_date >= '2100-12-30',[]
9650f7dfbf4442af6df9fb82,What was the name of the outputs that patient 10027445 first had on 09/10/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-10' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT output_name FROM duckdb_outputs WHERE duckdb_outputs.patient_id = 10027445 AND duckdb_outputs.output_date = '09/10/2022' ORDER BY duckdb_outputs.output_date NULLS FIRST LIMIT 1,[]
ce843fac6f9ff9ab4f1d2dc3,How many hours elapsed since the last time patient 10004733 received a urobilinogen lab test on this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urobilinogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_time)) FROM lab_data WHERE patient_id = 10004733 AND lab_name = 'urobilinogen' AND lab_time IS NOT NULL ORDER BY lab_time DESC LIMIT 1;",[]
cf4eb47f352c6460fa580827,"What are the three most frequently ordered medications that patients in their 40s were prescribed during the same month after they were diagnosed with hyperlipidemia, unspecified since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'hyperlipidemia, unspecified' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.id, medication.name, medication.drug_date FROM medication JOIN patient ON medication.patient_id = patient.id WHERE patient.age BETWEEN 40 AND 49 AND DATETIME(medication.drug_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.drug_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.drug_date",
2504708564dec501dc2fdde3,Was the platelet count value last measured on the last hospital visit of patient 10005866 less than first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.value FROM lab WHERE lab.patient = 10005866 AND NOT lab.value IS NULL ORDER BY lab.date DESC LIMIT 1) < (SELECT lab.value FROM lab WHERE lab.patient = 10005866 AND NOT lab.value IS NULL ORDER BY lab.date DESC LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
a064cc53a6478ab0d31cb958,What was the name of the specimen test which patient 10038992 has last received in 11/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_name FROM specimen_table WHERE patient_id = 10038992 AND last_received = '11/2100',[]
e0bdf1f255574123e3d82ebc,Did patient 10007818 go through any lab test in 07/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',labevents.charttime) = '2100-07'","SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10007818 AND STRFTIME('%y-%m', lab_tests.test_date) = '2100-07'",[{'COUNT(*)>0': 0}]
b589fb2df1dcb6da13ec9456,"What are the three most frequently given diagnoses for patients who had previously had hemodialysis within 2 months, in 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE treatment.treatment_date BETWEEN '2100-01-01' AND '2100-12-31' AND treatment.treatment_type = 'hemodialysis') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31') AS t2 ON t1.id = t2.id WHERE t1.treatment_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) BETWEEN DATETIME(t1.treat",
120f063de471a96faf9b302a,"How many times did the dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic procedure take place last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.location = ""right main bronchus"" AND procedures.intraluminal_device = ""natural or artificial opening endoscopic"" AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",
82c36b2b9cc4fe915955f4ec,Inform me about the total amount of patient 10010471's input since 03/19/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19'",SELECT SUM(input) FROM brackets WHERE patient_id = 10010471 AND input_date >= '03/19/2100',[{'SUM(inputevents.totalamount)': 37625.0}]
76f01a85f8f50fc5f408fa3b,How many dofetilide prescription instances occurred in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'dofetilide' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Dofetilide' AND STRFTIME('%y', prescriptions.date) = '2100';",[{'COUNT(*)': 0}]
7bd0fb1be2b05eacb63558d9,What do the precautions be after the spinal canal explor nec procedure?,,SELECT precautions FROM procedures WHERE procedure = 'Spinal canal explor NEC';,
cd7ec076d6dd032a842781fe,"Today compared to yesterday, what new medication does patient 10039831's prescription include?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescription FROM medication_usage WHERE patient_id = 10039831 AND date_compared = 'today compared to yesterday',[]
e48b5607cc89f2dc1adfa775,What was the last time patient 10016810 was prescribed a medication using the po route since 05/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM medication_usage WHERE patient_id = 10016810 AND route = 'po' AND date_prescribed >= '2000-05-2100',[]
439e2e43115263121a562994,When was the first test of patient 10005348's microbiology urine in 09/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '09' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT MIN(date) FROM microbiology WHERE microbiology.patient_id = 10005348 AND microbiology.urine = 'urine' AND DATETIME(microbiology.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', microbiology.date) = '09'",[]
8b5709aba37b6339722a0855,What is the average rdw-sd value of patient 10022880 in 04/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04'",SELECT AVG(rdw_sd) FROM this_table WHERE patient_id = 10022880 AND date = '04/this year',[{'AVG(labevents.valuenum)': None}]
5459dfb5c9c49adbe57a0564,Can you tell me the average total hospital cost that involves oxycodone sr (oxycontin)?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'oxycodone sr (oxycontin)' ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM prescriptions WHERE prescriptions.drug = 'oxycodone sr (oxycontin)' GROUP BY prescriptions.patient_id) AS t1,
67f5a1fdc92cd01b4aedb45c,"Of the patients aged 40s this year, what are the top three most common procedures?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.CATEGORY FROM (SELECT CATEGORY, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT UNNEST(CURRENT_SETTING('procedures', 's3://my-bucket/procedures.parquet', 'FORMAT PARQUET')) AS t1 JOIN (SELECT UNNEST(CURRENT_SETTING('patients', 's3://my-bucket/patients.parquet', 'FORMAT PARQUET')) AS t2 ON t1.PATIENT_ID = t2.PATIENT_ID WHERE t2.AGE BETWEEN 40 AND 49 AND DATETIME(t2.LAST_UPDATE, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY CATEGORY) AS t1 WHERE t1.c1 <= 3",
96a8776128757eb24aa751cc,How many admitted patients are there right now?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM admitted WHERE admitted = true;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
9b52e008ae7f63b3fa3eeb3d,Tell me the average total cost of a hospital visit involving hyperpotassemia since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperpotassemia' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",SELECT AVG(T1.total_cost) FROM (SELECT SUM(T2.unit_price * T2.quantity) AS total_cost FROM (SELECT * FROM diagnosis WHERE diagnosis = 'hyperpotassemia') AS T1 JOIN inventory AS T2 ON T1.diagnosis_id = T2.diagnosis_id WHERE T1.date >= CURRENT_DATE - INTERVAL '1 year') AS T1,
c40320a8cc992e9cf6c9c807,"What does a procedure under the name destruction of right lower lung lobe, via natural or artificial opening endoscopic cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) )","SELECT * FROM duckdb_procedures WHERE procedure_name = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic cost';",
658f14f535401c3647d83d50,Is the alkaline phosphatase value of patient 10015860 on the last measurement on the first hospital visit greater than the value from the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT alkaline_phosphatase FROM lab_data WHERE lab_data.patient_id = 10015860 AND NOT lab_data.hospital_visit_number IS NULL ORDER BY lab_data.measurement_date DESC LIMIT 1) > (SELECT alkaline_phosphatase FROM lab_data WHERE lab_data.patient_id = 10015860 AND NOT lab_data.hospital_visit_number IS NULL ORDER BY lab_data.measurement_date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
e07ed121ec710b96ce8e6acd,Give me the top five most frequent treatments patients received within 2 months after being diagnosed with rheumatic disorders of both mitral and aortic valves in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, t1.diagnosis_date FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Rheumatic disorders of both mitral and aortic valves') AS t1 JOIN (SELECT patient.id, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE TIMESTAMP_2100(treatment.treatment_date) BETWEEN TIMESTAMP_2100(diagnosis.diagnosis_date) AND TIMESTAMP_2100(diagnosis.diagnosis_date, '+2 month')) AS t2 ON t1.id = t2.patient_id GROUP BY t2.treatment) AS t3 GROUP BY t3.treatment ORDER BY COUNT(t3.treatment) DESC LIMIT 5",
02759807d268a649ffbc56e0,Can you tell me the total volume of foley output for patient 10018081 since 12/07/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-07'","SELECT SUM(FOLEY_OUTPUT) FROM bracket_table WHERE PATIENT_ID = 10018081 AND STRFTIME('%m/%d/%Y', FOLEY_DATE) >= '12/07/2100'",[{'SUM(outputevents.value)': None}]
4b895ff0d3cb5fd9fe1e5e50,What is the maximum total cost of the hospital visits that included a procedure called alcohol detoxification since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.procedure_name = 'alcohol detoxification' AND STRFTIME('%y', cost_table.date) >= '2100' GROUP BY cost_table.patient_id) AS t1",
f370a107576540264d73906f,Can you confirm the gender of patient 10015931?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10015931,SELECTconfirm_gender(10015931) ASgender_confirmation;,[{'gender': 'M'}]
39292afed1a39dd0e0b8a031,Count the number of patients who stayed during the last year at pacu.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE location = 'pacu' AND stay_duration_days > 365,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e6f198df1f603a2a44353e4d,Could you unfold the four most frequent outputs in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT UNNEST(ARRAY_AGG(output, 10000)) AS output",[]
61ac565159bfa5d3f30f2941,"What was the name of the prescription drug given to patient 10018081 within the same day after undergoing the ileostomy, not otherwise specified procedure?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.name FROM (SELECT patient.name, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.id WHERE patient.id = 10018081 AND treatment.type = 'ileostomy, not otherwise specified') AS t1 JOIN (SELECT patient.name, prescription.date FROM prescription JOIN patient ON prescription.patient = patient.id WHERE patient.id = 10018081) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day')",
c4fbaf36df80d6e9685e37c1,When was the last time patient 10021312 had a medication prescribed via the vg route since 5 months ago?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'vg' AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month') ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM medication_prescriptions WHERE patient_id = 10021312 AND route = 'vg' AND date_prescribed >= CURRENT_DATE - INTERVAL '5 month',[]
d624abedfa96e75fb614fc58,What was the sw dose that patient 10016810 was first prescribed during their last hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'sw' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(sw_dose) FROM prescriptions WHERE prescriptions.patient_id = 10016810 AND NOT prescriptions.dispense_date IS NULL AND prescriptions.drug_id = (SELECT drug_id FROM prescriptions WHERE prescriptions.patient_id = 10016810 AND NOT prescriptions.dispense_date IS NULL ORDER BY prescriptions.dispense_date DESC LIMIT 1),[]
1dab5b5124587cef9d328d99,Count the number of times that excision of axillary lymph node was performed.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of axillary lymph node' ),SELECT COUNT(*) FROM procedures WHERE procedures.name = 'excision of axillary lymph node';,[{'COUNT(*)': 0}]
6460cd5a26ffc1b6bcc56a55,How much 0.9% sodium chloride has patient 10038999 been prescribed since 18 months ago?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.drug = '0.9% sodium chloride' AND datetime(prescriptions.starttime) >= datetime(current_time,'-18 month')","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10038999 AND medication.drug = '0.9% Sodium Chloride' AND DATETIME(medication.date) >= DATETIME(CURRENT_TIME, '-18 month')",[{'SUM(prescriptions.dose_val_rx)': None}]
6256d1fb1cd3aeaba0eb11a8,Has patient 10009035 been prescribed a specific drug since 02/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'",SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10009035 AND prescriptions.drug_date >= '2000-02-2100' AND prescriptions.drug_name = 'Specific Drug',[{'COUNT(*)>0': 1}]
0b9e619bdb576876f002d49a,What is the title of the medication that was given to patient 10021118 first via the ih means during the last hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT medication_administered FROM medication_usage WHERE patient_id = 10021118 AND administration_method = 'ih means' AND NOT hospital_encounter_id IS NULL ORDER BY hospital_encounter_id DESC LIMIT 1;,[]
2d745a50f391efc3dab3ccd8,What was the medication patient 10014354 was prescribed for the last time since 05/2100 via the im route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.medication FROM prescriptions WHERE prescriptions.patient_id = 10014354 AND prescriptions.route = 'im' AND STRFTIME('%y-%m', prescriptions.date) >= '2100-05' ORDER BY prescriptions.date DESC LIMIT 1;",[]
5cf80e270db47987d26f8d2c,What was the name of the output that patient 10022017 had last since 10/04/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT ""output"" FROM ""patient_output"" WHERE ""patient_id"" = 10022017 AND ""date"" >= '10/04/2100';",[{'label': 'Void'}]
b5f30bce905a467fe3d9be05,Has patient 10015931 received any laboratory testing since 1 month ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 month')","SELECT COUNT(*) > 0 FROM lab_testing WHERE lab_testing.patient_id = 10015931 AND DATETIME(lab_testing.date) >= DATETIME(CURRENT_TIME, '-1 month')",[{'COUNT(*)>0': 1}]
12a69eaacc6a1663c3d9259f,What was the last time of input for patient 10018081 since 02/25/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-25' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10018081 AND input_time >= '2000-02-25';,[{'starttime': '2134-08-07 14:00:00'}]
405a65223844faf30d226448,"Give me the top five most frequently prescribed drugs within the same month for patients in their 40s who were diagnosed with acute alcoholic intoxication in alcoholism, continuous since 1 year ago.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t1.drug FROM (SELECT drugs.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patients.age FROM patients WHERE patients.age BETWEEN 40 AND 49) AS t1 JOIN (SELECT diagnoses.drug FROM diagnoses WHERE diagnoses.drug = 'acute alcoholic intoxication in alcoholism') AS t2 ON t1.patient = t2.patient WHERE t1.age BETWEEN 40 AND 49 AND DATETIME(diagnoses.diagnosis_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+1 month') GROUP BY t1.drug) AS t3 WHERE t3.c1 <= 5",
fa8dc90654adb35a8f98e8e2,"Patient 10005817, when was your last mrsa screen microbiology test since 10/2100?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(date) FROM screen_microbiology WHERE patient_id = 10005817 AND date >= ""10/2100""",[]
97972bbea1fe2404f8de1b69,Please calculate the total output for patient 10027602 since 12/02/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-02'",SELECT SUM(output) FROM brackets WHERE patient = 10027602 AND date >= '12/02/2100',[{'SUM(outputevents.value)': 42636.0}]
30912953ec6a9977cec930db,What was the admission type during patient 10038992's last entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038992 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038992 ORDER BY admissions.admission_date DESC LIMIT 1,[{'admission_type': 'SURGICAL SAME DAY ADMISSION'}]
8a1a5f5b16afc5af43b04d08,"Can you retrieve the top five most frequent lab tests patients had following a diagnosis of cardiac complications, not elsewhere classified during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'Cardiac complications, not elsewhere classified') AS t1 JOIN (SELECT patient.uniquepid, lab_test.lab_test, lab_test.lab_test_date FROM lab_test JOIN patient ON lab_test.patient_id = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.lab_test_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_test_date, 'start of month') GROUP BY t2.lab_test) AS t3 GROUP BY t3.lab_test ORDER BY COUNT(t3.lab_test) DESC LIMIT 5",
be836b4ae0b043e2a4a3ff81,"Among patients diagnosed with diastolic heart failure, unspecified , what are the top three most common lab tests that followed afterward in the same hospital encounter?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diastolic heart failure, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnoses.diagnosis_date, patient.had_diagnosis FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE diagnoses.diagnosis = 'diastolic heart failure, unspecified') AS t1 JOIN (SELECT patient.subject_id, lab_test, lab_test_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.subject_id) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.lab_test_date AND t1.had_diagnosis = 1 GROUP BY t2.lab_test) AS t3 WHERE t3.c1 <= 3",
2dab95be5e31c24b8faf79af,How many days was patient 10020944 in the intensive care unit during their first visit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT COUNT(DISTINCT t2.date) FROM (SELECT t1.date FROM (SELECT DATE '1992-09-20' AS date FROM patients WHERE id = 10020944) AS t1 JOIN (SELECT DATE '1992-09-20' AS date FROM patients WHERE id = 10020944) AS t2 ON t1.date = t2.date WHERE t1.dischtime IS NULL AND t2.dischtime IS NULL) AS t3 JOIN intensive_care_unit ON t3.unit = intensive_care_unit.unit,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 9.076828703749925}]"
241a6bd6f1e129a31b43bea9,Did patient 10021938 go through a lymphocytes test in the last month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10021938 AND lab_data.test_name = 'lymphocytes' AND DATETIME(lab_data.test_date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month')",[{'COUNT(*)>0': 0}]
a5e8f7d9e725fdd3e6eced18,When did patient 10011398 get inputs for the first time since 12/11/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-11' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT input_date FROM inputs WHERE patient_id = 10011398 AND STRFTIME('%y-%m-%d', input_date) >= '2100-12-11' ORDER BY input_date NULLS FIRST LIMIT 1",[{'starttime': '2146-12-15 12:30:00'}]
7041b79655fa30e1c31b1c57,How many drugs have been prescribed to patient 10019777 since 03/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10019777 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-03'",[{'COUNT(*)': 154}]
7d5c2f5180cb8edef4ee7d95,Calculate the number of hospital visits made by patient 10036156 during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10036156 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT visit_date) FROM visit_table WHERE patient_id = 10036156 AND DATETIME(visit_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
7fd1121ddb007a49e5ed2f4c,How much was the difference in weight of patient 10029291 measured at 2100-03-07 03:00:00 compared to the value measured at 2100-03-05 00:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-07 03:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-05 00:00:00' ),SELECT (SELECT weight_kg FROM patients WHERE patient_id = 10029291 AND measurement_date = '2100-03-07 03:00:00') - (SELECT weight_kg FROM patients WHERE patient_id = 10029291 AND measurement_date = '2100-03-05 00:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-07 03:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-05 00:00:00' )"": None}]"
6eaa704e430235558d82f887,Count the total patients who were prescribed clonidine patch 0.2 mg/24 hr this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'clonidine patch 0.2 mg/24 hr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient_id) FROM medication_usage WHERE medication_name = 'Clonidine Patch 0.2 mg/24 hr' AND date_trunc('year', date) = date_trunc('year', CURRENT_DATE)",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
7418b9331c35714137e940b5,When did patient 10023117 receive a mcv lab test on the first occasion?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT lab.date FROM lab WHERE lab.patient = 10023117 AND lab.type = 'mcv' ORDER BY lab.date NULLS FIRST LIMIT 1;,[]
0427a5eaa446635b1a4b7f18,How much is the difference of patient 10015272's respiratory rate second measured on the first ICU visit compared to the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10015272 AND measurement_time = ""ICU visit 1"" ORDER BY measurement_time NULLS FIRST LIMIT 1) - (SELECT respiratory_rate FROM patient_respiratory_rate WHERE patient_id = 10015272 AND measurement_time = ""ICU visit 1"" ORDER BY measurement_time NULLS FIRST LIMIT 1)","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
be691057d7c16aac7ebabc58,Using the other anticancer drugs is the protocol of the anticancer drugs,,SELECT * FROM protocols WHERE protocol_name = 'Other anticancer drugs',
45cf62bc8aba279eba7b413a,What is the patient count for sotalol prescription since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'sotalol' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE prescriptions.drug = 'Sotalol' AND STRFTIME('%y', prescriptions.start_date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 10}]
567d369cd559cd950e3354cf,"Since 1 year ago, what are the three common diagnoses of patients of age 20s?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",SELECT t1.diagnosis FROM (SELECT diagnosis FROM patients WHERE age BETWEEN 20 AND 29 AND date_of_entry BETWEEN '2019-01-01' AND '2020-12-31') AS t1 JOIN (SELECT diagnosis FROM patients WHERE age BETWEEN 20 AND 29 AND date_of_entry BETWEEN '2019-01-01' AND '2020-12-31') AS t2 ON t1.diagnosis = t2.diagnosis GROUP BY t1.diagnosis ORDER BY COUNT(*) DESC LIMIT 3,
b179e910614a955e056b279f,What is the maximum total hospital cost including a drug named vitamin d since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vitamin d' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE name = 'vitamin d' AND year >= 2100 GROUP BY patient_id) AS t1,
c4b38e4af79858745e77342a,Calculate the total volume of patient 10014729's input since 03/06/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-06'",SELECT SUM(volume) FROM intake WHERE patient_id = 10014729 AND date >= '2100-03-06',[{'SUM(inputevents.totalamount)': 21490.0}]
73df5b035a5cac7c093f1211,Calculate patient 10013049's length of stay in days for the first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT patient 10013049's length of stay in days FROM icu WHERE NOT patient 10013049's length of stay in days IS NULL ORDER BY patient 10013049's length of stay in days NULLS FIRST LIMIT 1;,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.1769212959334254}]"
9605044db0cc93ca8e59d0be,What is the reimbursement standard for drug?,,"SELECT ""reimbursement_standard"" FROM ""drug"" WHERE ""drug_type"" = 'brackets';",
5a47ea8047b87b5f311738fc,How many times was a excision of dental lesion of jaw procedure done in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",SELECT COUNT(*) FROM procedures WHERE procedures.year = 2100 AND procedures.procedure = 'Excision of dental lesion of jaw',
2d80cb1e489c0421c68be6f2,How many hours has it been since patient 10021487 last received the red blood cells lab test during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab.result_date)) FROM lab WHERE lab.patient_id = 10021487 AND lab.lab_name = 'red blood cells' AND lab.result_date = (SELECT MAX(result_date) FROM lab WHERE lab.patient_id = 10021487)",[]
39f61d8cb6ee0e63eed2c0c1,Did patient 10035185 receive any disease diagnoses in their last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10035185 AND diagnoses.dischtime IS NULL,[{'COUNT(*)>0': 1}]
ae7068db15837f529f79fa01,Share the five most frequently performed procedures since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT treatment FROM procedures WHERE date >= CURRENT_DATE - INTERVAL '1 year') AS t1 JOIN procedures AS t2 ON t1.treatment = t2.treatment GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 5",
73752639a8e1cbb92081f23b,What is the average total hospital cost which includes a drug named ezetimibe since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.c1) FROM (SELECT SUM(T1.c1) AS c1 FROM (SELECT T2.c1 FROM (SELECT T1.drug_name FROM (SELECT 'ezetimibe' AS drug_name, 2100 AS start_year, 2022 AS end_year) AS T1 JOIN (SELECT '1234567890' AS id, 12 AS quantity, 15.5 AS price) AS T2 ON T1.drug_name = T2.drug_name WHERE T1.start_year <= 2100 AND T1.end_year >= 2100) AS T1 GROUP BY T1.id) AS T2",
3aa3f14b20280118b146135d,What was the first hematocrit reading during the last hospital visit for patient 10019385?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT MIN(hematocrit) FROM visit_details WHERE patient_id = 10019385 AND NOT visit_details.hospital_id IS NULL ORDER BY visit_details.visit_time DESC LIMIT 1;,[]
84ba0d560e8d6b40089569b5,"Was patient 10005909 prescribed with the medication enoxaparin sodium, docusate sodium, or 5% dextrose in their last hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'enoxaparin sodium', 'docusate sodium', '5% dextrose' )","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id IN (SELECT patient.id FROM patient WHERE patient.hospital_visits = (SELECT COUNT(*) FROM hospital WHERE patient.id = 10005909 ORDER BY patient.hospital_admittime DESC LIMIT 1)) AND medication.name IN ('enoxaparin sodium', 'docusate sodium', '5% dextrose')",[{'COUNT(*)>0': 0}]
30c85360417e25270068544b,Present the count of ICU visits for patient 10004422 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND strftime('%Y',icustays.intime) >= '2100'",SELECT COUNT(ICU_VISITS) FROM visits WHERE PATIENT_ID = 10004422 AND YEAR(ICU_VISITS) >= 2100,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
d487fac15a8ce3ed54ed440e,What was the four most common lab test given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT lab_test, COUNT(*) FROM lab_results GROUP BY lab_test ORDER BY COUNT(*) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
008eed7a13c0d37c26d9a293,Get me the top five most frequent diagnoses for patients of age 50s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis, COUNT(t1.diagnosis) FROM (SELECT diagnosis FROM (SELECT * FROM patients WHERE age BETWEEN 50 AND 59) AS t1 JOIN (SELECT * FROM diagnoses WHERE year = 2100) AS t2 ON t1.diagnosis = t2.diagnosis) AS t3 GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 5;",
1f1add74c7e3a0f4247c5a78,"So, what was the first respiratory rate of patient 10015272 on 06/23/this year?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '06-23' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(respiratory_rate) FROM respiratory_rate WHERE patient_id = 10015272 AND date = '2022-06-23',[]
9906646cfa86ce749ac4d08e,What methods are used to ingest tramadol?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'tramadol',SELECT DISTINCT method FROM ingredient WHERE ingredient = 'tramadol';,[{'route': 'ORAL'}]
db0532f93811b5c3527eb224,During a blood transfusion has patient 18866 ever experienced any side effects?,,SELECT COUNT(*) > 0 FROM blood_transfusion WHERE patient_id = 18866,
92628b8e1f9f488eca11c7ea,How much is the average total hospital cost associated with closed fracture of lumbar vertebra without mention of spinal cord injury?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of lumbar vertebra without mention of spinal cord injury' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(t1.c1) FROM (SELECT SUM(ci.cost) AS c1 FROM (SELECT ci.cost FROM cost_info ci WHERE ci.cost_type = 'total hospital cost') AS t1 JOIN (SELECT s.subject_id FROM subjects s WHERE s.subject_type = 'patient') AS t2 ON t1.subject_id = t2.subject_id JOIN (SELECT d.diagnosis FROM diagnoses d WHERE d.diagnosis_type = 'closed fracture of lumbar vertebra without mention of spinal cord injury') AS t3 ON t1.subject_id = t3.subject_id GROUP BY t1.subject_id) AS t4,
83ee51e6e7fdc992ab579780,What was the drug prescribed to patient 10027602 for the last time via the pr route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(drug_date) FROM prescriptions WHERE prescriptions.patient_id = 10027602 AND prescriptions.route = 'pr',[]
781ef8abeed146047598411d,Can you tell me how many extracorporeal circulation auxiliary to open heart surgery procedures were done in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",SELECT COUNT(*) FROM procedures WHERE procedures.year = 2100 AND procedures.description = 'extracorporeal circulation auxiliary to open heart surgery',
c87fdda7e48ed877eae86d9a,Has there been any organism found in the first microbiological pleural fluid test of patient 10014729 since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT COUNT(*) > 0 FROM organism WHERE organism.microbiological_pleural_fluid = '2100' AND patient.patient_id = 10014729,[{'COUNT(*)>0': 0}]
0548ea40a64c517f125a4be7,When did patient 10021487 get input for the last time since 12/14/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-14' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(date_entered) FROM input_table WHERE patient_id = 10021487 AND date_entered >= '12/14/2100',[{'starttime': '2117-03-09 14:20:00'}]
ef941c1feaedb7696f5f3fda,When did patient 10005817 first leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient_10005817_first_leave_date FROM patient WHERE patient_10005817_first_leave_date IS NOT NULL,[{'dischtime': '2132-12-20 15:04:00'}]
b6084da68e989df297fd4021,Tell me the name of an output that patient 10007818 has first had since 06/08/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-08' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM outputs WHERE patient = '10007818' AND date_first_had > '2100-06-08',[{'label': 'Foley'}]
26befa90776e4ef7c35488fc,What were the top five diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT t.diagnosis, t.c1, t.c2 FROM (SELECT diagnosis, 3 AS c1, 1 AS c2 FROM diagnoses WHERE c13234 = 1) AS t ORDER BY t.c1 DESC LIMIT 5;",
299e7e4682125161d8892193,Give me patient 10027602's total amount of nacl 0.45% input during their last ICU visit.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.45%' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) FROM input WHERE patient_id = 10027602 AND input_type = 'nacl 0.45%' AND visit_number = (SELECT MAX(visit_number) FROM input WHERE patient_id = 10027602 AND input_type = 'nacl 0.45%' AND visit_number IS NOT NULL),[{'SUM(inputevents.totalamount)': None}]
d4d40dd78c364c6f666d1a05,What percentile does a platelet count value of 328.0 for patient 10023117 place in today on the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 328.0",SELECT 328.0 * 10023117.platelet_count FROM brackets WHERE today() = (SELECT MAX(today()) FROM brackets WHERE today() = 328.0 * 10023117.platelet_count),
059ed55281d42669ad25d514,"For the first time in the previous month, what was the drug that patient 10019172 was prescribed via iv drip route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT patient.name, prescription.drug FROM patient WHERE patient.id = 10019172 AND prescription.route = 'iv drip' AND DATETIME(prescription.start_time, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month') ORDER BY prescription.start_time NULLS FIRST LIMIT 1",[]
d11f27c0322c15dc8f10c8b2,What is the reimbursement standard for cerebrovascular mri?,,"SELECT ""Reimbursement"" FROM ""Standard"" WHERE ""Procedure"" = 'Cerebrovascular MRI'",
b9810aef8d75d1d2a9a31183,"In relation to others of the same age, where does a hemoglobin value of 12.2 for patient 10021487 rank in percentiles on this hospital encounter?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 12.2",SELECT encode(hemoglobin) FROM patients WHERE patient_id = 10021487 AND hemoglobin IS NOT NULL AND database_name = 'your_database_name',
bad5c823a031437e5a7ff621,What was the last measurement of o2 saturation pulseoxymetry in patient 10015931's body since 10/01/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-01' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MIN(o2_saturation_pulseoxymetry) FROM pulseoxymetry WHERE patient_id = 10015931 AND measurement_date >= '2100-10-01',[]
70628d63be371358ecd526de,Which medication was patient 10009628 prescribed during the same hospital encounter following the extracorporeal circulation auxiliary to open heart surgery procedure in 10/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '10' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T4.medication FROM (SELECT T2.medication, T2.start_time, T2.end_time, T1.subject_id, T1.start_time AS procedure_start_time, T1.end_time AS procedure_end_time FROM (SELECT patient_id, start_time, end_time FROM procedures WHERE patient_id = 10009628 AND start_time BETWEEN '2020-10-01 00:00:00' AND '2020-10-01 23:59:59') AS T1 JOIN (SELECT patient_id, medication, start_time, end_time FROM medications WHERE patient_id = 10009628 AND start_time BETWEEN '2020-10-01 00:00:00' AND '2020-10-01 23:59:59') AS T2 ON T1.patient_id = T2.patient_id WHERE T1.start",
83c534985f90fb45936d3f90,What was the total dose of lisinopril prescribed to patient 10005817 in their first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'lisinopril',SELECT SUM(prescription_dose) FROM prescriptions WHERE prescriptions.patient_id = 10005817 AND NOT prescriptions.had_any_effect = false AND prescriptions.drug_name = 'Lisinopril',[{'SUM(prescriptions.dose_val_rx)': None}]
47b4b008bc5e93c16c231277,Can you give me patient 10021118's daily maximum lr input in 12/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT MAX(daily_lr_input) FROM patient_input WHERE patient_id = 10021118 AND input_date BETWEEN '12/2100' AND '12/2100',[]
133bff217be024035d5957e2,Was the urea nitrogen value last measured on the first hospital visit of patient 10027445 greater than first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT urea_nitrogen FROM 10027445 WHERE NOT patient_hospital_info.first_hospital_visit IS NULL ORDER BY patient_hospital_info.first_hospital_visit DESC LIMIT 1) > (SELECT urea_nitrogen FROM 10027445 WHERE NOT patient_hospital_info.first_hospital_visit IS NULL ORDER BY patient_hospital_info.first_hospital_visit NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
9ab4162dbb0abdcc190c4d21,What did patient 10018845 have last as the output since 279 days ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-279 day') ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT output FROM patient WHERE patient.output = 'last' AND DATETIME(patient.output) >= DATETIME(CURRENT_TIME, '-279 day') AND patient.id = 10018845",[{'label': 'Foley'}]
988d06c4434babbd7c78a275,"Has patient 10016742 gone through a urea nitrogen, urine test in 07/this year?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'","SELECT COUNT(*) FROM lab_results WHERE lab_results.patient_id = 10016742 AND lab_results.test_name = 'urea nitrogen, urine' AND DATETIME(lab_results.result_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', lab_results.result_date) = '07'",[{'COUNT(*)>0': 0}]
249cf2ffc11ec1d31980296c,What was patient 10018081's last input time since 11/26/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10018081 AND input_time >= '2100-11-26',[{'starttime': '2134-08-07 14:00:00'}]
dce18218fbb62e3b07c34441,Has there been any diagnosis that patient 10020306 has received?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ),SELECT COUNT(*) > 0 FROM diagnosis WHERE diagnosis.patient_id = 10020306,[{'COUNT(*)>0': 1}]
f6066d140303a698b6edceea,"How many extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic treatments were executed since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.lobe = 'right lower lung lobe' AND procedures.treatment = 'extirpation of matter' AND STRFTIME('%y', procedures.date) >= '2100'",
adf57bf6800cbd7a1bcce75f,"When was the first time on the last hospital encounter that patient 10014078 had the maximum value of osmolality, measured?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT MIN(hospital_stay.start_date) FROM hospital_stay WHERE hospital_stay.patient_id = 10014078 AND NOT hospital_stay.dischtime IS NULL ORDER BY hospital_stay.osmolality, measured DESC LIMIT 1",[]
c509b3b51764a1c88c5721c0,When did patient 10022017 first leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient_10022017_first_left_hospital FROM patient_10022017 WHERE patient_10022017_first_left_hospital IS NOT NULL;,[{'dischtime': '2189-09-16 15:00:00'}]
3db50784b5c5fd5267669673,How many days have elapsed since patient 10039831 stayed in the careunit discharge lounge for the first time in the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.staydate)) FROM patient WHERE patient.staydate = (SELECT MIN(staydate) FROM patient WHERE patient.subject = 10039831 AND patient.dischtime IS NULL) AND patient.location = 'careunit discharge lounge'",[]
0f89bd1a01e56d8d8578cd27,When did the last input for patient 10001217 occur since 10/02/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-02' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(date_input) FROM input_table WHERE patient_id = 10001217 AND date_input >= '2100-10-02',[{'starttime': '2157-12-20 14:00:00'}]
350181bd71c310c99e34da39,What is the difference between weights second measured on the first hospital visit compared to the first value measured on the first hospital visit for patient 10008454?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weights_second FROM patient_weight_changes WHERE patient_id = 10008454 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1) - (SELECT weights_second FROM patient_weight_changes WHERE patient_id = 10008454 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
16db3d465f88c900b68652e7,Can you tell me the first time patient 10018081 had a SaO2 that was less than 98.0 since 354 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-354 day') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(SaO2) FROM (SELECT SaO2 FROM patient_10018081 WHERE SaO2 < 98.0) AS T WHERE TIMESTAMPDIFF('day', T.time, CURRENT_TIMESTAMP()) >= 354",[]
1f2e37aaa091d50e833afad1,What was the admission type for patient 10026255's last entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10026255 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10026255 ORDER BY admissions.admission_date DESC LIMIT 1;,[{'admission_type': 'EW EMER.'}]
e65459f8f7e59ea27494cb7b,Tell me the total number of patients who stayed in neuro stepdown in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT admissions.subject, admissions.staydate FROM admissions WHERE admissions.dischargedate IS NULL AND admissions.staydate BETWEEN '2100-01-01' AND '2100-12-31' AND admissions.location = 'neuro stepdown') AS t1 JOIN (SELECT admissions.subject, admissions.staydate FROM admissions WHERE admissions.dischargedate IS NULL AND admissions.staydate BETWEEN '2100-01-01' AND '2100-12-31' AND admissions.location = 'neuro stepdown') AS t2 ON t1.subject = t2.subject WHERE t1.staydate < t2.staydate",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
298e26144b0f329a5a0615a2,What was the name of the output patient 10022880 last had in their first ICU visit?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime DESC LIMIT 1 ),"SELECT ""output"" FROM ""patient"" WHERE ""patient"" = 10022880 AND NOT ""output"" IS NULL ORDER BY ""date"" NULLS FIRST LIMIT 1",[{'label': 'Void'}]
adb4dc30adc6acdfe49dc9c0,"Compared to last measured on the first ICU visit, is the arterial blood pressure mean value of patient 10005817 less than second to last measured on the first ICU visit?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT arterial_blood_pressure_mean FROM icu_arterial_blood_pressure WHERE icu_id IN (SELECT icu_id FROM icu_info WHERE patient_id = 10005817) ORDER BY measurement_time NULLS FIRST LIMIT 1) < (SELECT arterial_blood_pressure_mean FROM icu_arterial_blood_pressure WHERE icu_id IN (SELECT icu_id FROM icu_info WHERE patient_id = 10005817) ORDER BY measurement_time NULLS FIRST LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
998714278a267519fc47473b,"Since 22 months ago, what was patient 10038933's first weight measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(weight) FROM patient_weight WHERE patient_id = 10038933 AND measurement_date >= DATEADD(month, -22, CURRENT_DATE)",[]
21c6f3b0cb788bda4faf8249,Tell me the number of patients who stayed in med/surg/gyn.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' ),"SELECT COUNT(DISTINCT patient_id) FROM patients WHERE location = ""MED/SURG/GYN""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
574263846551eca2f19ac645,What was the name of the output patient 10015931 first had since 06/06/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT name FROM output WHERE patient = 10015931 AND date < '2100-06-06' ORDER BY date NULLS FIRST LIMIT 1,[{'label': 'OR EBL'}]
506c9dbd5d01f2cf98f45ec5,List the top five most frequent lab tests during this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.Lab_Test, COUNT(t1.Lab_Test) FROM Lab_Tests AS t1 JOIN Brackets ON t1.Lab_Test = Brackets.Lab_Test WHERE Brackets.Year = 2015 GROUP BY t1.Lab_Test ORDER BY COUNT(t1.Lab_Test) DESC LIMIT 5",[]
6cc5dc7c9bdf2cc361bd3a79,"What is the price of the drug, nystatin oral suspension?",SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nystatin oral suspension' ),,
1696ad4b19442533de0141ff,"How many patients received enteral infusion of concentrated nutritional substances within the same month after being diagnosed with cerebral artery occlusion, unspecified with cerebral infarction?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'Cerebral artery occlusion, unspecified with cerebral infarction') AS t1, (SELECT patient.subject_id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.subject_id WHERE treatment.treatment = 'Enteral infusion of concentrated nutritional substances') AS t2 WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.treatment_date, 'start of month')",
762749a6a8452aa83554f391,"On 04/04/2100, when did patient 10020740 receive an input for the first time?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-04' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT input_date FROM input_table WHERE patient_id = 10020740 AND input_date BETWEEN '2100-04-04' AND '2100-04-05' ORDER BY input_date NULLS FIRST LIMIT 1,[]
ab584de115671b8402117e00,How many patients were given hydroxychloroquine sulfate prescriptions during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'hydroxychloroquine sulfate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.prescriptions.had_any_value(prescription_data->'hydroxychloroquine sulfate') AND DATETIME(patient.prescriptions.last_given, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
694ecac71896531f9afc039a,What was the medication patient 10021118 was prescribed for the last time via im since 10/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT prescriptions.medication FROM prescriptions WHERE prescriptions.patient_id = 10021118 AND prescriptions.date >= '10/2100' AND prescriptions.date = (SELECT MAX(date) FROM prescriptions WHERE prescriptions.patient_id = 10021118 AND prescriptions.date >= '10/2100') AND prescriptions.method = 'im',[]
0e5f94ff7f2b90800950a848,"For patient 10018081, how many hours have passed since the first diagnosis with unspecified essential hypertension during their current hospital visit?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE patient_id = 10018081 AND diagnosis_name = 'unspecified essential hypertension' AND status = 'current hospital visit' ORDER BY diagnosis_date NULLS FIRST LIMIT 1;",
464395597c069391d5a6f398,Show us the top three most common microbiology tests in this year.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t.tests, COUNT(t.tests) FROM (SELECT microbiology.tests FROM microbiology WHERE DATETIME(microbiology.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) AS t GROUP BY t.tests ORDER BY COUNT(t.tests) DESC LIMIT 3;",[]
75349759bb3df71a7b6f7649,When was the last time patient 10038081 was prescribed medication via the iv route in 10/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM patient_prescriptions WHERE patient_id = 10038081 AND route = 'iv' AND date_prescribed >= '2010-01-01' AND date_prescribed < '2010-01-01' + INTERVAL '1 year';,[]
fe2ca53dea49bfb8f192692f,What was the first measurement of arterial blood pressure diastolic that patient 10005817 had?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(arterial_blood_pressure_diastolic) FROM measurements WHERE patient_id = 10005817,[]
ad25eb02b71d4d267ce0abfc,Can you tell me the id of patient 1372's ward that he or she may be admitted to?,,SELECT ward_id FROM patients WHERE patient_id = 1372,
47f5715cbbaf2be1e8505994,When was the first time in which patient 10039831 had the minimum respiratory rate since 253 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-253 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(respiratory_rate) FROM respiratory_rate WHERE patient_id = 10039831 AND days_since_last_report > 253,[]
ad9324e51fa0e24a795cc9c7,Tell me the difference in the systolic blood pressure value for patient 10020944 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT systolic_blood_pressure FROM icu_visits WHERE icu_visits.patient_id = 10020944 AND NOT icu_visits.outflow = 0 ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1 OFFSET 1) - (SELECT systolic_blood_pressure FROM icu_visits WHERE icu_visits.patient_id = 10020944 AND NOT icu_visits.outflow = 0 ORDER BY icu_visits.admittime NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
2da4a2b003a50f04b2d7623f,What was the name of that output that patient 10039831 last had since 19 days ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-19 day') ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT output_name FROM duckdb_outputs WHERE patient_id = 10039831 AND date_sub('day', CURRENT_DATE, output_date) >= 19 ORDER BY output_date DESC LIMIT 1;",[{'label': 'Foley'}]
a803aa24d51a01da7f6a534e,"Since 2100, how many arteriography of cerebral arteries procedures were there?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.name = 'arteriography of cerebral arteries' AND STRFTIME('%y', procedures.date) >= '2100';",
b90aaff4f6dc54dd7eefdaae,What are the five most frequent microbiology tests since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t1.TestName, COUNT(t1.TestName) FROM microbiology AS t1 JOIN (SELECT bacteria, year(date) as year FROM microbiology WHERE year(date) >= 2100) AS t2 ON t1.TestName = t2.bacteria GROUP BY t1.TestName ORDER BY COUNT(t1.TestName) DESC LIMIT 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
6866d0c0c9db304d897bd1b8,What was the name of the organism that was found in the last microbiology test on patient 10007795's abscess?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM microbiology WHERE patient_id = 10007795 AND sample_type = 'abscess' AND NOT microbiology_id IS NULL ORDER BY microbiology_id DESC LIMIT 1;,[]
732c03e81ef4b688df802e29,How many days was patient 10019172's last stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', patient.icu_dischtime) - STRFTIME('%j', patient.icu_admittime) FROM patient WHERE patient.icu_admittime IS NOT NULL AND patient.icu_dischtime IS NOT NULL AND patient.patient_id = 10019172 ORDER BY patient.icu_admittime DESC LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.4558912040665746}]"
d555deebd511e5b4c5c57695,"On 07/03/2100, did patient 10007818 have any input of dextrose 5%?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-07-03'",SELECT COUNT(*) > 0 FROM input_table WHERE input_table.patient_id = 10007818 AND input_table.input_date = '07/03/2100' AND input_table.input_name = 'dextrose 5%',[{'COUNT(*)>0': 0}]
5eabde65a4146642bc2431c9,How many patients in 2100 were prescribed metronidazole (flagyl)?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'metronidazole (flagyl)' AND strftime('%Y',prescriptions.starttime) = '2100' )",SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.prescriber_id IN (SELECT employees.employee_id FROM employees WHERE employees.last_name = 'Cohen' AND employees.first_name = 'Mary') AND patient.date_prescribed BETWEEN '2000-01-01' AND '2000-12-31' AND patient.prescription_name = 'Metronidazole (Flagyl)',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
fc3894dd76e5cc3a753eedfb,What is the reimbursement standard for genetic and chromosomal testing?,,"SELECT ""Reimbursement Standard"" FROM ""Questionnaire"" WHERE ""Testing Area"" = 'Genetic and Chromosomal Testing';",
66f0e9afff14db4b814ca058,"When was patient 10004422's last maximum cholesterol, total value on their last hospital encounter?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",,[]
b755ff2035aac255f467595c,So tell me what to do before you go for hemodialysis.,,SELECT * FROM Posts WHERE PostTypeId = 1 AND Score > 55,
3a7b1ab9c06a0e50231e8017,What is the yearly minimum value of patient 10020944's weight?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y',chartevents.charttime)",SELECT MIN(weight) FROM patients WHERE patient_id = 10020944 GROUP BY weight_year,[]
e71755ea81b230d5dd2a212d,"What were the five most frequently diagnosed microbiology tests for patients who were diagnosed with sciatica, unspecified side before within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sciatica, unspecified side' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t3.MicrobiologyTest, COUNT(t3.MicrobiologyTest) FROM (SELECT t2.MicrobiologyTest, t1.Id FROM (SELECT Id, MicrobiologyTest FROM (SELECT ScanId, MicrobiologyTest FROM (SELECT SurgeryId, MicrobiologyTest FROM (SELECT PatientId, MicrobiologyTest FROM (SELECT STATE_NORMAL_DEVIATION(VAR_POP), STATE_NORMAL_DEVIATION(VAR_POP) FROM (SELECT SUM(CASE WHEN ScanId = 1 THEN 1 ELSE 0 END) AS ScanId, MicrobiologyTest FROM (SELECT SUM(CASE WHEN ScanId = 2 THEN 1 ELSE 0 END) AS ScanId, MicrobiologyTest FROM (SELECT SUM(CASE WHEN ScanId = 3 THEN 1 ELSE 0 END) AS ScanId, MicrobiologyTest FROM (SELECT SUM(CASE WHEN ScanId = 4 THEN 1 ELSE 0 END) AS ScanId, MicrobiologyTest FROM (SELECT SUM(CASE WHEN ScanId = 5 THEN 1 ELSE 0",
620be6a2707f02d1b5444ed9,Could you list the monthly minimum piggyback input of patient 10011398 since 12/22/2100?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-22' GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MIN(Piggyback) FROM input WHERE Patient = 10011398 AND Date >= '12/22/2100',[]
7a49c6dcd4b96553b57013d0,What is the minimum total hospital cost to include a drug called nicardipine iv since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nicardipine iv' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.drug = 'nicardipine iv' AND STRFTIME('%y', cost_table.date) >= '2100' GROUP BY cost_table.patient_id) AS t1",
3eb6d37c0b82ceb5b2df547e,How is ranitidine (liquid) typically taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)',"SELECT AVG(dosage) FROM products WHERE product_name = ""Ranitidine (Liquid)""",[]
8dc71388fea9c3fd6452055a,Has there been any organism detected in the last microbiological examination of patient 10019172's urine on the first hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT COUNT(*) > 0 FROM microbiology WHERE microbiology.patient_id IN (SELECT patient.patient_id FROM patient WHERE patient.hospital_visits = 1) AND microbiology. Urine = '10019172' AND NOT microbiology.date IS NULL ORDER BY microbiology.date DESC LIMIT 1,[{'COUNT(*)>0': 0}]
92b7fb1f0888976bb221ed1d,List the preparations for cv cath plcmt w guidance,,SELECT * FROM procedures WHERE procedures.preparation = 'cv cath plcmt w guidance',
3bf09c03de716a687fc51856,What percentile is 0.69 on a troponin t test among patients of the same age as patient 10002495 in their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.69","SELECT t.unit FROM (SELECT patient.age FROM patient WHERE patient.id = 10002495 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1) AS subquery, (SELECT lab.value FROM lab WHERE lab.patient = subquery.age AND lab.label = 'troponin t') AS t WHERE t.value = 0.69",
26c74839913ab4510813fb05,What is the value of patient 10010471's daily average nacl 0.9% input since 12/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT AVG(input) FROM input_table WHERE patient_id = 10010471 AND input_type = 'nacl 0.9%' AND date >= '12/2100' GROUP BY date,[]
975c987c6333e4a188a0a375,When was patient 10016150 prescribed with a drug via the oral route for the last time?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10016150 AND route = 'ORAL',[]
be05d63abe091e094958fc47,How many patients stayed in careunit medicine in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient) FROM patients WHERE careunit = 'medicine' AND DATETIME(staydate, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
93fdc53c054b08a886a68474,What was the total rosuvastatin calcium dose prescribed for patient 10039997 since 08/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug = 'rosuvastatin calcium' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'",SELECT SUM(ROSUVASTATIN CALCIUM) FROM diagnoses INNER JOIN prescriptions ON diagnoses.file_path = prescriptions.file_path WHERE diagnoses.patient_id = 10039997 AND prescriptions.date_prescribed >= '2000-08-2100',[{'SUM(prescriptions.dose_val_rx)': None}]
f235f99faeb9fd03302dd63c,Get me the top four most frequent events since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT event, COUNT(*) FROM my_table WHERE date > CURRENT_DATE - INTERVAL '1 year' GROUP BY event ORDER BY COUNT(*) DESC LIMIT 4;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
45153a5a7e5066d969dc5e94,What was the three most common lab test given in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.lab_test FROM (SELECT lab_test, COUNT(lab_test) AS c FROM (SELECT lab_test FROM lab_tests WHERE year = 2100) AS t1 JOIN lab_results ON t1.lab_test = lab_results.lab_test GROUP BY lab_test) AS t2 ORDER BY c DESC LIMIT 3",[]
01bb1845215fb7cc77678534,When did patient 10021118 receive urine microbiology test the last time?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(MicrobiologyReceivedDate) FROM urine_microbiology WHERE PatientID = 10021118,[]
3f52f0b4c069263ecd9729b0,How many hours have elapsed since patient 10018081 first received a lactate lab test during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lactate_lab_test.lactate_date)) FROM lactate_lab_test WHERE lactate_lab_test.patient_id = 10018081 AND lactate_lab_test.lactate_date IS NOT NULL;",[]
b02b2e4bfa20498bce6b232d,What were the four most commonly given diagnoses for patients who had received diagnostic ultrasound of digestive system before within 2 months in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.subject_id WHERE treatment.treatment_type = 'diagnostic ultrasound of digestive system' AND STRFTIME('%y', treatment.treatment_date) = '2100') AS t1 JOIN (SELECT patient.subject_id, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.treatment_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) BETWEEN DATETIME(t1.treatment_date) AND DATETIME(t",
50231ace46e9680780376e5f,Give me the top three most frequent procedures that patients were given within the same hospital visit after receiving parenteral infusion of concentrated nutritional substances in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.procedure FROM (SELECT t2.procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientuniqueid = patient.uniquepid WHERE treatment.treatmenttype = 'parenteral infusion of concentrated nutritional substances' AND STRFTIME('%y', treatment.treatmenttime) = '2100') AS t1 JOIN (SELECT patient.uniquepid, treatment.procedure, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientuniqueid = patient.uniquepid WHERE STRFTIME('%y', treatment.treatmenttime) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.treatmenttime AND t1.patientname = t2.patientname GROUP BY t2.procedure) AS t3 WHERE t3.c1 <= 3",
f97a37d5ea7b54467da5e351,What was the last value of arterial blood pressure systolic patient 10035185 had on 05/19/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-05-19' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(arterial_blood_pressure_systolic) FROM patient WHERE patient.id = 10035185 AND date = '2100-05-19',[]
ba0e6ef5be18634efe802c90,How many patients stayed at the med/surg/gyn?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' ),SELECT COUNT(DISTINCT patient_id) FROM stays WHERE location = 'med/surg/gyn';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
fb100dfee04065d29677af93,Tell me the last output of patient 10016742 on 07/22/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-22' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT last_output FROM patients WHERE patient_id = 10016742 AND output_date = '07/22/2100',[]
46beded22d8893f7ce7fbb8d,Show me the top five most frequent lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.lab_test, COUNT(t1.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE year >= 2100) AS t1 JOIN lab_results ON t1.lab_test = lab_results.lab_test GROUP BY t1.lab_test ORDER BY COUNT(t1.lab_test) DESC LIMIT 5","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
63963fa9f83cbade78c334a0,Can you count how many operating rooms there is now,,SELECT COUNT(*) FROM inventory WHERE item = 'operating room',
43731ce15c8a2d2bccfff70e,What was the five most common microbiology test conducted since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT t.type, COUNT(t.type) FROM (SELECT microbiology_test_type AS type FROM microbiology_tests WHERE microbiology_test_date >= dateadd(year, -1, current_date)) AS t GROUP BY t.type ORDER BY COUNT(t.type) DESC LIMIT 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]"
e18a2d8bc4701233c6f71e19,What is the cost of a diagnosis for other cirrhosis of liver?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) ),SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = 'Other cirrhosis of liver',
1e1a1711a9e429a5c0a74eec,What was the drug prescribed to patient 10007818 for the last time in 07/this year via the pr route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10007818 AND prescriptions.route = 'pr' AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '07' ORDER BY prescriptions.date DESC LIMIT 1;",[]
83619f693733b0a1c2937f55,What's the average total hospital cost that includes a anticardiolipin antibody igg lab test?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igg' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.item = 'anticardiolipin antibody igg' GROUP BY cost_table.patient_id) AS t1,
6d3fe547b78cd9bdc187e610,"How many instances of drainage of peritoneal cavity, percutaneous approach procedures have been completed since 1 year ago?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'Drainage of peritoneal cavity, percutaneous approach' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
88f1c32259e7e65db186fc61,Tell me the protocol of anticancer drugs?,,SELECT protocol FROM drugs WHERE category = 'anticancer';,
666412cc886fa97817ea1d59,What was the first value of the o2 saturation pulseoxymetry for patient 10021487 on this month/09?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '09' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(O2_SATURATION_PULSEOXYMETRY) FROM pulseoxymetry WHERE PATIENT_ID = 10021487 AND MONTH = 9 AND DAY = 09,[]
1f55785a38dfb75deb3bfb40,When did patient 10040025 get discharged from the hospital for the first time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10040025 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT HOSP_DISCH_DATE FROM patient WHERE PAT_ID = 10040025 ORDER BY HOSP_DISCH_DATE NULLS FIRST LIMIT 1;,[]
f4668d73e48714b3c81b72ab,When did patient 10021938 have the maximum respiratory rate the last time during their last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT MAX(respiratory_rate) FROM (SELECT respiratory_rate FROM patient_respiratory WHERE patient_id = 10021938 AND NOT icu_id IS NULL ORDER BY icu_admission_date DESC LIMIT 1),[]
b09ed49b64bdf344e14bb1c7,Did patient 10014354 have any chloride lab tests done during the previous month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10014354 AND lab_results.lab_name = 'chloride' AND DATETIME(lab_results.result_date, 'start of month') = DATETIME(CURRENT_DATE, 'start of month', '-1 month')",[{'COUNT(*)>0': 0}]
75b0b6062a202e39dc311504,What is the percentile of 26.2 in a mch lab test conducted at the same age as patient 10038081 during the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 26.2","SELECT DISTINCT t1.c1 FROM (SELECT lab.mch, PERCENT_RANK() OVER (ORDER BY lab.mch NULLS FIRST) AS c1 FROM lab WHERE lab.age = (SELECT age FROM patient WHERE patient.id = 10038081 AND NOT patient.dischtime IS NULL ORDER BY patient.hospitaladmittime DESC LIMIT 1)) AS t1 WHERE t1.mch = 26.2",
8cd487610ef7e6e0e454d96b,"What was the name of the medication which patient 10016742 was prescribed in the same hospital visit after receiving introduction of nutritional substance into lower gi, via natural or artificial opening?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.name FROM (SELECT patient.name, treatment.hospital_visit_id FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE patient.patient_id = 10016742 AND treatment.treatment_type = 'introduction of nutritional substance into lower gi, via natural or artificial opening') AS t1 JOIN (SELECT patient.name, medication.name FROM medication JOIN patient ON medication.patient_id = patient.patient_id WHERE patient.patient_id = 10016742) AS t2 ON t1.name = t2.name WHERE t1.hospital_visit_id = t2.hospital_visit_id",
1cf1e58d245ff59b4d7adc31,How many hours have passed since patient 10039831 last received a laboratory test of amylase during their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_test.lab_date)) FROM lab_test WHERE lab_test.patient_id = 10039831 AND lab_test.lab_name = 'amylase' AND lab_test.status = 'completed';",[]
a3bc0d803f5c36757f71d51c,Was patient 10004733's glucose last measured on the current hospital visit greater than the value first measured on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.result FROM lab WHERE lab.patient = 10004733 AND lab.label = 'glucose' AND lab.measured_at = (SELECT MAX(measured_at) FROM lab WHERE lab.patient = 10004733 AND lab.label = 'glucose' AND lab.measured_at IS NOT NULL)) > (SELECT lab.result FROM lab WHERE lab.patient = 10004733 AND lab.label = 'glucose' AND lab.measured_at = (SELECT MIN(measured_at) FROM lab WHERE lab.patient = 10004733 AND lab.label = 'glucose' AND lab.measured_at IS NOT NULL)),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
db9fb5b609cf5c9785924c0c,How many hours have passed since patient 10004733 first visited the careunit medical/surgical intensive care unit (micu/sicu) during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.first_visited_careunit)) FROM patient WHERE patient.id = 10004733 AND patient.first_visited_careunit IS NOT NULL AND patient.hospital_dischtime IS NULL",[]
7ae500ee11764d469951ff85,Can you indicate the yearly minimum dose of kcl (bolus) that patient 10014078 received?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",SELECT MIN(KCL_BOLUS) FROM KCL WHERE PATIENT_ID = 10014078 GROUP BY YEAR;,[]
a3c1f40e880ba9d30165da29,Do you know what type of blood patient 98517 has?,,SELECT patient.blood_type FROM patients WHERE patient.id = 98517;,
8575bf6a21bdfbbe6b80a4ab,Tell me the total or ebl output of patient 10027602.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ),SELECT SUM(output) FROM brackets WHERE patient = 10027602,[{'SUM(outputevents.value)': None}]
355c64d2875efbf6a8cd7683,What was the name of the output which patient 10019172 had first had since 04/07/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07' ORDER BY outputevents.charttime ASC LIMIT 1 )",SELECT text FROM duckdb_outputs WHERE patient_id = 10019172 AND date_since = '2100-04-07' ORDER BY date_since NULLS FIRST LIMIT 1,[{'label': 'Foley'}]
aafda5799cef4cdbb1a8c0e0,What's the count of current patients?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE status = 'current';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d2d60e3fb7175ae8e24658d9,Tell me what diagnosis patient 32153 received at the other department.,,SELECT diagnosis FROM patients WHERE department = 'other department' AND patient = 32153,
042ab61601f982ee4d6436fd,What did patient 10022041 get diagnosed with in 2100 for the first time?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis FROM diagnoses WHERE patient_id = 10022041 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100' ORDER BY diagnoses.diagnosis_date NULLS FIRST LIMIT 1",
9a8f62c083931e6b853cf083,What is the name of a procedure patient 10029291 underwent two or more times since 30 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",SELECT d.procedure_name FROM (SELECT COUNT(DATE(CURRENT_DATE - INTERVAL 30 MONTH)) AS c FROM procedures WHERE patient_id = 10029291 GROUP BY procedures.procedure_name) AS d WHERE c >= 2,
797af2b7be25b810c1fa0b00,Count the ICU visits of patient 10009035 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y',icustays.intime) >= '2100'","SELECT COUNT(ICU_VISITS) FROM patients WHERE PATIENT_ID = 10009035 AND STRFTIME('%y', ICU_ADMIT_DATE) >= '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 1}]
a2e0e5bf31da42c112583f6a,When did patient 10038933 first get prescribed famotidine and glyburide at the same time since 06/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10038933 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glyburide' AND admissions.subject_id = 10038933 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",,[]
d3f3a4406592054ad20c2093,When did patient 10022017 get the microbiology test for the last time since 10/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology WHERE patient = 10022017 AND date >= '10/2100',[{'charttime': '2189-09-13 08:16:00'}]
d9e6af32ff852ac88dc76577,What is dr. barna's outpatient schedule today?,,SELECT dr.barna.outpatient_schedule.today;,
1dea8e8367ea15758b8ca92e,Calculate the number of patients prescribed insulin.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'insulin' ),,[{'COUNT( DISTINCT admissions.subject_id )': 21}]
2d707b84d2f9dc480c7effa7,What treatment were provided to patient 10021312 two or more times since 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",SELECT TIMESTAMP '2000-05-2100 00:00:00' FROM patients WHERE patients.id = 10021312 GROUP BY patients.id HAVING COUNT(*) >= 2,
228233a09c8164c6e564f551,"Has any organism been found in the first fluid,other microbiological test of patient 10021487 in 12/this year?","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT COUNT(*) FROM organism_table WHERE patient_id = 10021487 AND fluid_type = '1' AND date_of_test = '12/21487',[{'COUNT(*)>0': 0}]
df4054d39dfcc41a5f36e76b,At what time did the last incident of patient 10020944 having a maximum respiratory rate occur on 03/12/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-12' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",SELECT TIMESTAMP '2100-03-12 01:02:03' FROM incident_data WHERE patient_id = 10020944 AND max_respiratory_rate = (SELECT MAX(respiratory_rate) FROM incident_data WHERE patient_id = 10020944),[]
4244cfa368679a0ccc3f5672,Does patient 65309 have a trip history overseas?,,,
1f0fce096cb3fb07a3c96ef2,How many days has it been since the last time during this hospital encounter that patient 10004733 was diagnosed with proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",SELECT COUNT(DISTINCT t1.date_of_diagnosis) FROM (SELECT patient.date_of_diagnosis FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.patient_id WHERE diagnoses.infection_site = 'unspecified site' AND diagnoses.infection_agent = 'proteus (mirabilis) (morganii)') AS t1 JOIN (SELECT patient.date_of_admission FROM admissions JOIN patient ON admissions.patient_id = patient.patient_id WHERE patient.hospital_dischtime IS NULL) AS t2 ON t1.patient_id = t2.patient_id,
95523c3c68ef7d68aa2cd797,Tell me the total volume of input that patient 10021938 was given since 07/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-12'",SELECT SUM(volume) FROM intake WHERE patient = '10021938' AND date >= '2100-07-12',[{'SUM(inputevents.totalamount)': 1754.0}]
480c4f9f6cb6210afb07ec17,Can you tell me the five most frequent diagnoses during this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM diagnoses WHERE DATETIME(diagnosis, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 5",
9c4387eddc635a52994b4e04,How much does it cost for a severe sepsis diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'severe sepsis' ) ),SELECT SUM(cost) FROM diagnoses WHERE diagnosis = 'severe sepsis';,
e7119697712668b05c2da0e5,Count how many current patients are aged 50s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,SELECT COUNT(*) FROM patients WHERE age BETWEEN 50 AND 59,
76247d92b87ae733ddbc1905,When was the last test of patient 10020740's microbiology stool in 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'stool' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology_stool WHERE patient_id = 10020740 AND date BETWEEN '2000-03-2100' AND '2000-03-2100',[]
2398b4f90c62615b764ca247,How many days have elapsed since the last time on this hospital encounter patient 10039831 got a magnesium lab test?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', Magnesium.LastTestDate)) FROM Magnesium WHERE Magnesium.PatientID = 10039831 AND Magnesium.LastTestDate IS NOT NULL;",[]
223c28432258577bfde7c6ee,Can you tell me when the first monocytes test of patient 10009049 was conducted in 06/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(Monocytes) FROM lab WHERE Lab.Patient = 10009049 AND Monocytes = '06/this year',[]
7787b854dab1f43b718313bf,Was patient 10022017 diagnosed with anything last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10022017 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
0577ee51b3ad3c9fcf8fbbae,What is the average value of oxygen in patient 10014729's body in 03/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'","SELECT AVG(Oxygen) FROM (SELECT Oxygen FROM 'patient_10014729' WHERE Oxygen IS NOT NULL AND DATETIME(Oxygen, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND DATETIME(Oxygen, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year'))",[{'AVG(labevents.valuenum)': None}]
adead92d438c2cc8419cbb1a,What was the drug name that patient 10027445 was last prescribed through the tp route in 09/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'tp' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug_name FROM prescriptions WHERE prescriptions.patient_id = 10027445 AND prescriptions.route = 'tp' AND DATETIME(prescriptions.drug_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.drug_date) = '09' ORDER BY prescriptions.drug_date DESC LIMIT 1",[]
dc333dc95c29a9b3f3719647,"For patients previously diagnosed with nicotine dependence, cigarettes, uncomplicated , what were the five most frequent specimens tested in the same month afterward?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.month FROM (SELECT patient.specimen, diagnoses.month FROM diagnoses JOIN patient ON diagnoses.patient = patient.patient WHERE diagnoses.diagnosis = 'NICOTINE DEPENDENCE, COMPLICITED') AS t1 JOIN (SELECT patient.specimen, tests.month FROM tests JOIN patient ON tests.patient = patient.patient WHERE tests.test = 'Cigarettes') AS t2 ON t1.specimen = t2.specimen WHERE t1.month = t2.month GROUP BY t3.specimen) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 5",
ab3f000e7808a99742228d97,"What was the name of the drug patient 10015931 was prescribed within 2 days after having received a introduction of other therapeutic substance into peripheral artery, percutaneous approach procedure during this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug_name FROM (SELECT t1.patient_id, t1.date FROM (SELECT patient_id, date FROM patient_events WHERE event_type = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach') AS t1 GROUP BY t1.patient_id HAVING MIN(t1.date) = t1.date) AS t2 JOIN (SELECT patient_id, date FROM patient_events WHERE event_type = 'prescription of drug') AS t3 ON t2.patient_id = t3.patient_id WHERE t2.date < t3.date AND DATETIME(t2.date, 'start of month') = DATETIME(t3.date, 'start of month') AND DATETIME(t2.date) BETWEEN DATETIME(t3.date) AND DATETIME(t3.date, '+2 day')",
39206b0e94f1d50dfd4f7a97,"In the first hospital visit, what age was patient 10021118?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.age FROM patient WHERE patient.id = 10021118 AND NOT patient.hospital_info.dischtime IS NULL ORDER BY patient.hospital_info.admittime NULLS FIRST LIMIT 1,
21725d6a5831671fc4d0dc87,Has patient 10016742 come to the ER?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM patient WHERE patient.gender = 'f' AND patient.age >= 35 AND patient.age <= 45 AND patient.admit_location = 'emergency room admit' AND patient.subject_id = 10016742,[{'COUNT(*)>0': 0}]
634b0f8deeebe3bcb1a50a09,What is the dose of prescribed opioid for patient 30826?,,SELECT SUM(opioid_dose) FROM prescriptions WHERE prescriptions.patient_id = 30826,
5939dbebe9fc6fd912fa8878,"What is the average total cost of the hospital, which includes the medicine named glucose gel since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucose gel' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE name = 'glucose gel' AND year >= 2100 GROUP BY name) AS t1,
dc21479affad398d7e20b2da,Was there any nacl 0.9% given to patient 10010471 on 12/15/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-15'",SELECT COUNT(*) FROM inventory WHERE item = 'nacl 0.9%' AND patient = 10010471 AND date = '12/15/2100',[{'COUNT(*)>0': 0}]
1d30f0f67382fed6a575cafc,What was the name of the drug that patient 10004733 was prescribed within 2 days after having received since 10/2100 a enteral infusion of concentrated nutritional substances procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-10' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.subject, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.subject WHERE patient.subject = 10004733 AND treatment.type = 'enteral infusion of concentrated nutritional substances' AND STRFTIME('%y-%m', treatment.date) >= '2100-10') AS t1 JOIN (SELECT patient.subject, drug.drug, treatment.date FROM drug JOIN patient ON drug.patient = patient.subject WHERE patient.subject = 10004733 AND STRFTIME('%y-%m', treatment.date) >= '2100-10') AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
fb61ff0592412ac1416aee55,Calculate the number of patients staying in emergency department observation.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' ),SELECT COUNT(DISTINCT patient_id) FROM emergency_department_observation;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
9cdb25ef0c41840e0b599dbb,What is the pricing for ampicillin sodium?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' ),SELECT AVG(price) FROM products WHERE product = 'Ampicillin Sodium';,
d8f365a561e69cca2b2fea83,What was the first polys reading in 06/2100 for patient 10007818?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(Polys) FROM read_parquet('patients/10007818/polys.parquet', hive_partitioning=1) WHERE Date = '2000-06-2100';",[]
abe89412efcd41bf266d253a,What is the name of the diagnosis that patient 30267 received from the other department?,,SELECT diagnosis.diagnosis_name FROM diagnosis WHERE diagnosis.department_id <> (SELECT patient.department_id FROM patient WHERE patient.unique_patient_id = 30267),
dea9a4a3b6415cd9f853cbe4,"In 09/2100, how much dorzolamide 2%/timolol 0.5% ophth. has been prescribed to patient 10005348 in total?","SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09'",SELECT SUM(prescriptions.dose) FROM prescriptions WHERE prescriptions.patient_id = 10005348 AND prescriptions.date BETWEEN '2009-01-01' AND '2009-12-31' AND prescriptions.drug IN ('dorzolamide 2%/timolol 0.5% ophth.'),[{'SUM(prescriptions.dose_val_rx)': None}]
fe6a7a8b896a7b2e6cd69e64,I need the total volume of input for patient 10038999 on 06/03/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-06-03'",SELECT SUM(input_volume) FROM input WHERE patient_id = 10038999 AND input_date = '2100-06-03',[{'SUM(inputevents.totalamount)': None}]
388eba2ee935cfefacdbbcf6,Could you provide the total volume of output for patient 10009049 on 06/13/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-06-13'","SELECT SUM(output.volume) FROM output WHERE output.patient_id = 10009049 AND STRFTIME('%y-%m-%d', output.date) = '2100-06-13'",[{'SUM(outputevents.value)': None}]
dba831b22948cb6030f2a0dd,Count how many current patients are aged 30s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT(*) FROM patients WHERE age BETWEEN 30 AND 39,
c5924167cb9c4a6790f631c5,What was the total of lidocaine 1% (for picc/midline insertions) that patient 10038081 had been prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'lidocaine 1% (for picc/midline insertions)',SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10038081 AND prescriptions.drug = 'Lidocaine 1% (For PICC/Midline Insertions)',[{'SUM(prescriptions.dose_val_rx)': None}]
de726b4a741c447f0cdcb8e5,How much does a medication called acetaminophen iv cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetaminophen iv' ),SELECT DISTINCT cost FROM medication WHERE name = 'acetaminophen iv';,
c1f271e8baade40b3d9d4596,When did patient 10021666 first get urine microbial tests in 04/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM urine_microbial WHERE patient_id = 10021666 AND date BETWEEN '2004-01-01' AND '2004-12-31',[]
e4d3934ae79126d2f578ee32,Did patient 10027602 have gastric meds given in their first hospital visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10027602 AND medication.location = 'gastric' AND NOT medication.dischtime IS NULL ORDER BY medication.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
d073173860e35bfa703b57ab,Display the top three most commonly prescribed drugs.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id FROM admissions WHERE admissions.dischtime IS NULL) AS t1 JOIN (SELECT admissions.subject_id, prescriptions.drug FROM admissions JOIN prescriptions ON admissions.subject_id = prescriptions.subject_id) AS t2 ON t1.subject_id = t2.subject_id GROUP BY t2.drug) AS t3 WHERE t3.c1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]"
2b2758c78e28d13baca5b743,Can you show me the top three most frequent lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Lab_Test, COUNT(t1.Lab_Test) FROM lab_tests AS t1 JOIN results AS t2 ON t1.Lab_Test_ID = t2.Lab_Test_ID WHERE t1.Year >= 2100 GROUP BY t1.Lab_Test ORDER BY COUNT(t1.Lab_Test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
8dea7b9b04a6934cbc300217,What was the total dose of readi-cat 2 (barium sulfate 2% suspension) patient 10038992 had been prescribed last month?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(DISTINCT readi_cat_2) FROM patients WHERE patient_id = 10038992 AND date_sub('month', CURRENT_DATE, readi_cat_2) = 1",[{'SUM(prescriptions.dose_val_rx)': None}]
722720600298a5f82bca4716,What output did patient 10018081 generate last since 12/26/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-26' ORDER BY outputevents.charttime DESC LIMIT 1 )",,[{'label': 'Foley'}]
dedd0a8a0ba377a957737cd9,Show me the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving other endoscopy of small intestine since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DISTINCT t1.id FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE treatment.type = 'other endoscopy of small intestine' AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE DATETIME(diagnosis.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.id = t2.patient_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.count > 3",
a6cec8e8e6020c8b18e14f57,Has patient 10016810 been provided with any medication since 05/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'","SELECT COUNT(*) > 0 FROM medication_table WHERE medication_table.patient_id = 10016810 AND STRFTIME('%y-%m', medication_table.date) >= '2100-05'",[{'COUNT(*)>0': 1}]
eff7745b76fcafa8bf36d64d,What was the specimen test ranked at three that was done most commonly?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(*) FROM brackets GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 1","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
0cf19476dc727db127ab20bf,What was the name of the last specimen test which patient 10018328 has received since 17 months ago?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-17 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT specimen_type FROM specimen_table WHERE patient_id = 10018328 AND date_test >= DATEADD(month, -17, CURRENT_DATE) ORDER BY date_test DESC LIMIT 1",[{'spec_type_desc': 'URINE'}]
bca0d0989ef1a590d9a72d9f,When was the last time patient 10018328 was discharged from hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018328 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = 10018328;,[{'dischtime': '2154-05-03 14:00:00'}]
3f15a65a81b4cc91090d4562,What was the medicine that was prescribed to patient 10009035 in the same hospital encounter after undergoing extracorporeal circulation auxiliary to open heart surgery in 05/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t3.medication FROM (SELECT t2.medication FROM (SELECT t1.medication FROM (SELECT '10009035' AS patient_id, '05/2022' AS date_of_entry) AS t1 JOIN (SELECT '10009035' AS patient_id, '05/2022' AS date_of_entry, 'extracorporeal circulation auxiliary to open heart surgery' AS medication) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.date_of_entry = t2.date_of_entry) AS t3 WHERE t2.date_of_entry = t3.date_of_entry",
5301d3f2ee9055f024af59a4,How many hours have elapsed since the last time patient 10039831 got a lactate lab test in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lactate_lab_time)) FROM lab_results WHERE lab_results.patient_id = 10039831 AND lactate_lab_time IS NOT NULL;",[]
5497d84d98c1646706086e2e,Will they have any urine test done for patient 24268?,,SELECT COUNT(*) > 0 FROM urine_test WHERE patient_id = 24268,
0424a90b6986dc6ca2da8b3b,"During their last hospital encounter, when did patient 10023239 last receive a calcium, total test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(date) FROM lab WHERE lab.patient = 10023239 AND lab.test = 'Calcium, Total'",[]
1b9d385c18198422e5cc0a04,The first time patient 10007795 was prescribed lactated ringers and gemfibrozil at the same time since 06/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT COUNT(*) FROM (SELECT patient.subject_id FROM patient WHERE patient.patient_id = 10007795) AS t1 JOIN (SELECT patient.subject_id FROM patient WHERE patient.patient_id = 10007795) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.start_date < t2.start_date AND DATETIME(t2.start_date) BETWEEN DATETIME(t1.start_date) AND DATETIME(t1.start_date, '+1 month')",[]
45fe917c7821d64a778aee8e,Tell me the total input for patient 10004733 yesterday.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT COUNT(*) FROM input WHERE patient_id = 10004733 AND input_date = DATEADD('day', -1, CURRENT_DATE)",[{'SUM(inputevents.totalamount)': None}]
8b05dac24440c0e125c2982d,What was the duration of serum transfusion nec for patient 29540?,,SELECT COUNT(DISTINCT serum_transfusion_nec) FROM serum_transfusion_nec WHERE patient_id = 29540,
2b2a1cb7c1f3e55513ccdcd8,"Since 2100, what was the top five most frequent diagnoses patients were diagnosed with during the same month after receiving extracorporeal circulation auxiliary to open heart surgery?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'extracorporeal circulation auxiliary to open heart surgery' AND STRFTIME('%y', treatment.treatmentdate) >= '2100') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE STRFTIME('%y', diagnosis.diagnosisdate) >= '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t1.treatmentdate, 'start of month') = DATETIME(t2.diagnosisdate, 'start of month') GROUP BY t2.diagnosis) AS t3",
543fac252e1b711db022052e,"What is the maximum cost of a hospital that involves acute alcoholic intoxication in alcoholism, continuous since 1 year ago?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(CASE WHEN alcoholism = 'acute alcoholic intoxication' THEN 1 ELSE 0 END) AS c1 FROM alcoholism_diagnoses WHERE alcoholism_diagnoses.date = DATETIME(CURRENT_TIME, '-1 year') GROUP BY alcoholism_diagnoses.date) AS t1",
a5a346eb9f19336f14d5a615,Could you inform me about patient 10019172's last o2 saturation pulseoxymetry since 07/07/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-07-07' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT * FROM pulseoxymetry WHERE patient_id = 10019172 AND measurement_date >= '2100-07-07' AND o2_saturation = 'last',[]
721bfea157a6426f9d055a41,What was the total dose of 0.83% sodium chloride prescribed to patient 10018501 in the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = '0.83% sodium chloride',SELECT SUM(0.83% Sodium Chloride) FROM patients WHERE patient_id = 10018501 AND NOT patients.hospital_dischtime IS NULL ORDER BY patients.hospital_admittime DESC LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
675c3bb58c7f84d6c7abcb76,"Has patient 10016742 been ordered sw, sodium chloride 0.9%, or heparin in 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug IN ( 'sw', 'sodium chloride 0.9%', 'heparin' ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) > 0 FROM orders WHERE patient_id = 10016742 AND order_date = 2100 AND prescription = IN ('sw', 'sodium chloride 0.9%', 'heparin')",[{'COUNT(*)>0': 0}]
5837deca15847d294628637f,Can you tell me the cost of repair of atrial septal defect with tissue graft?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of atrial septal defect with tissue graft' ) ),"SELECT ""cost of repair"" FROM repair WHERE ""type of repair"" = 'atrial septal defect with tissue graft'",
6cb0d732bdcaaf606d0b499a,"What was the first sodium, whole blood lab value for patient 10005348 in the last hospital visit?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(Sodium, Whole Blood) FROM lab WHERE Patient.ID = 10005348 AND NOT Patient.DischTime IS NULL ORDER BY Patient.AdmitTime DESC LIMIT 1;",[]
463dff1e23c71f21ca726e31,When did patient 10038999 last receive a pleural fluid microbiology test in 06/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '06' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(date) FROM microbiology WHERE patient = 10038999 AND microbiology_type = 'pleural fluid' AND date_part('year', date) = date_part('year', CURRENT_DATE) AND date_part('month', date) = 6",[]
1c752280e681b6e8e598bdae,When was the last time that patient 10021312 has received a red blood cells lab test during their last hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(lab_date) FROM lab WHERE lab.patient_id = 10021312 AND lab.lab_name = 'red blood cells',[]
1495b796ffe9d906c0df1b75,Has any prescriptions been given to patient 10016810?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ),SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10016810;,[{'COUNT(*)>0': 1}]
88cfaf0dcef49943a266c313,What was the drug that patient 10021487 was prescribed for within 2 days after undergoing arterial catheterization since 2 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-2 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE patient.id = 10021487 AND treatment.treatment = 'arterial catheterization' AND DATETIME(treatment.date) >= DATETIME(CURRENT_TIME, '-2 month')) AS t1 JOIN (SELECT patient.id, drug.drug, treatment.date FROM drug JOIN patient ON drug.patient_id = patient.id WHERE patient.id = 10021487 AND DATETIME(drug.date) >= DATETIME(CURRENT_TIME, '-2 month')) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 day')",
d8830bd1398db83dd14ba4d6,What are the three most commonly ordered medications in this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.name FROM (SELECT medication AS name, COUNT(medication) AS c FROM medication INNER JOIN orders ON medication.code = orders.medication_code INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE DATETIME(orders.order_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY medication) AS t1 ORDER BY c DESC LIMIT 3;",[]
8694ace52a01f31ca53cc69a,When has patient 10000032 been given urea nitrogen test for the first time in 08/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08' ORDER BY labevents.charttime ASC LIMIT 1","SELECT urea_nitrogen_test.result_date FROM urea_nitrogen_test WHERE urea_nitrogen_test.patient_id = 10000032 AND STRFTIME('%y-%m', urea_nitrogen_test.result_date) = '2100-08' ORDER BY urea_nitrogen_test.result_date NULLS FIRST LIMIT 1",[]
8022e43f6d6b61363a0e1da2,What was the total foley output of patient 10013049 on 06/24/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '06-24'",SELECT SUM(foley) FROM output WHERE patient = 10013049 AND date = '06/24/2022',[{'SUM(outputevents.value)': None}]
bbaf6db3927ca6221096a678,When are dr. smith's rounds and procedures?,,"SELECT dr.smith.rounds, dr.smith.procedures FROM duckdb_functions WHERE function_name = 'dr. smith';",
e3659a41757c0fd2645fe816,Tell me the total number of patients who stayed in vascular since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT subject, vascular FROM (SELECT patient_id, 1 FROM (SELECT patient_id, 0 FROM patients WHERE birth_year < 2100) AS t1 JOIN patients AS t2 ON t1.patient_id = t2.patient_id WHERE vascular = 1) AS t3",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
a0275ba4dd2c244770e9553e,Calculate the number of patients staying in med/surg/gyn since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient_id) FROM med_surg_gyn WHERE stay_duration >= '1 year',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
62062f47a37fdbe9d1c27aaa,Did patient 10012552 undergo any procedure in the first hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10012552 AND procedures.hospital_sequence = 1,[{'COUNT(*)>0': 1}]
73d40a25005323dbe30f475f,What did patient 10026354 get diagnosed with on their first hospital encounter for the first time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE patient_id = 10026354 AND NOT patient_id IN (SELECT patient_id FROM diagnoses WHERE NOT patient_id IS NULL AND visit_number > 1) ORDER BY diagnosis_date NULLS FIRST LIMIT 1,
2c69aa2c7d2c6989277b55bb,Calculate patient 10027602's total input amount of nacl 0.9% on this month/05.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '05'",SELECT SUM(input_amount) FROM input_table WHERE patient_id = 10027602 AND input_type = 'nacl 0.9%' AND input_date >= CURRENT_DATE - INTERVAL '0 month' AND input_date <= CURRENT_DATE - INTERVAL '0 month' + INTERVAL '0 day' AND input_time >= CURRENT_TIME - INTERVAL '0 hour' AND input_time <= CURRENT_TIME - INTERVAL '0 hour' + INTERVAL '0 minute';,[{'SUM(inputevents.totalamount)': None}]
b8c83d640d2fe3594c7c2cb3,What was the output patient 10038933 had since 06/15/2100 on the last occasion?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-15' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT ""output"" FROM ""patients"" WHERE ""patient"" = '10038933' AND ""date"" = '06/15/2100'",[{'label': 'Foley'}]
5b73fda84131aee9f4b13b57,Count the number of patients that were discharged during the previous year from the hospital.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissed_date IS NULL AND DATETIME(dismissed_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
3ba74bf54de10d143025c7db,How many prescriptions were prescribed since 1 year ago for pseudoephedrine?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'pseudoephedrine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Pseudoephedrine' AND DATETIME(prescriptions.date_prescribed) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT(*)': 0}]
7ce2a21d5cd40b04d8cb2c75,Tell me the number of patients diagnosed with personal history of sudden cardiac arrest since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of sudden cardiac arrest' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT diagnosis.patient_id) FROM diagnosis WHERE diagnosis.text LIKE '%personal history of sudden cardiac arrest%' AND STRFTIME('%y', diagnosis.date) >= '2100'",
e2be072741fd9d09da7ab8b3,"Compared to yesterday, what are the new prescriptions for patient 10004733 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescriptions FROM medication_usage WHERE patient_id = 10004733 AND date = '2022-01-01',[]
97d4f5fa5be6b24ab07da93f,I want to know the total volume of input patient 10019172 has received during their first ICU visit.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ),SELECT SUM(volume) FROM intake WHERE patient = 10019172 AND NOT icu_order IS NULL ORDER BY icu_order NULLS FIRST LIMIT 1;,[{'SUM(inputevents.totalamount)': 29170.0}]
407b4851260c5c0836e1d89e,Has patient 10003400 been diagnosed with any type of disease?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10003400,[{'COUNT(*)>0': 1}]
1b7a372bc73c1b3e5e13c41d,Show me patient 10004422's total jackson pratt #1 output on 01/20/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jackson pratt #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-01-20'",SELECT SUM(jackson_pratt_#1) FROM patient WHERE patient_id = 10004422 AND pratt_date = '01/20/2100',[{'SUM(outputevents.value)': None}]
891190b131bd38e70baa856f,"What is the average total cost of a hospital, which includes a drug called ciprofloxacin iv since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(ciprofloxacin iv) AS c1 FROM hospital WHERE year >= 2100 GROUP BY hospital.id) AS t1,
5b8ab7986b30db4c19fb1088,"Was patient 10000032 ordered insulin (regular) for hyperkalemia, tiotropium bromide, or albuterol 0.083% neb soln during their first hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'tiotropium bromide', 'insulin (regular) for hyperkalemia', 'albuterol 0.083% neb soln' )","SELECT COUNT(*) > 0 FROM orders WHERE orders.patient_id = 10000032 AND orders.insulin_type = 'insulin (regular) for hyperkalemia, tiotropium bromide, or albuterol 0.083% neb soln' AND NOT orders.dischtime IS NULL ORDER BY orders.admittime NULLS FIRST LIMIT 1",[{'COUNT(*)>0': 0}]
82c59daa8e3a56e7f5ad97c0,"Since 1 year ago, what are the top four most frequent procedures that patients received in the same hospital encounter after being diagnosed with unspecified disorder of kidney and ureter?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date, patient.patient_location FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'Unspecified disorder of kidney and ureter' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment, treatment.treatment_date, patient.patient_location FROM treatment JOIN patient ON treatment.patient_id = patient.uniquepid WHERE DATETIME(treatment.treatment_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.treatment_date AND t1.patient_location = t2.patient_location GROUP BY",
74439a67da9347c057e1d1c8,When had patient 10016810 last been prescribed for pseudoephedrine and levothyroxine sodium at the same time since 06/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pseudoephedrine' AND admissions.subject_id = 10016810 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levothyroxine sodium' AND admissions.subject_id = 10016810 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT COUNT(DISTINCT t1.date_prescribed) FROM (SELECT patient_id, date_prescribed FROM medication_table WHERE medication_name = 'pseudoephedrine') AS t1 JOIN (SELECT patient_id, date_prescribed FROM medication_table WHERE medication_name = 'levothyroxine sodium') AS t2 ON t1.patient_id = t2.patient_id WHERE DATETIME(t1.date_prescribed) >= DATETIME('%m/%Y') AND DATETIME(t1.date_prescribed) < DATETIME('%m/%Y') AND t1.patient_id = t2.patient_id GROUP BY t1.patient_id HAVING MIN(t1.date_prescribed) = MAX(t2.date_prescribed)",[]
d2eeacdc392b4745759a9da7,What is the name of the medication that was prescribed to patient 10007818 for the first time via the subcut route during their last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'subcut' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT name FROM medication WHERE id = (SELECT medication_id FROM visit WHERE patient_id = 10007818 AND NOT last_dischtime IS NULL ORDER BY visit.admittime DESC LIMIT 1);,[]
1129dbf956a1de639c79960c,When was the last input time of patient 10005817 during the first ICU stay?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,SELECT MAX(input_time) FROM patient WHERE patient.icu_stay_id = 10005817,[{'starttime': '2132-12-17 17:23:00'}]
8d8cd6284d24a2bdccc48b42,What number of days has it been since the first time patient 10004733 was diagnosed with diverticulosis of colon (without mention of hemorrhage) during this hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diverticulosis of colon (without mention of hemorrhage)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_code = ""DIVERTICULOSIS OF COLON (WITHOUT MENTION OF HEMORRHAGE)"" AND patient_id = 10004733 AND hospital_visit_id = 1",
a8704a105b87163e999ca81d,Are there new medications in the prescription of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT SELECT COUNT(*) > 0 FROM prescription WHERE prescription.patient_id = 10018081 AND DATETIME(prescription.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescription.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
cbec37a67b1882b8d6f5c38a,What was the top five most frequent diagnoses since 1 year ago that patients were diagnosed with within the same month after receiving incision with removal of foreign body or device from skin and subcutaneous tissue?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'incision with removal of foreign body or device from skin and subcutaneous tissue' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'incision with removal of foreign body or device from skin and subcutaneous tissue' AND DATETIME(treatment.treatmentdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t1.treatmentdate, 'start of month') = DATETIME(t2.diagnosisdate, 'start of",
ddaecde2d7500bcb038b6060,"Tell me, was lr given to patient 10013049 on 06/23/2100?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-06-23'",SELECT COUNT(DISTINCT lr) FROM patients WHERE patient_id = 10013049 AND lr_date = '2100-06-23',[{'COUNT(*)>0': 0}]
76ce0be28b35e8726dc606fa,When was the first time the heart rate of patient 10018081 was measured at a reading greater than 107.0 during this ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 107.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate_measurement_time) FROM icu_heart_rate_measurements WHERE icu_heart_rate_measurements.patient_id = 10018081 AND icu_heart_rate_measurements.heart_rate > 107.0,[]
77056748c01969f4cedd4f49,What was the first medication that patient 10007795 was prescribed via po/ng route in 05/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(brackets.medication_date) FROM brackets WHERE brackets.patient_id = 10007795 AND brackets.route = 'po/ng' AND DATETIME(brackets.medication_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', brackets.medication_date) = '05'",[]
b91c712088f552af0be44e46,What are the top four most common specimens tested for patients previously diagnosed with traumatic shock within 2 months?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT patient.name, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.diagnosis = 'traumatic shock') AS t1 JOIN (SELECT patient.name, specimen FROM lab WHERE patient.name IN (SELECT name FROM patient WHERE diagnosis.date < (SELECT date FROM diagnosis WHERE patient = 'traumatic shock'))) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.specimen) AS t3 JOIN (SELECT patient.name, specimen FROM lab WHERE patient.name IN (SELECT name FROM patient WHERE diagnosis.date < (SELECT date FROM diagnosis WHERE patient = 'traumatic shock'))) AS t4 ON t3.name = t4.name GROUP BY t4.specimen ORDER BY COUNT",
c7cc1c1c0a6dfab998b9a573,"What is the maximum total hospital cost that includes a procedure named restriction of left internal carotid artery with intraluminal device, percutaneous approach since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure_name = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' AND STRFTIME('%y', date) >= '2100' GROUP BY cost) AS t1",
967175d0df47b1226680f9bc,What was the name of the organism at the first urine test of patient 10031757 during their last hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT organism_name FROM urine_log WHERE patient_id = 10031757 AND NOT organism_name IS NULL ORDER BY log_date NULLS FIRST LIMIT 1,[]
edaebbb4a2886364c2f5455c,"Since 1 year ago, has patient 10021938 been to an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",SELECT COUNT(*) > 0 FROM call_history WHERE call_type = 'emergency department' AND patient_id = 10021938 AND call_date >= (CURRENT_DATE - INTERVAL '1 year'),[{'COUNT(*)>0': 0}]
be95e0c0ef52ac9abbba1a3c,"What is the number of drainage of right pleural cavity with drainage device, percutaneous approach procedures carried out in this year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(*) FROM procedures WHERE procedures.year = 2021 AND procedures.drainageDevice = 'right pleural cavity',
b0e46f47baaef8c5efa0dcdb,What was the last measured value of o2 saturation pulseoxymetry for patient 10027445 on 08/12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-08-12' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT last_measured_value FROM pulseoxymetry WHERE patient_id = 10027445 AND measurement_date = '2100-08-12' AND measurement_type = 'o2 saturation pulseoxymetry',[]
625878ba2c323f56d784df19,"For the last time , what was patient 10017492 diagnosed with?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnosis FROM diagnoses WHERE patient_id = 10017492 ORDER BY diagnosis_date DESC LIMIT 1,
107acacd9df083f664395e57,How many times patient 10018501 came to the hospital in this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10018501 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient.hospital_id) FROM patient WHERE patient.unique_patient_id = 10018501 AND DATETIME(patient.hospital_admission_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
2815edbcab8252d5b617ad55,When did patient 10029484 last depart from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10029484 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(departure_date) FROM patient WHERE patient_id = 10029484,[]
5a5b63cc59222e36f5a0e0ea,"Compared to yesterday, what were the new prescriptions for patient 10004733 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescriptions FROM medication_usage WHERE patient_id = 10004733 AND date = '2022-03-01',[]
40c4039e5ddeb88faf4449aa,Which are the top three most frequent procedures patients had within 2 months after being diagnosed with personal history of malignant neoplasm of large intestine since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.procedure, COUNT(t3.procedure) FROM (SELECT t2.procedure, COUNT(t2.procedure) FROM (SELECT patient.name, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.diagnosis = 'Personal history of malignant neoplasm of large intestine' AND DATETIME(diagnosis.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.name, procedure.procedure, procedure.date FROM procedure JOIN patient ON procedure.patient = patient.name WHERE DATETIME(procedure.date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.procedure) AS t3 GROUP BY t3.procedure ORDER BY COUNT(t3.procedure) DESC LIMIT",
11781310efb83f845ca54e72,Retrieve the top four most frequent procedures that were delivered to patients within 2 months after they received other laparoscopic umbilical herniorrhaphy in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.procedure FROM (SELECT t2.procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.procedure = 'other laparoscopic umbilical herniorrhaphy' AND STRFTIME('%y', treatment.treatdate) = '2100') AS t1 JOIN (SELECT patient.uniquepid, treatment.procedure, treatment.treatdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE STRFTIME('%y', treatment.treatdate) = '2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatdate < t2.treatdate AND DATETIME(t2.treatdate) BETWEEN DATETIME(t1.treatdate) AND DATETIME(t1.treatdate, '+2 month') GROUP BY t2.procedure) AS t3 WHERE t3.c1 <=",
0efae2c62f95516d380e6775,How much is the average total hospital bill when it includes a % hemoglobin a1c lab test in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.year = 2100 AND cost_table.lab_test = '% hemoglobin a1c' GROUP BY cost_table.year) AS t1,
5bc31e9ba087ef781c202f7d,What is the maximum total cost for the hospital when a transferrin lab test is involved?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'transferrin' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.item = 'transferrin lab' GROUP BY cost_table.patient_id) AS t1,
df5a70f5890755916496aef6,What is the number of ICU visits for patient 10006580.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ),SELECT COUNT(DISTINCT icu_visit_id) FROM icu_visits WHERE patient_id = 10006580,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
83ef051d3b1070d79701011f,What were the five most frequent output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT output FROM code ORDER BY COUNT(*) DESC LIMIT 5;,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
3f355b4c88735775a5eeacb2,What is the opiate dose recommended for patient 2518,,SELECT MAX(opiate_dose) FROM patient WHERE patient_id = 2518,
0caf055cee4dccc45176c275,How many patients last year were diagnosed with attention deficit disorder with hyperactivity?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",SELECT COUNT(DISTINCT patient.attention_deficit_disorder_with_hyperactivity) FROM patient WHERE patient.last_year = true,
ef8f70442734cae2d9b783a3,List the top three most common events since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT Event, COUNT(*) FROM (SELECT Event FROM Events WHERE Year >= 2100 GROUP BY Event ORDER BY COUNT(*) DESC LIMIT 3)","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
a6b9ade99c3cfb9b0eddcbec,"In 2100, how many patients received fluoroscopy of multiple coronary arteries using other contrast within the same hospital visit after being diagnosed with severe sepsis with septic shock?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'severe sepsis with septic shock' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.diagnosis_date, t2.hospital_location FROM (SELECT subject_id, diagnosis_date, hospital_location FROM (SELECT subject_id, CAST(diagnosis_date AS DATE) AS diagnosis_date, hospital_location FROM (SELECT subject_id, sepsis WITH septic shock FROM patients WHERE sepsis WITH septic shock = 1) AS t1 JOIN (SELECT subject_id, diagnosis_date, hospital_location FROM (SELECT subject_id, CAST(diagnosis_date AS DATE) AS diagnosis_date, hospital_location FROM (SELECT subject_id, CAST(diagnosis_date AS DATE) AS diagnosis_date, hospital_location FROM patients WHERE sepsis WITH septic shock = 1) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.diagnosis_date AND t1.hospital_location = t2.hospital_location) AS t3 GROUP BY t1.subject",
4613c69ff92c982ad6b0c73e,What was the weight of patient 10014729 first in the first hospital visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(weight) FROM patients WHERE patient_id = 10014729 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1,[]
ab0dc7cef40d44572a80367e,What is the minimum total hospital cost for a person with coronary atherosclerosis of autologous vein bypass graft since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.diagnosis = 'coronary atherosclerosis of autologous vein bypass graft' AND STRFTIME('%y', cost_table.date) >= '2100' GROUP BY cost_table.patient_id) AS t1",
1dbe09373cc9df99e58c1b27,Can anyone help me determine the code that corresponds to icd-11 and for preterm nec 2000-2499g in icd-10?,,SELECT icd_11 FROM sql_table WHERE icd_10 = 'preterm nec 2000-2499g';,
60fcfb33b6da12626f9c0ed4,"In the last hospital encounter, what was patient 10037861's age?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patient WHERE patient.id = 10037861 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1,
6d16d17d6f59ace9a2e0a9bd,How many patients were discharged since 1 year ago from hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",SELECT COUNT(DISTINCT patient_id) FROM notifications WHERE type = 'discharged' AND date >= (CURRENT_DATE - INTERVAL '1 year');,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
ac2e5b4fdd7c9a6ea505a929,What changes were made in the prescription of patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM prescriptions WHERE patient_id = 10004733 AND date = '2022-01-01',[]
426f5871dfa620cca1f14a84,Tell me the percentile for mcv of 89.0 among patients in the same age as patient 10020740 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 89.0",SELECT (SELECT percent_rank() OVER (ORDER BY (SELECT mcv FROM patients WHERE patients.age = (SELECT age FROM patients WHERE patient_id = 10020740 ORDER BY hospital_ encounter DESC LIMIT 1))) AS percentile,
fe3277e1cb0eca8a574478bb,"On the last hospital stay, what was patient 10007928's insurance plan?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance_plan FROM patients WHERE patient.stay_length = (SELECT MAX(stay_length) FROM patients WHERE patient.subject_id = 10007928),[{'insurance': 'Other'}]
8738512f4dab78e20d4a3a23,What are the three most frequently ordered laboratory tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.Test, COUNT(t1.Test) FROM (SELECT Test, YEAR(Date) AS year FROM Lab_Tests WHERE YEAR(Date) >= 2100) AS t1 JOIN Lab_Tests AS t2 ON t1.Test = t2.Test WHERE t1.year = t2.year GROUP BY t1.Test ORDER BY COUNT(t1.Test) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
6a7adc80e43e20c9c20e21aa,Tell me the name of the organism found in patient 10007795's last abscess microbiology tests in 05/this year?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT name FROM microbiology WHERE patient_id = 10007795 AND type = 'last abscess' AND date = '2005-01-01',[]
e07839bc9af48a037d0d54bb,"Among the patients of age 20s this year, what are the top four most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT * FROM patients WHERE age BETWEEN 20 AND 29) AS t1 JOIN (SELECT * FROM diagnoses) AS t2 ON t1.diagnosis = t2.diagnosis WHERE DATETIME(t1.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY diagnosis) AS t1 WHERE t1.c1 <= 4",
20c1cb7239a17a4dbbe96296,What was the total dosage of chlorpheniramine maleate prescribed to patient 10016810 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.drug = 'chlorpheniramine maleate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'","SELECT SUM(dosage) FROM prescriptions WHERE prescriptions.patient_id = 10016810 AND prescriptions.drug_name = 'Chlorpheniramine Maleate' AND DATETIME(prescriptions.date_prescribed, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date_prescribed) = '07';",[{'SUM(prescriptions.dose_val_rx)': None}]
7808f5d4ac9c6409be01f55f,What was the name of the prescription drug given to patient 10004235 in the same day after undergoing the simple excision of other lymphatic structure procedure since 07/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug_name FROM (SELECT patient.uniquepid, procedure.date FROM procedure JOIN patient ON procedure.patient_id = patient.uniquepid WHERE patient.uniquepid = 10004235 AND procedure.procedure_name = 'simple excision of other lymphatic structure' AND STRFTIME('%y-%m', procedure.date) >= '2100-07') AS t1 JOIN (SELECT patient.uniquepid, drug_name FROM drug JOIN patient ON drug.patient_id = patient.uniquepid WHERE patient.uniquepid = 10004235 AND STRFTIME('%y-%m', drug.date) >= '2100-07') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.date = t2.date",
3b9849548e56c59f768d5447,Tell me the minimum respiratory rate in patient 10021118 in the first ICU visit.,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ),SELECT MIN(respiratory_rate) FROM (SELECT respiratory_rate FROM icu_respiratory_rate WHERE icu_number = 1 AND patient_id = 10021118),[{'MIN(chartevents.valuenum)': None}]
051c19cebb0a8796d0c84043,"What are the three most frequently given lab tests for patients that were diagnosed with atrial fibrillation previously within the same month, in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'atrial fibrillation' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.id, lab_test, lab_date FROM lab WHERE STRFTIME('%y', lab_date) = '2100') AS t2 ON t1.id = t2.patient_id WHERE t1.diagnosis_date < t2.lab_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_date, 'start of month') GROUP BY t2.lab_test) AS t3 WHERE t3.c1 <= 3",
dcfb3bfb9c133a83a862251a,How should we disinfect the quarantine room?,,"SELECT * FROM ""schema"".""quarantine_room"" WHERE ""disinfecting_method"" = 'brackets';",
37c75c3b997199029b9998b4,Has patient 10004235 received any surgery?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ),SELECT COUNT(*) > 0 FROM surgery WHERE patient_id = 10004235;,[{'COUNT(*)>0': 1}]
b1cb5d3e6f5cc86239c34959,What is the maximum cost of a hospital that involves methicillin resistant pneumonia due to staphylococcus aureus since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(CASE WHEN staphylococcus_aureus.species = 'methicillin resistant pneumonia' THEN 1 ELSE 0 END) AS c1 FROM staphylococcus_aureus WHERE staphylococcus_aureus.strain = 'community' AND STRFTIME('%y', staphylococcus_aureus.date) >= '2100' GROUP BY staphylococcus_aureus.species) AS t1",
4f0a03f732e95fdcb15376f7,Calculate the total volume of input for patient 10005817 since 06/23/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'",SELECT SUM(volume) FROM input WHERE patient = 10005817 AND date >= '2100-06-23',[{'SUM(inputevents.totalamount)': 166435.0}]
c84cfe8470cb11125e4f78bc,"Get me the top five most frequent procedures that patients received during the same hospital visit after receiving extirpation of matter from left common iliac vein, percutaneous approach.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT COUNT(DISTINCT t1.Name) FROM (SELECT p.Name, t.Method, t.Year FROM patients p JOIN procedures t ON p.ID = t.PatientID WHERE t.Method = 'Extirpation of matter from left common iliac vein, percutaneous approach') AS t1 JOIN (SELECT p.Name, t.Method, t.Year FROM patients p JOIN procedures t ON p.ID = t.PatientID WHERE t.Method = 'Posterior fork') AS t2 ON t1.Name = t2.Name WHERE t1.Year = t2.Year GROUP BY t1.Name ORDER BY COUNT(DISTINCT t1.Name) DESC LIMIT 5",
aefb5d2e178ea9fa647cd5fe,Has patient 10000032 been given any procedure since 1 year ago?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10000032 AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
f1c637616d0c91843526eb96,"List the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d.diagnosis FROM (SELECT diagnosis, COUNT(diagnosis) AS cnt FROM (SELECT patient.uniquecarrier, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquecarrier WHERE treatment.treatment = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic') AS t1 JOIN (SELECT patient.uniquecarrier, diagnosis, diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquecarrier) AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosisdate) BETWEEN DATETIME(t1.treatmentdate) AND DATETIME(t1.treatmentdate, '+2 month') GROUP BY diagnosis) AS d ORDER BY d.cnt DESC LIMIT 5",
2c770acc2155effc3c66d286,When did patient 10017492 first get the urine's microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND microbiologyevents.spec_type_desc = 'urine' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT microbiology_test_date FROM microbiology_tests WHERE microbiology_test_type = 'urine' AND patient_id = 10017492 ORDER BY microbiology_test_date NULLS FIRST LIMIT 1;,[]
760fc9ca5ebd74a67d09783d,Is there any new medication in the prescription of patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT COUNT(*) > 0 FROM prescription WHERE prescription.patient_id = 10004733 AND DATETIME(prescription.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescription.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
e22e5a88ca77a9f96af45fd7,How many patients underwent insertion of intercostal catheter for drainage during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intercostal catheter for drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT patient.subject, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.subject WHERE procedures.procedure = 'Insertion of intercostal catheter for drainage' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')) AS t1 JOIN (SELECT patient.subject, procedures.date FROM procedures JOIN patient ON procedures.patient = patient.subject WHERE procedures.procedure = 'Insertion of intercostal catheter for drainage' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')) AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date",
911bb06c9471e1c057977c81,What medication was prescribed to patient 10006053 first time in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT medication FROM prescriptions WHERE patient_id = 10006053 AND STRFTIME('%y-%m', prescriptions.date) = '2100-11' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[]
f3249c1cae12b134951c017d,What's the average total hospital cost that includes a urea nitrogen lab test in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM lab_tests WHERE lab_tests.test_name = 'urea nitrogen' AND STRFTIME('%y', lab_tests.test_date) = '2100' GROUP BY lab_tests.patient_id) AS t1",
fa3f52c79b018b43a9e8090a,Can you list the single rooms that are available today?,,SELECT DISTINCT room FROM rooms WHERE room_type = 'single' AND available = 'true';,
4a41f13171a4d40a9cb9e53b,How many times did the hemodialysis procedure take place?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ),SELECT COUNT(*) FROM procedures WHERE procedures.name = 'hemodialysis';,[{'COUNT(*)': 0}]
dcf9ab0261c9713de6f8dab0,Is the value of respiratory rate of patient 10023239 last measured on the last ICU visit greater than the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
b04265d8d305b0cccc5d7d67,Did patient 10025463 undergo a chloride test during the last hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10025463 AND lab_results.chloride IS NOT NULL AND lab_results.chloride <> '' AND lab_results.patient_id IN (SELECT patient_id FROM patient WHERE patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1),[{'COUNT(*)>0': 0}]
b30404be1d0cdffef60e38c6,"In 08/2100, when did patient 10021312 last receive a creatinine test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08' ORDER BY labevents.charttime DESC LIMIT 1",SELECT MAX(Creatinine_Date) FROM Creatinine_Test WHERE Patient_ID = 10021312 AND Creatinine_Date BETWEEN '2008-02-11' AND '2008-12-31',[]
0406ba9fa1c3ada7f76965a3,What was the name of the last medication that was prescribed to patient 10039708?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT medication_name FROM medication_history WHERE patient_id = 10039708 ORDER BY date DESC LIMIT 1;,[{'drug': 'Lactulose'}]
0f7b20f0c3c6fb3264a2cc98,When did patient 10038933 get inputs for the first time on 09/22/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-22' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT inputs.input_date FROM inputs WHERE inputs.patient_id = 10038933 AND STRFTIME('%y-%m-%d', inputs.input_date) = '2100-09-22' ORDER BY inputs.input_date NULLS FIRST LIMIT 1;",[]
6c0d7988692dd2731863ec96,Have patient 96429s ever suffered any side effects from blood transfusions?,,SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 96429 AND diagnoses.side_effects = 'side effects from blood transfusions',
764c1ad18155aabf053779ab,What was the first drug that was prescribed to patient 10027602 during this month via the po/ng route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT po_ng FROM pharmacy WHERE pharmacy.patient_id = 10027602 AND DATETIME(pharmacy.date_prescribed, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month') ORDER BY pharmacy.date_prescribed NULLS FIRST LIMIT 1",[]
39cc7a512a66650e91459e27,When did patient 10005348 get the microbiology test for the last time since 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT microbiology.date FROM microbiology WHERE microbiology.patient_id = 10005348 AND STRFTIME('%y-%m', microbiology.date) >= '2100-07' ORDER BY microbiology.date DESC LIMIT 1",[{'charttime': '2130-10-27 17:02:00'}]
c5f0f757c748ca958da5182f,What was the name of the output which patient 10039831 had for the last time today?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND datetime(outputevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT SELECT output_name FROM duckdb_outputs WHERE patient_id = 10039831 AND date_sub('day', CURRENT_TIMESTAMP, last_modified) = 0",[]
470559b06a3cc6cf01345c4a,"For patients who were previously diagnosed with fibromyalgia, what are the top three most frequent treatments within the same month in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fibromyalgia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, t2.date FROM (SELECT patient.name, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient = patient.name WHERE diagnosis.diagnosis = 'fibromyalgia') AS t1 JOIN (SELECT patient.name, treatment.treatment, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.name WHERE STRFTIME('%y', treatment.date) = '2100') AS t2 ON t1.name = t2.name WHERE t1.date < t2.date AND DATETIME(t1.date, 'start of month') = DATETIME(t2.date, 'start of month') GROUP BY t3.treatment) AS t3 WHERE COUNT(t3.treatment) > 3",
af1b692aa2f8340f719c17fe,"Among patients diagnosed with lens replaced by other means , what are the top four most common lab tests that followed afterward during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'lens replaced by other means' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.LabTest, COUNT(t3.LabTest) FROM (SELECT t2.LabTest, t2.Month FROM (SELECT DATE '2022-01-01' AS Date, LabTest FROM (SELECT 'Lens Replaced by Other Means' AS LabTest, 24 AS Month FROM dual) AS t1 JOIN (SELECT DATE '2022-01-01' + INTERVAL 1 MONTH * d.months AS Date, LabTest, 24 AS Month FROM dual) AS t2 ON t1.LabTest = t2.LabTest) AS t3 JOIN (SELECT COUNT(LabTest) AS months FROM t2 GROUP BY LabTest) AS d ON t3.LabTest = d.LabTest GROUP BY t3.LabTest ORDER BY COUNT(t3.LabTest) DESC LIMIT 4",
0ac5e8c127eb6f8f74e5d260,Total number of patients who had arteriography of cerebral arteries in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.patienttype = 'arteriography of cerebral arteries' AND DATETIME(patient.diagnosisdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
1bbc56c2fd1aad4535efd121,What was the top five most frequent diagnoses that patients were diagnosed with within the same month after receiving hemodialysis?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.name, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE treatment.treatment_type = 'hemodialysis') AS t1 JOIN (SELECT patient.name, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id) AS t2 ON t1.name = t2.name WHERE t1.treatment_date < t2.diagnosis_date AND DATETIME(t1.treatment_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 5",
c5d9d0626f74f9062b8f7509,What were the top four most frequent specimens ordered for patients after being diagnosed with hesitancy of micturition during the same hospital visit?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hesitancy of micturition' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT t1.subject, t1.diagnosis, t2.specimen, COUNT(t2.specimen) FROM (SELECT STATUS, DIAGNOSIS, SPECIMEN FROM diagnosis_table WHERE DIAGNOSIS = 'HESITANCY OF MICTURITION') AS t1 JOIN specimen_table AS t2 ON t1.subject = t2.subject GROUP BY t2.specimen) AS t3 GROUP BY t3.specimen) AS t4 WHERE t4.count > 4 GROUP BY t4.specimen",
cc6cddf1a72c4c14b010fdf1,What are the the single rooms that are available now?,,SELECT * FROMRooms WHERE roomType = 'single' AND isAvailable = true;,
2ba80682f1e2b0050e0acece,What are the three most common specimen tests that occurred since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(specimen) FROM brackets WHERE date > CURRENT_DATE - INTERVAL '1 year' GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
dc5d5f941a6b2d27b4856352,When was the last time of input time of patient 10004720 since 08/08/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-08' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10004720 AND input_time >= '2100-08-08',[{'starttime': '2186-11-17 15:29:00'}]
a13c273dcddfa537845c91d0,What medication was last given to patient 10038933?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ORDER BY prescriptions.starttime DESC LIMIT 1,,[{'drug': 'Heparin Flush (10 units/ml)'}]
e2b25103644606a2debc3586,When was the last time that patient 10038933 was prescribed medication in 09/this year via the ih route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'ih' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(oh_current_date) FROM medication_usage WHERE patient_id = 10038933 AND route = 'ih' AND prescription_date BETWEEN '2009-01-01' AND '2009-12-31',[]
d9ff976abef3224333ca77ba,Please inform me of all the prescriptions patient 8888 received in another department.,,SELECT prescriptions FROM patients WHERE department = 'another department' AND patient_id = 8888,
4805f5b946dd24bdc7c044c0,What are the four frequently ordered medications for patients diagnosed with paralytic ileus previously within the same month?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paralytic ileus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'paralytic ileus') AS t1 JOIN (SELECT patient.uniquepid, medication.medication, medication.medication_date FROM medication JOIN patient ON medication.patient_id = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.medication_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.medication_date, 'start of month') GROUP BY t2.medication) AS t3 WHERE t3.c1 <= 4",
103610582e111db3b8138c85,What's the cost to get replacement of stent (tube) in biliary or pancreatic duct?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of stent (tube) in biliary or pancreatic duct' ) ),"SELECT DISTINCT cost FROM replacements WHERE replacement_name = ""stent (tube) in biliary or pancreatic duct""",
55a91f4eaa637abafc6b75b7,What is the method of disinfection in the quarantine room?,,SELECT * FROM sanitization WHERE location = 'quarantine room';,
32e5482d088de481d141565d,Can you tell me the maximum heart rate for patient 10018081's body on 12/29/this year?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29'",SELECT MAX(heart_rate) FROM body WHERE patient_id = 10018081 AND date = '12/29/this year',[{'MAX(chartevents.valuenum)': None}]
7fa8d89115dcb79bd3b9d8b6,"How many patients received (aorto)coronary bypass of two coronary arteries treatment within the same month after being diagnosed with congestive heart failure, unspecified since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of two coronary arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_with, month(diagnosed_date) as diagnosed_month FROM (SELECT subject_id, diagnosed_with, diagnosed_date FROM (SELECT subject_id, congestive_heart_failure, diagnosed_date FROM (SELECT subject_id, coronary_bypass, diagnosed_date FROM (SELECT subject_id, aortocoronary_bypass, diagnosed_date FROM (SELECT * FROM (SELECT subject_id, heart_failure, diagnosed_date FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT *",
dc05a582149cb9a35f095c0b,What were the top four diagnoses of patients with age 20s in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,
6b81072250740cd9e14626a0,Do you know the ward id of patient 10624 to which they are admitted?,,SELECT ward_id FROM admissions WHERE patient_id = 10624,
018d243f5ca33716687af47d,Number of patients who received a other electric countershock of heart procedure.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ),SELECT COUNT(DISTINCT patient_id) FROM procedures WHERE procedure_name = 'Other electric countershock of heart';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ec6751ca286066dda72e0c84,"Was in their last hospital visit 0.9% sodium chloride, docusate sodium (liquid), or sertraline prescribed to patient 10016742?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( '0.9% sodium chloride', 'docusate sodium (liquid)', 'sertraline' )","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10016742 AND prescriptions.drug IN ('0.9% Sodium Chloride', 'Docusate Sodium (Liquid)', 'Sertraline')",[{'COUNT(*)>0': 0}]
f2545d14686ea54127cc9c44,Has patient 10003046 been given any medication since 01/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01'",SELECT COUNT(*) > 0 FROM medication_usage WHERE patient_id = 10003046 AND date_since = '2000-01-2100',[{'COUNT(*)>0': 1}]
465aed14cf9939565ad6d4cc,How many times was a other endovascular procedures on other vessels procedure conducted since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.type = 'other endovascular procedures on other vessels' AND STRFTIME('%y', procedures.date) >= '2100'",
a960378edd7b28956a92d2bb,What was the drug that patient 10025463 was prescribed with during the same day after the catheter based invasive electrophysiologic testing?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.drug FROM (SELECT patient.subject_id, catheter_based_invasive_electrophysiologic_testing.date FROM patient INNER JOIN catheter_based_invasive_electrophysiologic_testing ON patient.subject_id = catheter_based_invasive_electrophysiologic_testing.patient_id WHERE patient.subject_id = 10025463) AS t1 JOIN (SELECT patient.subject_id, prescribing.drug FROM patient INNER JOIN prescribing ON patient.subject_id = prescribing.patient_id WHERE patient.subject_id = 10025463) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date = t2.date",
db84c0e7a45cffa783b0950f,What was the last arterial blood pressure systolic in patient 10020187's body on 02/04/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-02-04' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(arterial_blood_pressure_systolic) FROM patient_10020187 WHERE date_of_measurement = '02/04/2100',[]
4f0abb317b82d6a5f186ef14,Present the count of ICU visits for patient 10021118 in the first hospital encounter.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(DISTINCT icu_visits) FROM visit_details WHERE patient_id = 10021118 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime NULLS FIRST LIMIT 1;,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
fb14ee1d9363c64de1cb8c84,Find out the number of hospital visits patient 10009628 had since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10009628 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(DISTINCT HOSP_VISIT) FROM hospital_visits WHERE PATIENT_ID = 10009628 AND STRFTIME('%y', HOSP_VISIT_DATE) >= '2100';",[{'COUNT( DISTINCT admissions.hadm_id )': 1}]
3c7e00141c354983c6fb8742,What medication was first given to patient 10014729?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ORDER BY prescriptions.starttime ASC LIMIT 1,,[{'drug': 'Milk of Magnesia'}]
084fbed97d37b17fe3de08f7,When did patient 10010471 first receive an input since 12/11/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-11' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(date_input) FROM input_table WHERE patient_id = 10010471 AND date_input >= '2100-12-11',[{'starttime': '2155-12-02 20:54:00'}]
015be3d8662ca93c5c0bab0b,Did patient 10015272 receive any disease diagnoses in the last hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10015272 AND diagnoses.dischtime IS NULL,[{'COUNT(*)>0': 1}]
8a4a4c79371999b9915a2ef3,How much does acute on chronic diastolic heart failure cost to get diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic heart failure' ) ),SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = 'acute on chronic diastolic heart failure';,
d048cd029e1afe980ed96d08,Could you inform me about patient 10020187's last arterial blood pressure systolic on 02/04/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-04' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT COUNT(DISTINCT TIMESTAMP '2022-04-02 12:30:00') FROM systolic_arterial_blood_pressure WHERE patient_id = 10020187,[]
54ce172ad4dee0a2a6d24cd0,But does patient 11426 have an appointment in other department?,,SELECT COUNT(*) FROM appointment WHERE appointment.patient_id = 11426 AND appointment.department_id <> (SELECT department_id FROM patient WHERE patient.name = 'John Doe'),
5565327861ed5fcac13b11e2,"How many times was introduction of other thrombolytic into central vein, percutaneous approach carried out this year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM procedures WHERE procedures.route = 'central vein, percutaneous approach' AND procedures.date BETWEEN '2015-01-01' AND '2015-12-31' AND procedures.method = 'introduction of other thrombolytic'",
55952982603c114a5b29a8b0,"What are the four commonly ordered medications for patients who were diagnosed with other and unspecified alcohol dependence, in remission previously during the same hospital encounter, since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t3.name FROM (SELECT t2.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date, patient.hospital_name FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Other and unspecified alcohol dependence' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.id, medication.name, medication.order_date, patient.hospital_name FROM medication JOIN patient ON medication.patient_id = patient.id WHERE STRFTIME('%y', medication.order_date) >= '2100') AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.order_date AND t1.hospital_name = t2.hospital_name GROUP BY t2.name) AS t3 WHERE t3.c1 <= 4",
95c5860371dc9446921eec10,What's the minimum total cost of the hospital visits that included a drug called fentanyl citrate since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl citrate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.total_cost) FROM (SELECT SUM(ci.cost) AS total_cost FROM cost_info ci JOIN patient_visits pv ON ci.patient_id = pv.patient_id JOIN prescriptions pr ON ci.prescription_id = pr.prescription_id WHERE pr.drug_name = 'fentanyl citrate' AND pv.visit_year >= 2100 GROUP BY ci.patient_id) AS t1,
c35347e6b1dda9ed6764a067,Could you tell me the last o2 saturation pulseoxymetry value that patient 10039831 had since 12/30/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-30' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(O2_SATURATION_PULSEOXYMETRY) FROM pulse_oxymetry WHERE patient_id = 10039831 AND measurement_date >= '2100-12-30',[]
6f8a9ea4d83dea4c52af5a4b,Was patient 10004422 on their first hospital visit given a mchc lab test?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM lab_data WHERE lab_data.patient_id = 10004422 AND lab_data.label = 'mchc' AND lab_data.date_of_lab = (SELECT MIN(date_of_lab) FROM lab_data WHERE lab_data.patient_id = 10004422),[{'COUNT(*)>0': 0}]
f6875e17c4dd27a3b3e56653,How many times did patient 10017492 attend the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10017492 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM attendance WHERE patient_id = 10017492 AND DATETIME(date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 2}]
6d037a4951c5f57d0e001cee,"What was the name of the medicine that was given to patient 10038999 within 2 days post procedure of drainage of left pleural cavity, percutaneous approach in 06/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.id WHERE patient.id = 10038999 AND treatment.date BETWEEN '2006-01-01' AND '2006-12-31' AND treatment.type = 'drainage of left pleural cavity, percutaneous approach') AS t1 JOIN (SELECT patient.id, medicine.name FROM medicine JOIN patient ON medicine.patient = patient.id WHERE patient.id = 10038999 AND DATETIME(medicine.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND DATETIME(medicine.date, 'start of month') = DATETIME(CURRENT_DATE, 'start of month', '-0 month')) AS t2 ON t1.id = t2.id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME",
d6f34e43fb6592a8c64d3f94,Has patient 10019917 been checked into the hospital since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019917 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",SELECT COUNT(*) > 0 FROM checkin_table WHERE patient_id = 10019917 AND checkin_date >= (CURRENT_DATE - INTERVAL '1 year'),[{'COUNT(*)>0': 1}]
93a6f19b82de2d952049362e,When did patient 10006053 get a microbiology test for the last time?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT MAX(microbiology_date) FROM microbiology WHERE patient_id = 10006053,[{'charttime': '2111-11-14 17:15:00'}]
fecffb251c3f41feb07c69c7,When was the first input time of patient 10001217 since 06/03/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-03' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10001217 AND input_time >= '2100-06-03',[{'starttime': '2157-11-20 19:32:00'}]
67d324104c936264768323f1,"When was the first time that patient 10036156 was tested for creatine kinase, mb isoenzyme on the last hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1",,[]
f7dca6ca66a468ed7f41631a,What is the maximum monthly number of people diagnosed with obstructive sleep apnea (adult)(pediatric) in this year?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'obstructive sleep apnea (adult)(pediatric)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MAX(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis.patient_id) AS c1 FROM diagnosis WHERE diagnosis.diagnosis = 'obstructive sleep apnea (adult)(pediatric)' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY STRFTIME('%y-%m', diagnosis.diagnosis_date)) AS t1",
61f316cdde3e8b077f86a486,How old was patient 10003400 during their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patient WHERE patient.id = 10003400 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime DESC LIMIT 1;,
7f9576332062c59f8d3332f3,How much does patient 10021118 weigh based on the last measurement since 13 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-13 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT SUM(weight_kg) FROM patients WHERE patient_id = 10021118 AND measurement_date >= DATEADD(month, -13, CURRENT_DATE)",[]
9043871db343ad385db09772,When did patient 10010471's first microbiological test occur since 1 month ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM microbiology WHERE patient_id = 10010471 AND date > (CURRENT_DATE - INTERVAL '1 month'),[{'charttime': '2155-12-03 19:58:00'}]
759aa16667e44e03f4caba14,When did patient 10011398 get input for the last time since 12/19/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT MAX(brackets.current_time) FROM brackets WHERE brackets.patient_id = 10011398 AND STRFTIME('%y-%m-%d', brackets.current_time) >= '2100-12-19'",[{'starttime': '2146-12-16 08:00:00'}]
36d78a53fb451b1de2c95f2f,How many patients in this year were discharged from the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(DISTINCT patient_id) FROM hospital_discharge WHERE date_discharge BETWEEN '2022-01-01' AND '2022-12-31';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
876f65e64154a3d0ee436ad3,Is patient 10008454's o2 saturation pulseoxymetry second measured on the last ICU visit less than the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT o2_saturation_pulseoxymetry FROM icu_o2_saturation WHERE icu_oid = (SELECT icu_oid FROM icu_management WHERE patient_oid = 10008454 AND NOT icu_management.outbound = 0 ORDER BY icu_management.admission_date DESC LIMIT 1) AND NOT icu_o2_saturation.outbound = 0 ORDER BY icu_o2_saturation.measurement_date DESC LIMIT 1) < (SELECT o2_saturation_pulseoxymetry FROM icu_o2_saturation WHERE icu_oid = (SELECT icu_oid FROM icu_management WHERE patient_oid = 10008454 AND NOT icu_management.outbound = 0 ORDER BY icu_management.admission_date DESC LIMIT 1) AND NOT icu_o2_saturation.outbound = 0 ORDER BY icu_o2_saturation.measurement_date NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
0142fefc91ec6884f43de80b,What is the code in icd-10 that corresponds to icd-11 for voice/resonance dis nec?,,SELECT icd_10 FROM icd_11 WHERE icd_11 = 'voice/resonance dis nec',
85d31f9d8735d20c26163c0b,How many patients were diagnosed since 1 year ago with chronic systolic (congestive) heart failure?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic (congestive) heart failure' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.diagnosis LIKE '%chronic systolic (congestive) heart failure%' AND DATETIME(patient.diagnosis) >= DATETIME(CURRENT_TIME, '-1 year')",
34324beee54e081e5e88f130,Was any platelets given to patient 10006053 in 11/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'platelets' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-11'",SELECT COUNT(*) FROM input WHERE patient_id = 10006053 AND input_date = '11/2100' AND platelet_count > 0,[{'COUNT(*)>0': 0}]
e2ce9bb566451b1c9b9ba7ee,What is the total volume of patient 10027602's input on this month/02?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '02'",SELECT SUM(input) FROM input WHERE patient_id = 10027602 AND input_date = '2022-04-02',[{'SUM(inputevents.totalamount)': None}]
b663ddcb1000b3c27f988cc2,Calculate the number of patients prescribed acetylcysteine 20%.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine 20%' ),SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE prescription_name = 'Acetylcysteine 20%',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
60e23877ec81a6c1b852706e,When pantoprazole and vial were prescribed to patient 10021312 for the first time at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10021312 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND admissions.subject_id = 10021312 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10021312 AND medication.drug_name = 'Pantoprazole' INTERSECT SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10021312 AND medication.drug_name = 'Vial',[]
66415948d667e13324c3969a,How much difference is there in creatinine levels among patient 10021938 last measured on the first hospital visit compared to the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab_values FROM lab_data WHERE lab_data.patient_id = 10021938 AND NOT lab_data.hospital_visit_number IS NULL ORDER BY lab_data.measurement_date DESC LIMIT 1) - (SELECT lab_values FROM lab_data WHERE lab_data.patient_id = 10021938 AND NOT lab_data.hospital_visit_number IS NULL ORDER BY lab_data.measurement_date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
28f850662f724d2a12bab092,"Among patients diagnosed with essential (primary) hypertension, what are the top five most common lab tests conducted in the same hospital encounter in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential (primary) hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t1.LabTest, COUNT(t1.LabTest) FROM (SELECT t.LabTest, t.hadm_connecting_diagnosis.diagnosis_date, t.hadm_connecting_diagnosis.hadm_id FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis_name = ""ESSENTIAL (PRIMARY) HYPERTENSION"") AS t GROUP BY t.LabTest) AS t1 JOIN (SELECT admissions.subject_id, diagnoses.diagnosis_date, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis_name = ""ESSENTIAL (PRIMARY) HYPERTENSION"") AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date = t2.diagnosis_date AND t1.",
11b773ce5f673720f4ff1cd9,Has patient 10009628 experienced any procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10009628 AND STRFTIME('%y', procedures.date) >= '2100'",
02fe4d0195664f0dc082a343,What are the top three common microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t.test_name, COUNT(t.test_name) AS count FROM microbiology_tests t GROUP BY t.test_name ORDER BY Count DESC LIMIT 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]"
327c193923b31d4de7547a06,Tell me the five most common lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT lab_tests FROM brackets_lab WHERE lab_tests IS NOT NULL GROUP BY lab_tests ORDER BY COUNT(*) DESC LIMIT 5,"[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
64b39620ce3e1a170ffb4a84,Could you provide me with the three most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",SELECT event FROM output WHERE date > '2016-01-01' GROUP BY event ORDER BY COUNT(*) DESC LIMIT 3,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
92ec6272af144fdb3b7740bd,What is the minimum total cost of hospitalization that includes the parathyroid hormone laboratory test in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'parathyroid hormone' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE test_name = 'parathyroid hormone laboratory' AND year = 2100 GROUP BY patient_id) AS t1,
71b139cfa31f5f0c28ac7223,When was the last mrsa screen microbiology test performed in 11/2100 for patient 10027602?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date) FROM microbiology_screen WHERE patient_id = 10027602 AND screen_type = 'mrsa screen microbiology' AND date BETWEEN '2000-11-21' AND '2000-11-21',[]
27f061fabd9f7d2e99e832c3,Give me the total amount of dextrose 5% given to patient 10021487 since 10/04/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-04'","SELECT COUNT(DISTINCT ""dextrose 5%"") FROM ""patient_10021487"" WHERE ""date"" >= '2010-04-2100'",[{'SUM(inputevents.totalamount)': None}]
41f819d9fd8944e5602a6279,"Tell me the maximum total hospital cost that involved venous catheterization, not elsewhere classified in 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.total_hospital_cost) FROM (SELECT SUM(T2.hospital_cost) AS total_hospital_cost FROM (SELECT 3 AS hospital_cost FROM services WHERE service_name = 'venous catheterization, not elsewhere classified') AS T2 JOIN (SELECT 1 AS total_hospital_cost FROM accounts WHERE account_name = '2100') AS T1 ON T1.account_number = T2.account_number) AS T1;",
67cfd4b9ba04c04a487ec39f,What are the precautions after the spinal canal explor nec procedure?,,"SELECT ""precautions"" FROM procedures WHERE ""procedure"" = 'spinal canal explor nec';",
a5af87eb9da16c85cfe6ddb7,Has there been any organism observed in patient 10007795's last blood culture ( myco/f lytic bottle) microbiology test on the first hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,,[{'COUNT(*)>0': 0}]
0e1a076c06d4a3c6b66107e3,What's the maximum total cost of the hospital visits that involve a procedure called arteriography of femoral and other lower extremity arteries since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(Cost) AS c1 FROM Visits WHERE Visits.Procedure = 'Arteriography of femoral and other lower extremity arteries' AND DATETIME(Visits.Visit_Date) >= DATETIME(CURRENT_DATE, '-1 year') GROUP BY Visits.Patient_ID) AS t1",
c3b19c4c394c0f1b38639a43,Can you tell how many times patient 10021938 visited the ICU this year?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(DISTINCT patient_id) FROM icu_visits WHERE patient_id = 10021938 AND DATETIME(icu_visits.visit_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}]
73bfff1ea31aa4d903100d70,What is the code which corresponds to the icd-11 for cerebral edema in icd-10?,,SELECT icd_11 FROM icd_tables WHERE icd_10 = 'cerebral edema';,
7d9cdd88b75501b509687396,Calculate the number of patients who were discharged from the hospital since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, current_time(date) AS current_time FROM patients WHERE current_time(date) >= '2100-01-01') AS t1 JOIN (SELECT subject_id, current_time(date) AS current_time FROM patients WHERE current_time(date) >= '2100-01-01') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.current_time < t2.current_time",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
5205a0314efeddff42fe6437,"What were the top three most common procedures that occurred during the same hospital encounter for patients who had extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic before since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.code FROM (SELECT t2.code, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' AND DATETIME(treatment.treatmenttime) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, treatment.code, treatment.treatmenttime, patient.patientname FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE DATETIME(treatment.treatmenttime) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.treatmenttime AND t1.patientname = t2.patientname GROUP BY t2.code) AS t3 WHERE t",
5768b3ec354138c3fd79bb7f,"What is the maximum total hospital cost for a patient suffering from acute edema of lung, unspecified since 1 year ago?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute edema of lung, unspecified' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.patient_name = 'acute edema of lung, unspecified' AND DATETIME(cost_table.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY cost_table.patient_name) AS t1",
585b1a785327dcf93085897b,How much does a medication called clobetasol propionate 0.05% ointment cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clobetasol propionate 0.05% ointment' ),SELECT DISTINCT cost FROM medication WHERE name = 'Clobetasol Propionate 0.05% Ointment',
7fd127de8b5bc25c0ca5a31b,Can you find the five most frequent drugs that were prescribed within the same hospital visit after a cachexia diagnosis was given since 1 year ago?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT admissions.subject_id, diagnoses.diagnosis_date FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'CACHEXIA' AND DATETIME(diagnoses.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT admissions.subject_id, prescriptions.drug, prescriptions.prescription_date FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE DATETIME(prescriptions.prescription_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.prescription_date AND DATETIME(t2.prescription_date) BETWEEN DATETIME(t1",
e8debe591ef7f4b4639bad49,When did patient 10031404 since 07/04/2100 for the first time have an input?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT input FROM input_table WHERE patient = 10031404 AND input_date >= '2100-07-04' ORDER BY input_date NULLS FIRST LIMIT 1,[{'starttime': '2113-08-04 19:00:00'}]
21a13676c67585e41b8f6a67,Dosage of opioid prescribed for patient 8116?,,SELECT SUM(opioid_dosage) FROM prescriptions WHERE prescriptions.patient_id = 8116,
e1a802bbddcfa313978c2d4b,Can you get me the top four diagnoses that have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT T4.diagnosis, T3.c1, T3.c2, T3.c3 FROM (SELECT T2.diagnosis, T2.c1, T2.c2 FROM (SELECT T1.diagnosis, T1.c1, T1.c2 FROM (SELECT 'diabetes with renal & microscopic support' AS diagnosis, 0.055 AS c1, 0.035 AS c2 FROM grades WHERE grade = 'top four') AS T1 GROUP BY T1.diagnosis) AS T2 JOIN (SELECT T4.diagnosis, 3 AS c3 FROM (SELECT 'diabetes with renal & microscopic support' AS diagnosis, 0.055 AS c1, 0.035 AS c2 FROM grades WHERE grade = 'top four') AS T4 GROUP BY T4.diagnosis) AS T3 ON T2.diagnosis = T3.diagnosis WHERE T2.c1 = T3.c1 ORDER BY T3.c3 DESC LIMIT 1",
e36f6d845834296a2ace08cd,How much is the average total cost of a hospital that involves a drug named tobramycin sulfate since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE name = 'tobramycin sulfate' AND year >= 2100 GROUP BY cost) AS t1,
a4914a96d11642f0050fc3d3,Tell me the three most common diagnosis.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",SELECT diagnosis FROM patients GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 3,"[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]"
707f754d71d05322bf6f1082,When did since 04/2100 patient 10000032 take the last microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT date FROM microbiology WHERE patient = 10000032 AND date >= '2004-02-10' ORDER BY date DESC LIMIT 1,[{'charttime': '2180-08-06 20:35:00'}]
0f3620b0b09198874571d19d,List the top four most frequent microbiology tests given to patients after being diagnosed with presence of cardiac pacemaker in the same month.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'presence of cardiac pacemaker' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t4.Microbiology, COUNT(t4.Microbiology) FROM (SELECT t3.Microbiology, COUNT(t3.Microbiology) FROM (SELECT t2.Microbiology, COUNT(t2.Microbiology) FROM (SELECT t1.Microbiology, COUNT(t1.Microbiology) FROM (SELECT NULL AS Microbiology) AS t1 JOIN (SELECT NULL AS Microbiology) AS t2 ON t1.Microbiology = t2.Microbiology WHERE t1.Microbiology = t2.Microbiology GROUP BY t1.Microbiology) AS t3 JOIN (SELECT NULL AS Microbiology) AS t4 ON t3.Microbiology = t4.Microbiology WHERE t3.Microbiology = t4.Microbiology GROUP BY t4.Microbiology) AS t5 WHERE t5.Microbiology = 'A' AND DATETIME(t5.Diagnosis, 'start of month') = DATETIME(t4.Diagnosis, 'start of month') GROUP BY",
d2b11a845b1f86d3c1436906,Can you tell me when patient 10020944 had their first stool microbiology test since 13 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND microbiologyevents.spec_type_desc = 'stool' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-13 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(StoolMicrobiologyDate) FROM StoolMicrobiology WHERE PatientID = 10020944 AND StoolMicrobiologyDate > (CURRENT_DATE - INTERVAL '13 month'),[]
256fd3ca11317b9a7e82835b,When is the earliest scheduled hospital visit by patient 91249?,,SELECT MIN(hospital_visit_date) FROM scheduled_hospital_visits WHERE patient_id = 91249;,
71d04374ffadf723feb6a4f5,When are dr. ford's rounds and procedures?,,"SELECT r.round, p.procedure FROM (SELECT d.date FROM dr.ford d WHERE d.round = 'Round 1') r JOIN procedures p ON r.round = p.round",
801278f003c473902d05fa06,Calculate the total amount of foley of patient 10005909 since 122 days ago.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-122 day')",SELECT SUM(foley) FROM patients WHERE patient_id = 10005909 AND date > CURRENT_DATE - INTERVAL '122' DAY,[{'SUM(outputevents.value)': None}]
d126628b6dfa7ff021c37cc5,"Since 06/2100, when did patient 10039831 receive the first mrsa screen microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT microbiology_test_date FROM lab_results WHERE patient_id = 10039831 AND lab_test = 'mrsa screen microbiology' AND microbiology_test_date >= '2006-02-11' ORDER BY microbiology_test_date NULLS FIRST LIMIT 1,[]
28146fa3c758abba5cbdbfae,"How much is the total average cost for a hospital that includes a osmolality, measured lab test since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(cost) FROM (SELECT SUM(cost) AS cost FROM lab_data WHERE lab_data.hospital_id = 1 AND lab_data.test_name = 'osmolality, measured' AND STRFTIME('%y', lab_data.date) >= '2100' GROUP BY lab_data.hospital_id) AS subquery",
861e1a2621058a2c9affd693,"Among patients who were administered extracorporeal circulation auxiliary to open heart surgery since 1 year ago, what were the top five most common treatments that they received during the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, heart.heart_open_date FROM heart JOIN patient ON heart.patient_id = patient.uniquepid WHERE heart.heart_open_date >= DATEADD(YEAR, -1, CURRENT_DATE)) AS t1 JOIN (SELECT patient.uniquepid, treatment.treatment, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.uniquepid WHERE treatment.treatment_date >= DATEADD(YEAR, -1, CURRENT_DATE)) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.heart_open_date < t2.treatment_date AND DATETIME(t1.heart_open_date, 'start of month') = DATETIME(t2.treatment_date, 'start of month') GROUP BY t2.treatment) AS t3 WHERE t3.c1 <= 5",
b90455e3cd10a2bcfe8f3419,What were the four frequent output events that occurred since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT Event, COUNT(*) FROM (SELECT * FROM output WHERE timestamp >= (SELECT current_timestamp - INTERVAL '1 year')) GROUP BY Event ORDER BY COUNT(*) DESC LIMIT 4;","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]"
1ed10993a5584026aae83537,What was the last urea nitrogen lab value for patient 10002428 since 02/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-02' ORDER BY labevents.charttime DESC LIMIT 1",SELECT MAX(lab_value) FROM lab WHERE lab_name = 'urea nitrogen' AND patient_id = 10002428 AND date_value >= '02/2100',[]
a169e91c54eaa5ebbdb895e6,How much does patient 10008287's systolic blood pressure differ from the last value measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT systolic_blood_pressure FROM icu_systolic_blood_pressure WHERE icu_systolic_blood_pressure.icu_id IN (SELECT icu_id FROM icu WHERE patient_id = 10008287) AND NOT icu_systolic_blood_pressure.last_measurement IS NULL ORDER BY icu_systolic_blood_pressure.measurement_time NULLS FIRST LIMIT 1) - (SELECT systolic_blood_pressure FROM icu_systolic_blood_pressure WHERE icu_systolic_blood_pressure.icu_id IN (SELECT icu_id FROM icu WHERE patient_id = 10008287) AND NOT icu_systolic_blood_pressure.last_measurement IS NULL ORDER BY icu_systolic_blood_pressure.measurement_time NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
975040b9662968e36fedac64,What were the five most common lab tests given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT lab_test FROM lab_results GROUP BY lab_test ORDER BY COUNT(*) DESC LIMIT 5;,"[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]"
4b57287bb27a24b3ea3db358,Is it patient 10008454's arterial blood pressure systolic last measured on the first ICU visit less than second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT systolic FROM (SELECT arterial_blood_pressure FROM icu WHERE icu_id IN (SELECT icu_id FROM patient WHERE patient_id = 10008454) AND NOT icu_visit_number = 1) AS systolic GROUP BY systolic ORDER BY systolic DESC LIMIT 1) < (SELECT systolic FROM (SELECT arterial_blood_pressure FROM icu WHERE icu_id IN (SELECT icu_id FROM patient WHERE patient_id = 10008454) AND NOT icu_visit_number = 1) AS systolic GROUP BY systolic ORDER BY systolic DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
4b4a86909d0c7240eeb9f9f2,What were the three most commonly performed lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT t.name FROM lab_tests t WHERE DATETIME(t.last_performance_date) >= DATETIME(CURRENT_DATE, '-1 year') GROUP BY t.name ORDER BY COUNT(*) DESC LIMIT 3","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
bc72b33b40a0a574955d98e6,What are the ways to consume metformin (glucophage)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'metformin (glucophage)',"SELECT DISTINCT ON (pathway) pathway, mechanism, reactants, products FROM metabolism WHERE product = 'metformin (glucophage)' ORDER BY pathway;",[]
be48ba72929ed97720c91848,What was the first time in 08/this year patient 10016742 had the maximum absolute eosinophil count value?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '08' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT MAX(absolute_eosinophil_count) FROM patients WHERE patient_id = 10016742 AND date = '08/22/1992',[]
b2f05f5bfed93860e52c33a1,Calculate patient 10029291's length of stay in days for the first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT patient.length_of_stay_days FROM patient WHERE patient.patient_id = 10029291 AND NOT patient.end_time IS NULL ORDER BY patient.start_time NULLS FIRST LIMIT 1;,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 6.327037037815899}]"
696eddd60cdf06cbb9ee62d7,What is the price of a drug named ampicillin sodium?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' ),SELECT MIN(price) FROM drugs WHERE name = 'Ampicillin Sodium',
e369e10b6bd8a83d98f15e53,What was the output patient 10026354 had since 06/24/2100 on the last occasion?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-24' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT strftime(patient.last_contact, '%m/%d/%Y') as last_contact_date",[{'label': 'Foley'}]
fb908288af351cf6ad047aec,List the top five most frequently tested specimens throughout this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT t.specimen, COUNT(t.specimen) FROM (SELECT specimen FROM brackets WHERE submission_date = '2022-01-01' AND NOT specimen IS NULL) t GROUP BY t.specimen ORDER BY COUNT(t.specimen) DESC LIMIT 5;",[]
76457237914bf971488e9425,Which are the five top specimens that were tested throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM brackets.specimens WHERE NOT sample_date IS NULL AND DATETIME(sample_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5;",[]
558b74ae3a2858468e9b6d75,How many times was a insertion or replacement of external ventricular drain [evd] procedure conducted since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,
f19baaf7b04bf9e553dd2cbf,What was the first time patient 10018328 was prescribed medications via the iv drip route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(pharmacy_sequence_number) FROM pharmacy_table WHERE patient_id = 10018328 AND route = 'iv drip',[]
3a16651efda4705bb6cbe794,"What was the name of the drug patient 10007818 was prescribed with during the same hospital visit after having received a introduction of nutritional substance into central vein, percutaneous approach procedure since 11 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug_name FROM (SELECT patient.uniquepid, treatment.treatment_date, patient.patient_info->'hospital'->>'uniquehospitalid' AS uniquehospitalid FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE patient.patient_info->'hospital'->>'uniquehospitalid' = '12345' AND treatment.treatment_name = 'Introduction of nutritional substance into central vein, percutaneous approach' AND DATETIME(treatment.treatment_date) >= DATETIME(CURRENT_TIME, '-11 month')) AS t1 JOIN (SELECT patient.uniquepid, drug_name, treatment.treatment_date FROM drug JOIN patient ON drug.patient_id = patient.patient_id WHERE patient.patient_info->'hospital'->>'uniquehospitalid' = '12345' AND DATETIME(treatment.treatment_date) >= DATETIME(CURRENT_TIME, '-11 month')) AS t2 ON t1.uniquepid =",
9aaa83b804392690737b00fb,"On the current hospital visit, how many hours have passed since patient 10018081's last diagnosis of acute vascular insufficiency of intestine?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute vascular insufficiency of intestine' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = 10018081 AND diagnosis.diagnosis = 'Acute vascular insufficiency of intestine' AND diagnosis.diagnosis_date = (SELECT diagnosis_date FROM diagnosis WHERE patient_id = 10018081 AND diagnosis.diagnosis = 'Acute vascular insufficiency of intestine' ORDER BY diagnosis_date DESC LIMIT 1)",
97d549d940853218be2a6803,How many hours has it been since patient 10021487 last received the protein lab test on the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.last_lab_date)) FROM patient WHERE patient.subject_id = 10021487 AND patient.last_lab_date IS NOT NULL AND patient.dischtime IS NULL",[]
91c2a89a059f3c099a994282,When was the first time patient 10009628 had a medication prescribed via the iv drip route in 10/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 10 AS _mg_iv_drip FROM Patient WHERE Patient.patient_id = 10009628 AND STRFTIME('%y-%m', Medication.medication_date) = '2100-10'",[]
b6ef3b8f901f6515811991a6,Tell me the total volume of input for patient 10039997 since 03/07/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'",SELECT SUM(input_volume) FROM input WHERE patient_id = 10039997 AND input_date >= '2100-03-07',[{'SUM(inputevents.totalamount)': 8840.0}]
16836caa5b38e5fa22166c1a,Is the pt level of patient 10027445 last measured on the last hospital visit greater than the second to last measurement on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT patient.pt FROM patient WHERE patient.id = 10027445 AND NOT patient.hospitaldischtime IS NULL ORDER BY patient.hospitaladmittime DESC LIMIT 1) > (SELECT patient.pt FROM patient WHERE patient.id = 10027445 AND NOT patient.hospitaldischtime IS NULL ORDER BY patient.hospitaladmittime DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
8a0c73ca152264371f4310c1,"In 2100, what are the top three most common lab tests ordered for patients during the same month after acute and subacute necrosis of liver?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.lab_test FROM (SELECT t2.lab_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Acute and subacute necrosis of liver' AND STRFTIME('%y', diagnosis_date) = '2100') AS t1 JOIN (SELECT patient.id, lab_test, diagnosis_date FROM lab JOIN patient ON lab.patient_id = patient.id WHERE STRFTIME('%y', diagnosis_date) = '2100') AS t2 ON t1.id = t2.id WHERE DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month') GROUP BY t2.lab_test) AS t3 WHERE t3.c1 <= 3",
6eab05aa70724d26ebe7e7c1,How many days is it since patient 10021487 last stayed in the careunit trauma sicu (tsicu) on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1",SELECT COUNT(DISTINCT TIMESTAMP '2022-04-01 00:00:00') FROM patient WHERE patient.current_hospital_unit = 'trauma sicu (tsicu)' AND patient.stay_length > 0 AND patient.stay_length < 1 AND patient.admit_date = (SELECT MAX(admit_date) FROM patient WHERE patient.subject_id = 10021487 AND patient.current_hospital_unit = 'trauma sicu (tsicu)'),[]
50a2ff309d50e7539213d116,"Has patient 10038081 been on 0.9% sodium chloride (mini bag plus), ketamine (for intubation), or heparin flush (10 units/ml) as prescribed since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug IN ( '0.9% sodium chloride (mini bag plus)', 'ketamine (for intubation)', 'heparin flush (10 units/ml)' ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10038081 AND prescriptions.drug IN ('0.9% Sodium Chloride (Mini Bag Plus)', 'Ketamine (For Intubation)', 'Heparin Flush (10 units/ml)') AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)>0': 0}]
8349ae15ee5f76bb723596fb,How much does patient 10004733's heart rate differ from the last value measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT heart_rate FROM patient_10004733 WHERE icu_visits = (SELECT COUNT(DISTINCT icu_id) FROM patient_10004733 WHERE patient_id = 10004733) AND measurement_time = (SELECT MAX(measurement_time) FROM patient_10004733 WHERE icu_visits = (SELECT COUNT(DISTINCT icu_id) FROM patient_10004733 WHERE patient_id = 10004733))) - (SELECT heart_rate FROM patient_10004733 WHERE icu_visits = (SELECT COUNT(DISTINCT icu_id) FROM patient_10004733 WHERE patient_id = 10004733) AND measurement_time = (SELECT MAX(measurement_time) FROM patient_10004733 WHERE icu_visits = (SELECT COUNT(DISTINCT icu_id) FROM patient_10004733 WHERE patient_id = 1,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
a8fc0b9f87df5a45d66da39e,"Can you tell me the cost for the procedure called drainage of left pleural cavity, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) )","SELECT cost FROM procedures WHERE procedure = 'drainage of left pleural cavity, percutaneous approach'",
7adf373e9c0d4a3cd7f5fec3,"This year, what are the three common diagnoses of patients of age 40s?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",SELECT 3 AS _common_diagnoses FROM patients WHERE _age >= 40,
5c20529abfd911e57654f545,Share the four most frequently performed procedures in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.Name, COUNT(t1.Name) FROM procedures AS t1 JOIN procedures_stats AS t2 ON t1.Code = t2.Code WHERE t2.Year = 2100 GROUP BY t1.Name ORDER BY COUNT(t1.Name) DESC LIMIT 4",
8f05ca0c74199be8f6803a5c,How many days is it since patient 10021487 last received the lymphocytes lab test on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab.lab_date)) FROM lab WHERE lab.patient_id = 10021487 AND lab.lab_name = 'lymphocytes' AND lab.hospital_id = (SELECT 1 FROM hosp WHERE hosp.patient_id = 10021487 AND hosp.dischtime IS NULL) ORDER BY lab.lab_date DESC LIMIT 1;",[]
95b245de3db0ff301118f6ef,Was the hematocrit reading for patient 10001725 second measured on the last hospital visit less than the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT (SELECT hematocrit FROM (SELECT patient_id, hematocrit FROM hematocrit_data WHERE patient_id = 10001725 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime DESC LIMIT 1) AS last_hematocrit_reading ORDER BY hematocrit_data DESC LIMIT 1) < (SELECT hematocrit FROM (SELECT patient_id, hematocrit FROM hematocrit_data WHERE patient_id = 10001725 AND NOT hospital_dischtime IS NULL ORDER BY hospital_admittime DESC LIMIT 1) AS last_hematocrit_reading ORDER BY hematocrit_data NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
23065749b2b2053dc0c8dcbc,Tell me the minimum total hospital cost that includes irbesartan.,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'irbesartan' ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(T1.total_hospital_cost) FROM (SELECT SUM(T2.hospital_cost) AS total_hospital_cost FROM irbesartan AS T1 JOIN patient AS T2 ON T1.patient_id = T2.patient_id) AS T1 WHERE T1.total_hospital_cost > 0,
d01b05000d59848ec7db20fc,I would like to learn some tips on how to prepare for the tachypnea procedure.,,"SELECT * FROM ""preparation"" WHERE ""condition"" = 'tachypnea';",
cc2bba4f303536420f4558fe,What is the number of patients who had a hyaline casts test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.hyalinecasts >= (SELECT CURRENT_DATE - INTERVAL '1 year'),[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e8be8d8ac70685f324507cdc,...when was the last time that patient 60219 had a medication that should be taken regularly?,,SELECT MAX(date_submitted) FROM medication_table WHERE patient_id = 60219 AND frequency = 'regular';,
555044660eecd23dbd5c8fa2,Can you retrieve the top four most frequent lab tests patients had following a diagnosis of secondary malignant neoplasm of bone and bone marrow in the same month?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary malignant neoplasm of bone and bone marrow' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Secondary malignant neoplasm of bone and bone marrow') AS t1 JOIN (SELECT patient.name, lab_test.lab_test, lab_test.lab_test_date FROM lab_test JOIN patient ON lab_test.patient_id = patient.patient_id) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_date < t2.lab_test_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_test_date, 'start of month') GROUP BY t2.lab_test) AS t3 GROUP BY t3.lab_test ORDER BY COUNT(t3.lab_test) DESC LIMIT 4",
9068933037510c1817c920bd,What was the total amount of output from patient 10014078 since 04/09/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-09'",SELECT SUM(output) FROM output WHERE patient_id = 10014078 AND date >= '2100-04-09',[{'SUM(outputevents.value)': 9445.0}]
0de3b7f259a662ea8dea4d2b,How much is the difference of patient 10019777's weight last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patient WHERE patient.id = 10019777 AND NOT patient.hospital_info.last_dischtime IS NULL ORDER BY weight DESC LIMIT 1) - (SELECT weight FROM patient WHERE patient.id = 10019777 AND NOT patient.hospital_info.last_dischtime IS NULL ORDER BY weight NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
86f22514f835be171f0fd68c,What time was the last time the heart rate of patient 10021487 was less than 114.0 on this month/14?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 114.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '14' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT STRFTIME('%Y-%m-%d %H:%M:%S', HEART_RATE.timestamp) FROM HEART_RATE WHERE HEART_RATE.patient_id = 10021487 AND HEART_RATE.heart_rate < 114.0 AND DATETIME(HEART_RATE.timestamp, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month') AND STRFTIME('%d', HEART_RATE.timestamp) = STRFTIME('%d', CURRENT_TIME)",[]
3eb9161ed9a1f7a609811822,What's the cost of a procedure named percutaneous balloon valvuloplasty?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous balloon valvuloplasty' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'percutaneous balloon valvuloplasty';,
367a2504a54faf728f7f96fc,"In 2100, what are the top four most frequently tested specimens for patients within 2 months after receiving assistance with cardiac output using balloon pump, continuous?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT patient.identifier, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.identifier WHERE treatment.treatment = 'assistance with cardiac output using balloon pump, continuous') AS t1 JOIN (SELECT patient.identifier, specimen FROM specimen JOIN patient ON specimen.patient = patient.identifier WHERE specimen.date = '2100') AS t2 ON t1.identifier = t2.identifier WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t2.specimen) AS t3 JOIN (SELECT patient.identifier, specimen FROM specimen JOIN patient ON specimen.patient = patient.identifier WHERE specimen.date = '2100') AS t4 ON t3.identifier = t4.identifier GROUP BY t4.specimen ORDER BY COUNT(t4.specimen) DESC",
fe581d0039127b044368f739,"In their last hospital visit, what was the insurance of patient 10016150?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT @insurance FROM patients WHERE patient_id = 10016150 AND NOT patients.dischtime IS NULL ORDER BY patients.admittime DESC LIMIT 1;,[{'insurance': 'Medicare'}]
85c3807521d93484430abc9e,When was patient 10021487 last given an input on 12/17/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-17' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_date) FROM input_table WHERE patient_id = 10021487 AND input_date BETWEEN '12/17/2000' AND '12/17/2005';,[]
8b1866c740133c63f16df25c,What's the percentile of 153.0 in a creatine kinase (ck) lab test at the same age as patient 10024043 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 153.0","SELECT t1.c1 FROM (SELECT lab.result, PERCENT_RANK() OVER (ORDER BY lab.result NULLS FIRST) AS c1 FROM lab WHERE lab.lab_name = 'creatine kinase (ck)' AND lab.patient_id IN (SELECT patient.patient_id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.patient_id = 10024043 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1))) AS t1 WHERE t1.result = 153.0",
0b6a628ddf97a2a792d52b70,How many people were given prescriptions for plasmalyte?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'plasmalyte' ),SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE prescriptions.drug = 'Plasmalyte';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
54ab42240e681be312ba36be,What was the name of the drug that was prescribed to patient 10020306 last time through the im route in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriber.drug_name FROM prescriber WHERE prescriber.patient_id = 10020306 AND prescriber.route = 'im' AND STRFTIME('%y-%m', prescriber.date) = '2100-11' ORDER BY prescriber.date DESC LIMIT 1",[]
ac175862df937e28b15bb023,When was the last time that a medication that should be taken regularly was had by patient 594?,,SELECT MAX(date_submitted) FROM medication_usage WHERE medication_type = 'regular' AND patient_id = 594,
4d0e1664ae29fa72ddcd640f,How many patients were diagnosed with other specified retention of urine?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified retention of urine' ) ),"SELECT COUNT(DISTINCT patient.id) FROM patient WHERE patient.diagnosis = ""OTHER SPECIFIED RETENTION OF URINE""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ea3b6816231eff47e5f4ff99,Well tell me what to do ahead of the left heart cardiac cath procedure,,SELECT * FROM brackets WHERE operation = 'left heart cardiac cath';,
90b567e91dc4ca2e45144a58,What is the standard amount of reimbursement for a drug?,,"SELECT AVG(Reimbursement) FROM ""drug"" WHERE Drug_Type = 'Standard';",
ec01a1e86108eda854c5cd91,When was the last time that patient 10038992 had the absolute basophil count minimum value on the first hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1","SELECT MIN(absolutetemp) FROM (SELECT absolute FROM (SELECT temp FROM (SELECT 10038992 AS patientid, NULL AS temp, NULL AS date, '2022-01-01' AS dateformat FROM dual) AS t1) AS t2) WHERE temp IS NOT NULL GROUP BY date ORDER BY date NULLS FIRST LIMIT 1",[]
13467297765b0e75201a52e3,What are the three most common output instances?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",SELECT COUNT(*) FROM (SELECT output FROM example WHERE output IS NOT NULL GROUP BY output ORDER BY COUNT(*) DESC LIMIT 3) AS three_most_common_outputs;,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]"
067face22845095ef5e901a0,What is the percentile of 104.0 in a chloride lab test conducted at the same age as patient 10016810 in the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 104.0",SELECT (SELECT percent_rank FROM lab_data WHERE lab_name = 'chloride' AND patient_id = 10016810 AND age = (SELECT age FROM lab_data WHERE lab_name = 'chloride' AND patient_id = 10016810 AND age IS NOT NULL ORDER BY age DESC LIMIT 1)) WHERE lab_name = 'chloride' AND patient_id = 10016810 AND age IS NOT NULL,
22ab23e20a87874b13ca865c,What is patient 10010471's heart rate change last measured on the first ICU visit compared to the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT heart_rate FROM icu_heart_rate WHERE icu_heart_rate.patient_id = 10010471 AND NOT icu_heart_rate.outcome IS NULL ORDER BY icu_heart_rate.measurement_time NULLS FIRST LIMIT 1) - (SELECT heart_rate FROM icu_heart_rate WHERE icu_heart_rate.patient_id = 10010471 AND NOT icu_heart_rate.outcome IS NULL ORDER BY icu_heart_rate.measurement_time NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
c3ad5487d2580375d41c2e06,When was the first time that patient 10008287 had a maximum SaO2?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",SELECT MIN(SaO2) FROM read_brackets WHERE patient_id = 10008287,[]
09a8d5869533c169168ee661,Count the total patients who were prescribed nifedipine cr this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.prescriptions LIKE '%nifedipine cr%' AND DATETIME(patient.prescriptions, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
47ed4895c2459c6df72bbc21,And how to find the code that shows icd-11 for mitral valve disorder in icd-10.,,SELECT icd_11 FROM icd_translation WHERE icd_10 = 'Mitral valve disorder',
f0fa794eb149befc0d010275,Can you inform me of the first white blood cells test result for patient 10007795 in 04/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1",SELECT MIN(White Blood Cells) FROM lab WHERE lab.Patient = 10007795 AND lab.Date BETWEEN '2004-01-01' AND '2004-12-31',[]
3bea1d4c8791561006ff719f,Can you name the procedure/treatment that patient 10015860 was given two or more times since 06/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t1.procedure, COUNT(t1.date) FROM (SELECT p.date, p.procedure FROM procedures p WHERE p.patient = 10015860 AND STRFTIME('%y-%m', p.date) >= '2100-06') AS t1 GROUP BY t1.procedure HAVING COUNT(t1.date) >= 2",
3b7aac248d67a932c390edb8,What was the number of patients receiving excision of dental lesion of jaw in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT jaw.patient) FROM jaw WHERE jaw.procedure = 'Excision of dental lesion of jaw' AND STRFTIME('%y', jaw.date) = '2100'",
925ed6c9ab8d40d8dc632226,Did patient 10020944 take a dextrose 5% medication on 03/10/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-10'",SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10020944 AND medication.date = '2100-03-10' AND medication.name = 'dextrose 5%',[{'COUNT(*)>0': 0}]
4b0dae2bf00cb70ac501a4d7,Has patient 10003400 been tested in the phosphate lab?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ),SELECT COUNT(*) FROM lab_results WHERE lab_name = 'phosphate' AND patient_id = 10003400;,[{'COUNT(*)>0': 0}]
6483b1969cfa3eda4e888a7a,What percentile is the value of the mch of 31.5 among patients of the same age as patient 10037928 on the first hospital stay?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 31.5","SELECT t1.c1 FROM (SELECT patient.age, MCH(patient.info->age) AS c1 FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.id = 10037928 AND NOT patient.dischtime IS NULL ORDER BY patient.hospitalstay DESC LIMIT 1)) AS t1 WHERE t1.age = 25",
90c8f7dcff48de642efa7222,Tell me what the top three most common diagnoses of patients with an age of 60 or above throughout this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT * FROM patients WHERE age >= 60) AS t1 JOIN (SELECT * FROM diagnoses WHERE date = '2022-01-01') AS t2 ON t1.diagnosis = t2.diagnosis GROUP BY diagnosis) AS t3 WHERE t3.c1 <= 3",
a8995e515e945700a73e1a38,What is the minimum total cost at a hospital including a lymphocytes laboratory test in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost <> 0 AND date BETWEEN '2100-01-01' AND '2100-12-31' AND lab_name = 'lymphocytes' GROUP BY patient_id) AS t1,
2c4e5ef20f7bc4bff7aa7301,Has any organism been found in patient 10021487's last sputum test conducted in 12/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*) > 0 FROM organism WHERE organism.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.last_sputum = '12/21487'),[{'COUNT(*)>0': 0}]
c4e7ab7b177fe5ebd0e590fc,When did patient 10019172's last input since 10/10/2100 occur?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-10' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT MAX(input_date) FROM input_table WHERE input_table.patient_id = 10019172 AND STRFTIME('%y-%m-%d', input_date) >= '2100-10-10'",[{'starttime': '2118-11-19 19:30:00'}]
8e71be5e11c9a90ff530970e,When was the first time that patient 10021487 was prescribed chlorhexidine gluconate 0.12% oral rinse and famotidine in this month at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.date FROM (SELECT patient_id, prescriber_id, date FROM prescriptions WHERE patient_id = 10021487 AND prescriber_id = 1 AND date = 2022-04-01) AS T1 JOIN (SELECT patient_id, prescriber_id, date FROM prescriptions WHERE patient_id = 10021487 AND prescriber_id = 2 AND date = 2022-04-01) AS T2 ON T1.patient_id = T2.patient_id WHERE DATETIME(T1.date) = DATETIME(T2.date) ORDER BY T1.date NULLS FIRST LIMIT 1",[]
2f95bc2423afa4e0a3965518,Get the count of the number of hospital visits of patient 10039708 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10039708 AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(Hospital_Visits) FROM Visits WHERE Patient_ID = 10039708 AND Year >= 2100,[{'COUNT( DISTINCT admissions.hadm_id )': 10}]
b90482cec7b5c892ea5302f4,What percentile is 13.0 urea nitrogen in a patient of the same age as patient 10022017 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.0","SELECT DISTINCT t1.c1 FROM (SELECT patient.age, urea.nitrogen, PERCENT_RANK() OVER (ORDER BY urea.nitrogen NULLS FIRST) AS c1 FROM (SELECT patient.age, urea.nitrogen FROM patient JOIN urea ON patient.age = urea.age WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = 'Jane Doe' AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay DESC LIMIT 1)) AS t1 WHERE t1.age = (SELECT patient.age FROM patient WHERE patient.name = 'Jim Brown' AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_stay DESC LIMIT 1) AND t1.nitrogen = 13.0",
f2719ed44a2bcf2baaa42242,"What is the minimum total hospital cost which involves congestive heart failure, unspecified in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(s1.c1) AS c1 FROM (SELECT 1 AS s1 FROM diagnoses WHERE d1 = 'congestive heart failure, unspecified') AS s1 JOIN (SELECT 1 AS c1 FROM procedures WHERE p1 = '2100') AS t1 ON s1 = t1.s1)",
ccf62a429718ac33d9c26686,What are the three most common specimen tests that occurred since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(*) FROM bracket_data WHERE year >= 2100 GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
c0cedb965b06326bbddb2eb4,Calculate the number of patients discharged from the hospital since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT(DISTINCT patient_id) FROM admissions WHERE NOT dismissed IS NULL AND STRFTIME('%y', dismissed) >= '2100';",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
2c9a172538d37c27f588e4f8,"What is the percentile of 9.3 in the laboratory test with calcium, total at the same age of patient 10007818 on their last hospital encounter?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 9.3","SELECT t1.c1 FROM (SELECT lab.c1, PERCENT_RANK() OVER (ORDER BY lab.c1 NULLS FIRST) AS c2 FROM lab WHERE lab.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.age = (SELECT patient.age FROM patient WHERE patient.name = 'Teddy'))) AS t1 WHERE t1.c2 = 9.3",
64dfb6c9030d4565fdcadb6f,When patient 10010471 was first discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10010471 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient.hospital_discharge_date FROM patient WHERE patient.unique_patient_id = 10010471 ORDER BY patient.hospital_discharge_date NULLS FIRST LIMIT 1,[{'dischtime': '2155-05-10 18:55:00'}]
83cc6dc500e1e949c8a26cdc,"Compared to measured at 2100-08-20 07:00:00 , is the o2 saturation pulseoxymetry value of patient 10006580 greater than measured at 2100-08-20 06:00:00?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 07:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 06:00:00' ),SELECT COUNT(*) > 0 FROM pulseoxymetry WHERE pulseoxymetry.patient_id = 10006580 AND pulseoxymetry.measurement_time >= '2100-08-20 06:00:00' AND pulseoxymetry.measurement_time < '2100-08-20 07:00:00' AND pulseoxymetry.o2_saturation > (SELECT o2_saturation FROM pulseoxymetry WHERE pulseoxymetry.patient_id = 10006580 AND pulseoxymetry.measurement_time = '2100-08-20 06:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 07:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 06:00:00' )"": None}]"
dcebcd167c495b6e52892fc8,I would like to know the top four diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT t4.diagnosis, t4.3_month_mortality",
5c8d918b88b696fa22b10f23,What are the four most common prescriptions in 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.prescriptions FROM (SELECT prescriptions, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.prescriptions FROM patient WHERE STRFTIME('%y', patient.date) = '2100') GROUP BY prescriptions) AS t1 WHERE t1.c1 <= 4",[]
c8111e2baf3638b5ee8951da,What specimen test has patient 10007795 received for the first time since 08/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_test FROM patient_specimens WHERE patient_id = 10007795 AND date_received >= '2000-08-2100' ORDER BY date_received NULLS FIRST LIMIT 1,[{'spec_type_desc': 'BLOOD CULTURE'}]
509007e836380f20bbceca57,Retrieve the top five most frequent lab tests that patients had after being diagnosed with ulcer of other part of foot in the same month since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ulcer of other part of foot' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'ulcer of other part of foot' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.id, lab_test, lab_test_date FROM lab_tests JOIN patient ON lab_tests.patient_id = patient.id WHERE DATETIME(lab_tests.lab_test_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.lab_test_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.lab_test_date, 'start of month') GROUP BY t2.lab",
4f9e42945038788848999c30,Display the top five most commonly prescribed drugs since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE DATETIME(prescriptions.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]"
458ec4c0b0b1086e917fb739,Tell me the time when patient 10018081's systolic blood pressure was less than 118.0 for the last time yesterday?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 118.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT COUNT(DISTINCT t.timestamp) FROM (SELECT timestamp FROM (SELECT systolic(blood_pressure) FROM patient WHERE patient_id = 10018081) AS t WHERE systolic(blood_pressure) < 118.0) AS t WHERE NOT t.timestamp IS NULL AND DATETIME(t.timestamp, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
4678e394b805643ece243dbd,"What are the top four most common microbiology tests that patients were diagnosed with after the diagnosis of spinal stenosis, lumbar region, without neurogenic claudication within the same hospital visit?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t3.microbiology_test FROM (SELECT t2.microbiology_test, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.subject_id, diagnosis.diagnosis_date, patient.patient_location FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'spinal stenosis, lumbar region, without neurogenic claudication') AS t1 JOIN (SELECT patient.subject_id, microbiology_test, microbiology_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.subject_id) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.microbiology_date AND t1.patient_location = t2.patient_location GROUP BY t2.microbiology_test) AS t3 WHERE t3.c1 <= 4",
3eee431c56b7e26f4a97d69f,Please calculate the total output for patient 10011398 since 07/15/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-15'",SELECT SUM(output) FROM (,[{'SUM(outputevents.value)': 4314.0}]
df128c1c320ab7a3577dbe3e,When did patient 10020187 get discharged from the hospital for the first time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020187 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1","SELECT STRFTIME('%d/%m/%Y', MIN(dischtime)) as first_discharge_date",[]
a3bc01d2aacfcab611fc1c53,Please send me the name of the diagnostic diagnosis patient 5828 received at the other department.,,SELECT diagnosis.diagnosis_name FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE patient.uniquepatientid = 5828 AND diagnosis.diagnosis_location = 'other department',
7344c8361b0e586129656284,"Was there a restriction of left internal carotid artery with intraluminal device, percutaneous approach procedure performed on patient 10018328 on their last hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id IN (SELECT patient.patient_id FROM patient WHERE patient.hospital_id IN (SELECT patient.hospital_id FROM patient WHERE patient.name = '10018328' AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1)) AND procedures.procedure_name = 'Left internal carotid artery with intraluminal device, percutaneous approach'",[{'COUNT(*)>0': 0}]
6a6f09403ba82cc0aaa73daa,When in 12/2100 did patient 10021118 get the last microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT date FROM Microbiology WHERE patient_id = 10021118 ORDER BY date DESC LIMIT 1,[]
3eb0479be3a32cecf1cfc9a1,Can you tell the daily maximum dose of or crystalloid intake that patient 10026354 received since 07/08/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-08' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT MAX(daily_intake) FROM intake_table WHERE patient_id = 10026354 AND intake_type = 'or crystalloid' AND date >= '2100-07-08',[]
dd637812c5b2444154d1942b,What was the first time that patient 10016742 had a minimum heart rate during the first ICU visit?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM icu WHERE icu.patient_id = 10016742 AND NOT icu.outcome = 'death' ORDER BY icu.admittime NULLS FIRST LIMIT 1),[]
e9b6fc1c47118c5de09e95d7,"What are the three most frequently administered laboratory tests for patients previously diagnosed with chronic airway obstruction, not elsewhere classified during the same hospital visit, since 1 year ago?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date, patient.patient_location FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis_name = 'Chronic airway obstruction, not elsewhere classified' AND DATETIME(diagnosis.diagnosis_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, test.test_name, test.test_date FROM test JOIN patient ON test.patient_id = patient.uniquepid WHERE DATETIME(test.test_date) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.test_date AND DATETIME(t1.diagnosis_date) BETWEEN DATETIME(t2.test_date) AND DATET",
5ebecd683c34753383eaaa76,What medication was prescribed for the first time during their first hospital visit to patient 10003046?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT medication FROM prescriptions WHERE patient_id = 10003046 AND NOT rank IS NULL ORDER BY date NULLS FIRST LIMIT 1;,[{'drug': 'Iso-Osmotic Dextrose'}]
c1f3f0db61bac26ec0d7afba,What were the four most frequently given diagnoses for patients who received percutaneous abdominal drainage previously within 2 months?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquecarrier, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquecarrier WHERE treatment.treatmenttype = 'percutaneous abdominal drainage') AS t1 JOIN (SELECT patient.uniquecarrier, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquecarrier) AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosisdate) BETWEEN DATETIME(t1.treatmentdate) AND DATETIME(t1.treatmentdate, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 4",
f84ac0f635563a2f0fad1c41,When was the first time the systolic blood pressure of patient 10009628 was measured at a reading less than 123.0 in the first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 123.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(systolic_blood_pressure) FROM (SELECT systolic_blood_pressure FROM icu_data WHERE icu_data.patient_id = 10009628 AND NOT icu_data.out_of_order = true) WHERE systolic_blood_pressure < 123.0,[]
5e54019ee712a69d9eb50369,"What are the three frequently tested specimens for patients that received extirpation of matter from left femoral vein, percutaneous approach previously within 2 months this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'Extirpation of matter from left femoral vein, percutaneous approach' AND DATETIME(treatment.treatmentdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.uniquepid, specimen, treatment.treatmentdate FROM specimen JOIN patient ON specimen.patientid = patient.uniquepid WHERE DATETIME(specimen.treatmentdate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.treatmentdate AND DATETIME(t2.treatmentdate) BETWEEN DATETIME(t1.tre",
db31b23e92a6097f61552803,Was patient 10005817 involved in any medical procedure last year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10005817 AND procedures.procedure_type = 'medical' AND DATETIME(procedures.procedure_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
9258a1a83e5bbfc697468adf,What is the count of prochlorperazine prescriptions made since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prochlorperazine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Prochlorperazine' AND DATETIME(prescriptions.date_modified) >= DATETIME(CURRENT_TIME, '-1 year');",[{'COUNT(*)': 0}]
ffefdb9195190d8fcb86fa14,How much does it cost for phenytoin sodium (iv)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium (iv)' ),SELECT DISTINCT cost FROM products WHERE product = 'phenytoin sodium (iv)',
1c91054ab8b9cc71f46ad1dd,"Since 2100, how many patients were diagnosed with type 2 diabetes mellitus with diabetic polyneuropathy?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with diabetic polyneuropathy' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed FROM diagnoses WHERE diagnosis_type = 'Type 2 diabetes mellitus with diabetic polyneuropathy' AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100') AS t1 JOIN (SELECT subject_id, diagnosed FROM diagnoses WHERE diagnosis_type = 'Type 2 diabetes mellitus with diabetic polyneuropathy' AND STRFTIME('%y', diagnoses.diagnosis_date) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed = 1 AND t2.diagnosed = 1",
aa7534c96dd01ae4543b138b,What's the average total cost of the hospital that involves a procedure called diagnostic ultrasound of heart since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of heart' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.procedure_name = 'diagnostic ultrasound of heart' AND DATETIME(cost_table.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY cost_table.id) AS t1",
960af01d63ac5e922c0eb129,"What are the top five most common specimens being tested for patients who were diagnosed with personal history of irradiation, presenting hazards to health within the same month in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of irradiation, presenting hazards to health' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t5.specimen, COUNT(t5.specimen) FROM (SELECT t4.specimen, DATETIMEFROMPARTS(t4.date, 'start of month', 'start of month') as month FROM (SELECT t3.specimen, DATETIMEFROMPARTS(t3.date, 'start of month', 'start of month') as month FROM (SELECT STRFTIME('%Y-%m-%d', date) as date FROM patients WHERE personal_history = 'irradiation') as t1 JOIN patients ON t1.date = patients.date) as t2 JOIN (SELECT t5.specimen, DATETIMEFROMPARTS(t5.date, 'start of month', 'start of month') as month FROM patients as t5 JOIN patients ON t5.date = patients.date) as t3 ON t2.month = t3.month GROUP BY t5.specimen ORDER BY COUNT(t5.specimen) DESC LIMIT 5",
c27b7ef096a3a3f132083738,"In 07/2100, levothyroxine sodium, 0.45% sodium chloride, or lisinopril was prescribed for patient 10002428.","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND prescriptions.drug IN ( 'levothyroxine sodium', '0.45% sodium chloride', 'lisinopril' ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07'",SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10002428 AND medications.date = '2007-2100' AND (medications.drug = 'Levothyroxine Sodium' OR medications.drug = '0.45% Sodium Chloride' OR medications.drug = 'Lisinopril'),[{'COUNT(*)>0': 0}]
ce91ec91b6aaa48439b33e96,What is the procedure of the anticancer drugs.,,SELECT procedures FROM drugs WHERE drugs.category = 'anticancer';,
682676ee539e16fc31ab086e,How many patients were discharged from hospitals?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT(DISTINCT id) FROM patients WHERE NOT discharge_date IS NULL;,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
24ad2857877ae3f6da374f4c,How many medications were assigned to patient 10038999 throughout this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(*) FROM medication_assignment WHERE patient_id = 10038999 AND date_assigned_to >= CURRENT_DATE AND date_assigned_to < CURRENT_DATE + INTERVAL '1 year';,[{'COUNT(*)': 0}]
97acefe23c241af475dc236d,"Has patient 10029291 been treated with introduction of other thrombolytic into central vein, percutaneous approach this year?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM treatment WHERE treatment.patient_id = 10029291 AND treatment.description = 'introduction of other thrombolytic into central vein, percutaneous approach' AND DATETIME(treatment.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
05a0dd22ccfcd8bac854d247,"Did patient 10018423 have a performance of cardiac output, continuous procedure on the first hospital stay?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) > 0 FROM cardiac_output, continuum WHERE cardiac_output.patient_id = 10018423 AND continuum.procedure_id = cardiac_output.procedure_id AND continuum.hospital_stay_id = cardiac_output.hospital_stay_id ORDER BY continuum.hospital_stay_id NULLS FIRST LIMIT 1",[{'COUNT(*)>0': 0}]
807c6c3264c76b6faa008696,What was patient 10006580's documented weight on the last record on the first hospital stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT patient.documented_weight FROM patient WHERE patient.patient_id = 10006580 AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime NULLS FIRST LIMIT 1;,[]
bf62c5424509b587645d8c69,"What is the diagnosis price for anoxic brain damage, not elsewhere classified?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anoxic brain damage, not elsewhere classified' ) )","SELECT diagnosis_price FROM diagnoses WHERE diagnosis = ""Anoxic brain damage, not elsewhere classified""",
267d7c119f8d5f96a44c309d,What was the name of the prescription drug given to patient 10025463 in the same hospital visit after undergoing the cardiac mapping procedure since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug_name FROM (SELECT patient.uniquepid, treatment.treatment_date, patient.patient_info->'hospital visit' AS hospital_info FROM treatment JOIN patient ON treatment.patient_id = patient.uniquepid WHERE patient.patient_info->'hospital visit'->>'start date' >= '2000-08-2100' AND treatment.treatment_type = 'cardiac mapping') AS t1 JOIN (SELECT patient.uniquepid, prescription.drug_name, prescription.start_date, patient.patient_info->'hospital visit' AS hospital_info FROM prescription JOIN patient ON prescription.patient_id = patient.uniquepid WHERE patient.patient_info->'hospital visit'->>'start date' >= '2000-08-2100') AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatment_date < t2.start_date AND t1.hospital_info = t2.hospital_info",
dcfe3d31d256b6f0069568e5,"When, since 02/2100, was the first time patient 10027445 was prescribed a medication via the nu route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'nu' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM prescriptions WHERE patient_id = 10027445 AND prescriber_location = 'nu' AND date_prescribed >= '2002-02-2100',[]
3d9d7abd6d9d5b5188725536,What was the total sum of inputs for patient 10007058 since 02/25/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-25'","SELECT SUM(input) FROM read_csv_auto('output.csv', patient_id=10007058, date='02/25/2100')",[{'SUM(inputevents.totalamount)': 10975.0}]
0845c5b2d9f8bde33129dc7a,Can you tell me which five diagnoses have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT 3 AS _month_mortality_rate, '5' AS diagnoses FROM brackets WHERE 3_month_mortality_rate = (SELECT MAX(3_month_mortality_rate) FROM brackets WHERE diagnoses = '5')",
c8b66e1569afc7477b2048fb,What was the last drug that patient 10019917 had been prescribed via the sc route on the first hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(drug_id) FROM prescriptions WHERE patient_id = 10019917 AND route = 'sc' AND hospital_stay = 1;,[]
8afa74497c4d9b8c7f0fe659,What are the three diagnoses with the lowest 3-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT diagnosis FROM (SELECT diagnosis, 3 AS month, 1000 - 120 AS survival_rate FROM (SELECT line, diagnosis, 3, 1000, 120 FROM (SELECT * FROM read_csv_auto('diagnoses.csv', header=true, columns={'Line': 'VARCHAR', 'Diagnosis': 'VARCHAR'}) AS diagnoses",
def0418fbc10900a82ffd5b9,How many cases involved the prescription of insulin (regular) for hyperkalemia since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'insulin (regular) for hyperkalemia' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'insulin (regular) for hyperkalemia' AND STRFTIME('%y', prescriptions.date) >= '2100'",[{'COUNT(*)': 0}]
4d0cbd90ae58506f9467785f,When was the last time that patient 10001725 was tested for eosinophils on their first hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT MAX(bracket_time) FROM (SELECT bracket_time FROM lab_data WHERE lab_data.patient_id = 10001725 AND lab_data.result_type = 'eosinophils' AND NOT lab_data.bracket_time IS NULL ORDER BY lab_data.bracket_time NULLS FIRST LIMIT 1),[]
62c407ce4b823a8f721bf1b5,What are the five most regularly ordered treatments for patients previously diagnosed with injury to thoracic aorta within the same month in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, t1.month FROM (SELECT date_part('month', i.date) AS month, i.treatment FROM inventory i WHERE i.treatment = 'injury to thoracic aorta') AS t1 JOIN (SELECT date_part('month', j.date) AS month, j.treatment FROM inventory j WHERE j.treatment = 'treatment') AS t2 ON t1.month = t2.month WHERE t1.treatment = t2.treatment) AS t3 GROUP BY t3.treatment ORDER BY COUNT(t3.treatment) DESC LIMIT 5",
abf27942525ea42427bca966,Is the value of anion gap of patient 10031404 second measured on the first hospital visit less than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM (SELECT lab.value FROM lab WHERE lab.patient_id = 10031404 AND NOT lab.visit_id IS NULL ORDER BY lab.visit_id NULLS FIRST LIMIT 1) AS value1 JOIN (SELECT lab.value FROM lab WHERE lab.patient_id = 10031404 AND NOT lab.visit_id IS NULL ORDER BY lab.visit_id NULLS FIRST LIMIT 1) AS value2 ON value1.value = value2.value,"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
ef68de2dc19e6a02e19bace9,What was the medication that patient 10004733 was prescribed for in the same day after receiving central venous catheter placement with guidance in this hospital visit?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t2.medication FROM (SELECT patient.uniquecarrier, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.patientid WHERE patient.patientid = 10004733 AND treatment.treatmentname = 'central venous catheter placement with guidance') AS t1 JOIN (SELECT patient.uniquecarrier, medication.medication, medication.treatmentdate FROM medication JOIN patient ON medication.patientid = patient.patientid WHERE patient.patientid = 10004733 AND DATETIME(medication.treatmentdate, 'start of hospital visit') = DATETIME(CURRENT_TIME, 'start of hospital visit')) AS t2 ON t1.uniquecarrier = t2.uniquecarrier WHERE t1.treatmentdate < t2.treatmentdate AND DATETIME(t1.treatmentdate, 'start of day') = DATETIME(t2.treatmentdate, 'start of day')",
67a50f9b79bc4e4a7c653ac5,What are the five most frequent diagnoses that patients were diagnosed within 2 months after having received a excision of dental lesion of jaw procedure?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmenttime FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'excision of dental lesion of jaw') AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosistime FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmenttime < t2.diagnosistime AND DATETIME(t2.diagnosistime) BETWEEN DATETIME(t1.treatmenttime) AND DATETIME(t1.treatmenttime, '+2 month') GROUP BY t2.diagnosis) AS t3 WHERE t3.c1 <= 5",
6f9e8ee2deac4ff0313cfd13,When has patient 10029484 been prescribed medication for the first time in 11/this year via the po/ng route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10029484 AND route = 'po/ng' AND prescriptions.date_prescribed BETWEEN '2011-11-01' AND '2011-11-30',[]
8db3a499f8e4f04b7f55b1a4,What procedure was given to patient 10005909 two times during the last month?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT COUNT(DISTINCT t1.timestamp) FROM (SELECT TIMESTAMP '2022-01-01 12:00:00' + INTERVAL (v1.int) MONTH FROM (VALUES (1), (2), (3)) AS v1(int)) AS t1 JOIN (SELECT TIMESTAMP '2022-01-01 12:00:00' + INTERVAL (v2.int) MONTH FROM (VALUES (1), (2), (3)) AS v2(int)) AS t2 ON t1.timestamp = t2.timestamp WHERE t1.patient_id = 10005909",
315e7c004443575bb2996afc,When was patient 10015272's last maximum chloride value in their first hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(chloride) FROM patients WHERE patient_id = 10015272 AND NOT patient_id IN (SELECT patient_id FROM admissions WHERE rank = 1),[]
b3f1921213d20471bf74e2f5,What was the name of the drug that was prescribed to patient 10027445 in the same hospital encounter after having had a percutaneous balloon valvuloplasty procedure since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous balloon valvuloplasty' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.name, procedure.date FROM patient JOIN procedures ON patient.record = procedures.patient WHERE patient.name = 'Jane Doe' AND procedures.date >= '2000-08-2100' AND procedures.type = 'percutaneous balloon valvuloplasty') AS t1 JOIN (SELECT patient.name, prescription.drug FROM patient JOIN prescriptions ON patient.record = prescriptions.patient WHERE patient.name = 'Jane Doe' AND STRFTIME('%y-%m', prescriptions.date) >= '2000-08-2100') AS t2 ON t1.name = t2.name WHERE t1.date = t2.date",
cc4241e21c09d7f7c2b141ff,What was the cost of the drug albumin 5% (25g / 500ml)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'albumin 5% (25g / 500ml)' ),SELECT DISTINCT cost FROM drugs WHERE drug_name = 'Albumin 5% (25g / 500ml)',
b78c0434ecf85c58970b853d,What is the cost of a diagnosis of long term (current) use of anticoagulants?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of anticoagulants' ) ),"SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = ""Long term (current) use of anticoagulants""",
c040519bfaa35e04239eecbd,Has patient 10020944 been admitted into an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room',SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.emergency_room_admission = 'EMERGENCY ROOM ADMITTED',[{'COUNT(*)>0': 0}]
ec8e06e2b743a81436720c46,"Since 1 year ago, how many patients were provided with tamoxifen citrate?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",SELECT COUNT(*) FROM patients WHERE patients.provided_tamoxifen = '1 year ago',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e2f69e562ea54caf705bd0c2,How many patients are there presently admitted?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE admit_date IS NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
7109e759c570a654d53e3ee4,Was patient 10006053 involved in any medical procedure on their first hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10006053 AND diagnoses.diagnosis_type = 'medical' AND NOT diagnoses.dischtime IS NULL ORDER BY diagnoses.admittime NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 1}]
b5b6f1a8e33ce9cea9bd0292,When was the last time patient 10007928 had the maximum rdw during the last hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(rdw) FROM patients WHERE patient_id = 10007928 AND NOT patients.hospital_info IS NULL ORDER BY patients.hospital_info DESC LIMIT 1;,[]
86cbd6023ea3c6b4277ad089,Quantify the number of patients who were tested since 2100 for ferritin.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND strftime('%Y',labevents.charttime) >= '2100' )",SELECT COUNT(DISTINCT id) FROM patients WHERE ferritin >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
21e50a8f4be7dfdd1d9fb392,Did patient 66015 ever have any side effects during a blood transfusion?,,SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 66015 AND diagnoses.side_effects = 'side effects' AND procedures.name = 'blood transfusion',
47dbc50e60c6491af7433121,Find out the number of drugs given to patient 10039997 since 02/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'",SELECT COUNT(*) FROM medication_usage WHERE patient_id = 10039997 AND date_since >= '2002-02-2100',[{'COUNT(*)': 59}]
af5515bbc62c20e665bfdae3,Is the chloride level of patient 10006053 second measured on the first hospital visit greater than the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT (SELECT Chloride FROM ""patient_10006053"" WHERE NOT ""hospital_1"" IS NULL ORDER BY ""date"" NULLS FIRST LIMIT 1 OFFSET 1) > (SELECT Chloride FROM ""patient_10006053"" WHERE NOT ""hospital_1"" IS NULL ORDER BY ""date"" NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
bb0544fc1cbc2ba271291243,What is the sex of patient 10020306?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306,SELECT SUM(sex) FROM patients WHERE patient_id = 10020306,[{'gender': 'F'}]
2d8f9dd2fbaff9e32a728bc4,"Has there been any phenobarbital, atenolol, or sodium chloride 0.9% ordered for patient 10018501 in 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND prescriptions.drug IN ( 'phenobarbital', 'atenolol', 'sodium chloride 0.9%' ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) > 0 FROM pharmacotherapy WHERE pharmacotherapy.patient_id = 10018501 AND pharmacotherapy.drug_name IN ('phenobarbital', 'attenolol', 'sodium chloride 0.9%') AND STRFTIME('%y', pharmacotherapy.ordered_date) = '2100'",[{'COUNT(*)>0': 0}]
24fdc72bfa641df5e25a4dd3,"What's the price of a procedure referred to as closed reduction of fracture with internal fixation, femur?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed reduction of fracture with internal fixation, femur' ) )","SELECT procedures.price FROM procedures WHERE procedures.name = ""Closed reduction of fracture with internal fixation, femur""",
40e6d3bcc00d291b26feb3e7,When did patient 10010471 first receive an input in their first ICU visit?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1,,[{'starttime': '2155-12-02 20:54:00'}]
cd68238c19445383f9469b6b,Is the temperature celsius level of patient 10005817 second measured on the last ICU visit greater than the first measurement on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT temperature FROM ICU WHERE ICU.patient = 10005817 AND NOT ICU.outbound = 0 ORDER BY ICU.admittime DESC LIMIT 1) > (SELECT temperature FROM ICU WHERE ICU.patient = 10005817 AND NOT ICU.outbound = 0 ORDER BY ICU.admittime DESC LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
01a258cef08c0eb27a9ef878,What methods are used to ingest emtricitabine-tenofovir (truvada)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'emtricitabine-tenofovir (truvada)',SELECT DISTINCT ingestion_method FROM drugs WHERE product_name = 'Emtricitabine-Tenofovir (Truvada)',[]
dcd2227eec0068298417064f,Give a count of the number of ICU visits of patient 10020187 throughout this year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(ICU_VISITS) FROM visit_table WHERE PATIENT_ID = 10020187 AND DATETIME BETWEEN DATETIME '2022-01-01' AND DATETIME '2022-12-31';,[{'COUNT( DISTINCT icustays.stay_id )': 0}]
c7ae2e00343bbb04614217b6,What medication was prescribed to patient 10023239 first time on their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT medication FROM prescriptions WHERE prescriptions.patient_id = 10023239 AND NOT prescriptions.hospital_id IS NULL ORDER BY prescriptions.hospital_id NULLS FIRST LIMIT 1;,[{'drug': 'Levothyroxine Sodium'}]
fa51b74dc317c3f8478a0ff5,List the top five most frequently tested specimens in 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM Brackets_2000 WHERE date = '2100' GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5;",[]
fec62efd2a043cb3d54efd38,How many days was patient 10020740's first stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', ICU_LENGTH(10020740, '2022-01-01')) - STRFTIME('%j', ICU_LENGTH(10020740, '2022-01-01', '-1 day')) AS days_in_icu","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 7.446423612069339}]"
790f43812849f0e3f94c3c15,"In the first hospital encounter, what age was patient 10020187?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT SUM(demographics.age) FROM demographics WHERE demographics.subject_id = 10020187 AND NOT demographics.dischtime IS NULL ORDER BY demographics.admittime NULLS FIRST LIMIT 1,
368dc6fa47ea7885905c48d5,How is olanzapine (disintegrating tablet) taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'olanzapine (disintegrating tablet)',,[]
6d8b67dc5b7691af8bcd4937,When was patient 10020740 prescribed a medication via the iv route the first time in 03/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT iv FROM medication_prescriptions WHERE patient_id = 10020740 AND prescriber_id = 104317 AND date_prescribed = '2022-03-01' ORDER BY date_prescribed NULLS FIRST LIMIT 1,[]
3a071ace73b6a8ed27c95001,"For patient 10021487, what were the first calcium, urine lab results during this month?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(lab.calcium, urine) FROM lab WHERE lab.patient = 10021487 AND DATETIME(lab.date, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')",[]
41deb2b6334194be2b87c10f,Count the number of medicines that have been prescribed to patient 10021312.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ),SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10021312;,[{'COUNT(*)': 126}]
f74c6d45811f3d87dac9bdc2,When was the first time patient 10038999 had a SaO2 that was greater than 96.0 since 02/02/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 96.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-02' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(timestamp) FROM read_brackets('patient_10038999.br') WHERE SaO2 > 96.0 AND timestamp >= '2100-02-02',[]
db4ef4453f0482846262ad5c,Tell me the total number of patients who stayed in cardiac surgery this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac surgery' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient_id, surgery_date FROM cardiac_surgery WHERE surgery_date BETWEEN '2000-01-01' AND '2000-12-31') AS t1 JOIN (SELECT patient_id, surgery_date FROM cardiac_surgery WHERE surgery_date BETWEEN '2000-01-01' AND '2000-12-31') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.surgery_date = t2.surgery_date AND DATETIME(t1.surgery_date, 'start of year') = DATETIME(t2.surgery_date, 'start of year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e55cd6da77f12e9a3c3752aa,What were the three most frequent microbiology tests that occurred throughout this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT t.microbiology_test, COUNT(t.microbiology_test) FROM (SELECT microbiology_test FROM microbiology WHERE date BETWEEN '2022-01-01' AND '2022-12-31') AS t GROUP BY t.microbiology_test ORDER BY COUNT(t.microbiology_test) DESC LIMIT 3;",[]
3b0b9d06060760720fcc6f1d,Has patient 10005817 been diagnosed with anything?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10005817,[{'COUNT(*)>0': 1}]
01c02f4b897bb8192e16bd1d,What was patient 10016742's minimum value of base excess in 07/this year?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'",SELECT MIN(base_excess) FROM lab_data WHERE patient_id = 10016742 AND date = '07/this year',[{'MIN(labevents.valuenum)': None}]
ecd2a10f46954975185155af,What was during the last month patient 10038992's minimum alanine aminotransferase (alt) value?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT MIN(alt) FROM lab WHERE lab.patient_id = 10038992 AND lab.date BETWEEN DATEADD(month, -1, CURRENT_DATE) AND CURRENT_DATE",[{'MIN(labevents.valuenum)': None}]
d6121ad75765bc51dceaf4c9,When patient 10018501 was last discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018501 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = '10018501';,[{'dischtime': '2141-08-05 18:06:00'}]
328c8f2538243e8dd6f5da24,What was the total cefpodoxime proxetil dose that has been prescribed during the first hospital encounter to patient 10020786?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'cefpodoxime proxetil',SELECT SUM(cefpodoxime_proxetil) FROM prescriptions WHERE prescriptions.patient_id = 10020786 AND NOT prescriptions.had_any_effect = 0 AND prescriptions.drug_name = 'Cefpodoxime Proxetil',[{'SUM(prescriptions.dose_val_rx)': None}]
beba565897d39febcb35f999,"How many hours have passed since patient 10018081 got her first diagnosis of congestive heart failure, unspecified on this hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE diagnosis_type = 'congestive heart failure, unspecified' AND patient_id = 10018081;",
215bb31f610d65f9b86033ff,How many hours is it since patient 10021487 first received the epithelial cells lab test during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.lab_result_date)) FROM patient WHERE patient.patient_id = 10021487 AND patient.lab_result_type = 'epithelial cells' AND patient.hospital_location = 'current hospital'",[]
65f6f12656c77dd1d0e81081,How much does the drug clobetasol propionate 0.05% ointment cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clobetasol propionate 0.05% ointment' ),SELECT DISTINCT cost FROM drugs WHERE drug = 'Clobetasol Propionate 0.05% Ointment',
eb857cd3f9ec24928e8c1674,When was the first time patient 10018081 SaO2 was measured greater than 98.0 yesterday.,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 98.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime(patient.sao2.measured_at, '%Y-%m-%d %H:%M:%S') FROM patient WHERE patient.id = 10018081 AND patient.sao2.measured_at >= strftime(CURRENT_TIME, '-1 day') AND patient.sao2.measured_at < strftime(CURRENT_TIME, '-2 days') AND patient.sao2.value > 98.0",[]
3e1d007895353da9f631ad02,List the top three most common events this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT Event, COUNT(Event) FROM events WHERE Event IN (SELECT Event FROM events WHERE Date BETWEEN '2012-01-01' AND '2012-12-31' ORDER BY COUNT(Event) DESC LIMIT 3)",[]
3ebc0a16e6352b3a0ce7bfab,"For patients diagnosed with right bundle branch block before, what are the top four most common treatments within the same month since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'right bundle branch block' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t.treatment, t.time FROM (SELECT patient.id, treatment.time FROM treatment JOIN patient ON treatment.patient = patient.id WHERE treatment.time >= '2100-01-01') AS t GROUP BY t.treatment HAVING MIN(t.time) = t.time) AS t1 JOIN (SELECT patient.id, treatment.time FROM treatment JOIN patient ON treatment.patient = patient.id WHERE treatment.time >= '2100-01-01') AS t2 ON t1.treatment = t2.treatment WHERE DATE_PART('month', t1.time) = DATE_PART('month', t2.time) GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 4",
1768d3075c1fd4b1f229afae,Has patient 10018845 received a laboratory test since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10018845 AND STRFTIME('%y-%m', lab_results.date) >= '2100-04'",[{'COUNT(*)>0': 1}]
e1bb157131c54de5c76b3a0c,When did patient 10018081 have the first systolic blood pressure observed to be less than 130.0 on this ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 130.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(br.systolic_blood_pressure) FROM (SELECT * FROM icu WHERE icu.patient_id = 10018081) AS br WHERE br.systolic_blood_pressure < 130.0,[]
b628445609db036ce56787c3,Has there been any organism present in patient 10038999's first pleural fluid microbiology test since 8 months ago?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-8 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT COUNT(*) > 0 FROM Microbiology WHERE Microbiology.patient_id = 10038999 AND Microbiology.sample_type = 'first pleural fluid' AND DATETIME(Microbiology.date) >= DATETIME(CURRENT_TIME, '-8 month')",[{'COUNT(*)>0': 0}]
7ccdae90c6ad3af703d3e038,List the top three most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT diagnosis, COUNT(*) FROM diagnoses GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 3;","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]"
8a73eab771e03264c24fffde,What was the first value of respiratory rate patient 10014078 had?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(respiratory_rate) FROM respiratory_rate WHERE patient_id = 10014078,[]
63e6ff5237da6b07b0c8a2d7,Tell me the count of other and unspecified pneumonectomy procedures that took place since 1 year ago.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.other = 'unspecified pneumonectomy' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year')",
822c7c92c1f48adca005dc81,Show the number of patients who underwent clipping of aneurysm since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'clipping of aneurysm' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date FROM t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t2.date >= ""2100-01-01"" AND t2.event = ""clipping of aneurysm"") AS t1",
d4a8c8cbd9db88a331e52ca2,"During their last hospital visit, was patient 10014078 admitted to an emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.location = 'emergency room admit' AND NOT admissions.dischtime IS NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'COUNT(*)>0': 0}]
08421f07d795de9a81dbc4b1,"Since 08/11/2100, when was the last input time of patient 10039831?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10039831 AND input_time >= '2100-08-11',[{'starttime': '2115-12-30 13:05:00'}]
3a019edb3d03bf43064b460c,How many cases involved the prescription of tiotropium bromide throughout this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tiotropium bromide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'Tiotropium Bromide' AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT(*)': 0}]
d37a478c48d46a196ddaac05,What is the average total hospital cost for a patient diagnosed with abnormal involuntary movements?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal involuntary movements' ) ) GROUP BY cost.hadm_id ) AS T1,"SELECT AVG(Total_Hospital_Cost) FROM ""abnormal involuntary movements"" WHERE ""diagnosis"" = 'abnormal involuntary movements'",
644187bf34aa3678b61cb3f5,Has any organism been found in patient 10010471's last microbiological blood culture test in 08/last year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*) > 0 FROM Microbiological_Blood_Cultures WHERE Microbiological_Blood_Cultures.patient_id = 10010471 AND Microbiological_Blood_Cultures.blood_culture_date = DATE '2008-12-31' AND NOT Microbiological_Blood_Cultures.blood_culture_date IS NULL,[{'COUNT(*)>0': 0}]
271a7ff6c3f876ddc5c5cbfc,How many patients were given a triiodothyronine (t3) lab test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.lab_value(DISTINCT patient.lab_value) AND DATETIME(patient.lab_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ef4ea41e6cdc6751ebe50de2,Show me the top three most frequent specimens tested in 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen FROM (SELECT specimen, COUNT(specimen) FROM brackets.species WHERE tested_in = 2100 GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3) AS subquery;",[]
a7766be547dac94471bb1f74,How many hours have elapsed since the last time during this hospital encounter that patient 10018081 was diagnosed with unspecified protein-calorie malnutrition?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified protein-calorie malnutrition' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnoses WHERE patient_id = 10018081 AND diagnosis = 'Unspecified protein-calorie malnutrition'",
ce863b6ee4d6d50f7003ce48,"When did patient 10027602 have a total protein, csf lab test for the first time during the last hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT lab.date FROM lab WHERE lab.patient = (SELECT patient.id FROM patient WHERE patient.hospital_visits = (SELECT COUNT(DISTINCT patient.hospital_id) FROM patient WHERE patient.id = 10027602 AND NOT patient.dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1)) AND lab.label = 'Total Protein, CSF' ORDER BY lab.date NULLS FIRST LIMIT 1",[]
e07aaf85d212b1a4dea88b36,What is the maximum total cost of the hospital visits that included right heart cardiac catheterization?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(t1.total_cost) FROM (SELECT SUM(cost) AS total_cost FROM (SELECT cost FROM cost_table WHERE cost_table.item = 'right heart cardiac catheterization') AS t1 JOIN patient_table ON t1.patient_id = patient_table.patient_id GROUP BY t1.patient_id) AS t2,
1b28768e1c1598353e806a5d,What was the daily maximum input of or colloid intake for patient 10039831 on the current ICU encounter?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",SELECT MAX(input) FROM intake WHERE patient = 10039831 AND icu = 1 AND intake.type = 'or colloid' AND date = '2022-04-01';,[]
d53298425ae0be6acf19c43b,When for the first time in 08/2100 was patient 10031404 prescribed atorvastatin and acetaminophen at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'atorvastatin' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT MIN(formula_date) FROM (SELECT patient_id, prescription_date FROM prescriptions WHERE prescription_date BETWEEN '2008-01-01' AND '2008-12-31' AND patient_id = 10031404) AS t WHERE t.prescription_date BETWEEN (SELECT prescription_date FROM prescriptions WHERE patient_id = 10031404 AND prescription = 'atorvastatin') AND (SELECT prescription_date FROM prescriptions WHERE patient_id = 10031404 AND prescription = 'acetaminophen')",[]
1688c6b7696b2a979945cb6c,How many operating rooms exist right now?,,SELECT COUNT(*) FROM Operating_Room WHERE Status = 'exists',
169d3a6eec5e7a3446cd5c85,Did patient 10021118 have or crystalloid intake input on their first ICU stay?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM icu_inputs WHERE icu_inputs.patient_id = 10021118 AND icu_inputs.input_type = 'or crystalloid',[{'COUNT(*)>0': 0}]
46f0cc9294673a19abea3ead,"During what last time during the first hospital visit did patient 10038992 have the maximum urea nitrogen, urine level?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1","SELECT MAX(UreaNitrogen, Urine) FROM hospital WHERE PatientID = 10038992 AND NOT HospitalDischtime IS NULL ORDER BY HospitalAdmittime NULLS FIRST LIMIT 1",[]
9ccc39b8569c5131efee591e,"Was chlorhexidine gluconate 0.12% oral rinse, fexofenadine, or ketorolac ordered during the last hospital visit for patient 10019385?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'chlorhexidine gluconate 0.12% oral rinse', 'fexofenadine', 'ketorolac' )","SELECT COUNT(*) FROM orders WHERE patient_id = 10019385 AND order_date = (SELECT MAX(order_date) FROM orders WHERE patient_id = 10019385 AND order_type = 'hospital visit') AND medication = IN ('chlorhexidine gluconate 0.12% oral rinse', 'fexofenadine', 'ketorolac')",[{'COUNT(*)>0': 0}]
217fb62b4029d43c8d4778f8,"In 2100, what were the top three most common specimens tested on patients within the same month after the diagnosis of body mass index (bmi) 35.0-35.9, adult?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index (bmi) 35.0-35.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, DATE_TRUNC('month', t2.diagnosis_date) AS diagnosis_month FROM (SELECT patient.name, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'body mass index (bmi) 35.0-35.9, adult') AS t1 JOIN (SELECT patient.name, specimen, diagnosis_date FROM specimen JOIN patient ON specimen.patient_id = patient.patient_id) AS t2 ON t1.name = t2.name WHERE t1.diagnosis_month = t2.diagnosis_month) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 3",
e6301d5787e165024081b9d7,"What drug was patient 10022017 prescribed for within the same day after undergoing bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach in 10/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-10' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT t1.drug FROM (SELECT patient.date FROM patient WHERE patient.patient_id = 10022017) AS t1 JOIN (SELECT patient.date FROM patient WHERE patient.patient_id = 10022017) AS t2 ON t1.date = t2.date WHERE t1.drug <> t2.drug AND DATETIME(t1.date, 'start of day') = DATETIME(t2.date, 'start of day') AND t1.date < t2.date ORDER BY t1.date DESC LIMIT 1",
48e8561f4462026521fab248,What are the top three diagnoses of patients in their 20s during this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT t.diagnosis FROM (SELECT unnest(array_agg(distinct diagnosis)) AS diagnosis FROM patients WHERE age BETWEEN 20 AND 29 GROUP BY diagnosis) AS t1 JOIN patients ON t1.diagnosis = patients.diagnosis WHERE date_part('year', patients.date) = date_part('year', current_date) GROUP BY t1.diagnosis) AS t2 WHERE c1 <= 3",
d0e1bf41e5fd8ca04ae79ba4,What were the total amount of sterile water input that patient 10007818 received in their first ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' ),SELECT SUM(sterile_water_input) FROM icu_input WHERE icu_input.patient_id = 10007818 AND NOT icu_input.out_of_bounds = true AND icu_input.unit = 'brackets',[{'SUM(inputevents.totalamount)': None}]
ba7f88a5002e6408a7156eed,When did patient 10021487 first get the rapid respiratory viral screen & culture's microbiology test since 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT DATE(test_date) FROM respiratory_viral_screen_culture WHERE patient_id = 10021487 AND test_type = 'microbiology' AND date_sub('month', TIMESTAMP '2021-12-2100', TIMESTAMP '2021-12-2100 - 0.5 years') <= 0",[]
9c48cfc44e14602d0728ed28,What are the single rooms available?,,,
6d74cbf5c9fe6defe17b715e,What was the last albuterol inhaler dose that patient 10015931 was prescribed on their last hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'albuterol inhaler' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(albuterol_inhaler) FROM prescriptions WHERE prescriptions.patient_id = 10015931 AND NOT prescriptions.dischtime IS NULL ORDER BY prescriptions.admittime DESC LIMIT 1;,[]
b180907473d137cd5300bdf3,How many days was patient 10001725's first stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT STRFTIME('%j', DATETIME('10001725', 'end of ICU stay 1')) - STRFTIME('%j', DATETIME('10001725', 'start of ICU stay 1')) FROM dual;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.338587962090969}]"
42495442e7c6484bb48ed957,Tell me the icd-11 code for tobacco use disorder in icd-10?,,SELECT icd_11_code FROM icd_10_to_icd_11 WHERE icd_10_code = 'tobacco use disorder',
cf40d706cfc1f0846399ec24,What was the name of the organism found in patient 10029291's last stool microbiology test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM microbiology_data WHERE patient_id = 10029291 AND stool_microbiology_type = 'last' AND organism_name IS NOT NULL;,[]
0a403bb61217529f94970734,What was patient 10018081's maximum systolic blood pressure since 06/07/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-07'",SELECT MAX(systolic_blood_pressure) FROM systolic_blood_pressure WHERE patient_id = 10018081 AND date >= '2100-06-07',[{'MAX(chartevents.valuenum)': None}]
0d4db28074f3b1bafc59af7e,What is patient 10011398's chloride change last measured on the first hospital visit compared to the value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab_results.chloride FROM lab_results WHERE lab_results.patient_id = 10011398 AND NOT lab_results.hospital_visit_number IS NULL ORDER BY lab_results.measurement_date NULLS FIRST LIMIT 1) - (SELECT lab_results.chloride FROM lab_results WHERE lab_results.patient_id = 10011398 AND NOT lab_results.hospital_visit_number IS NULL ORDER BY lab_results.measurement_date DESC LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
52796db611e85270a50a17e5,What is the minimum total hospital cost that involved control of epistaxis by anterior nasal packing procedure since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'control of epistaxis by anterior nasal packing' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM operations WHERE op_name = 'control of epistaxis by anterior nasal packing' AND TIMESTAMP >= '2100-01-01' GROUP BY patient_id) AS t1,
a252cc04ca403620d3979914,When was patient 10004720 prescribed the drugs glucose gel and glucagon at the same time for the last time in 12/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucose gel' AND admissions.subject_id = 10004720 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10004720 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM patients WHERE patient_id = 10004720 AND prescription_name = 'glucose gel' INTERSECT SELECT MAX(date_prescribed) FROM patients WHERE patient_id = 10004720 AND prescription_name = 'glucagon',[]
c6fff4b55ab874dfb73037a3,"What are the four commonly given procedures for patients that also received reposition left mandible with external fixation device, percutaneous approach previously within 2 months, since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.date_reposition LEFT JOIN t3 ON t2.date_reposition = t3.date_insertion WHERE t3.device_type = 'external fixation device' AND STRFTIME('%y', t2.date_reposition) >= '2100') AS t1 JOIN (SELECT t1.subject_id, t2.date_insertion FROM (SELECT t1.subject_id, CAST(DATE(date_insertion) AS DATE) AS date_insertion FROM t4 JOIN t5 ON t4.subject_id = t5.subject_id WHERE t5.device_type = 'external fixation device' AND STRFTIME('%y', t2.date_insertion) >= '2100') AS t1 JOIN (SELECT subject_id, date_reposition FROM t2 JOIN t3 ON t2.date_reposition = t3.date_insertion WHERE t3.device_type = 'external fixation device' AND STRFTIME('%y', date_reposition) >=",
fa7d9e05618f719c725c75ab,What is the total number of patients who stayed in careunit surgical intensive care unit (sicu)?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'surgical intensive care unit (sicu)' ),"SELECT COUNT(DISTINCT patient_id) FROM careunit_stay WHERE careunit_type = ""surgical intensive care unit (SICU)""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
85c838d478a4f152e0c9879e,When was the last discharge of patient 10020944 from the hospital?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020944 ORDER BY admissions.dischtime DESC LIMIT 1,SELECT MAX(dischtime) FROM patient WHERE patient.subject = 10020944;,[{'dischtime': '2131-03-13 17:01:00'}]
42b27d5b68477ed32b23938a,What was the first respiratory rate in patient 10019172's body since 145 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-145 day') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(respiratory_rate) FROM (SELECT respiratory_rate FROM exhalation_data WHERE exhalation_data.patient_id = 10019172 AND NOT respiratory_rate IS NULL AND DATETIME(exhalation_date) >= DATETIME(CURRENT_TIME, '-145 day'))",[]
0e206bae559f3646f2535376,Let me know what i'll need to prepare for the delayed clos abd wound procedure,,SELECT * FROM Posts WHERE Closed = 'true' AND Wound = 'delayed clos abd',
989ff39a5fc2d15ff9d12bef,Could you tell me the sex of patient 10007928?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10007928,"SELECT MIN(MEMBER_SEX) FROM (SELECT MEMBER_SEX FROM ""patients"" WHERE PATIENT_ID = 10007928)",[{'gender': 'F'}]
566bbc92e52ac6c9cd03050c,"Today compared to yesterday, what new drugs are being prescribed to patient 10004733?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT date_sub('day', CURRENT_TIMESTAMP, PRESCRIBE_DATE) FROM prescriptions WHERE patient_id = 10004733 AND date_sub('day', CURRENT_TIMESTAMP, PRESCRIBE_DATE) > 0",[]
388e3fc0fa30e6c5b9011872,"Count the number of people who received introduction of nutritional substance into lower gi, via natural or artificial opening in the same month after having been diagnosed with epilepsy, unspecified, not intractable, without status epilepticus in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM diagnoses WHERE diagnosis = 'EPILEPSY, UNSPECIFIED, NOT INTRACTABLE, WITHOUT STATUS EPILEPTICUS' AND year = 2100) AS t1 JOIN (SELECT subject_id, diagnosed_date FROM diagnoses WHERE diagnosis = 'INTRODUCTION OF NUTRITIONAL SUBSTANCE INTO LOWER GI, VIA NATURAL OR ARTIFICIAL OPENING' AND year = 2100) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date < t2.diagnosed_date AND DATETIME(t1.diagnosed_date, 'start of month') = DATETIME(t2.diagnosed_date, 'start of month')",
f548e5423305443cc9bd89c3,When did patient 10005909 first depart from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005909 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1","SELECT strftime(departure_date, '%Y-%m-%d %H:%M:%S') as formatted_date",[{'dischtime': '2144-11-02 15:23:00'}]
d0c67568fc6aa214a04e3aaa,When did patient 10037928 have the minimum anion gap value the last time?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MIN(anion_gap) FROM brackets WHERE patient_id = 10037928,[]
d080d1e38919b6a529de708c,When did patient 10015931 first have the minimum amount of ph in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT MIN(ph) FROM patient WHERE patient.id = 10015931 AND DATETIME(ph, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND DATETIME(ph, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')",[]
03b89b45a7325ecb997b183f,Do you have any suggestions for preparation for the temporary tracheostomy procedure?,,"SELECT * FROM procedures WHERE procedure = ""Temporary tracheostomy"";",
f591b46504d2236b89d77bf8,What are the total number of fiber-optic bronchoscopy procedures performed during the previous year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'fiber-optic bronchoscopy' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year');",
5a435c4f165c08508edbd449,"How many patients in the last year were diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t1.subject_id, t2.chronic_kidney_disease_stage_i, t2.chronic_kidney_disease_stage_iv FROM (SELECT subject_id, diagnosis_date FROM duckdb_diagnoses WHERE diagnosis_date >= (SELECT MAX(diagnosis_date) FROM duckdb_diagnoses WHERE diagnosis_date <= (SELECT current_date - INTERVAL '1 year'))) AS t1 JOIN (SELECT subject_id, chronic_kidney_disease_stage_i, chronic_kidney_disease_stage_iv FROM duckdb_chronic_kidney_disease WHERE diagnosis_date >= (SELECT MAX(diagnosis_date) FROM duckdb_diagnoses WHERE diagnosis_date <= (SELECT current_date - INTERVAL '1 year'))) AS t2 ON t1.subject_id = t2.subject_id WHERE t2.chronic_kidney_disease_stage_i = '",
45cf63c5e6579e640cddd3b1,Can you tell me the last value of the alkaline phosphatase test for patient 10015931 on the first hospital encounter?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT lab.result FROM lab WHERE lab.patient_id = 10015931 AND lab.test = 'alkaline phosphatase' ORDER BY lab.result DESC LIMIT 1;,[]
e8fdd9acc2da7140baf49188,Does patient 95470 have reflux esophagitis in his family?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.family_member_id IN (SELECT patient_95470.family_member_id FROM patient_95470 WHERE patient_95470.diagnosis = 'reflux esophagitis'),
643390539a60fbe52d9fc05a,Has patient 10019385 had a hospital admission since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(*) > 0 FROM patient WHERE patient.hospital_admission_date >= ""2100-01-01"" AND patient.uniquepatientid = 10019385",[{'COUNT(*)>0': 1}]
3c678de40d16a9eae2e6f6dd,Are you letting me know if patient 3677 is subject to covid-19 testing?,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_to_covid_19_testing = 1 AND patients.patient_id = 3677,
ffeeae0595efa3f5c9f10a86,"What is the minimum total cost of the hospital, which includes the glucocorticoid deficiency?",SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'glucocorticoid deficiency' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(DISTINCT t1.c1) FROM (SELECT SUM(cost) AS c1 FROM hospital WHERE diagnosis = 'glucocorticoid deficiency' GROUP BY cost) AS t1,
4f90e141b3068b6b2ff3d1a5,Is there any medication that patient 10039831 has received in 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10039831 AND STRFTIME('%y', medication.date) = '2100'",[{'COUNT(*)>0': 0}]
aed29b51a927aae66b5d4811,What was the last time that patient 10022041 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022041 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",SELECT MAX(dischtime) FROM patient WHERE patient.subject = 10022041;,[]
f4526c3446deb95d067dc788,How long took entral infus nutrit sub for patient 10855?,,SELECT COUNT(DISTINCT entral_infus_nutrit_sub) FROM entrals WHERE patient_id = 10855,
f4bb5d766bfd7957102de24a,"Since 05/12/2100, when did patient 10020740 have his last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-12' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT input_date FROM input_table WHERE patient_id = 10020740 AND input_date >= '2100-05-12' ORDER BY input_date DESC LIMIT 1,[{'starttime': '2150-06-04 19:53:00'}]
c4afaf3f596cdc2be83cac17,How many days have elapsed since the last time patient 10039831 got a creatinine lab test on the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', Creatinine_Lab_Date)) FROM Creatinine_Lab_Results WHERE Creatinine_Lab_Results.patient_id = 10039831 AND Creatinine_Lab_Results.lab_date = Creatinine_Lab_Date",[]
4ebb5e52ed23ff0830bbedbf,What are the four most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.drug FROM (SELECT prescriptions.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions GROUP BY prescriptions.drug) AS t1 WHERE t1.c1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]"
ccf60f7cf6c692a95a30282b,Tell me the duration in days of patient 10004720's last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', icu.out_time) - STRFTIME('%j', icu.in_time) FROM icu WHERE icu.patient_id = 10004720 AND NOT icu.out_time IS NULL ORDER BY icu.in_time DESC LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.056192129850388}]"
0d8dbb180db73cb98f531c2d,Tell me the top four most common specimens tested since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT specimen, COUNT(*) FROM results WHERE date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]"
b2d4a908cb2de00418d09277,How much does it cost for a other specified disorders of stomach and duodenum diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified disorders of stomach and duodenum' ) ),"SELECT COUNT(DISTINCT diagnosis_id) FROM diagnoses WHERE diagnosis_type = ""Other specified disorders of stomach and duodenum""",
908ae520eb086d09751ea4b9,What are the top four diagnoses of patients in their 30s since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.diagnosis FROM (SELECT t3.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosisdate >= '2100-01-01' AND patient.age BETWEEN 30 AND 39) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosisdate >= '2100-01-01' AND patient.age BETWEEN 40 AND 49) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.diagnosisdate GROUP BY t1.diagnosis) AS t3 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.",
1d9b6672711d15ed28bd19bc,How much is the minimum total hospital cost associated with pseudomonas infection in conditions classified elsewhere and of unspecified site this year?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pseudomonas infection in conditions classified elsewhere and of unspecified site' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_pseudomonas INFECTION IN UNKNOWN SITE AND CLASSIFY ELSEWHERE AND YEAR(diagnosis_date) = 2000 GROUP BY patient_id) AS t1,
fabc39d4768ddcfc1eaea089,Tell me the amount of po intake input that patient 10018845 received since 01/28/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-28'",SELECT SUM(PO_INTake) FROM intake WHERE Patient_ID = 10018845 AND Date >= '2100-01-28',[{'SUM(inputevents.totalamount)': None}]
468732462fc76ffb0eabb559,What was the admission type for patient 10003046 during their last hospital admission?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10003046 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1","SELECT ""admission_type"" FROM ""patient_admission"" WHERE ""patient_id"" = 10003046 AND NOT ""dischtime"" IS NULL ORDER BY ""admittime"" DESC LIMIT 1;",[]
7d25ac3b59f8763886afb8a7,What are the prices of the drug 0.83% sodium chloride?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = '0.83% sodium chloride' ),SELECT AVG(price) FROM drugs WHERE drug = '0.83% Sodium Chloride',
54afc6318164ae9f335372fe,Is there any new medication in the prescription of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT COUNT(*) > 0 FROM prescription WHERE prescription.patient_id = 10018081 AND DATETIME(prescription.date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day') AND DATETIME(prescription.date, 'start of day') <> DATETIME(CURRENT_TIME, 'start of day', '-1 day')",[]
4334a09dd6d34538cc7445dc,What was the drug prescribed to patient 10007795 for the first time via im route during the first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescription.drug FROM prescription WHERE prescription.patient_id = 10007795 AND prescription.route = 'im' ORDER BY prescription.date NULLS FIRST LIMIT 1;,[]
e7552c3d9e8f53dd5494cd5d,"What is the cost for the procedure other operations on carotid body, carotid sinus and other vascular bodies?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other operations on carotid body, carotid sinus and other vascular bodies' ) )","SELECT SUM(cost) FROM procedures WHERE procedure = 'Other operations on carotid body, carotid sinus and other vascular bodies';",
ae5ec3820a0b5ba66f56bc5a,"What is the total number of patients who underwent drainage of pericardial cavity with drainage device, percutaneous approach in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT patient_id) FROM procedures WHERE procedure_name = 'Drainage of pericardial cavity with drainage device, percutaneous approach' AND year = 2100",
9446bf724e050f51ed6448e1,What's the ward id that can get patient 56490 in?,,SELECT ward_id FROM patient WHERE patient_id = 56490,
e5194571023c182470d8d9f8,When was the first time that patient 10005817's heart rate was measured at less than 84.0 on their first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 84.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM (SELECT heart_rate FROM patient_10005817 WHERE heart_rate < 84.0 AND icu_number = 1),[]
3842f39935a34d58b55be97d,"Did patient 10013049 get a sodium, whole blood lab test in 06/2100?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'","SELECT COUNT(*) FROM lab WHERE lab.patient_id = 10013049 AND lab.label = 'Sodium, Whole Blood' AND STRFTIME('%y-%m', lab.date) = '2100-06'",[{'COUNT(*)>0': 0}]
c6b942401a65b3fa2db93ef0,What kind of blood patient 18866 has.,,"SELECT ""blood"" FROM ""patients"" WHERE ""patient_id"" = 18866",
b6199c44eb942b29559195b3,Has patient 17944 arranged an appointment with another department?,,SELECT COUNT(*) > 0 FROM appointment WHERE appointment.patient_id = 17944 AND appointment.department_id <> 135,
631f6c7b12fe0e5f5fad366d,Has patient 10023239 got a diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patientId = 10023239;,[{'COUNT(*)>0': 1}]
3c21d00c8e06bab6642fad1c,Show the weight changes of patient 10020944 measured at 2100-03-15 04:00:00 compared to the value measured at 2100-03-14 00:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-15 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-14 00:00:00' ),SELECT (SELECT weight_change FROM patient_weight_changes WHERE patient_id = 10020944 AND measurement_time = '2100-03-15 04:00:00') - (SELECT weight_change FROM patient_weight_changes WHERE patient_id = 10020944 AND measurement_time = '2100-03-14 00:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-15 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-14 00:00:00' )"": None}]"
654bb26fa8a99fc375bca767,Calculate the total volume of input by patient 10020740 on 04/07/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-07'",SELECT SUM(volume) FROM (SELECT volume FROM input WHERE patient = 10020740 AND date = '04/07/2100'),[{'SUM(inputevents.totalamount)': None}]
fbe7d2b820e2ed531e0311d7,What is the pricing for 0.9% sodium chloride?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = '0.9% sodium chloride' ),SELECT * FROM pricing WHERE product = '0.9% Sodium Chloride';,
fe7e8800a8ef335ce9596217,Has any medicine been prescribed to patient 10038933 since 5 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month')","SELECT COUNT(*) > 0 FROM medication_usage WHERE patient_id = 10038933 AND date_sub('month', CURRENT_DATE, date_prescribed) >= 5",[{'COUNT(*)>0': 1}]
d66c3f48f55c47d9fb861e1f,Count the ICU visits of patient 10031404 during the last year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(ICU_VISITS) FROM (SELECT ICU_VISITS FROM icu_visits WHERE PATIENT_ID = 10031404) AS subquery WHERE DATETIME(ICU_VISITS.ICU_DATE, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year');",[{'COUNT( DISTINCT icustays.stay_id )': 0}]
285483bc9981158e35956874,"What was the number of dilation of left common iliac vein with intraluminal device, percutaneous approach procedures performed last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT t.Id) FROM Treatments AS t JOIN Brackets ON t.Id = Brackets.TreatmentId WHERE t.TreatmentName = 'Left common iliac vein with intraluminal device, percutaneous approach' AND DATETIME(t.Date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
377abeef64a076e8f592c701,How many hours have elapsed since patient 10039831 last received a mch lab test on their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', mch_lab_time)) FROM mch_lab_data WHERE mch_lab_data.patient_id = 10039831 AND mch_lab_data.hospital_location = 'current hospital'",[]
55afa0bf1f513c0f82f9d9c4,"What was the name of the drug prescribed for patient 10016742 within 2 days after having received a inspection of tracheobronchial tree, via natural or artificial opening endoscopic procedure since 13 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-13 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug_name FROM (SELECT t1.patient_id, t1.date_inspection FROM (SELECT patient_id, date_inspection FROM patient_inspections WHERE date_inspection >= (CURRENT_DATE - INTERVAL '13 month')) AS t1 JOIN patient_prescriptions ON t1.patient_id = patient_prescriptions.patient_id WHERE t1.date_inspection <= (SELECT date_inspection FROM patient_inspections WHERE patient_id = t1.patient_id AND date_inspection >= (CURRENT_DATE - INTERVAL '13 month'))) AS t2 JOIN (SELECT patient_id, date_prescription FROM patient_prescriptions WHERE date_prescription >= (CURRENT_DATE - INTERVAL '13 month')) AS t3 ON t2.patient_id = t3.patient_id WHERE t2.date_inspection < t3.date_prescription AND DATETIME(t3.date_prescription) BETWEEN DATETIME(t2.date_inspection) AND DATETIME(t2",
d376f746682d3677c16ad196,"For patients who were diagnosed with bradycardia, unspecified since 1 year ago, what are the top three most common medications that followed afterward in the same hospital encounter?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.medication FROM (SELECT t2.medication, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.patientid WHERE diagnosis.diagnosis = 'bradycardia, unspecified' AND DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, medication.medication, medication.medicationdate FROM medication JOIN patient ON medication.patientid = patient.patientid WHERE DATETIME(medication.medicinationdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.medicationdate AND t1.patientid = t2.patientid GROUP BY t2.medication) AS t3 WHERE t3.c1 <= 3",
40f3aab550a4fd091b0e4468,When was the first time that patient 10002495 was prescribed a medication during the first hospital visit via sc?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(prescription_date) FROM prescriptions WHERE patient_id = 10002495 AND visit_number = 1,[]
edb18fda949ab33cd5cd47c8,"Is the value of patient 10004720's hematocrit, second measured on the last hospital visit, greater than the first value measured on the last hospital visit?",SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT Hematocrit FROM patient WHERE patient.Hospitalized = 1 AND NOT patient.Hospitalized = 0 AND patient.ID = 10004720 ORDER BY patient.Hospital_Stay_Length DESC LIMIT 1) > (SELECT Hematocrit FROM patient WHERE patient.Hospitalized = 1 AND NOT patient.Hospitalized = 0 AND patient.ID = 10004720 ORDER BY patient.Hospital_Stay_Length DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
13123a9ba850d6caba5a0faa,Has patient 10029484 been diagnosed with any diseases this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10029484 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
def40a677b6ecbf4f1bd3de2,The earliest hospital visit of patient 99661?,,SELECT MIN(Hospital.Visit) FROM Hospital WHERE Hospital.Patient = 99661;,
a0d612dc021f06119cd82641,"When was the first time patient 10021487, on this month/12, had the maximum mean blood pressure?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '12' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",SELECT MAX(mean_blood_pressure) FROM patient_10021487 WHERE date_of_measurement = '2022-03-12',[]
0eb2954ae5544e9247d70c59,What were the number of patients who received a polys test?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) ),SELECT COUNT(DISTINCT id) FROM results WHERE test = 'polys',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ad181c030f922bb1d3793964,What kind of rooms are available right now?,,SELECT room_name FROM rooms WHERE room_count = 1 AND available = true,
e4f4aa529c397e3b7d0ddcd2,"What is the minimum total hospital cost for a person with jaundice, unspecified, not of newborn since 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'jaundice, unspecified, not of newborn' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(ci) AS c1 FROM (SELECT 1 AS ci FROM diagnoses WHERE d_name = 'jaundice, unspecified') AS t1 JOIN (SELECT 1 AS ci FROM diagnoses WHERE d_name = 'newborn') AS t2 ON t1.d_name = t2.d_name WHERE t1.ci >= 2100 GROUP BY t1.d_name) AS t3",
eed2ec21308a4facd8e30ec6,When was the first time that patient 10038081 had the minimum immunoglobulin g value?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",SELECT MIN(immunoglobulin_g) FROM patient_10038081;,[]
e7fa38bcee63c4dff174564d,When did patient 10012853 depart hospital for the first time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient.hospital_discharge_date FROM patient WHERE patient.subject_id = 10012853 ORDER BY patient.hospital_discharge_date NULLS FIRST LIMIT 1;,[{'dischtime': '2175-04-10 16:55:00'}]
749cd7577c772cdc228d8a49,"What percentile is the calcium, total value of 8.2 among patients of the same age as patient 10020740 on the last hospital stay?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.2","SELECT t1.name, t1.value FROM (SELECT patient_id, value FROM lab_data WHERE lab_data.patient_id = (SELECT patient_id FROM patient WHERE name = 'John Doe') AND lab_data.label = 'Calcium, Total' ORDER BY lab_data.date DESC LIMIT 1) AS t1 JOIN patient ON t1.patient_id = patient.patient_id WHERE patient.age = (SELECT age FROM patient WHERE name = 'Jane Doe')",
408df91458c4945438a0d705,"What are the three frequently tested specimens for patients that received bypass coronary artery, one artery from aorta with autologous venous tissue, open approach previously in the same month in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT 3 AS _frequently_tested_specimens FROM patients WHERE bypass_coronary_artery = 'one artery from aorta with autologous venous tissue, open approach' AND STRFTIME('%y', bypass_coronary_artery) = '2100' GROUP BY bypass_coronary_artery ORDER BY COUNT(bypass_coronary_artery) DESC LIMIT 1",
180fff17c7418b127d038bf7,How was patient 10038933 admitted in terms of admission type for the last time?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038933 ORDER BY admissions.admittime DESC LIMIT 1,SELECT AdmissionType FROM Admissions WHERE PatientID = 10038933 ORDER BY AdmissionDate DESC LIMIT 1,[{'admission_type': 'EW EMER.'}]
4712867863ba837a91019c8f,When furosemide and albuterol inhaler were prescribed to patient 10037975 for the first time in 02/this year at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10037975 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol inhaler' AND admissions.subject_id = 10037975 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT COUNT(DISTINCT t1.id) FROM (SELECT patient_id, prescription_date FROM prescriptions WHERE patient_id = 10037975 AND prescription_date BETWEEN '2022-02-01' AND '2022-02-31') AS t1 JOIN (SELECT patient_id, prescription_date FROM prescriptions WHERE patient_id = 10037975 AND prescription_date BETWEEN '2022-02-01' AND '2022-02-31') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.prescription_date = t2.prescription_date AND prescriptions.drug IN ('furosemide', 'albuterol inhaler')",[]
4a4b1ff6e491614e8bed8e49,"How many times, , was a rhinoscopy procedure ordered?",SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'rhinoscopy' ),SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'Rhinoscopy',[{'COUNT(*)': 0}]
79af64ce3260e4d25b227939,What was the amount of tramadol (ultram) prescribed to patient 10012552 in total in 04/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND prescriptions.drug = 'tramadol (ultram)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'",SELECT SUM(tramadol_ultram) FROM patients WHERE patient_id = 10012552 AND date_prescribed BETWEEN '2000-04-01' AND '2000-04-30',[{'SUM(prescriptions.dose_val_rx)': None}]
aac6ebb3d651674fd6c07123,Ist patient 13329 subject to covid-19 testing,,SELECT COUNT(*) > 0 FROM patients WHERE patients.subject_to_covid_19_testing = 13329,
312eb217dff66ce52d145060,How much miconazole nitrate vag cream 2% was given to patient 10021312 for the first time during their first hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'miconazole nitrate vag cream 2%' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT COUNT(*) FROM patients WHERE patients.patient_id = 10021312 AND products.product_name = 'Miconazole Nitrate Vag Cream 2%',[]
19858e80b7638280abbda010,When did patient 10029484 have the maximum ketone value for the last time since 04/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1","SELECT MAX(ketone) FROM patient WHERE patient.id = 10029484 AND STRFTIME('%y-%m', ketone.date) >= '2100-04'",[]
cf44316ed6f26cdb2af0efb9,Could you tell me the average total cost in a hospital where tramadol (ultram) is used since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tramadol (ultram)' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.c1) FROM (SELECT SUM(T2.c2) AS c1 FROM (SELECT 1 AS c2 FROM ""schema"".""table"" WHERE ""column"" = 'tramadol (ultram)') AS T1 JOIN (SELECT 1 AS c2 FROM ""schema"".""table"" WHERE ""column"" = 'tramadol (ultram)') AS T2 ON T1.c1 = T2.c2 GROUP BY T1.c1) AS T3 JOIN (SELECT 1 AS c1 FROM ""schema"".""table"" WHERE ""column"" = 'tramadol (ultram)') AS T4 ON T3.c1 = T4.c1 WHERE T3.c2 >= (SELECT 1 FROM ""schema"".""table"" WHERE ""column"" = 'tramadol (ultram)') - 1",
90edd0b36b71d1dde04a4381,What are the top five most frequent procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.procedure, COUNT(t1.procedure) FROM (SELECT procedure, date_part('year', date) AS year FROM procedures WHERE date_part('year', date) >= 2100) AS t1 JOIN (SELECT date_part('year', date) AS year FROM procedures WHERE date_part('year', date) >= 2100) AS t2 ON t1.year = t2.year GROUP BY t1.procedure ORDER BY COUNT(t1.procedure) DESC LIMIT 5",
a492bf5968b017604595cb27,Has patient 10008454 had any ptt lab tests done since 12/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10008454 AND lab_results.lab_name = 'ptt' AND STRFTIME('%y-%m', lab_results.date) >= '2100-12'",[{'COUNT(*)>0': 0}]
7d7aee677bb35ba8d39e2a8e,What is the recorded sex of patient 10022880?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880,SELECT recorded_sex FROM patients WHERE patient_id = 10022880;,[{'gender': 'M'}]
aa2c37cca4ef58130e2faadd,Tell me the amount of or urine patient 10019172 had since 11/12/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-12'","SELECT COUNT(DISTINCT ""or urine"") FROM ""patient"" WHERE ""patient"" = 10019172 AND ""date"" >= '11/12/2100'",[{'SUM(outputevents.value)': None}]
61943ff9aadb518fc206c477,"What is the cost of a surgery called drainage of pericardial cavity with drainage device, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure = 'Drainage of pericardial cavity with drainage device, percutaneous approach';",
47bcce86f3ab85e1c0edd92a,Is the anion gap value of patient 10014729 on the at 2100-04-02 05:22:00 measurement less than the value from the at 2100-04-01 05:18:00 measurement?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-02 05:22:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-01 05:18:00' ),SELECT (SELECT anion_gap FROM measurements WHERE patient_id = 10014729 AND measurement_date = '2100-04-02 05:22:00') < (SELECT anion_gap FROM measurements WHERE patient_id = 10014729 AND measurement_date = '2100-04-01 05:18:00'),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-02 05:22:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-01 05:18:00' )"": None}]"
0d74b2ee638041bc581f98ec,When was the first sputum microbiology test of patient 10027602's performed in 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT MIN(date) FROM microbiology WHERE patient = 10027602 AND type = 'sputum' AND date BETWEEN '2000-12-2100' AND '2000-12-2100',[]
ded7c37a33a0d81b227fca60,"What's the maximum yearly number of admissions for respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia since 2100?","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT MAX(t1.c1) FROM (SELECT COUNT(DISTINCT diagnosis_date) AS c1 FROM diagnoses WHERE diagnosis_type = ""RESPIRATORY FAILURE, UNKNOWN"" AND hypoxia = ""0"" OR hypoxia = ""1"" GROUP BY diagnosis_date) AS t1 JOIN (SELECT diagnosis_date FROM diagnoses WHERE diagnosis_type = ""RESPIRATORY FAILURE, UNKNOWN"" AND hypoxia = ""0"" OR hypoxia = ""1"") AS t2 ON t1.diagnosis_date = t2.diagnosis_date WHERE t1.diagnosis_date >= ""2100-01-01"" GROUP BY diagnosis_date",
4fac3af5df19be6347d3c772,What is the price for acetazolamide sodium?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' ),SELECT price FROM products WHERE product = 'Acetazolamide Sodium',
1c2f1cfa5e513beb87314705,"What is the diagnosis cost of catatonic type schizophrenia, unspecified?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'catatonic type schizophrenia, unspecified' ) )","SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = ""Catatonic type schizophrenia, unspecified""",
c321346f08463a3979f09efe,What was the accumulated output for patient 10004733 since 10/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-26'","SELECT SUM(output) FROM (SELECT patient_id, output FROM postgres_scan('', 'public', 'output') WHERE patient_id = 10004733 AND output_date >= '2100-10-26') subquery;",[{'SUM(outputevents.value)': 17410.0}]
d121006b2aba46e7a9730510,When did patient 10020944 get input on the first ICU stay for the first time?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1,SELECT icu.input_date FROM icu WHERE icu.patient_id = 10020944 AND NOT icu.output_date IS NULL ORDER BY icu.input_date NULLS FIRST LIMIT 1;,[{'starttime': '2131-02-27 17:30:00'}]
48ea16ef9a9f1871ed032c14,What are the three most often performed treatments for patients aged 60 or above in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.treatment FROM (SELECT treatment, COUNT(treatment) AS c FROM (SELECT patient.name, treatment FROM treatment JOIN patient ON treatment.patient = patient.name WHERE treatment.year = 2100) AS t1 JOIN (SELECT patient.name, patient.age FROM patient WHERE patient.age >= 60) AS t2 ON t1.patient = t2.name) GROUP BY treatment ORDER BY c DESC LIMIT 3;",
1c7af8d5ad19cc00a657ccc2,When did patient 10027445 get a microbiology test for the first time since 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiology_date FROM microbiology_tests WHERE patient_id = 10027445 AND STRFTIME('%y-%m', microbiology_date) >= '2100-02' ORDER BY microbiology_date NULLS FIRST LIMIT 1",[{'charttime': '2142-07-31 06:07:00'}]
86b774ee38e2c7aa2ac12919,"Among patients who were diagnosed with hip joint replacement, what were the top five most common microbiology tests conducted within 2 months in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hip joint replacement' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT t2.Microbiology, COUNT(t2.Microbiology) FROM (SELECT t1.Subject, t1.Date FROM (SELECT Subject, Date FROM patients WHERE Joint = 'Hip') AS t1 JOIN (SELECT Subject, Date FROM procedures WHERE Year = 2100) AS t2 ON t1.Subject = t2.Subject WHERE t2.Date < t1.Date AND DATETIME(t2.Date) BETWEEN DATETIME(t1.Date) AND DATETIME(t1.Date, '+2 month') GROUP BY t2.Microbiology ORDER BY COUNT(t2.Microbiology) DESC LIMIT 5",
876fc2621bff0c8dd69e9b66,Count the number of patients in neuro stepdown in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE treatment_step = 'neuro stepdown' AND DATETIME(treatment_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
38d2cf0507adde7b8f7a6eb3,"Tell me the name of the drug patient 10007818 was prescribed during the same day after having received a fluoroscopy of superior vena cava using other contrast, guidance procedure in 07/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",SELECT name FROM drugs WHERE patient_id = 10007818 AND procedure_date = '07/2016' AND treatment_type = 'drug',
c8620b45b18ebc1c914a2581,Does patient 3242 have a family history of malign neopl prostate?,,"SELECT COUNT(*) FROM patients WHERE patients.family_history = ""Malign neopl prostate"" AND patients.id = 3242",
44a6d21d8264b4fa98a0113f,Tell me the price of gemfibrozil.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil' ),SELECT price FROM products WHERE product = 'gemfibrozil',
71621e85a074b2ac8ffc6ace,How many hours has it been since patient 10004733's last cholesterol ratio (total/hdl) lab test in their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol ratio (total/hdl)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result.result_date)) FROM lab_result WHERE lab_result.patient_id = (SELECT patient.patient_id FROM patient WHERE patient.hospital_location = (SELECT hospital.hospital_location FROM hospital WHERE hospital.hospital_name = 'Taylor hospital')) AND lab_result.result_type = 'cholesterol ratio (total/hdl)' ORDER BY lab_result.result_date DESC LIMIT 1;",[]
f6c6d5c25fc74762144de677,"What is the average total hospital cost that involved implantation or replacement of carotid sinus stimulation device, total system since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(Total_Hospital_Cost) FROM (SELECT SUM(Total_Hospital_Cost) FROM (SELECT Total_Hospital_Cost FROM ""carotid_sinus_stimulation_device.csv"" WHERE Implantation_or_Replacement = 'Carotid sinus stimulation device') AS T1 JOIN (SELECT Score, Total_Hospital_Cost FROM ""carotid_sinus_stimulation_device.csv"" WHERE Implantation_or_Replacement = 'Carotid sinus stimulation device') AS T2 ON T1.Score = T2.Score) AS T3 WHERE T3.Total_Hospital_Cost >= (SELECT AVG(Total_Hospital_Cost) FROM (SELECT SUM(Total_Hospital_Cost) FROM (SELECT Total_Hospital_Cost FROM ""carotid_sinus_stimulation_device.csv"" WHERE Implantation_or_Replacement = 'Carotid sinus stimulation device') AS T1 JOIN (SELECT Score, Total_Hospital_Cost FROM ""carotid_sinus_stimulation_device.csv"" WHERE Implantation_",
11608a4c97632da4a6c7043d,What is the name of the drug which should not be administered during the venous cath nec procedure?,,SELECT name FROM drugs WHERE id IN (SELECT id FROM procedures WHERE name = 'venous cath nec');,
65a18d6c6863a8702f23d4ed,Did patient 10016810 have albumin 25% input during their first ICU visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) > 0 FROM icu_inputs WHERE icu_inputs.patient_id = 10016810 AND icu_inputs.input_type = 'albumin 25%' AND NOT icu_inputs.end_time IS NULL ORDER BY icu_inputs.start_time NULLS FIRST LIMIT 1,[{'COUNT(*)>0': 0}]
4f7c481bcc13707e66944d07,"What are the three frequently ordered drugs for patients diagnosed with tobacco use disorder previously in the same month, this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT t3.drug FROM (SELECT t2.drug, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'tobacco use disorder' AND DATETIME(diagnosis.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1 JOIN (SELECT patient.id, drug.drug, drug.drug_date FROM drug JOIN patient ON drug.patient_id = patient.id WHERE DATETIME(drug.drug_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.drug_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.drug_date",
559cabbd94ac4b49afae49bd,How much does patient 10020187's weight differ from the last value measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT weight FROM patient_weight WHERE patient_id = 10020187 AND NOT patient_weight.date IN (SELECT patient.date FROM patient WHERE patient.id = 10020187 AND NOT patient.date IS NULL ORDER BY patient.date DESC LIMIT 1)) - (SELECT weight FROM patient_weight WHERE patient_id = 10020187 AND NOT patient_weight.date IN (SELECT patient.date FROM patient WHERE patient.id = 10020187 AND NOT patient.date IS NULL ORDER BY patient.date DESC LIMIT 1) ORDER BY patient_weight.date NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
771ae0e7dfa569d1298f749c,What is the difference between weights last measured on the current hospital visit compared to the second to last value measured on the current hospital visit for patient 10018081?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT weights_kg FROM patient_weight_summary WHERE patient_id = 10018081 AND measurement_time = (SELECT MAX(measurement_time) FROM patient_weight_summary WHERE patient_id = 10018081 AND current_hospital_visit = 1)) - (SELECT weights_kg FROM patient_weight_summary WHERE patient_id = 10018081 AND measurement_time = (SELECT MAX(measurement_time) FROM patient_weight_summary WHERE patient_id = 10018081 AND current_hospital_visit = 1) - INTERVAL '1 month');,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
28f891c6136adc2119884018,Calculate the number of patients who were discharged from the hospital in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(DISTINCT patient_id) FROM discharge_summary WHERE date_discharged >= (SELECT MAX(date_discharged) FROM discharge_summary) - INTERVAL '1 year';,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
4fbd4f9863cff8b2fd42e23b,Did patient 10019777 undergo the procedure on single vessel in the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10019777 AND procedures.procedure_name = 'single vessel' AND DATETIME(procedures.procedure_date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year')",
e65595aa4d0b66d5c6625a99,When did patient 10022017 first depart from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient.hospital_departure_date FROM patient WHERE patient.unique_patient_id = 10022017,[]
65f0a54b0c223f74168d1b02,How many days have it been since the last stay of patient 10004733 in their current hospital visit in the careunit medicine?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime DESC LIMIT 1",SELECT COUNT(*) FROM stay WHERE patient_id = 10004733 AND location = 'careunit medicine',[]
62458787b60bd28c2b337541,"During their first hospital encounter, when did patient 10014354 receive their last medication via the im route?",SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT patient.hospital_admission_date FROM patient WHERE patient.uniquepatientid = 10014354 AND patient.hospital_dischdate IS NULL ORDER BY patient.hospital_admission_date DESC LIMIT 1,[]
6c26a6c8707782ccd2a0c56c,How many hours has it been since the first time patient 10004733 stayed on this hospital visit in the careunit medical/surgical intensive care unit (micu/sicu)?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.admittime)) FROM patient WHERE patient.subject = 10004733 AND patient.dischtime IS NULL AND patient.careunit = 'medical/surgical intensive care unit (micu/sicu)'",[]
bae3bed8ddded1a1b46a172f,"Of the patients aged 60 or above in 2100, what are the top three most common procedures?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,
e5c3587bfbb2d97b71b9e953,How much duloxetine has been prescribed to patient 10007795 in 05/2100 in total?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug = 'duloxetine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'","SELECT SUM(duloxetine) FROM medication WHERE medication.patient_id = 10007795 AND STRFTIME('%y-%m', medication.date) = '2100-05';",[{'SUM(prescriptions.dose_val_rx)': None}]
ec5cf43c52672339fb5e9d7f,What is the maximum total hospital cost for a patient suffering from early satiety since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'early satiety' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(si.cost) AS c1 FROM (SELECT s.quantity AS cost FROM satiety s WHERE s.satiety = 'early') AS si INNER JOIN prescriptions p ON si.prescriptions = p.name INNER JOIN patient p ON p.patient_id = si.patient_id WHERE p.year >= 2100 GROUP BY p.patient_id) AS t1,
a7391e86f5ef2065e3ea2a57,Has patient 10001725 been given a diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ),SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10001725;,[{'COUNT(*)>0': 1}]
0f1dd768a428334842bfec50,What specimen tests did patient 10001217 undergo for the first time since 12/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT specimen_type FROM procedures WHERE patient_id = 10001217 AND date_of_procedure >= '12/2100' ORDER BY date_of_procedure NULLS FIRST LIMIT 1,[{'spec_type_desc': 'CSF;SPINAL FLUID'}]
b76a7905227123a769fc9e14,How many individuals are current patients in their 40s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT(DISTINCT current_patient_40s) FROM patients;,
b0b4926abc6fba2f9b78a017,"How many patients were diagnosed with hyperlipidemia, unspecified during the same hospital encounter after the previous diagnosis with presence of cardiac pacemaker throughout this year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'presence of cardiac pacemaker' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT t.subject_id, t.diagnosis_date, t.hospital_name FROM (SELECT * FROM diagnoses WHERE diagnosis = 'hyperlipidemia, unspecified') AS t GROUP BY t.subject_id HAVING MIN(t.diagnosis_date) = t.diagnosis_date AND DATETIME(t.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t1, (SELECT t.subject_id, t.diagnosis_date, t.hospital_name FROM (SELECT * FROM diagnoses WHERE diagnosis = 'presence of cardiac pacemaker') AS t GROUP BY t.subject_id HAVING MIN(t.diagnosis_date) = t.diagnosis_date AND DATETIME(t.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 WHERE t1.diagnosis_date < t2",
d8cfaf1fb8e89c395bcfc473,Calculate the total quantity of output of patient 10021487 on 12/18/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-18'","SELECT SUM(output.quantity) FROM output WHERE output.patient_id = 10021487 AND DATETIME(output.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m-%d', output.date) = '12-18'",[{'SUM(outputevents.value)': None}]
53ac27ef5178d9758e371569,What output did patient 10007818 first have on 07/03/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-03' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT patient.name, patient.age, STRFTIME('%d/%m/%Y', patient.date_of_first_contact) FROM patient WHERE patient.unique_patient_id = 10007818",[]
cf32c8a66e9b2e46a4a073dd,How much chlorhexidine gluconate 0.12% oral rinse was prescribed on their last hospital encounter for the first time to patient 10027602?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10027602 AND prescriptions.drug_name = 'Chlorhexidine Gluconate 0.12% Oral Rinse',[]
e01675d4835c5611d02521e2,What was the first time in 05/2100 patient 10009035 had the maximum mchc value?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT MAX(mchc) FROM patients WHERE patient_id = 10009035 AND measurement_date BETWEEN '2000-05-2100' AND '2000-05-2100',[]
f0229fb196610726d6ec7c44,How many times was other excision or destruction of lesion or tissue of pancreas or pancreatic duct carried out since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other excision or destruction of lesion or tissue of pancreas or pancreatic duct' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.output = 'other excision or destruction of lesion or tissue of pancreas or pancreatic duct' AND STRFTIME('%y', procedures.date) >= '2100'",
0104804c5c294f840bfc43b0,What were the five most commonly performed lab tests during this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT lab_test FROM lab_tests WHERE year = 2015 GROUP BY lab_test ORDER BY COUNT(*) DESC LIMIT 5,[]
7b61d39dc6064005d5fe1b91,What are five of the most frequent specimens taken in this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM inventory WHERE date BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5",[]
c122bbbae5a9d7b44953325a,How many days has it been since the last bacteremia diagnosis for patient 10004733 on their current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT COUNT(DISTINCT diagnosis_date) FROM diagnosis WHERE diagnosis.patient_id = 10004733 AND diagnosis.diagnosis = 'bacteremia' AND DATETIME(diagnosis_date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-1 day')",
06445e2823bf14c47a058abe,"Has patient 19412 been administered any additional fluid,other test?",,"SELECT COUNT(*) FROM additional_fluid, patient WHERE patient.patient_id = 19412 AND additional_fluid.patient_id = 19412",
b99ca86c27c7418b8cadc2bb,"Currently, how many operating rooms are available?",,SELECT COUNT(*) FROM Operating_Rooms WHERE Available = 1,
b4a201694189deda17a0ac3f,Could you inform me of the top five most common specimen tests that were conducted during this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen_type, COUNT(specimen_type) FROM top_five_species GROUP BY specimen_type ORDER BY COUNT(specimen_type) DESC",[]
58b2237d10cf18728234ae55,How many patients were given heparin since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin' AND strftime('%Y',prescriptions.starttime) >= '2100' )",SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patientunitheparin >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 2}]
4ce7e0d7febc6b899fff7a21,What was the change in platelet count in patient 10029484 second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT (SELECT platelet_count FROM ""brackets"".""patient_10029484"" WHERE NOT ""hospital_dischtime"" IS NULL ORDER BY ""hospital_admittime"" NULLS FIRST LIMIT 1 OFFSET 1) - (SELECT platelet_count FROM ""brackets"".""patient_10029484"" WHERE NOT ""hospital_dischtime"" IS NULL ORDER BY ""hospital_admittime"" NULLS FIRST LIMIT 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
00bc7d25ccf848dbe8ebd03d,Show me the top three most frequent specimens tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",SELECT specimen FROM (,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
3cf174e9abff40de817ec43c,What was the total volume of foley patient 10026354 had since 07/09/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-09'","SELECT SUM(volume) FROM ""brackets"" WHERE patient = 10026354 AND date >= '2100-07-09'",[{'SUM(outputevents.value)': None}]
893d50d72560ef334a7c8471,What drug was prescribed to patient 10021487 during the same hospital visit after the procedure of enteral infusion of concentrated nutritional substances in 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",SELECT name FROM drugs WHERE id IN (SELECT drug_id FROM procedures WHERE patient_id = 10021487 AND procedure_date = '12/2100' AND description = 'enteral infusion of concentrated nutritional substances'),
8ecbbbd543e11b1626e55488,What was the name of the drug which patient 10007795 was prescribed in the same hospital visit after receiving a drainage of pancreatic cyst by catheter procedure since 04/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pancreatic cyst by catheter' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.name, procedure.date FROM procedures JOIN patient ON procedures.patient = patient.ssn JOIN (SELECT patient.ssn, MAX(date) AS date FROM procedures JOIN patient ON procedures.patient = patient.ssn WHERE patient.ssn = 10007795 GROUP BY patient.ssn) AS t1 ON t1.ssn = procedures.patient WHERE procedures.date >= '2100-04-01') AS t2 ON t2.name = (SELECT patient.name FROM patients JOIN prescriptions ON patients.ssn = prescriptions.patient WHERE prescriptions.date >= '2100-04-01')",
be8af28d0bb7aa9b2af1434f,Can you provide the name of the drug that was prescribed to patient 10027602 within 2 days post arteriography of cerebral arteries procedure since 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.drug_name FROM (SELECT patient.id, procedures.post_arteriography_cerebral_arteries FROM procedures JOIN patient ON procedures.patient_id = patient.id WHERE patient.id = 10027602 AND procedures.post_arteriography_cerebral_arteries IS NOT NULL AND STRFTIME('%y-%m', procedures.post_arteriography_cerebral_arteries) >= '2100-12') AS t1 JOIN (SELECT patient.id, prescriptions.drug_name FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.id WHERE patient.id = 10027602 AND STRFTIME('%y-%m', prescriptions.date) >= '2100-12') AS t2 ON t1.id = t2.id WHERE t1.post_arteriography_cerebral_arteries WITHIN 2 DAYS",
35ed250e4f509e49e30cba17,Could you tell me the sex of patient 10002930?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10002930,SELECT Sex FROM patients WHERE Patient = 10002930,[{'gender': 'F'}]
d459384c23821c7436fd1a3e,Give me the top four most commonly prescribed medications during the same month to patients aged 60 or above after they were diagnosed with unspecified essential hypertension since 1 year ago.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT t4.name FROM (SELECT t3.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosis = 'unspecified essential hypertension' AND DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, medication.name, medication.medicationdate FROM medication JOIN patient ON medication.patientid = patient.uniquepid WHERE patient.age >= 60 AND DATETIME(medication.medicationdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosisdate < t2.medicationdate AND DATETIME(t1.diagnosisdate, 'start of month') = DATETIME(t2.medicationdate, 'start of month') GROUP BY t",
b7db8d58388d97ad0352fd3f,What was the monthly minimum input of nacl 0.9% for patient 10015931 since 09/2100?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-09' GROUP BY strftime('%Y-%m',inputevents.starttime)","SELECT MIN(input) FROM input_table WHERE input_table.patient_id = 10015931 AND input_table.date = '09/2100' AND input_table.type = 'nacl 0.9%' GROUP BY STRFTIME('%y-%m', input_table.date)",[]
8567ab1c50977e5114c864e1,When was the first time since 06/05/2100 that patient 10007818's mean blood pressure was measured greater than 72.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 72.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-05' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime(patient_10007818.mean_blood_pressure_date, '%d/%m/%Y') FROM patient_10007818 WHERE patient_10007818.mean_blood_pressure > 72.0 AND strftime(patient_10007818.mean_blood_pressure_date, '%d/%m/%Y') >= '06/05/2100'",[]
05a019fa9f7c243ee7ac5682,Can you give me the five most common output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
218edde218dc6a20ef8e8fad,What is the price of a drug named tobramycin sulfate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' ),,
6aa4881be1a49d2ae7f3e749,What were the top five most frequent diagnoses that followed within 2 months for those patients who received laparoscopic partial cholecystectomy since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic partial cholecystectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DDITIME FROM (SELECT p.part1, p.part2 FROM (SELECT p.part1, p.part2, t.type, t.time FROM (SELECT part1, part2 FROM patients WHERE part1 = 'laparoscopic partial cholecystectomy') AS t1 JOIN (SELECT diagnosis, time FROM diagnoses WHERE time > (CURRENT_TIME, '-1 year')) AS t2 ON t1.part1 = t2.diagnosis GROUP BY t2.diagnosis) AS t3 JOIN (SELECT diagnosis, time FROM diagnoses WHERE time > (CURRENT_TIME, '-1 year')) AS t4 ON t3.diagnosis = t4.diagnosis WHERE t3.time < t4.time AND DATETIME(t4.time) BETWEEN DATETIME(t3.time) AND DATETIME(t3.time, '+2 month')",
a3ca87a1ecbcd3145068f456,How much octreotide acetate has patient 10007818 been prescribed on the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'octreotide acetate',SELECT SUM(octreotide_acetate) FROM prescriptions WHERE prescriptions.patient_id = 10007818 AND NOT prescriptions.hospital_dischtime IS NULL ORDER BY prescriptions.hospital_admittime DESC LIMIT 1;,[{'SUM(prescriptions.dose_val_rx)': None}]
9ad11c0699674c054d7a4074,Can you calculate how many patients were prescribed glucagon this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patienttype = 'prescribed' AND patient.prescriptiondate BETWEEN DATEADD(YYYY, -1, GETDATE()) AND DATEADD(YYYY, 0, GETDATE()) AND patient.prescriptions = 'Glucagon'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
7c3ea800b2b64cb1b3cf89a4,What is the title of the medication that was given to patient 10012853 last via the po means in 04/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT T1.title FROM medication AS T1 JOIN patient AS T2 ON T1.patient_id = T2.patient_id WHERE T2.patient_id = 10012853 AND T1.route = 'po' AND DATETIME(T1.date_administered, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', T1.date_administered) = '04' ORDER BY T1.date_administered DESC LIMIT 1",[]
f9a927c46dab94fac56cd983,What is the name of the treatment given to patient 10038081 two or more times since 07/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT t2.treatment_name FROM (SELECT t1.treatment_name, COUNT(t1.date) AS c1 FROM (SELECT date, treatment_name FROM procedures WHERE patient_id = 10038081) AS t1 WHERE t1.date >= '2000-07-2100' GROUP BY t1.treatment_name) AS t2 WHERE t2.c1 >= 2",
f26a53de07f2471e33f3f8b5,What is the total number of excision of dental lesion of jaw procedures that took place in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.date = ""2100-01-01"" AND procedures.description = ""Excision of dental lesion of jaw""",
066f306279b80b6d43827f27,"In 2100, what are the five frequently ordered treatments for patients who were diagnosed with cachexia during the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT t1.name, t2.treatment FROM (SELECT date_part('month', diagnosis.date) AS name, diagnosis.treatment FROM diagnosis WHERE diagnosis.treatment = 'cachexia') AS t1 JOIN (SELECT date_part('month', treatment.date) AS treatment FROM treatment WHERE date_part('year', treatment.date) = 2100) AS t2 ON t1.name = t2.treatment) GROUP BY t1.treatment ORDER BY COUNT(t1.treatment) DESC LIMIT 5",
6b6d306062e42562e6047276,Tell me the four most common diagnoses since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis, COUNT(diagnosis) FROM diagnoses WHERE DATETIME(diagnoses.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY diagnosis ORDER BY COUNT(diagnosis) DESC LIMIT 4",
4a22689b12923d592f28be83,Has there been any organism present in patient 10016742's first stool microbiology test since 03/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT COUNT(*) > 0 FROM organism WHERE patient_id = 10016742 AND microbiology_date >= '2000-03-2100' AND stool_type = 'first',[{'COUNT(*)>0': 0}]
0af1a06bcce4aacbc5a936f4,Has patient 10008454 acquired any medication since 10/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'","SELECT COUNT(*) > 0 FROM medication_history WHERE medication_history.patient_id = 10008454 AND STRFTIME('%y-%m', medication_history.acquisition_date) >= '2100-10'",[{'COUNT(*)>0': 1}]
afc288ae1efdf1107f545e9d,When did patient 10004720 receive the last prescription of soln and bag at the same time since 12/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'soln' AND admissions.subject_id = 10004720 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bag' AND admissions.subject_id = 10004720 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",,[]
f0508cab258d6df36060ea48,What is patient 10016150's heart rate change last measured on the first ICU visit compared to the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT heart_rate FROM icu_visits WHERE icu_visits.patient_id = 10016150 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.in_time NULLS FIRST LIMIT 1) - (SELECT heart_rate FROM icu_visits WHERE icu_visits.patient_id = 10016150 AND NOT icu_visits.out_time IS NULL ORDER BY icu_visits.in_time NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
45d38cc2d6126200d9c5ec99,How many days have elapsed since patient 10039831 had received a hemoglobin lab test for the first time in this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', hemoglobin_lab.hemoglobin_date)) FROM hemoglobin_lab WHERE hemoglobin_lab.patient_id = 10039831 AND hemoglobin_lab.hemoglobin_date =hemoglobin_lab.hemoglobin_date ORDER BY hemoglobin_lab.hemoglobin_date NULLS FIRST LIMIT 1;",[]
d6c3eb4c10881ccf9ced74ae,Give me the three most frequent procedures performed.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t1.three FROM (SELECT t2.procedure, COUNT(t2.procedure) AS ""count"" FROM (SELECT three FROM (SELECT ""procedure"" FROM procedures ORDER BY ""procedure"" NULLS FIRST LIMIT 3) AS t3 JOIN procedures AS t2 ON t3.procedure = t2.procedure) AS t2 GROUP BY t2.procedure) AS t1 JOIN (SELECT three FROM (SELECT ""procedure"" FROM procedures ORDER BY ""procedure"" NULLS FIRST LIMIT 3) AS t3 JOIN procedures AS t2 ON t3.procedure = t2.procedure) AS t2 ON t1.three = t2.three WHERE t1.count > (SELECT MIN(count) FROM (SELECT t2.procedure, COUNT(t2.procedure) AS ""count"" FROM (SELECT three FROM (SELECT ""procedure"" FROM procedures ORDER BY ""procedure"" NULLS FIRST LIMIT 3) AS t3 JOIN procedures AS t2 ON t3.procedure = t2.procedure) AS t2 GROUP BY t2.procedure)","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Other nonoperative respiratory measurements'}]"
3f66ff390a54bf2f82dedd51,"In 09/2100, what was the minimum sodium value for patient 10038933?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND strftime('%Y-%m',labevents.charttime) = '2100-09'",SELECT MIN(Sodium) FROM 09/2100 WHERE Patient = 10038933,[{'MIN(labevents.valuenum)': None}]
c0ed5f3463fb838c2206713f,How many days have passed since patient 10004733 got his last diagnosis of proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site on their current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis.diagnosis_date)) FROM diagnosis WHERE diagnosis.patient_id = 10004733 AND diagnosis.diagnosis = 'Proteus (Mirabilis) (Morganii) infection in conditions classified elsewhere and of unspecified site'",
7ae435e691f248d18ab7bec3,How many hours have elapsed since patient 10018081 first received a hematocrit lab test during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', hematocrit_lab_time)) FROM hematocrit_lab_results WHERE hematocrit_lab_results.patient_id = 10018081 AND hematocrit_lab_results.hospital_visit_id = 1",[]
aa46c093a028ee5e0201520e,"Tell me the maximum total hospital cost that includes introduction of nutritional substance into lower gi, via natural or artificial opening.","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.total_hospital_cost) FROM (SELECT SUM(T2.hospital_cost) AS total_hospital_cost FROM (SELECT HOSPITAL_COST FROM cost_matrix WHERE COST_MATRIX_ID = 1) AS T1 JOIN patient_location ON T1.patient_id = patient_location.patient_id WHERE patient_location.location = 'INTRODUCTION OF NUTRITIONAL SUBSTANCE INTO LOWER GI, VIA NATURAL OR ARTIFICIAL OPENING') AS T2 GROUP BY T1.patient_id) AS T1;",
48ce377b6362c251e67e2e6b,What are the top five most frequently performed procedures for patients who are 20s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1. procedures FROM (SELECT procedures, COUNT(procedures) AS cnt FROM (SELECT patients.name, procedures FROM patients JOIN procedures ON patients.name = procedures) WHERE patients.age BETWEEN 20 AND 29) AS t1 JOIN (SELECT procedures, COUNT(procedures) AS cnt FROM (SELECT patients.name, procedures FROM patients JOIN procedures ON patients.name = procedures) WHERE patients.age BETWEEN 20 AND 29) AS t2 ON t1.procedures = t2.procedures WHERE DATETIME(t1.name) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY t1.procedures ORDER BY t1.cnt DESC LIMIT 5",
859635e6c88f004f9e9f32da,When are dr. martin's rounds and procedures?,,"SELECT dr.martin.round, dr.martin.procedure FROM Users JOIN Dr.Martin ON Users.Id = Dr.Martin.UserId",
5969b3f1a95b57d848d81e86,What was the organism found in the last microbiology test done on the patient 10008454's urine since 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism FROM microbiology WHERE patient_id = 10008454 AND urine = 1 AND date >= '2021-10-2100' ORDER BY date DESC LIMIT 1,[]
4769deceed9b3988f20fff62,Have any diagnoses been made for patient 10039831 during this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM diagnoses WHERE diagnoses.patient = 10039831 AND DATETIME(diagnoses.diagnosis_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",
eee2d17dec0a42b12da8deaa,"Since 1 year ago, how many patients were prescribed prismasate (b22 k4)?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prismasate (b22 k4)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
d6a206ecc5cbf7eeccb7956b,"Among patients who underwent other electroshock therapy this year, what were the top five diagnoses they received within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.diagnosis, COUNT(t3.diagnosis) FROM (SELECT t2.diagnosis, t1.date FROM (SELECT patient.id, treatment.date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE treatment.treatment_type = 'other electroshock therapy') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE DATETIME(diagnosis.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')) AS t2 ON t1.patient_id = t2.patient_id WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME(t1.date, '+2 month') GROUP BY t3.diagnosis ORDER BY COUNT(t3.diagnosis) DESC LIMIT 5",
8c24b509ca406f3cf4ea3e2a,Calculate the number of patients who were in the pacu careunit this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient) FROM patients WHERE careunit = 'pacu' AND DATETIME(patients.admittime, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
c464ddc6ede81a650537c328,"When, on 01/28/2100, was patient 10019917's heart rate measured less than 73.0 for the last time?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 73.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-01-28' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(heart_rate) FROM patients WHERE patient_id = 10019917 AND measurement_date BETWEEN '2000-01-28' AND '2000-01-28' AND heart_rate < 73.0,[]
7ba5a831808e4e5851837fe5,Count the number of patients who were discharged.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissed_date IS NULL;,[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
402d46f2e8f68504cd726d4d,Show me the length of stay in days of patient 10019385 from the last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', icu.stay.end_time) - STRFTIME('%j', icu.stay.start_time) AS length_of_stay_days","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.3132870369590819}]"
3cc0342acbb3992a4b0cf40b,Can you report the last respiratory rate for patient 10007058 since 09/08/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-08' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(respiratory_rate) FROM respiratory_rate WHERE patient_id = 10007058 AND measurement_date >= '2009-08-2100',[]
f854c9821a5c5435e850b71e,Tell me the top three most frequent procedures that patients received in the same hospital encounter after being diagnosed with other forms of acute ischemic heart disease.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other forms of acute ischemic heart disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.treatment FROM (SELECT t2.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_time, patient.patient_location FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'other forms of acute ischemic heart disease') AS t1 JOIN (SELECT patient.id, treatment.treatment, treatment.treatment_time, patient.patient_location FROM treatment JOIN patient ON treatment.patient_id = patient.id) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_time < t2.treatment_time AND t1.patient_location = t2.patient_location GROUP BY t2.treatment) AS t3 WHERE t3.c1 <= 3",
f9f4d6def655d54dcbd63348,What is the dose of opiate prescribed for patient 8908?,,SELECT SUM(opiate) FROM prescriptions WHERE patient = 8908,
83b0e5365db1483f3adcf4cd,What was the medicine that was prescribed to patient 10025463 in the same hospital encounter after undergoing catheter based invasive electrophysiologic testing during the last month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t3.medication FROM (SELECT t2.medication, t2.hospital_expiration, t1.hospital_admission FROM (SELECT patient.uniquepid, hospital.hospital_admission FROM patient JOIN hospital ON patient.hospital = hospital.hospital_name WHERE patient.uniquepid = 10025463) AS t1 JOIN (SELECT patient.uniquepid, medication.medication, medication.hospital_expiration FROM patient JOIN medication ON patient.hospital = medication.hospital_name WHERE patient.uniquepid = 10025463) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.hospital_expiration = t2.hospital_expiration AND DATETIME(t1.hospital_expiration, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-1 month')) AS t3 WHERE t3.hospital_expiration = t2.hospital_expiration AND DATETIME(t3.hospital_expiration, 'start of month') = DATETIME",
b7925774086e29f5d02b778f,Can you tell how many times patient 10015272 visited the ICU in 2100?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND strftime('%Y',icustays.intime) = '2100'","SELECT COUNT(DISTINCT patient_id) FROM icu_visits WHERE patient_id = 10015272 AND STRFTIME('%y', visit_date) = '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 0}]
5febe2a89e917d60303afd4c,What were the top three most common diagnoses?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT diagnosis, COUNT(*) FROM diagnoses GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 3;","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]"
da71745a0892dc4e3347b091,What is the method for disinfecting the quarantine room?,,SELECT * FROM sanitation WHERE function = 'quarantine';,
89f547ad3bff27fb734acf00,"Patient 10015931, when was your last blood culture microbiology test in 12/this year?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT MAX(blood_culture_microbiology.date) FROM blood_culture_microbiology WHERE blood_culture_microbiology.patient_id = 10015931 AND DATETIME(blood_culture_microbiology.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', blood_culture_microbiology.date) = '12'",[]
4313578eaa6f5e20b0f3a246,List the top four most frequently prescribed medications in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT t1.name FROM (SELECT prescriptions.name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM prescriptions WHERE STRFTIME('%y', prescriptions.date) = '2100' GROUP BY prescriptions.name) AS t1 WHERE t1.c1 <= 4;",[]
15aef1c4f860681d29061482,How much is the difference of SaO2 of patient 10019777 last measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT SaO2 FROM Patient WHERE patient_id = 10019777 AND NOT icu_visit IS NULL ORDER BY icu_visit NULLS FIRST LIMIT 1) - (SELECT SaO2 FROM Patient WHERE patient_id = 10019777 AND NOT icu_visit IS NULL ORDER BY icu_visit NULLS FIRST LIMIT 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
0981b590800b50362ed9bd99,How many patients were diagnosed with other postoperative infection since 2100 after already being diagnosed with injury to thoracic aorta during the same hospital encounter?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postoperative infection' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed FROM (SELECT subject_id, diagnosed FROM patients WHERE diagnosed = 1 AND treatment = 2100) AS t1 JOIN (SELECT subject_id, diagnosed FROM patients WHERE diagnosed = 1 AND treatment = 2101) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed = 1 AND t2.diagnosed = 1) AS t3",
88a7b298bbf40e3593b5f065,What are the top three most common specimens tested after receiving arteriography of other intra-abdominal arteries in the same month since 1 year ago?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t1.month FROM (SELECT date_part('year', arteriography_date) AS month, specimen FROM arteriography WHERE arteriography_type = 'arteriography of other intra-abdominal arteries') AS t1 JOIN (SELECT date_part('year', arteriography_date) AS month, specimen FROM arteriography WHERE arteriography_type = 'arteriography of other intra-abdominal arteries') AS t2 ON t1.month = t2.month) AS t3 GROUP BY t3.specimen ORDER BY COUNT(t3.specimen) DESC LIMIT 3",
358cc7b4a0a0a45ee24a26fd,"What was the first instance when the SaO2 of patient 10031757 was less than 97.0, during their last ICU stay?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 97.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(intake_sao2) FROM intake_sao2 WHERE intake_sao2 < 97.0 AND intake_subject_id = 10031757 AND NOT intake_dischtime IS NULL ORDER BY intake_dischtime DESC LIMIT 1,[]
ebc57b735ed65bf597257c3e,What is the average total hospital cost involving a drug named loratadine since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'loratadine' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE cost >= 2100 AND drug = 'loratadine' GROUP BY patientid) AS t1,
0a43e2fe814473ab9035db70,What was the total output that patient 10004720 had on 12/06/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-06'",SELECT SUM(output) FROM output WHERE patient_id = 10004720 AND output_date = '12/06/2100',[{'SUM(outputevents.value)': None}]
168c04ce1956c158d1651a93,"In 2100, has patient 10002495 received a fluoroscopy of multiple coronary arteries using other contrast treatment?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",SELECT COUNT(*) FROM procedures WHERE patient_id = 10002495 AND procedure_type = 'fluoroscopy of multiple coronary arteries using other contrast treatment' AND year = 2100,
59f57cae084573bb29dadab2,Has patient 10001217 been admitted into the emergency room in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'",SELECT COUNT(*) > 0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.emergency_room_admittime BETWEEN '2100-01-01' AND '2100-12-31',[{'COUNT(*)>0': 0}]
c204f2867fbb32ebf4703865,Calculate how many drugs patient 10006580 was prescribed in 04/last year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10006580 AND DATETIME(medication.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-1 year') AND STRFTIME('%m', medication.date) = '04'",[{'COUNT(*)': 0}]
9d1688657943a3556c9c8704,"How many patients were diagnosed with type 2 diabetes mellitus without complications during the same month after they were first diagnosed with altered mental status, unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus without complications' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosed_date FROM diagnoses WHERE diagnosis_type = '2 diabetes mellitus without complications') AS t1 JOIN (SELECT subject_id, diagnosed_date FROM diagnoses WHERE diagnosis_type = 'altered mental status, unspecified') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosed_date < t2.diagnosed_date AND DATETIME(t1.diagnosed_date, 'start of month') = DATETIME(t2.diagnosed_date, 'start of month')",
26ceeacb486699b10996ccda,Calculate the number of ICU visits of patient 10001725 in 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y',icustays.intime) = '2100'","SELECT COUNT(DISTINCT icu_visits) FROM icu_visits WHERE icu_patient_id IN (SELECT icu_patient_id FROM patient WHERE patient_id = 10001725) AND STRFTIME('%y', icu_visits.visit_date) = '2100';",[{'COUNT( DISTINCT icustays.stay_id )': 0}]
06cb3e044663d50bd84a38f0,When has patient 10016742 had the first input since 03/25/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-25' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_date) FROM input_data WHERE patient_id = 10016742 AND input_date >= '2100-03-25',[{'starttime': '2178-07-04 01:00:00'}]
9b71dfdbadbc316c5802b20d,"In 05/2100, what was the first drug that patient 10016150 was prescribed through the iv route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(drug_date) FROM iv_route WHERE patient_id = 10016150 AND drug_date BETWEEN '2005-02-11' AND '2005-02-11',[]
ffb225e9649d2d2a042af243,What was the admission type for patient 10020306's first admission to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020306 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT MIN(admission_type) FROM admissions WHERE subject_id = 10020306;,[]
2cf0ff14f070a284cf574db2,What is the foley output for patient 10018081 on 12/30/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-30'",SELECT SUM(foley) FROM output WHERE patient = 10018081 AND date = '12/30/2022',[{'SUM(outputevents.value)': None}]
b1a78da076378d37eda3aeb6,What are the top four most commonly diagnosed conditions since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT diagnosis, COUNT(*) FROM diagnoses WHERE date >= (CURRENT_DATE - INTERVAL '1 year') GROUP BY diagnosis ORDER BY COUNT(*) DESC LIMIT 4",
a1d2ad87eb4e531d5e0486d3,Give me the name of the diagnosis patient 51605 had in the other department,,SELECT diagnosis FROM diagnoses WHERE diagnoses.patient_id = 51605 AND diagnoses.department_id <> (SELECT departments.department_id FROM departments WHERE departments.name = 'other department'),
d2dd4d4753286d5a02aee69a,Tell me the minimum total cost of a hospital visit involving a alanine aminotransferase (alt) lab test in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(total_cost) FROM (SELECT SUM(cost) AS total_cost FROM lab WHERE lab.type = 'alanine aminotransferase (alt)' AND STRFTIME('%y', lab.date) = '2100' GROUP BY lab.patient_id)",
7da203f6a27901736f057b8c,"On last month/02, what was patient 10021938's first heart rate?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '02' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(heart_rate) FROM patient_10021938 WHERE date = (SELECT date FROM range(TIMESTAMP '2022-01-01', TIMESTAMP '2022-12-31', INTERVAL '1 month') WHERE range(TIMESTAMP '2022-01-01', TIMESTAMP '2022-12-31', INTERVAL '1 month') = TIMESTAMP '2022-12-31') AND patient_10021938.heart_rate IS NOT NULL",[]
4e8e76dc6a0595e8d2d83aba,What was the time of patient 10029291's last blood culture microbiology test in 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT TIMESTAMP '2000-02-2100 15:30:00' FROM microbiology WHERE microbiology.patient_id = 10029291 AND microbiology.blood_culture_type = 'blood culture' AND STRFTIME('%y-%m', microbiology.timestamp) = '2100-02' ORDER BY microbiology.timestamp DESC LIMIT 1",[]
2533e11570c9cac4cf3be471,Was patient 10019777 treated with a procedure on single vessel procedure in the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10019777 AND procedures.procedure_type = 'treatment of a procedure on single vessel' AND DATETIME(procedures.treatment_date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",
edb3cbffb2caabbeb6d54ab6,Retrieve the top five most frequent output occurrences.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",SELECT COUNT(*) FROM (SELECT output FROM program GROUP BY output ORDER BY COUNT(*) DESC LIMIT 5) subquery;,"[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]"
2dc83d6d0ed121d2f9b4c9ca,What medication was last given to patient 10005817 since 22 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-22 month') ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT medication FROM medication_table WHERE patient_id = 10005817 AND date_sub('month', CURRENT_DATE, date_given) >= 22 ORDER BY date_given DESC LIMIT 1;",[{'drug': 'HYDROmorphone (Dilaudid)'}]
45892e6b5af0f6b70b5c1edd,When was the first hospital discharge time for patient 10005866?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005866 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT MIN(hospital_dischtime) FROM (SELECT * FROM patient_history WHERE patient_id = 10005866),[]
d11649ef6f1e014d999ead71,When was patient 10022017's last hospital discharge?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 ORDER BY admissions.dischtime DESC LIMIT 1,SELECT patient.hospital_discharge_date FROM patient WHERE patient.unique_patient_id = 10022017,[{'dischtime': '2189-09-16 15:00:00'}]
ffdfd1a0a23a14c7d23101f8,Can you show me the top four most frequent lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.lab_test, COUNT(t1.lab_test) FROM (SELECT lab_test FROM lab_tests WHERE date > (SELECT date FROM lab_tests WHERE date = '1 year ago')) AS t1 JOIN lab_tests AS t2 ON t1.lab_test = t2.lab_test GROUP BY t1.lab_test ORDER BY COUNT(t1.lab_test) DESC LIMIT 4","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]"
12d278afa5aced986bad28bf,"Was the chloride, whole blood value of patient 10018423 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )","SELECT (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10018423 AND lab_data.label = 'chloride, whole blood' ORDER BY lab_data.measured_date DESC LIMIT 1) < (SELECT lab_value FROM lab_data WHERE lab_data.patient_id = 10018423 AND lab_data.label = 'chloride, whole blood' ORDER BY lab_data.measured_date DESC LIMIT 1 OFFSET 1)","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
f838d7118ed779a45387d3aa,"How many patients were given occlusion of right femoral artery with intraluminal device, percutaneous approach in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right femoral artery with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, procedures.date FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.device = ""Intraluminal device"" AND procedures.date BETWEEN ""2100-01-01"" AND ""2100-12-31"") AS t1 JOIN (SELECT patient.subject_id, procedures.date FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.device = ""Oclusion of right femoral artery with intraluminal device, percutaneous approach"" AND procedures.date BETWEEN ""2100-01-01"" AND ""2100-12-31"") AS t2 ON t1.subject_id = t2.subject_id WHERE t1.date < t2.date",
2cc3cfa013ef1b065613e661,What is the minimum total cost of a hospital stay involving bariatric surgery status in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bariatric surgery status' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost_table WHERE cost_table.surgery_status = 'bariatric' AND STRFTIME('%y', cost_table.surgery_date) = '2100' GROUP BY cost_table.patient_id) AS t1",
b6d3b1cf1ff9f38a9adebb0a,Show me the top five most frequent specimens tested since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM inventory WHERE date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5;","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
5498f998fad51770de8a3567,Has patient 10004235 had lab testing since 01/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'","SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10004235 AND STRFTIME('%y-%m', lab_results.date) >= '2100-01'",[{'COUNT(*)>0': 1}]
a124aa7b3370848af7ee0c6b,What was the weight of patient 10038081 last since 5 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-5 month') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(weight) FROM patients WHERE patient_id = 10038081 AND date < CURRENT_DATE - INTERVAL '5 month',[]
662b2f7dbfe34ec1b9a8e485,How is disinfection performed in the quarantine room?,,"SELECT * FROM ""quarantine_room"" WHERE ""disinfection"" = 'performed';",
54ed73ce298076765282857a,"When was the last time in the first hospital visit that patient 10007818 had the minimum value of lactate dehydrogenase, ascites?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase, ascites' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",,[]
98c5ba7c0885aff19ce951a4,Tell me the insurance plan of patient 10029291 on the last hospital encounter.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT insurance_plan FROM patients WHERE patient_id = 10029291 AND NOT last_hospital_encounter IS NULL,[{'insurance': 'Medicare'}]
fa71c8774f1846ae6af571b6,What was the last time that patient 10002495 had a maximum value of mchc in 06/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(mchc) FROM patient WHERE patient_id = 10002495 AND measurement_date BETWEEN '2000-06-2100' AND '2000-06-2100',[]
eb7bf6c61602ad306a17337c,What were the most frequent diagnoses among the top three throughout this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosisdate BETWEEN '2022-01-01' AND '2022-12-31' AND STRFTIME('%j', diagnosis.diagnosisdate) BETWEEN 1 AND 365) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE diagnosis.diagnosisdate BETWEEN '2022-01-01' AND '2022-12-31' AND STRFTIME('%j', diagnosis.diagnosisdate) BETWEEN 1 AND 365) AS t2 ON t1.uniquepid = t2.uniquepid",
cc6c86acab499b90014c3eac,"Since 1 year ago, has patient 10022281 come to the ER?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022281 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",SELECT COUNT(*) > 0 FROM call_history WHERE patient_id = 10022281 AND call_type = 'emergency department' AND date_called >= (CURRENT_DATE - INTERVAL '1 year'),[{'COUNT(*)>0': 0}]
c4b6b11d95a82c6b74f94e76,"Number of patients who were given a drainage of right pleural cavity with drainage device, percutaneous approach procedure.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )","SELECT COUNT(DISTINCT patient.subject_id) FROM patient WHERE patient.patient_type = ""RIGHT PLEURAL CAVITY WITH DRAINAGE DEVICE, PERCUTANEOUS APPROACH""",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
55005268f132ecb83abd1166,What was measured as patient 10010471's weight during the first check?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT ""weight"" FROM ""patients"" WHERE ""patient_id"" = 10010471 AND NOT ""weight_units"" IS NULL ORDER BY ""weight_check_date"" NULLS FIRST LIMIT 1",[]
7d9bd95cb1ec8590bac2746b,What was the duration in days of patient 10018328's first stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT SUM(DaysInICU) FROM icu_stays WHERE ICUStayID IN (SELECT ICUStayID FROM icu_stays WHERE PatientID = 10018328 ORDER BY ICUStayDate NULLS FIRST LIMIT 1),"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 7.702511574141681}]"
0c54d58c887f5d5cfcec260c,"What are the top four most frequently tested specimens for patients within the same hospital visit after receiving bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT t4.specimen, COUNT(t4.specimen) FROM (SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, COUNT(t2.specimen) FROM (SELECT ""Aorta"" AS specimen, COUNT(""Aorta"") AS cnt FROM patients WHERE NOT ""Aorta"" IS NULL GROUP BY ""Aorta"" UNION ALL SELECT ""Aorta"" AS specimen, COUNT(""Aorta"") AS cnt FROM patients WHERE ""Aorta"" IS NULL GROUP BY ""Aorta"") AS t1 JOIN (SELECT ""Aorta"" AS specimen, COUNT(""Aorta"") AS cnt FROM patients WHERE NOT ""Aorta"" IS NULL GROUP BY ""Aorta"" UNION ALL SELECT ""Aorta"" AS specimen, COUNT(""Aorta"") AS cnt FROM patients WHERE ""Aorta"" IS NULL GROUP BY ""Aorta"") AS t2 ON t1.specimen = t2.specimen GROUP BY t2.specimen) AS t3 JOIN (SELECT ""Aorta"" AS specimen, COUNT(""Aorta"") AS cnt FROM patients WHERE",
3e3c16a752c633d8a67ecda2,Was the haptoglobin reading for patient 10007818 last measured on the last hospital visit greater than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.haptoglobin FROM lab WHERE lab.patient_id = 10007818 AND NOT lab.hospital_visit_id IS NULL ORDER BY lab.measurement_date DESC LIMIT 1) > (SELECT lab.haptoglobin FROM lab WHERE lab.patient_id = 10007818 AND NOT lab.hospital_visit_id IS NULL ORDER BY lab.measurement_date NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
3f1090acd1fbd153ed566e98,What is the percentile of 34.1 in the mchc lab test with the same age as patient 10022041 on the first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.1","SELECT DISTINCT t1.c1 FROM (SELECT lab.mchc, PERCENT_RANK() OVER (ORDER BY lab.mchc NULLS FIRST) AS c1 FROM lab WHERE lab.age = (SELECT age FROM patient WHERE patient.uniquepid = 10022041 AND NOT patient.hospitaldischtime IS NULL ORDER BY patient.hospitaladmittime NULLS FIRST LIMIT 1)) AS t1 WHERE t1.mchc = 34.1",
1138580aa607ef75fdf6df17,Count the number of patients who were discharged since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT patient_id IS NULL AND STRFTIME('%y', patient_id) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
38b0a6d72077dca2e36faa92,Show the respiratory rate changes of patient 10023239 last measured on the first ICU visit compared to the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT (SELECT respiratory_rate FROM (SELECT patient_id, measurement_time FROM icu_measurements WHERE patient_id = 10023239 ORDER BY measurement_time NULLS FIRST LIMIT 1) AS first_measurements GROUP BY patient_id HAVING MIN(measurement_time) = first_measurements.measurement_time) - (SELECT (SELECT respiratory_rate FROM (SELECT patient_id, measurement_time FROM icu_measurements WHERE patient_id = 10023239 ORDER BY measurement_time NULLS FIRST LIMIT 1) AS first_measurements GROUP BY patient_id HAVING MIN(measurement_time) = first_measurements.measurement_time)","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
354ec0afe942f8cf2f5c706e,"In 10/2100, when did patient 10019172 last receive the % hemoglobin a1c test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime DESC LIMIT 1",SELECT MAX(hemoglobin_a1c) FROM lab_results WHERE patient_id = 10019172 AND lab_result_type = '% hemoglobin a1c' AND date BETWEEN '2021-01-01' AND '2021-12-31',[]
2348bda143e013d91131d2d9,What are patient 10037861's changes in ph last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT ph_last FROM patient_10037861 WHERE NOT hh_last IS NULL ORDER BY hh_last DESC LIMIT 1) - (SELECT ph_last FROM patient_10037861 WHERE NOT hh_last IS NULL ORDER BY hh_last DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
5f4091b20b6ccfd4e72a8f1f,Please tell me the sex of patient 10018328.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10018328,SELECT patients.sex FROM patients WHERE patients.id = 10018328,[{'gender': 'F'}]
65faa312dd5804c3f1f638f3,What was the first time of patient 10038992 blood culture ( myco/f lytic bottle) microbiology test during the previous month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT date_from FROM microbiology_data WHERE patient_id = 10038992 AND microbiology_type = 'blood culture ( myco/f lytic bottle)' AND date_to = (SELECT date_from FROM microbiology_data WHERE patient_id = 10038992 AND microbiology_type = 'blood culture ( myco/f lytic bottle)' AND date_from = (SELECT date_from FROM microbiology_data WHERE patient_id = 10038992 AND microbiology_type = 'blood culture ( myco/f lytic bottle)' AND date_from = current_timestamp - INTERVAL '1 month')),[]
94b617e6ff37a625db538e00,"During the last hospital encounter, what was the last time patient 10026406 had a medication via the po/ng route prescribed?",SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(drug_start_time) FROM medication_usage WHERE patient_id = 10026406 AND route = 'po/ng',[]
437e22cc3839c9e567107949,What is the average total cost of the hospital which involves chronic systolic (congestive) heart failure in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic (congestive) heart failure' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(t1.c1) FROM (SELECT SUM(si.cost) AS c1 FROM (SELECT s.quantity * p.unit_price AS cost FROM systolic_heart_failure s JOIN patient p ON s.patient_id = p.patient_id WHERE s.systolic_heart_failure_type = 'chronic systolic (congestive) heart failure') AS si JOIN (SELECT d.date_of_admittance, c.cost FROM diagnosis d JOIN patient c ON d.patient_id = c.patient_id WHERE d.diagnosis_type = 'chronic systolic (congestive) heart failure' AND STRFTIME('%y', d.date_of_admittance) = '2100') AS t1 ON t1.cost = 2100",
0056cade81e16f20fe9fe322,Has patient 10023239 had any medication prescribed since 05/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'","SELECT COUNT(*) > 0 FROM medication WHERE medication.patient_id = 10023239 AND STRFTIME('%y-%m', medication.date) >= '2100-05'",[{'COUNT(*)>0': 1}]
347b35d5873783b49e222bc6,What was the total sum of inputs for patient 10007795 on the first ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ),SELECT SUM(inputs) FROM (SELECT inputs FROM icu_inputs WHERE icu_number = 1 AND patient_id = 10007795),[{'SUM(inputevents.totalamount)': 8640.0}]
78c1ef777fd6564ef1b1164f,When was the first time patient 10014729 had been prescribed medication through the td route on the first hospital visit?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(date_prescribed) FROM medication_usage WHERE patient_id = 10014729 AND route = 'td',[]
32b1864cd437a05f94495679,What number of patients were in the medicine since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND strftime('%Y',transfers.intime) >= '2100' )",SELECT COUNT(DISTINCT patient_id) FROM medicine_usage WHERE year >= 2100,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
f8bfabf3d67d5c270425864f,What was the last weight of patient 10014729?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MAX(weight) FROM patients WHERE patient_id = 10014729,[]
259109556cec2005a9ea3db8,What specimen test was first given to patient 10038999?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT specimen_test FROM history WHERE patient_id = 10038999 ORDER BY event_date NULLS FIRST LIMIT 1;,"[{'spec_type_desc': 'FLUID,OTHER'}]"
91d0d988d9caf739b370a0af,What are the new drugs for patient 10039831 today compared to the earlier ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT * FROM drugs WHERE patient_id = 10039831 AND date = '2022-10-08',[]
76d64d32df1f5a7f51202106,Has patient 10023117 got a platelet count lab test since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND strftime('%Y',labevents.charttime) >= '2100'","SELECT COUNT(*) > 0 FROM lab WHERE lab.patient_id = 10023117 AND lab.lab_name = 'platelet count' AND STRFTIME('%y', lab.date) >= '2100'",[{'COUNT(*)>0': 0}]
01389011a3cea028b226b95b,What was the amount of insulin prescribed to patient 10020740 in total in 05/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'insulin' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'","SELECT SUM(insulin) FROM prescriptions WHERE patient = ""10020740"" AND date = ""2000-05-2100""",[{'SUM(prescriptions.dose_val_rx)': None}]
d3ba4b68ea980852ba7f2f4a,What was the last drug prescribed since 09/2100 to patient 10011398?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10011398 AND STRFTIME('%y-%m', date_prescribed) >= '2100-09';",[{'drug': 'Metoprolol Tartrate'}]
9259d15f15a7db0e59aaff9d,Could you inform me of the maximum rdw value for patient 10021118 in 12/this year?,"SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12'",SELECT MAX(rdw) FROM brackets WHERE patient_id = 10021118 AND date BETWEEN '12/this year' AND '12/next year',[{'MAX(labevents.valuenum)': None}]
35845dbc8e2d2791d609cc18,What is the reimbursement standard for genetic and chromosome tests?,,SELECT STDDEV(reimbursement) FROM brackets_exercise WHERE type = 'Genetic' OR type = 'Chromosome';,
a718668474f99aed79794a78,What's the weight difference of patient 10027602's body second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT (SELECT body_weight FROM patient WHERE patient.name = '10027602' AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1) - (SELECT body_weight FROM patient WHERE patient.name = '10027602' AND NOT patient.hospital_dischtime IS NULL ORDER BY patient.hospital_admittime DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]"
221b036ed4f338f8d4bd1c8a,What was the total sum of inputs for patient 10038933 since 03/19/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19'",SELECT SUM(inputs) FROM brackets WHERE patient_id = 10038933 AND input_date >= '03/19/2100',[{'SUM(inputevents.totalamount)': 60779.0}]
e45d3d0893b986609bb61212,What should not be administered during a proc-vessel bifurcation procedure?,,SELECT * FROM procedures WHERE procedure_name = 'proc-vessel bifurcation' AND administer_during_procedure = 'no',
d9c4c3a85c5787478f083a3a,What are three of the most frequent specimens taken since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",SELECT specimen FROM inventory WHERE date >= (CURRENT_DATE - INTERVAL '1 year') GROUP BY specimen ORDER BY COUNT(*) DESC LIMIT 3,"[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
40c2eb3691b1c2483780d090,What exactly was the first drug that patient 10038992 was prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT patient.name, medication.drug_name FROM patient WHERE patient.id = 10038992 ORDER BY medication.date_prescribed NULLS FIRST LIMIT 1;",[{'drug': 'Heparin'}]
37bfc037c806a2407d309d50,What is the minimum transitional epithelial cells value of patient 10018081 during their current hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'transitional epithelial cells' ),SELECT MIN(epithelial_cells) FROM transitional_epithelial_cells WHERE patient_id = 10018081 AND hospital_episode_id = (SELECT hospital_episode_id FROM hospitals WHERE patient_id = 10018081 AND is_current = true);,[{'MIN(labevents.valuenum)': None}]
488e2a77c6798e98c810e20b,What is the patient count for ascorbic acid prescription during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE prescription_name = 'Ascorbic Acid' AND date_trunc('year', prescription_date) = date_trunc('year', CURRENT_DATE)",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
ed4bfebb071d64a0de120838,How many of acetaminophen were prescribed to patient 10004235 in total in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'acetaminophen' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'","SELECT COUNT(DISTINCT acetaminophen) FROM prescriptions WHERE prescriptions.patient_id = 10004235 AND DATETIME(prescriptions.date, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year') AND STRFTIME('%m', prescriptions.date) = '07'",[{'SUM(prescriptions.dose_val_rx)': None}]
c84dfff5f8753a12aab6815f,What organism was found in patient 10029291's first stool test during their first hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT organism FROM (SELECT stool FROM (SELECT patient FROM patient WHERE patient.hospital_visits = 1) AS T1 JOIN sample ON T1.stool_id = sample.stool_id WHERE T1.patient_id = 10029291) AS T2 JOIN organism ON T2.organism_id = organism.organism_id WHERE T2.stool_rank = 1;,[]
7765d7fe671288bae59a5fa7,Did patient 10021118 go through any lab test during the first hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) > 0 FROM lab_results WHERE lab_results.patient_id = 10021118 AND lab_results.hospital_rank = 1,[{'COUNT(*)>0': 1}]
3f43e5ace937d4b9a8b18b3f,How many hours has it been since the first diagnosis of other iatrogenic hypotension in patient 10021487 on their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', diagnosis_date)) FROM diagnosis_table WHERE diagnosis_table.patient_id = 10021487 AND diagnosis_table.diagnosis = 'Other iatrogenic hypotension' AND diagnosis_table.dischtime IS NULL;",
c3b9775f6f9f3f0a14d7ec29,"For the first time in 08/this year, how much scopolamine patch was prescribed to patient 10016742?","SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'scopolamine patch' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT COUNT(*) FROM medication WHERE medication.patient_id = 10016742 AND medication.date = '2008-01-01' AND medication.drug = 'Scopolamine Patch',[]
0843691130d6cd5cd2dedc9f,What was the number of patients that were given a ferritin test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",SELECT COUNT(DISTINCT id) FROM patients WHERE ferritin_test > '1 year ago',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
8073dc91a374c05758eb7cd2,What are the ways to consume sodium bicarbonate?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate',"SELECT DISTINCT ON(method) method, uses FROM sodium_bicarbonate WHERE method IN ('bracket', 'equilibrium', 'incorporation', 'precipitation');","[{'route': 'IV'}, {'route': 'ORAL'}]"
dbadc610a502fc0a6c69d44e,How was patient 10039997 admitted in terms of admission type for the last time at the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039997 ORDER BY admissions.admission_date DESC LIMIT 1,[]
089ab5e83166d7733ba43ccc,Expose the top five most frequent output events in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT COUNT(DISTINCT t2.event_type) FROM t2 JOIN (SELECT t1.object_id, t1.event_type FROM t1 JOIN (SELECT object_id, COUNT(event_type) AS event_count FROM t2 GROUP BY object_id) AS t3 ON t1.object_id = t3.object_id) AS t4 WHERE t4.event_count > 5 GROUP BY t4.event_type ORDER BY t4.event_count DESC",[]
2753f3dc8c10c48e64cf034a,Count how many patients were discharged from hospital since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissed_date IS NULL AND STRFTIME('%y', dismissed_date) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
224951a256954e9d3b39076e,Has patient 10022281 undergone any laboratory tests in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*) FROM lab_tests WHERE lab_tests.patient_id = 10022281 AND STRFTIME('%y', lab_tests.test_date) = '2100'",[{'COUNT(*)>0': 0}]
bcaec1a9a3a9b59caef1e49a,Is there any record of cardiogenic shock in patient 83182's family?,,SELECT * FROM history WHERE patient_id = 83182 AND text_entry LIKE '%cardiogenic shock%',
27640049ed54c86d051fc8ff,"What is the maximum total hospital cost including a cholesterol, ldl, calculated lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, ldl, calculated' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(Lab.cost) AS c1 FROM Lab WHERE Lab.lab_name = 'Cholesterol, LDL, Calculated' GROUP BY Lab.patient_id) AS t1",
68ee1d315023f57029b6ce03,What is the yearly minimum piggyback input for patient 10014729 since 02/2100?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-02' GROUP BY strftime('%Y',inputevents.starttime)",SELECT MIN(piggyback_input) FROM input_table WHERE patient_id = 10014729 AND input_date >= '02/2100',[]
933c7c79dce6c6b398e200c9,"Has patient 10015860 been ordered triamcinolone acetonide 0.1% cream, docusate sodium, or calcium carbonate since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug IN ( 'triamcinolone acetonide 0.1% cream', 'docusate sodium', 'calcium carbonate' ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) > 0 FROM orders WHERE patient_id = 10015860 AND order_date >= '2100-01-01' AND order_name = 'triamcinolone acetonide 0.1% cream, docusate sodium, or calcium carbonate'",[{'COUNT(*)>0': 0}]
6971ce16d647c323dc5a6150,What was patient 10022041's maximum heart rate reading in their first ICU stay?,SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ),SELECT MAX(heart_rate) FROM (SELECT heart_rate FROM icu WHERE patient_id = 10022041 AND NOT icu_location = 'none' ORDER BY icu_admission_date NULLS FIRST LIMIT 1),[{'MAX(chartevents.valuenum)': None}]
c6a37b7e4bf30a4820758f4a,When was the last time that patient 10004235 was prescribed heparin and sodium chloride 0.9% in 07/2100 at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium chloride 0.9%' AND admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(DATE '2000-07-2100') FROM patient WHERE patient.id = 10004235 AND patient.prescriptions.drug_1 = 'Heparin' AND patient.prescriptions.drug_2 = 'Sodium Chloride 0.9%',[]
c72ddd4c729a31793b216593,What is the average absolute monocyte count value of patient 10004720 since 10/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute monocyte count' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'",SELECT AVG(ABS(Monocytes)) FROM AbsoluteMonocytes WHERE PatientID = 10004720 AND MeasurementDate >= '2021-10-2100',[{'AVG(labevents.valuenum)': None}]
8ce7af691c9be7d9abda7cc7,Count how many patients were discharged from hospital since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT(DISTINCT patient_id) FROM patients WHERE NOT dismissed_date IS NULL AND DATE(dismissed_date) >= DATEADD('year', -1, CURRENT_DATE);",[{'COUNT( DISTINCT admissions.subject_id )': 180733}]
78444405504330982a1f5e0a,"Among patients diagnosed with esophagitis, unspecified, what were the top four most common microbiology tests conducted within the same hospital visit in this year?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophagitis, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT t4.MicrobiologyTest, COUNT(t4.MicrobiologyTest) FROM (SELECT t3.MicrobiologyTest, COUNT(t3.MicrobiologyTest) FROM (SELECT t2.MicrobiologyTest, COUNT(t2.MicrobiologyTest) FROM (SELECT t1.MicrobiologyTest, COUNT(t1.MicrobiologyTest) FROM (SELECT Microbiology.MicrobiologyTest FROM Microbiology WHERE Microbiology.year = 2022) AS t1 GROUP BY t1.MicrobiologyTest) AS t2 GROUP BY t2.MicrobiologyTest) AS t3 JOIN (SELECT Microbiology.MicrobiologyTest, COUNT(Microbiology.MicrobiologyTest) FROM Microbiology WHERE Microbiology.year = 2022) AS t4 ON t3.MicrobiologyTest = t4.MicrobiologyTest WHERE t3.diagnosis = 'ESOPHAGITIS, UNSPECIFIED' GROUP BY t4.MicrobiologyTest ORDER BY COUNT(t4.Micro",
9bcc50dfeada714797755ff0,What is the checklist you need to follow in advance of your egd with closed biopsy procedure?,,SELECT * FROM procedures WHERE procedure = 'Closed biopsy',
0ceee1a85a040c4d57c27a09,"Has patient 10008287 been ordered acetaminophen iv, dexamethasone, or heparin in 04/last year?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.drug IN ( 'acetaminophen iv', 'dexamethasone', 'heparin' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*) > 0 FROM orders WHERE patient_id = 10008287 AND order_date BETWEEN '2004-01-01' AND '2004-12-31' AND drug IN ('acetaminophen iv', 'dexamethasone', 'heparin')",[{'COUNT(*)>0': 0}]
540b84764bb982f9853d1621,Has patient 10038999 been diagnosed with any diseases in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10038999 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100'",
955c6240945fc39d733c8375,Provide the count of hospital visits for patient 10026354 during the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT HOSP_VISIT) FROM hospital_visits WHERE PATIENT_ID = 10026354 AND DATETIME(HOSP_VISIT, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
5ee025cab135eb911d61888a,What are the four most frequent procedures for patients aged 50s throughout this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.CATEGORY, COUNT(t1.CATEGORY) FROM (SELECT t2.CATEGORY FROM (SELECT * FROM patients WHERE AGE BETWEEN 50 AND 59) AS t1 JOIN procedures AS t2 ON t1.PATIENT_ID = t2.PATIENT_ID WHERE t1.DISTINCT_FORM = '50s' AND DATETIME(t2.PROCEDURE_DATE, 'start of year') = DATETIME(CURRENT_DATE, 'start of year', '-0 year')) GROUP BY t1.CATEGORY ORDER BY COUNT(t1.CATEGORY) DESC LIMIT 4",
82eed12efc2bbbf2dd01b1c2,Tell me what to prepare before the peripheral nerve graft procedure :,,"SELECT ""to prepare before the peripheral nerve graft"" FROM ""brackets_questions"" WHERE ""question"" = 'Tell me what to prepare before the peripheral nerve graft'",
35cf8678b7b636890f6218de,How many patients were staying in medicine since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )","SELECT COUNT(DISTINCT patient_id) FROM stays WHERE length(stay_duration) > 1 AND stay_type = 'medicine' AND DATETIME(stay_start_date) >= DATETIME(CURRENT_TIME, '-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
e4740c820cb8320bffa0e957,What is the total count of patients who stayed in careunit cardiac vascular intensive care unit (cvicu) during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac vascular intensive care unit (cvicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.careunit = ""CVICU"" AND DATETIME(patient.staydate, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
003865fdb611e9f27fe18281,Tell me the top four most common diagnoses for patients aged 30s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.diagnosis FROM (SELECT t3.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.age FROM patient WHERE patient.age BETWEEN 30 AND 39) AS t1 JOIN (SELECT patient.diagnosis FROM patient WHERE patient.diagnosis = 'ACUTE TUBERCULOSIS') AS t2 ON t1.age = t2.age GROUP BY t3.diagnosis) AS t3 JOIN (SELECT diagnosis, COUNT(*) AS c2 FROM t3 GROUP BY diagnosis) AS t4 ON t3.diagnosis = t4.diagnosis AND t3.c1 = t4.c1",
dd87fb2dfb9bf1eaf69c3a59,When has patient 10019172 had the first input since 03/05/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT MIN(input_time) FROM input_table WHERE patient_id = 10019172 AND STRFTIME('%d/%m/%Y', input_time) >= '03/05/2100'",[{'starttime': '2118-11-16 11:20:00'}]
a61da9b50a816c216dab4107,When was the time of patient 10031757's first hospital discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10031757 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient.hospital_discharge_time FROM patient WHERE patient.patient_id = 10031757,[]
9162de3307e705f564c4492d,Provide the top four most common treatments.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t4.treatment, COUNT(t4.treatment) FROM (SELECT t3.treatment, COUNT(t3.treatment) FROM (SELECT t2.treatment, COUNT(t2.treatment) FROM (SELECT t1.treatment, COUNT(t1.treatment) FROM (SELECT ' ' AS treatment) AS t1 GROUP BY t1.treatment) AS t2 GROUP BY t2.treatment) AS t3 GROUP BY t3.treatment) AS t4 GROUP BY t4.treatment ORDER BY COUNT(t4.treatment) DESC LIMIT 4","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Central venous catheter placement with guidance'}, {'long_title': 'Other nonoperative respiratory measurements'}]"
6d3b33c130ee573fc9b4e5f8,Can you retrieve the top four most frequent lab tests patients had following a diagnosis of closed fracture of seven ribs in the same hospital visit since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of seven ribs' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT t4.lab_test, COUNT(t4.lab_test) FROM (SELECT t3.lab_test, COUNT(t3.lab_test) FROM (SELECT t2.lab_test, COUNT(t2.lab_test) FROM (SELECT t1.subject_id, t1.diagnosis_date, t2.lab_test FROM (SELECT t1.subject_id, t1.diagnosis_date, t2.lab_test FROM (SELECT SUM(t1.subject_id) AS subject_id, t1.diagnosis_date, t2.lab_test FROM (SELECT t1.subject_id, t1.diagnosis_date, t2.lab_test FROM (SELECT STATUS = 'CLOSED', DATE = '2100-01-01' FROM t2 JOIN t1 ON t2.subject_id = t1.subject_id WHERE t2.diagnosis = 'CLOSED FRACTURE OF SEVEN RIBS') AS t1 JOIN t2 ON t1.subject_id = t2.subject_id WHERE t",
51bf2e035e47da3885e46b70,"Since 03/03/2100, when was the first input time for patient 10018423?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-03' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10018423 AND input_time >= '2100-03-03',[{'starttime': '2167-05-05 19:22:00'}]
84ba715b229207e9b74e2c7f,Provide the top three most frequent diagnoses that patients were assigned within 2 months after receiving diagnostic ultrasound of digestive system in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.id WHERE treatment.treatment_name = 'diagnostic ultrasound of digestive system' AND STRFTIME('%y', treatment.treatment_date) = '2100') AS t1 JOIN (SELECT patient.id, diagnosis.diagnosis, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.treatment_date < t2.diagnosis_date AND DATETIME(t2.diagnosis_date) BETWEEN DATETIME(t1.treatment_date) AND DATETIME(t1.treatment_",
33b3c4f8d9aabedcd9066605,What was the medication that patient 10019777 was prescribed for within 2 days after receiving other endoscopy of small intestine in 03/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT t2.name FROM (SELECT patient.subject, treatment.date FROM treatment JOIN patient ON treatment.patient = patient.subject WHERE patient.subject = 10019777 AND treatment.type = 'other endoscopy of small intestine' AND DATETIME(treatment.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', treatment.date) = '03') AS t1 JOIN (SELECT patient.subject, medication.name FROM medication JOIN patient ON medication.patient = patient.subject WHERE patient.subject = 10019777 AND DATETIME(medication.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') AND STRFTIME('%m', medication.date) = '03') AS t2 ON t1.subject = t2.subject WHERE t1.date < t2.date AND DATETIME(t2.date) BETWEEN DATETIME(t1.date) AND DATETIME",
d74b04155d86c3e804553ede,Tell me the five most frequent medical diagnoses since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.medical_diagnosis FROM (SELECT medical_diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT * FROM users WHERE birthdate < '2100-01-01') AS t1 GROUP BY medical_diagnosis) AS t2 WHERE t2.c1 <= 5",
486aad9ca1f13f573fabc677,How much is the cost for the drug sodium chloride 0.9%?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium chloride 0.9%' ),SELECT DISTINCT cost FROM drugs WHERE drug = 'Sodium Chloride 0.9%',
1183bcefba1a2e8f38f90e8e,What amount of heparin was prescribed to patient 10021666?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'heparin',SELECT heparin FROM prescriptions WHERE patient = 10021666;,[{'SUM(prescriptions.dose_val_rx)': None}]
60eba7103445142138d17aea,"Since 09/09/2100, what was the first value of arterial blood pressure mean of patient 10021487?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-09' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(arterial_blood_pressure_mean) FROM patient_10021487 WHERE arterial_blood_pressure_mean IS NOT NULL AND date_of_measurement >= '2009-09-2100',[]
5a930b48e4949a1ed44fe056,What immunotherapies have been used for the past five years?,,"SELECT * FROM products WHERE product_category = 'immunotherapies' AND date_sub('year', 5, CURRENT_DATE) <= manufacturing_date;",
a544c5a0f893e479f14079f0,What was the total number of input patient 10018081 has received since 11/20/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-20'","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT patient.subject, SUM(input.quantity) AS total_quantity FROM patient WHERE patient.subject = 10018081 GROUP BY patient.subject) AS t1 JOIN (SELECT patient.subject, SUM(input.quantity) AS total_quantity FROM patient WHERE patient.subject = 10018081 GROUP BY patient.subject) AS t2 ON t1.subject = t2.subject WHERE t1.total_quantity = t2.total_quantity AND STRFTIME('%y-%m-%d', t1.date) >= '2100-11-20'",[{'SUM(inputevents.totalamount)': 171300.0}]
0eec887f694582394cfc6f10,How many patients in 2100 received open and other cecectomy within 2 months after being diagnosed with pure hypercholesterolemia?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open and other cecectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'Pure hypercholesterolemia' AND STRFTIME('%y', diagnosis.diagnosis_date) = '2100') AS t1, (SELECT patient.subject_id, procedures.procedure_date FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.procedure = 'Open and other cecectomy' AND STRFTIME('%y', procedures.procedure_date) = '2100') AS t2 WHERE t1.diagnosis_date < t2.procedure_date AND DATETIME(t2.procedure_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month')",
ad15992e182e0964c4084195,What is the opioid dosage prescribed for patient 7107?,,SELECT prescriptions.dosage FROM prescriptions WHERE prescriptions.patient_id = 7107 AND prescriptions.drug_name = 'Opioid',
74a38dccf5ce3b494dd37197,What was the change in SaO2 in patient 10016742 last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT SAO2 FROM iCuData WHERE iCuData.patient = 10016742 AND NOT iCuData.unit = 'string' ORDER BY iCuData.measurementTime DESC LIMIT 1) - (SELECT SAO2 FROM iCuData WHERE iCuData.patient = 10016742 AND NOT iCuData.unit = 'string' ORDER BY iCuData.measurementTime DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
8d8518ce9ca76a042a0c5bb0,What are the prices for the drug called vitamin e?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vitamin e' ),,
9f56b7e6de37d05e0ac335a3,Count the number of patients who were given the lamotrigine in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lamotrigine' AND strftime('%Y',prescriptions.starttime) = '2100' )",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE date_trigged = '2100-01-01' AND prescription = 'lamotrigine',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
81852273a5351d699a554177,How much midazolam was prescribed since 09/2100 for the first time to patient 10021487?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'midazolam' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10021487 AND prescriptions.drug_name = 'midazolam' AND STRFTIME('%y-%m', prescriptions.date) >= '2100-09' ORDER BY prescriptions.date NULLS FIRST LIMIT 1",[]
f691d2a9bc22649ae9adddac,"What is the average total cost of a hospital that includes a procedure called fluoroscopy of superior vena cava using other contrast, guidance throughout this year?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(Total) FROM (SELECT SUM(Cost) AS Total FROM procedures WHERE procedures.name = 'fluoroscopy of superior vena cava using other contrast, guidance' AND DATETIME(procedures.date, 'start of year') = DATETIME(CURRENT_TIME, 'start of year', '-0 year') GROUP BY procedures.id)",
81882a684bf6449f672dfca5,When did patient 10006580 get a mrsa screen microbial test for the last time in 08/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT MAX(date_requested) FROM lab_requests WHERE patient_id = 10006580 AND lab_request_type = 'mrsa screen microbial' AND date_requested BETWEEN '2008-01-01' AND '2008-12-31',[]
b8c79b9be82f4813cd52ed92,How many hospitalized patients are there now?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE hospitalized = true;,[{'COUNT( DISTINCT admissions.subject_id )': 0}]
48965885b40400e08e4d8528,Count the number of hospital visits for patient 10020306 during the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(DISTINCT visit_id) FROM visit_table WHERE patient_id = 10020306 AND visit_date BETWEEN DATEADD(year, -1, CURRENT_DATE) AND CURRENT_DATE",[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
981338dedcce7e27679a41c7,When was the last time that patient 59941 had a medication that should be taken daily?,,SELECT MAX(date_last_drug) FROM medication WHERE medication.patient_id = 59941 AND medication.drug_duration = '1 day',
6a4f0f27325a4881d537e381,Show me the five most common specimens tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(specimen) FROM brackets_db WHERE year > 2100 GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 5;","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]"
6012b1badcebf4d12139de0e,Get me patient 10026354's total output volume on 10/31/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-31'",SELECT SUM(output_volume) FROM my_table WHERE patient_id = 10026354 AND output_date = '2022-10-31',[{'SUM(outputevents.value)': None}]
3fceb3f3200f3f095b671be0,What is the body weight change of patient 10004720 measured at 2100-12-07 00:00:00 compared to the value measured at 2100-12-06 00:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 00:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-06 00:00:00' ),SELECT (SELECT weight_change FROM measurements WHERE patient_id = 10004720 AND measurement_time = '2100-12-07 00:00:00') - (SELECT weight_change FROM measurements WHERE patient_id = 10004720 AND measurement_time = '2100-12-06 00:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 00:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-06 00:00:00' )"": None}]"
22b41e8ee0723aa4a6acf31c,What is the hospital's minimum total cost that involved a procedure called endovascular (total) embolization or occlusion of head and neck vessels since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedures.name = 'endovascular (total) embolization or occlusion of head and neck vessels' AND DATETIME(procedures.date) >= DATETIME(CURRENT_TIME, '-1 year') GROUP BY procedures.hospital) AS t1",
24bf28822b415fe4f9bd906c,What specimen tests did patient 10038992 undergo for the first time during the first hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT specimen_type FROM visit_details WHERE patient_id = 10038992 AND visit_number = 1 AND sample_date = MIN(sample_date),[{'spec_type_desc': 'BLOOD CULTURE'}]
99bcce6bc0fdda73e97057c2,When was patient 10027602's first input time since 07/21/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-21' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT p.date_input FROM patient p WHERE p.patient_id = 10027602 AND STRFTIME('%y-%m-%d', p.date_input) >= '2100-07-21' ORDER BY p.date_input NULLS FIRST LIMIT 1",[{'starttime': '2201-10-30 12:08:00'}]
7499a31689ceddb83308b2d0,"Since 2100, has patient 10004235 undergone a simple excision of other lymphatic structure procedure?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10004235 AND procedures.procedure_type = 'Simple excision of other lymphatic structure' AND STRFTIME('%y', procedures.date) >= '2100'",
537ba5b0d8bba89f02aeaf41,"Since 06/14/2100, when did patient 10019172 have his last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-14' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT input_date FROM input_table WHERE patient_id = 10019172 AND input_date >= '2100-06-14' ORDER BY input_date DESC LIMIT 1,[{'starttime': '2118-11-19 19:30:00'}]
a1b0068465d08286b72f7de4,Tell me the duration in days of patient 10005909's first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",SELECT COUNT(DISTINCT ICU.startDate) FROM ICU WHERE ICU.patientId = 10005909 AND NOT ICU.endDate IS NULL,"[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.677384258713573}]"
1e43adf0cab50573f8e61e90,What was the first thing patient 10021312 had as output since 03/11/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-11' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT STRFTIME('%d/%m/%Y', PATIENT_OUTPUT.TIME) AS OUTPUT_DATE, PATIENT_OUTPUT.VALUE",[{'label': 'Void'}]
00c6c1102d545178bf7380f3,"Has acetaminophen, lidocaine 0.5%, or soln been prescribed for patient 10007928?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND prescriptions.drug IN ( 'acetaminophen', 'lidocaine 0.5%', 'soln' )","SELECT COUNT(*) > 0 FROM prescriptions WHERE prescriptions.patient_id = 10007928 AND prescriptions.drug IN ('acetaminophen', 'lidocaine 0.5%', 'soln')",[{'COUNT(*)>0': 0}]
3bf2d40135249f916f915ace,What was the last specimen test given to patient 10020786 since 05/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen_type FROM specimens WHERE patient_id = 10020786 AND date_specified >= '2000-05-2100' ORDER BY date_specified DESC LIMIT 1,[{'spec_type_desc': 'BLOOD CULTURE'}]
5077dabbbdb1f143ad870dd9,"Calculate the number of patients diagnosed with body mass index 31.0-31.9, adult since 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 31.0-31.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT patient.subject, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'BODYMASSINDEX31.0-31.9' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1",
880dda6394687e6af314914f,"Tell me the three most common microbiology tests for patients who were previously diagnosed with adverse effect of penicillins, initial encounter within 2 months.","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of penicillins, initial encounter' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT t3.test_name FROM (SELECT t2.test_name, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'adverse effect of penicillins, initial encounter') AS t1 JOIN (SELECT patient.id, microbiology.test_name, microbiology.test_date FROM microbiology JOIN patient ON microbiology.patient_id = patient.id) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.test_date AND DATETIME(t2.test_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.test_name) AS t3 WHERE t3.c1 <= 3",
8a5ef0e3b44f9d29e1d8e450,Patient 10014078's chloride last measured on the last hospital visit is less than the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT lab.result FROM lab WHERE lab.patient = 10014078 AND lab.label = 'chloride' AND NOT lab.result IS NULL ORDER BY lab.measured DESC LIMIT 1) < (SELECT lab.result FROM lab WHERE lab.patient = 10014078 AND lab.label = 'chloride' AND NOT lab.result IS NULL ORDER BY lab.measured DESC LIMIT 1 OFFSET 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
2723a0b2a202e96ddb72ec44,What were the three most common drugs prescribed throughout this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT t1.drug, COUNT(t1.drug) FROM (SELECT prescriber.drug FROM prescriber WHERE prescriber.date BETWEEN '2000-01-01' AND '2000-12-31') AS t1 GROUP BY t1.drug ORDER BY COUNT(t1.drug) DESC LIMIT 3",[]
69d1179ddab59c8ffa8e22d7,What was the first time of input for patient 10009049 on 06/14/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '06-14' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(input_time) FROM input_table WHERE patient_id = 10009049 AND input_time BETWEEN '06/14/2022' AND '06/14/2022',[]
b01254cc6625f82626d18102,"What is the cost for the procedure destruction of right main bronchus, via natural or artificial opening endoscopic?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) )","SELECT ""Cost"" FROM procedures WHERE ""Procedure"" = 'Destruction of right main bronchus, via natural or artificial opening endoscopic'",
5a57c249d0fff38a58052135,"What are the four most typically ordered procedures for patients previously diagnosed with other anaphylactic reaction, which took place within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other anaphylactic reaction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.other_procedure FROM (SELECT t2.other_procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.id WHERE diagnosis.diagnosis = 'Other anaphylactic reaction') AS t1 JOIN (SELECT patient.id, procedure.other_procedure, procedure.procedure_date FROM procedure JOIN patient ON procedure.patient_id = patient.id) AS t2 ON t1.id = t2.id WHERE t1.diagnosis_date < t2.procedure_date AND DATETIME(t2.procedure_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.other_procedure) AS t3 WHERE t3.c1 <= 4",
1e888452b37ac8ca86b6980c,What the code that refers to icd-11 for senile dementia uncomp in icd-10?,,SELECT icd_11 FROM icd_10 WHERE icd_10 = 'senile dementia uncomp';,
5d3b63e510deecde492912dc,What culture was patient 10021666 first tested?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT culture FROM patients WHERE patient_id = 10021666 ORDER BY date_first_tested NULLS FIRST LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}]
ef3149b9a35fb04e1492d336,When did the first time patient 10015272 had the minimum value of SaO2?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(SaO2) FROM (SELECT SaO2 FROM read_csv_auto('patient_10015272_sao2.csv') WHERE patient_id = 10015272),[]
c3ec4bb31cef4c9d976a8b02,What was the organism found in patient 10029291's last urine test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT urine FROM patients WHERE patient_id = 10029291 ORDER BY urine_date DESC LIMIT 1,[]
641457e48596a76706eaa733,"What is the maximum total hospital cost, which includes other acute pain since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other acute pain' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM cost WHERE costdate >= '2100-01-01' AND costdate < '2021-01-01' AND diagnosis = 'other acute pain' GROUP BY costdate) AS t1,
3917dc2e272fabe6467257d2,I need the name of the diagnostic that patient 31510 received in the other department,,SELECT d.name FROM diagnoses d WHERE d.patient = 31510 AND d.department <> (SELECT department FROM departments WHERE name = 'Other department'),
bbb1655c44fb049ef7b879ae,Tell me the number of patients who stayed in medicine since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND strftime('%Y',transfers.intime) >= '2100' )",SELECT COUNT(DISTINCT patient_id) FROM patients WHERE medicine_stay_length >= '2100',[{'COUNT( DISTINCT admissions.subject_id )': 0}]
19514defe49fe155ab776c71,What were the top five most frequent specimens ordered for patients after being diagnosed with proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site within the same hospital visit?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT t3.specimen, COUNT(t3.specimen) FROM (SELECT t2.specimen, t2.hospital_visit_id FROM (SELECT t1.subject_id, t1.diagnosis, t1.hospital_visit_id FROM (SELECT SUM(CASE WHEN diverticulitis = 'proteus (mirabilis) (morganii)' THEN 1 ELSE 0 END) AS diverticulitis, t1.hospital_visit_id FROM (SELECT t1.subject_id, t1.diagnosis, t1.hospital_visit_id FROM (SELECT SUM(CASE WHEN diverticulitis = 'proteus (mirabilis) (morganii)' THEN 1 ELSE 0 END) AS diverticulitis, t1.hospital_visit_id FROM (SELECT SUM(CASE WHEN diverticulitis = 'proteus (mirabilis) (morganii)' THEN 1 ELSE 0 END) AS diverticulitis, t1.hospital_visit_id FROM (SELECT t1.subject_id, t1.diagnosis, t1.h",
997ad426b096ea558462f1a2,Did patient 10005817 have an input of kcl (bolus) on this month/25?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '25'","SELECT COUNT(*) FROM input WHERE input.patient_id = 10005817 AND input.input_type = 'kcl (bolus)' AND DATETIME(input.input_date, 'start of month') = DATETIME(CURRENT_DATE, 'start of month', '-0 month') AND STRFTIME('%d', input.input_date) = '25';",[{'COUNT(*)>0': 0}]
a49d3f97e37407754c15cf05,When for the last time since 08/2100 was patient 10015860 prescribed ondansetron and bisacodyl at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10015860 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bisacodyl' AND admissions.subject_id = 10015860 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM medication WHERE medication.patient_id = 10015860 AND medication.drug_name = 'ondansetron' AND STRFTIME('%y-%m', date_prescribed) >= '2100-08' INTERSECT SELECT MAX(date_prescribed) FROM medication WHERE medication.patient_id = 10015860 AND medication.drug_name = 'bisacodyl' AND STRFTIME('%y-%m', date_prescribed) >= '2100-08'",[]
543a7a730e5752f6d23804e0,"Did patient 10015931 receive the procedure of a replacement of aortic valve with zooplastic tissue, percutaneous approach during their last hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )","SELECT COUNT(*) > 0 FROM procedures WHERE procedures.patient_id = 10015931 AND procedures.procedure_name = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' AND NOT procedures.date IS NULL AND procedures.date = (SELECT MAX(procedures.date) FROM procedures WHERE procedures.patient_id = 10015931 AND NOT procedures.date IS NULL)",[{'COUNT(*)>0': 0}]
794da47ae77cd75fe2914cf2,"In the previous year, how many patients underwent a transcatheter embolization for gastric or duodenal bleeding within 2 months after the diagnosis of unspecified essential hypertension?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'transcatheter embolization for gastric or duodenal bleeding' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient_id, diagnosed_date FROM (SELECT patient_id, DATEADD(month, -2, diagnosed_date) AS diagnosed_date FROM (SELECT patient_id, diagnosed_date FROM gastric_bleeding WHERE diagnosed_date IS NOT NULL) AS t1 JOIN (SELECT patient_id, diagnosed_date FROM duodenal_bleeding WHERE diagnosed_date IS NOT NULL) AS t2 ON t1.patient_id = t2.patient_id) AS t3 JOIN (SELECT patient_id, treatment_date FROM transcatheter_embolization_for_gastric_or_duodenal_bleeding WHERE treatment_date IS NOT NULL) AS t4 ON t3.patient_id = t4.patient_id AND t3.diagnosed_date BETWEEN t4.treatment_date AND t4.treatment_date + INTERVAL '2 month') AS t5;",
bbd3ab3b5e2878e0c7d8dc79,What was the maximum value of lymphocytes in patient 10016742's body in 07/2100?,"SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07'",SELECT MAX(lymphocytes) FROM patient WHERE patient.patient_id = 10016742 AND date = '07/2100',[{'MAX(labevents.valuenum)': None}]
b0fa39290a379ac3962d1215,Does patient 12410 have experience with overseas travel?,,SELECT EXISTS (SELECT * FROM patients WHERE patients.experience = 'overseas travel' AND patients.id = 12410),
381ee96e607f7191231167cb,Tell me the insurance plan in place for patient 10039831 on this hospital stay.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL,SELECT insurance_plan FROM duckdb_insurance WHERE patient_id = 10039831 AND hospital_stay_id = (SELECT hospital_stay_id FROM duckdb_hospital WHERE patient_id = 10039831 AND date_in_place = CURRENT_DATE),[]
1d35d6275c13a75467d5621f,"How many patients underwent endovascular (total) embolization or occlusion of head and neck vessels within the same hospital visit after the diagnosis of attention deficit disorder with hyperactivity, in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT t1.subject) FROM (SELECT t1.subject, t2.diagnosis_date, t1.had_surgery FROM (SELECT subject, diagnosis_date, had_surgery FROM (SELECT subject, DATE(diagnosis_date) AS diagnosis_date, BOOLEAN(had_surgery) AS had_surgery FROM (SELECT subject, DATE(diagnosis_date) AS diagnosis_date FROM (SELECT patient.subject, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'Attention deficit disorder with hyperactivity') AS t1 JOIN (SELECT patient.subject, embolization.diagnosis_date, embolization.had_surgery FROM embolization JOIN patient ON embolization.patient_id = patient.patient_id WHERE embolization.diagnosis = 'Endovascular (total) embolization or occlusion of head and neck vessels') AS t2 ON t1.subject = t2.subject WHERE t",
5ea4690a08942372011bee45,"Of the patients of age 50s since 1 year ago, what were the top four most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT t1.diagnosis FROM (SELECT diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis FROM diagnosis JOIN patient ON diagnosis.patient = patient.uniquepid WHERE diagnosis.age IN (50, 51) AND DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 WHERE t1.c1 <= 4",
1f7740e7b17317dd9085a8ce,Did patient 10020944 have any surgeries in their last hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) > 0 FROM patient WHERE patient.last_hospital_visit = (SELECT MAX(patient.last_hospital_visit) FROM patient WHERE patient.subject_id = 10020944) AND patient.discharge_reason = 'SURGERY',[{'COUNT(*)>0': 1}]
56902909daa613c259aedbde,What is the average total expenditure of a hospital that involves the medication miconazole nitrate vag cream 2% during this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'miconazole nitrate vag cream 2%' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",SELECT AVG(t1.c1) FROM (SELECT SUM(Medication.c1) AS c1 FROM Medication WHERE Medication.d1 = '2022-01-01' AND Medication.d2 = 'miconazole nitrate vag cream 2%' GROUP BY Medication.c1) AS t1,
69670441a1821ea09ab84daa,Show me patient 10018081's total ostomy (output) output amount since 07/25/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-25'","SELECT COUNT(DISTINCT ""ostomy (output)"") FROM ""patient"" WHERE ""patient"" = 10018081 AND ""date"" = '07/25/2100'",[{'SUM(outputevents.value)': None}]
962c0dd05a16f3d046055b17,What specimen tests did patient 10039997 undergo for the last time since 05/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT specimen FROM results WHERE patient_id = 10039997 AND date >= '2000-05-21' ORDER BY date DESC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}]
45d81fe4cd05b27444d9f58e,What does a procedure under the name coronary arteriography using two catheters cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) ),SELECT DISTINCT cost FROM procedures WHERE name = 'coronary arteriography using two catheters';,
d4838da30561bc40110b929d,Do you think patient 1912 has dmii circ nt st uncntrld in his or her family?,,"SELECT COUNT(DISTINCT patient.uniquepatientid) FROM patient WHERE patient.patientfamilyid IN (SELECT patient.patientfamilyid FROM patient WHERE patient.uniquepatientid = 1912) AND patient.diagnosis = ""DMII CIRCULANT ST UNCNTRLD""",
049fb43f09ae244560ee52a7,"Compared to yesterday, what new prescriptions were given to patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT prescriptions FROM medication_usage WHERE patient_id = 10039831 AND date = '2022-03-01' EXCEPT SELECT prescriptions FROM medication_usage WHERE patient_id = 10039831 AND date = '2022-03-01' - INTERVAL '1 day';,[]
04e24b204bd0cfa1f803ee70,Tell me the difference in the heart rate value for patient 10019385 last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT heart_rate FROM icu_heart_rate WHERE icu_heart_rate.icu_id IN (SELECT icu_id FROM icu WHERE patient_id = 10019385 AND NOT icu_heart_rate.heart_rate IS NULL ORDER BY icu_heart_rate.heart_rate_date NULLS FIRST LIMIT 1) - (SELECT heart_rate FROM icu_heart_rate WHERE icu_heart_rate.icu_id IN (SELECT icu_id FROM icu WHERE patient_id = 10019385 AND NOT icu_heart_rate.heart_rate IS NULL ORDER BY icu_heart_rate.heart_rate_date NULLS FIRST LIMIT 1) OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
64a43632d54bb861d083b284,Get the count of the number of hospital visits of patient 10031404 last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10031404 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(visits) FROM (,[{'COUNT( DISTINCT admissions.hadm_id )': 0}]
d1848715fb9bd76d88e82c49,What was the last o2 saturation pulseoxymetry value patient 10018081 had on this month/27?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '27' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT MAX(O2_SATURATION_PULSEOXYMETRY) FROM pulseoxymetry WHERE PATIENT_ID = 10018081 AND MONTH = 10 AND DAY = 27,[]
dd84074c0fd0874c556d0511,How often did patient 10018845 go to the ICU?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ),SELECT COUNT(DISTINCT icu_stay_id) FROM icu_stays WHERE patient_id = 10018845,[{'COUNT( DISTINCT icustays.stay_id )': 1}]
c2611c6cae651d68d35a90db,"How many days have elapsed since the last time patient 10004733 was diagnosed with tachycardia, unspecified on the current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tachycardia, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT COUNT(DISTINCT diagnosis_date) FROM diagnoses WHERE patient_id = 10004733 AND diagnosis = ""TACHYCARDIA, UNOBSERVED""",
0e012c21a61355d6b84c3090,How much does it cost for insulin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'insulin' ),SELECT DISTINCT cost FROM products WHERE product = 'insulin';,
58005b8292ece24dcde6f455,What was the number of fluoroscopy of right heart using other contrast procedures performed in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of right heart using other contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",SELECT COUNT(*) FROM procedures WHERE procedures.date BETWEEN '2100-01-01' AND '2100-12-31' AND procedures.method = 'fluoroscopy of right heart using other contrast',
687bceb15b59fc60e8fe6650,Could you provide the top four most common output events in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT 2000 FROM (SELECT COUNT(DISTINCT (output_event)) FROM 2000 WHERE YEAR = 2000) AS TOP4;,[]
3d45d365e05eb1ff7b926005,How many hours elapsed since patient 10018081 received his chloride lab test for the last time on their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', lab_result.result_date)) FROM lab_result WHERE lab_result.patient_id = 10018081 AND lab_result.result_type = 'chloride' AND lab_result.result_date = (SELECT lab_result.result_date FROM lab_result WHERE lab_result.patient_id = 10018081 AND lab_result.result_type = 'chloride' ORDER BY lab_result.result_date DESC LIMIT 1);",[]
7f05f81e2c4bccc575d180b8,Could you inform me of the top three most common specimen tests that were conducted?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen, COUNT(specimen) FROM (SELECT specimen FROM post_extract WHERE post_extract.post_id IN (SELECT post_id FROM posts WHERE posts.date = '2009-01-01')) GROUP BY specimen ORDER BY COUNT(specimen) DESC LIMIT 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]"
2d6e4345dac956dd550150ea,When patient 10014078 first had a urine microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT STRFTIME('%y-%m', MIN(Microbiology.Date)) as FirstUrineMicrobiology FROM Microbiology WHERE Microbiology.Patient = 10014078 AND Microbiology.Type = 'urine' AND STRFTIME('%y-%m', MIN(Microbiology.Date)) >= '2100-03'",[]
77fee139a7a8698c4a12156a,Tell me the top five most frequent procedures that patients received within 2 months after being diagnosed with hyperplasia of renal artery.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperplasia of renal artery' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT t3.procedure FROM (SELECT t2.procedure, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.uniquepid WHERE diagnosis.diagnosis = 'hyperplasia of renal artery') AS t1 JOIN (SELECT patient.uniquepid, procedure.procedure, procedure.procedure_date FROM procedure JOIN patient ON procedure.patient_id = patient.uniquepid) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.diagnosis_date < t2.procedure_date AND DATETIME(t2.procedure_date) BETWEEN DATETIME(t1.diagnosis_date) AND DATETIME(t1.diagnosis_date, '+2 month') GROUP BY t2.procedure) AS t3 WHERE t3.c1 <= 5",
18010be66782b5371bb31160,What were the four most commonly given diagnoses for patients who had received percutaneous abdominal drainage before within 2 months since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT t3.diagnosis FROM (SELECT t2.diagnosis, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS c1 FROM (SELECT patient.uniquepid, treatment.treatmentdate FROM treatment JOIN patient ON treatment.patientid = patient.uniquepid WHERE treatment.treatmenttype = 'percutaneous abdominal drainage' AND DATETIME(treatment.treatmentdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t1 JOIN (SELECT patient.uniquepid, diagnosis.diagnosis, diagnosis.diagnosisdate FROM diagnosis JOIN patient ON diagnosis.patientid = patient.uniquepid WHERE DATETIME(diagnosis.diagnosisdate) >= DATETIME(CURRENT_TIME, '-1 year')) AS t2 ON t1.uniquepid = t2.uniquepid WHERE t1.treatmentdate < t2.diagnosisdate AND DATETIME(t2.diagnosisdate) BETWEEN DATETIME(t1.treatmentdate) AND DATETIME(t1.treatmentdate,",
bfb03e1d79c3802ab3081d33,"In total, how many patients were prescribed iso-osmotic sodium chloride since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT(DISTINCT patient.uniquepid) FROM patient WHERE patient.patienttype = 'iso-osmotic sodium chloride' AND STRFTIME('%y', patient.lastmodified) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}]
1ac4bb5a24bb2e2beea14966,Is the respiratory rate reading for patient 10014078 last measured on the first ICU visit greater than the value second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT (SELECT respiratory_rate FROM icu_readings WHERE icu_number = 1 AND patient_id = 10014078 ORDER BY measurement_time DESC LIMIT 1) > (SELECT respiratory_rate FROM icu_readings WHERE icu_number = 1 AND patient_id = 10014078 ORDER BY measurement_time DESC LIMIT 1 OFFSET 1),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]"
cb480ff3c89f74e82be45053,What was the last drug prescribed since 12/2100 to patient 10021118?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(date_prescribed) FROM prescriptions WHERE prescriptions.patient_id = 10021118 AND STRFTIME('%y-%m', date_prescribed) >= '2100-12';",[{'drug': 'Furosemide'}]
3244f169b0839776c6f8d9aa,What's the alkaline phosphatase change of patient 10021938 last measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT lab.result FROM lab WHERE lab.patient = 10021938 AND NOT lab.result IS NULL ORDER BY lab.measurement_time NULLS FIRST LIMIT 1) - (SELECT lab.result FROM lab WHERE lab.patient = 10021938 AND NOT lab.result IS NULL ORDER BY lab.measurement_time NULLS FIRST LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
15d1606a584e98abfb4203b3,Retrieve the yearly average amount of patient 10021118's or cell saver intake input since 12/2100.,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12' GROUP BY strftime('%Y',inputevents.starttime)",SELECT AVG(intake_amount) FROM intake_table WHERE patient_id = 10021118 AND intake_type = 'or cell saver' AND input_date >= '12/2100',[]
f4312adc1652536556c92455,What was patient 10018423's last input time on 05/21/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-05-21' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT patient.name, patient.age, STRFTIME('%m/%d/%Y', patient.input_time) as input_time",[]
d73de23832fc51ea33bed174,What was the name of the drug that patient 10027602 was prescribed with within the same hospital visit after undergoing continuous invasive mechanical ventilation for less than 96 consecutive hours during this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT t2.drug FROM (SELECT patient.name, treatment.start_time, patient.patient_id FROM treatment JOIN patient ON treatment.patient_id = patient.patient_id WHERE patient.patient_id = 10027602 AND treatment.treatment_type = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' AND DATETIME(treatment.start_time, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')) AS t1 JOIN (SELECT patient.name, prescription.drug, prescription.start_time, patient.patient_id FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE patient.patient_id = 10027602 AND DATETIME(prescription.start_time, 'start of month') = DATETIME(CURRENT_TIME, 'start of month', '-0 month')) AS t2 ON t1.name = t2.name WHERE t1.start_time < t2.start_time AND t1.",
24ebd2bae7cfabd18b6ce9c8,Does patient 46528 have a history of overseas travel?,,SELECT COUNT(*) > 0 FROM travel_history WHERE patient_id = 46528 AND overseas_travel = 'Yes',
db18ec5bfbe1e3422939cf2b,How much is drainage of pancreatic cyst by catheter?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pancreatic cyst by catheter' ) ),"SELECT SUM(amount) FROM ""questions"" WHERE ""question"" = 'How much is drainage of pancreatic cyst by catheter'",
f06966c4eb707fc9298cf8ed,When has patient 10015272 last had the creatine kinase (ck) minimum value?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",SELECT MAX(creatine_kinase_ (ck)) FROM patients WHERE patient_id = 10015272;,[]
edf02ff65e3bddb4db278a87,When was the last time patient 83182 had medication that should be regularly taken?,,SELECT MAX(date_supplied) FROM medication_usage WHERE patient_id = 83182 AND frequency = 'regular',
347ab7a4fae1946384a4e79f,What is the maximum total hospital cost which involves (aorto)coronary bypass of four or more coronary arteries since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM (SELECT 1 AS cost FROM coronary_arteries WHERE bypass_type = '(AORTO)CORONARY BYPASS OF FOUR OR MORE CORONARY ARTERIES') AS t1 GROUP BY t1.cost) AS t2 WHERE t2.c1 >= 2100,
c749d56aa8cacdcfa66338ba,Tell me all the prescriptions that patient 83062 received at the other department.,,SELECT prescriptions FROM rx_table WHERE department = 'other department' AND patient_id = 83062;,
c7fe6ea31f9f71af4dcc0072,How many hours is it since patient 10004733 last stayed in the careunit neurology in the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patient.admittime)) FROM patient WHERE patient.subjectid = 10004733 AND patient.dischtime IS NULL AND patient.unitassigned.careunit = 'neurology'",[]
73b0f8fd2749c9bf490fe19c,"What is the maximum total hospital cost that involves a procedure called insertion of infusion device into right atrium, percutaneous approach?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into right atrium, percutaneous approach' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(t1.c1) FROM (SELECT SUM(cost) AS c1 FROM procedures WHERE procedure_name = 'insertion of infusion device into right atrium, percutaneous approach' GROUP BY cost) AS t1",
d162e9cc060eadbc00511ac2,What methods are used to ingest lisinopril?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lisinopril',SELECT DISTINCT ingestion_method FROM products WHERE product_name = 'Lisinopril';,"[{'route': 'ORAL'}, {'route': 'PO/NG'}]"
55cd50500d3f96c291347d01,How many patients underwent transcatheter embolization for gastric or duodenal bleeding within the same month after the diagnosis of other specified hypotension?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified hypotension' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'transcatheter embolization for gastric or duodenal bleeding' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient_id, diagnosis_date FROM (SELECT patient_id, DATE(diagnosis_date) AS diagnosis_date FROM diagnoses WHERE diagnosis = 'other specified hypotension') AS t1 JOIN (SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnosis = 'transcatheter embolization for gastric or duodenal bleeding') AS t2 ON t1.patient_id = t2.patient_id WHERE t1.diagnosis_date < t2.diagnosis_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.diagnosis_date, 'start of month')",
ea75ae7fadc90d510e6c9488,What is the price of a diagnosis for other lymphedema?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other lymphedema' ) ),"SELECT ""Price (US $)"" FROM diagnoses WHERE ""Diagnosis"" = 'Other lymphedema'",
7ea687da89af68315ce96f56,Does patient 19175 have a family history of colostomy status?,,"SELECT COUNT(*) FROM patients WHERE patients.patient_id = 19175 AND patients.family_history = ""Colostomy status""",
69b4dbcc3e05876c15ab3314,During what last time in their first hospital encounter did patient 10022880 have the maximum epithelial cells level?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",SELECT MAX(epithelial_cells) FROM (SELECT epithelial_cells FROM patient_10022880 WHERE NOT patient_10022880.hospital_dischtime IS NULL ORDER BY patient_10022880.hospital_admittime NULLS FIRST LIMIT 1),[]
577572963a504b16ab2aced7,Show me patient 10004733's total volume of output since 12/07/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-07'",SELECT SUM(output) FROM 'volume_output.csv' WHERE patient_id = 10004733 AND date >= '2100-12-07',[{'SUM(outputevents.value)': 17410.0}]
1c833319621b08fd5e14e8ff,What was the last drug prescribed since 05/2100 to patient 10018328 via the sc route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT MAX(date_prescribed) FROM sc_route WHERE patient_id = 10018328 AND date_prescribed >= '2000-05-21',[]
a19797fad6ac2c57326769e0,"In 2100, has patient 10005909 been diagnosed with any illness?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'","SELECT COUNT(*) > 0 FROM diagnoses WHERE diagnoses.patient_id = 10005909 AND STRFTIME('%y', diagnoses.diagnosis_date) = '2100'",
627069dc134dd25c3ddbbb5a,What was the first medication that patient 10021118 was prescribed via po/ng route in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(dosage) FROM medication WHERE patient_id = 10021118 AND route = 'po/ng' AND dosage_date = '11/2100',[]
f0f7a54c7ede3f83d04bd4df,What was the name of the organism found in the first microbiological examination of patient 10037861's urine?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT organism_name FROM microbiology WHERE patient_id = 10037861 AND microbiology_type = 'urine' AND NOT organism_name IS NULL ORDER BY microbiology_date NULLS FIRST LIMIT 1;,[]
facfa7d227ce410e9a85def3,What is the title of the medication that was given to patient 10014078 first via the sc means on the last hospital stay?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT medication.title FROM medication WHERE medication.patient_id = 10014078 AND medication.route = 'sc' AND NOT medication.dischtime IS NULL ORDER BY medication.admittime DESC LIMIT 1;,[]
96487dd035f8b985f4b01677,When is the earliest of patient 31880's next visit to other departments?,,SELECT MIN(visit_date) FROM visit_table WHERE patient_id = 31880 AND visit_type = 'other departments',
6dbf8d68ebe9d4efd1f714f1,What was the last input time of patient 10026354 since 03/12/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' ORDER BY inputevents.starttime DESC LIMIT 1",SELECT MAX(input_time) FROM input_table WHERE patient_id = 10026354 AND input_time >= '2100-03-12',[{'starttime': '2119-10-27 14:02:00'}]
d6a0bcd1249a8b5f2385ac6b,When had patient 10018501 first been prescribed for omeprazole and phenobarbital alcohol withdrawal dose taper (days 2-7) at the same time in 08/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'omeprazole' AND admissions.subject_id = 10018501 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' AND admissions.subject_id = 10018501 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT COUNT(DISTINCT t1.id) FROM (SELECT patient.id, prescriptions.start_date FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.id WHERE prescriptions.drug = 'Omeprazole' AND patient.id = 10018501) AS t1 JOIN (SELECT patient.id, prescriptions.start_date FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.id WHERE prescriptions.drug = 'Phenobarbital Alcohol Withdrawal Dose Taper (days 2-7)' AND patient.id = 10018501) AS t2 ON t1.id = t2.id WHERE DATETIME(t1.start_date, 'start of year') = DATETIME(t2.start_date, 'start of year') AND STRFTIME('%m', t1.start_date) = STRFTIME('%m', t2.start_date)",[]
42ec95f5707880f8478c4eb9,What were the four most often conducted microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4",SELECT test_name FROM microbiology_tests WHERE date >= (SELECT CURRENT_DATE - INTERVAL '1 year') GROUP BY test_name ORDER BY COUNT(*) DESC LIMIT 4,"[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]"
5852e743e53e91715cff50d3,Tell me the length of stay in days of patient 10007795's last ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%j', icu.end_time) - STRFTIME('%j', icu.start_time) FROM icu WHERE icu.patient_id = 10007795 AND NOT icu.end_time IS NULL ORDER BY icu.start_time DESC LIMIT 1;","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.0505208340473473}]"
f1308ea9b8bbc94c5e296e34,How much does the neutrophils change in patient 10004733 last measured on the current hospital visit compared to the first value measured on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT (SELECT neutrophils FROM patient WHERE patient.hospital_visit_id IN (SELECT patient.hospital_visit_id FROM patient WHERE patient.id = 10004733 AND patient.hospital_dischtime IS NULL) ORDER BY neutrophils DESC LIMIT 1) - (SELECT neutrophils FROM patient WHERE patient.hospital_visit_id IN (SELECT patient.hospital_visit_id FROM patient WHERE patient.id = 10004733 AND patient.hospital_dischtime IS NULL) ORDER BY neutrophils DESC LIMIT 1),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]"
fb06f32bc5c8aef557ce529e,When did patient 10004422 last get prescribed aspirin and milk of magnesia at the same time in 01/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10004422 AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10004422 AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT MAX(DATE '2100-01-01') FROM prescriptions WHERE prescriptions.patient_id = 10004422 AND prescriptions.drug_name = 'aspirin' AND prescriptions.drug_name = 'milk of magnesia',[]
fd81b513857342c1199e0cf2,What was patient 10038999's last tested specimen during their first hospital encounter?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT patient.last_tested_specimen FROM patient WHERE patient.patient_id = 10038999 AND NOT patient.dischtime IS NULL ORDER BY patient.admittime NULLS FIRST LIMIT 1,[{'spec_type_desc': 'PLEURAL FLUID'}]
9c5f4de218634410a8efb1a9,Calculate the number of ICU visits of patient 10010471 since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",SELECT COUNT(DISTINCT icu_visits) FROM visits WHERE patient_id = 10010471 AND visit_date >= CURRENT_DATE - INTERVAL '1 year',[{'COUNT( DISTINCT icustays.stay_id )': 1}]
0cd0b92b050e9e355d9c8775,What's the total of avapro prescriptions in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'avapro' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug_name = 'Avapro' AND STRFTIME('%y', prescriptions.start_date) = '2100';",[{'COUNT(*)': 0}]
7a2a83f4a894b5b5f2076da6,What is today's outpatient schedule for dr. gaylor?,,"SELECT COUNT(appointments.appt_id) FROM appointments JOIN patients ON appointments.patient_id = patients.pt_id WHERE appointments.appt_type = 'Outpatient' AND patients.pt_dr = 'Gaylor' AND DATETIME(appointments.appt_date, 'start of day') = DATETIME(CURRENT_TIME, 'start of day', '-0 day')",
79e773e17e3c570dd78813ae,"How many patients received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic treatment in the same month after having been diagnosed with other diseases of bronchus, not elsewhere classified since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT patient.subject_id, diagnosis.diagnosis_date FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'Other diseases of bronchus, not elsewhere classified' AND STRFTIME('%y', diagnosis.diagnosis_date) >= '2100') AS t1 JOIN (SELECT patient.subject_id, treatment.treatment_date FROM treatment JOIN patient ON treatment.patient_id = patient.subject_id WHERE treatment.treatment = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic treatment' AND STRFTIME('%y', treatment.treatment_date) >= '2100') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis_date < t2.treatment_date AND DATETIME(t1.diagnosis_date, 'start of month') = DATETIME(t2.treatment_date, 'start",
bb37a5a6fa2b7bfb4a31e4e7,Can you show me the top five most common procedures conducted since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT t1.procedure, COUNT(t1.procedure) FROM procedures AS t1 JOIN procedures_conducted AS t2 ON t1.procedure_id = t2.procedure_id WHERE t2.conducted_since > CURRENT_TIMESTAMP - INTERVAL '1 year' GROUP BY t1.procedure ORDER BY COUNT(t1.procedure) DESC LIMIT 5",
27f86a5f461f220f2b2ed647,How many days have passed since patient 10021487 first visited the careunit emergency department on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1","SELECT 1 * (STRFTIME('%j', CURRENT_TIME) - STRFTIME('%j', patients.first_visited_emergency_department)) FROM patients WHERE patients.subject_id = 10021487 AND patients.first_visited_emergency_department IS NOT NULL AND patients.current_hospital_location = 'emergency room admit'",[]
ffd93124fef0ab4f2c5e1f7d,When did the first input for patient 10021487 occur since 12/19/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19' ORDER BY inputevents.starttime ASC LIMIT 1",SELECT MIN(date_entered) FROM input_table WHERE patient_id = 10021487 AND date_entered >= '12/19/2100',[{'starttime': '2116-12-03 00:26:00'}]
45ff22c09f3754e81e8ab8b4,How many patients underwent extracorporeal circulation auxiliary to open heart surgery within 2 months after the diagnosis of long-term (current) use of insulin?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM (SELECT subject_id, diagnosis FROM (SELECT subject_id, diagnosis FROM diagnoses WHERE diagnosis = 'long-term (current) use of insulin') AS t1 JOIN (SELECT subject_id, procedure FROM procedures WHERE procedure = 'open heart surgery') AS t2 ON t1.subject_id = t2.subject_id WHERE t1.diagnosis = t2.procedure AND DATETIME(t2.procedure) BETWEEN DATETIME(t1.diagnosis) AND DATETIME(t1.diagnosis, '+2 month')",
0e87f2737511d219196c8409,What's the weight difference of patient 10038999's body measured at 2100-06-07 05:00:00 compared to the value measured at 2100-06-06 06:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-07 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-06 06:00:00' ),SELECT (SELECT weight_kg FROM patients WHERE patient_id = 10038999 AND measurement_time = '2100-06-07 05:00:00') - (SELECT weight_kg FROM patients WHERE patient_id = 10038999 AND measurement_time = '2100-06-06 06:00:00'),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-07 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-06 06:00:00' )"": None}]"
1707f8cb73d2f9a0fc881db5,What was measured as patient 10007818's weight during the first check since 23 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-23 month') ORDER BY chartevents.charttime ASC LIMIT 1",SELECT MIN(weight) FROM patients WHERE patient_id = 10007818 AND measurement_time >= (CURRENT_TIMESTAMP - INTERVAL '23 month'),[]
8f3012a3f38700d9fef0fbad,Is patient 23070 a person with a family history of any disease?,,"SELECT COUNT(*) > 0 FROM patients WHERE patients.family_history = ""ANY"" AND patients.id = 23070",
ed9a4d3d34a8ae1c9e013631,When was the first time patient 10040025 was prescribed a medication in 03/2100 via the po/ng route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(date_prescribed) FROM medication_usage WHERE patient_id = 10040025 AND route = 'po/ng' AND date_prescribed BETWEEN '2000-03-21' AND '2000-03-21',[]
